<!DOCTYPE html>
<html lang="ko" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>이벤트 루프(또는 워커 풀)를ブロ킹하지 마세요 | API &amp; 가이드 &amp; 개발자를 위한 문서 센터</title>
    <meta name="description" content="Node.js에서 이벤트 루프와 워커 풀의 블로킹을 피하는 방법으로 DoS 공격에 강한 고성능 웹 서버를 작성하는 방법.">
    <meta name="generator" content="VitePress v2.0.0-alpha.5">
    <link rel="preload stylesheet" href="/assets/style.DMJS6Yzr.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    <script type="module" src="/assets/chunks/metadata.b396fbd4.js"></script>
    <script type="module" src="/assets/app.DawBhKzk.js"></script>
    <link rel="modulepreload" href="/assets/chunks/plugin-vue_export-helper.Bts1mPc7.js">
    <link rel="modulepreload" href="/assets/chunks/translation.CRvAmi0k.js">
    <link rel="modulepreload" href="/assets/chunks/VPLocalSearchBox.CiMs7L_f.js">
    <link rel="modulepreload" href="/assets/ko_nodejs_guide_dont-block-the-event-loop.md.dC4-8_BY.lean.js">
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
    <link rel="icon" type="image/png" href="/logo.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="theme-color" content="#5f67ee">
    <meta property="og:type" content="website">
    <meta property="og:title" content="iDoc | API &amp; Guide for Developers">
    <meta property="og:site_name" content="iDoc">
    <meta property="og:image" content="https://idoc.dev/logo.svg">
    <meta property="og:url" content="https://idoc.dev/ko/nodejs/guide/dont-block-the-event-loop">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="idoc.dev">
    <meta name="twitter:image" content="https://idoc.dev/logo.svg">
    <meta name="twitter:title" content="이벤트 루프(또는 워커 풀)를ブロ킹하지 마세요 | Node.js - iDoc.dev">
    <meta name="twitter:creator" content="neo@idoc.dev">
    <meta name="twitter:url" content="https://node.idoc.dev/">
    <meta name="twitter:description" content="Node.js에서 이벤트 루프와 워커 풀의 블로킹을 피하는 방법으로 DoS 공격에 강한 고성능 웹 서버를 작성하는 방법.">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-X0C67TVVXR"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-X0C67TVVXR");</script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3961359407117622" crossorigin="anonymous"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <meta name="og:title" content="이벤트 루프(또는 워커 풀)를ブロ킹하지 마세요 | Node.js - iDoc.dev">
    <meta name="og:description" content="Node.js에서 이벤트 루프와 워커 풀의 블로킹을 피하는 방법으로 DoS 공격에 강한 고성능 웹 서버를 작성하는 방법.">
    <link rel="canonical" href="https://idoc.dev/ko/nodejs/guide/dont-block-the-event-loop">
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-4539713c><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-4539713c data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-cb5e22fa><div class="wrapper" data-v-cb5e22fa><div class="container" data-v-cb5e22fa><div class="title" data-v-cb5e22fa><div class="VPNavBarTitle has-sidebar" data-v-cb5e22fa data-v-d4488dd0><a class="title" href="/ko/" data-v-d4488dd0><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.svg" width="24" height="24" alt="iDoc.dev" data-v-ab19afbb><!--]--><span data-v-d4488dd0>iDoc</span><!--[--><!--]--></a></div></div><div class="content" data-v-cb5e22fa><div class="content-body" data-v-cb5e22fa><!--[--><!--]--><div class="VPNavBarSearch search" data-v-cb5e22fa><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="문서 검색"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">문서 검색</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-cb5e22fa data-v-020be4db><span id="main-nav-aria-label" class="visually-hidden" data-v-020be4db> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/ko/nodejs/api/synopsis" tabindex="0" data-v-020be4db data-v-815115f5><!--[--><span data-v-815115f5>API 참고</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/ko/nodejs/guide/what-is-nodejs" tabindex="0" data-v-020be4db data-v-815115f5><!--[--><span data-v-815115f5>가이드</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-cb5e22fa data-v-acee064b data-v-9bb987dd><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="다국어" data-v-9bb987dd><span class="text" data-v-9bb987dd><span class="vpi-languages option-icon" data-v-9bb987dd></span><!----><span class="vpi-chevron-down text-icon" data-v-9bb987dd></span></span></button><div class="menu" data-v-9bb987dd><div class="VPMenu" data-v-9bb987dd data-v-2f78439e><!----><!--[--><!--[--><div class="items" data-v-acee064b><p class="title" data-v-acee064b>한국어</p><!--[--><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>English</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/zh/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>简体中文</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/es/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Español</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/fr/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Français</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/pt/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Português</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/de/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Deutsch</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/it/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Italiano</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/ja/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>日本語</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/ru/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Русский</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/ar/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>العربية</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-cb5e22fa data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-cb5e22fa data-v-f953d92f data-v-9bb987dd><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-9bb987dd><span class="vpi-more-horizontal icon" data-v-9bb987dd></span></button><div class="menu" data-v-9bb987dd><div class="VPMenu" data-v-9bb987dd data-v-2f78439e><!----><!--[--><!--[--><div class="group translations" data-v-f953d92f><p class="trans-title" data-v-f953d92f>한국어</p><!--[--><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>English</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/zh/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>简体中文</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/es/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Español</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/fr/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Français</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/pt/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Português</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/de/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Deutsch</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/it/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Italiano</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/ja/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>日本語</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/ru/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Русский</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/ar/nodejs/guide/dont-block-the-event-loop" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>العربية</span><!--]--></a></div><!--]--></div><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>테마</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-cb5e22fa data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-cb5e22fa><div class="divider-line" data-v-cb5e22fa></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-4539713c data-v-6c0451ca><div class="container" data-v-6c0451ca><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-6c0451ca><span class="vpi-align-left menu-icon" data-v-6c0451ca></span><span class="menu-text" data-v-6c0451ca>메뉴</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-6c0451ca data-v-92b7576c><button data-v-92b7576c>맨 위로</button><!----></div></div></div><aside class="VPSidebar" data-v-4539713c data-v-606f96d3><div class="curtain" data-v-606f96d3></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-606f96d3><span class="visually-hidden" id="sidebar-aria-label" data-v-606f96d3> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>입문 가이드</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/what-is-nodejs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>소개</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/how-to-install-nodejs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js 설치 방법</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/javascript-for-nodejs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js의 JavaScript</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/differences-between-node-and-browser" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js와 브라우저의 차이점</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/v8-engine" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>V8 JavaScript 엔진</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/npm-package-manager" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Npm 패키지 관리자</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/ECMAScript-2015(ES6)-and-beyond" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ECMAScript 2015(ES6) 및 이후 버전</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/the-difference-between-development-and-production" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js: 개발과 생산의 차이점</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/nodejs-with-typescript" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>TypeScript와 함께 사용하는 Node.js</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/nodejs-with-webassembly" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>WebAssembly와 함께 사용하는 Node.js</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/debugging-nodejs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js 디버깅</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/profiling-nodejs-applications" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js 애플리케이션 분석</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/security-best-practices" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>보안 모범 사례</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed has-active" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>비동기 작업</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/asynchronous-flow-control" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>비동기 흐름 제어</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/overview-of-blocking-vs-non-blocking" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>차단과 비차단 개요</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/javascript-asynchronous-programming-and-callbacks" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>JavaScript 비동기 프로그래밍과 콜백</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/discover-javascript-timer" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>JavaScript 타이머 개요</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/nodejs-event-loop" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js 이벤트 루프</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/nodejs-event-emitter" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js 이벤트 발행기</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/understanding-process-nexttick" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>process.nextTick() 이해하기</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/understanding-setimmediate" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>setImmediate() 이해하기</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/dont-block-the-event-loop" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>이벤트 루프 차단하지 않기</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>파일 작업</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/nodejs-file-stats" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js 파일 통계</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/nodejs-file-path" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js 파일 경로</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/working-with-file-descriptors-in-nodejs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js에서 파일 디스크립터 작업하기</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/reading-files-with-nodejs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js에서 파일 읽기</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/writing-files-with-nodejs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js에서 파일 쓰기</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/working-with-folders-in-nodejs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js에서 폴더 작업하기</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/how-to-work-with-different-filesystems" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>다양한 파일 시스템 작업하기</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>명령줄</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/run-nodejs-scripts-from-the-command-line" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>명령줄에서 Node.js 스크립트 실행하기</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/how-to-read-environment-variables-from-nodejs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js에서 환경 변수 읽기</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/how-to-use-the-nodejs-repl" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js REPL 사용법</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/output-to-the-command-line-using-nodejs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js를 사용한 명령줄 출력</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/accept-input-from-the-command-line-in-nodejs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js 명령줄 입력 받기</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>모듈</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/how-to-publish-a-nodejs-package" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js 패키지 배포 방법</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/anatomy-of-an-http-transaction" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>HTTP 트랜잭션 분석</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/abi-stability" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ABI 안정성</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/backpressuring-in-streams" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>스트림에서의 백프레셔 처리</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>진단</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/user-journey" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>사용자 경험</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/memory" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>메모리</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/live-debugging" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>실시간 디버깅</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/poor-performance" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>성능 저하</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/flame-graphs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>플레임 그래프</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>테스트 실행기</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/discovering-nodejs-test-runner" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js 테스트 실행기 탐색</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ko/nodejs/guide/using-nodejs-test-runner" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Node.js 테스트 실행기 사용법</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-4539713c data-v-2652e39a><div class="VPDoc has-sidebar has-aside" data-v-2652e39a data-v-d668f7cc><!--[--><!--]--><div class="container" data-v-d668f7cc><div class="aside" data-v-d668f7cc><div class="aside-curtain" data-v-d668f7cc></div><div class="aside-container" data-v-d668f7cc><div class="aside-content" data-v-d668f7cc><div class="VPDocAside" data-v-d668f7cc data-v-cb998dce><!--[--><!--[--><!--[--><!--[--><div class="share"><div class="share-item"><a href="https://twitter.com/intent/tweet?text=%EC%9D%B4%EB%B2%A4%ED%8A%B8%20%EB%A3%A8%ED%94%84(%EB%98%90%EB%8A%94%20%EC%9B%8C%EC%BB%A4%20%ED%92%80)%EB%A5%BC%E3%83%96%E3%83%AD%ED%82%B9%ED%95%98%EC%A7%80%20%EB%A7%88%EC%84%B8%EC%9A%94%20%7C%20API%20%26%20%EA%B0%80%EC%9D%B4%EB%93%9C%20%26%20%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%A5%BC%20%EC%9C%84%ED%95%9C%20%EB%AC%B8%EC%84%9C%20%EC%84%BC%ED%84%B0&amp;url=https%3A%2F%2Fidoc.dev%2Fko%2Fnodejs%2Fguide%2Fdont-block-the-event-loop" target="_blank" title="공유하기 X"><img src="https://idoc.dev/x-logo.svg" alt="X" class="logo x-logo"></a></div><div class="share-item"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fidoc.dev%2Fko%2Fnodejs%2Fguide%2Fdont-block-the-event-loop" target="_blank" title="공유하기 Facebook"><img src="https://idoc.dev/fb-logo.svg" alt="Facebook" class="logo fb-logo"></a></div></div><!--]--><!--]--><!--]--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-c8b19031><div class="content" data-v-c8b19031><div class="outline-marker" data-v-c8b19031></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-c8b19031>페이지 탐색</div><ul class="VPDocOutlineItem root" data-v-c8b19031 data-v-b7d7ef80><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--[--><!--[--><!--[--><ins class="adsbygoogle" style="display:block;" data-ad-client="ca-pub-3961359407117622" data-ad-slot="4724601302" data-ad-format="auto" data-full-width-responsive="true"></ins><!--]--><!--]--><!--]--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-d668f7cc><div class="content-container" data-v-d668f7cc><!--[--><!--]--><main class="main" data-v-d668f7cc><div style="position:relative;" class="vp-doc _ko_nodejs_guide_dont-block-the-event-loop" data-v-d668f7cc><div><h1 id="이벤트-루프-또는-워커-풀-를-막지-마세요" tabindex="-1">이벤트 루프(또는 워커 풀)를 막지 마세요 <a class="header-anchor" href="#이벤트-루프-또는-워커-풀-를-막지-마세요" aria-label="Permalink to “이벤트 루프(또는 워커 풀)를 막지 마세요”">​</a></h1><h2 id="이-가이드를-읽어야-할까요" tabindex="-1">이 가이드를 읽어야 할까요? <a class="header-anchor" href="#이-가이드를-읽어야-할까요" aria-label="Permalink to “이 가이드를 읽어야 할까요?”">​</a></h2><p>간단한 명령줄 스크립트보다 복잡한 것을 작성하고 있다면, 이것을 읽는 것이 더 높은 성능과 더 안전한 애플리케이션을 작성하는 데 도움이 될 것입니다.</p><p>이 문서는 Node.js 서버를 염두에 두고 작성되었지만, 개념은 복잡한 Node.js 애플리케이션에도 적용됩니다. OS별 세부 사항이 다른 경우, 이 문서는 Linux 중심입니다.</p><h2 id="요약" tabindex="-1">요약 <a class="header-anchor" href="#요약" aria-label="Permalink to “요약”">​</a></h2><p>Node.js는 이벤트 루프(초기화 및 콜백)에서 JavaScript 코드를 실행하고, 파일 I/O와 같은 비용이 많이 드는 작업을 처리하기 위해 워커 풀을 제공합니다. Node.js는 확장성이 뛰어나며, 때로는 Apache와 같이 더 무거운 접근 방식보다 낫습니다. Node.js의 확장성의 비결은 적은 수의 스레드를 사용하여 많은 클라이언트를 처리한다는 것입니다. Node.js가 더 적은 스레드로도 충분히 처리할 수 있다면, 시스템의 시간과 메모리를 스레드에 대한 공간 및 시간 오버헤드(메모리, 컨텍스트 전환)를 지불하는 대신 클라이언트에 더 많이 사용할 수 있습니다. 하지만 Node.js는 스레드가 적기 때문에, 애플리케이션을 현명하게 사용하도록 구성해야 합니다.</p><p>Node.js 서버를 빠르게 유지하는 데 도움이 되는 좋은 규칙은 다음과 같습니다. <em>Node.js는 주어진 시간에 각 클라이언트와 관련된 작업이 &quot;작을&quot; 때 빠릅니다.</em></p><p>이는 이벤트 루프의 콜백과 워커 풀의 작업에 적용됩니다.</p><h2 id="왜-이벤트-루프와-워커-풀을-막지-말아야-할까요" tabindex="-1">왜 이벤트 루프와 워커 풀을 막지 말아야 할까요? <a class="header-anchor" href="#왜-이벤트-루프와-워커-풀을-막지-말아야-할까요" aria-label="Permalink to “왜 이벤트 루프와 워커 풀을 막지 말아야 할까요?”">​</a></h2><p>Node.js는 적은 수의 스레드를 사용하여 많은 클라이언트를 처리합니다. Node.js에는 두 가지 유형의 스레드가 있습니다. 하나는 이벤트 루프(메인 루프, 메인 스레드, 이벤트 스레드 등으로도 알려짐)이고, 다른 하나는 워커 풀의 <code>k</code> 워커 풀(스레드 풀이라고도 함)입니다.</p><p>스레드가 콜백(이벤트 루프) 또는 작업(워커)을 실행하는 데 오랜 시간이 걸리는 경우, 우리는 그것을 &quot;막혔다&quot;라고 부릅니다. 스레드가 한 클라이언트를 대신하여 막혀 있는 동안에는 다른 클라이언트의 요청을 처리할 수 없습니다. 이는 이벤트 루프나 워커 풀을 막지 않아야 하는 두 가지 동기를 제공합니다.</p><ol><li>성능: 두 유형의 스레드에서 모두 정기적으로 무거운 활동을 수행하면 서버의 <em>처리량</em>(요청/초)이 저하됩니다.</li><li>보안: 특정 입력에 대해 스레드 중 하나가 막힐 수 있는 경우, 악의적인 클라이언트가 이 &quot;악성 입력&quot;을 제출하여 스레드를 막히게 하고 다른 클라이언트에 대한 작업을 수행하지 못하게 할 수 있습니다. 이는 <a href="https://en.wikipedia.org/wiki/Denial-of-service_attack" target="_blank" rel="noreferrer">서비스 거부 공격</a>입니다.</li></ol><h2 id="node에-대한-간략한-복습" tabindex="-1">Node에 대한 간략한 복습 <a class="header-anchor" href="#node에-대한-간략한-복습" aria-label="Permalink to “Node에 대한 간략한 복습”">​</a></h2><p>Node.js는 이벤트 기반 아키텍처를 사용합니다. 오케스트레이션을 위한 이벤트 루프와 비용이 많이 드는 작업을 위한 작업자 풀이 있습니다.</p><h3 id="이벤트-루프에서-실행되는-코드는-무엇입니까" tabindex="-1">이벤트 루프에서 실행되는 코드는 무엇입니까? <a class="header-anchor" href="#이벤트-루프에서-실행되는-코드는-무엇입니까" aria-label="Permalink to “이벤트 루프에서 실행되는 코드는 무엇입니까?”">​</a></h3><p>Node.js 애플리케이션은 시작될 때 먼저 초기화 단계를 완료하고 모듈을 <code>require</code>하고 이벤트에 대한 콜백을 등록합니다. 그런 다음 Node.js 애플리케이션은 이벤트 루프에 진입하여 적절한 콜백을 실행하여 들어오는 클라이언트 요청에 응답합니다. 이 콜백은 동기적으로 실행되며 완료 후 처리를 계속하기 위해 비동기 요청을 등록할 수 있습니다. 이러한 비동기 요청에 대한 콜백도 이벤트 루프에서 실행됩니다.</p><p>이벤트 루프는 또한 콜백에 의해 이루어진 네트워크 I/O와 같은 비차단 비동기 요청을 수행합니다.</p><p>요약하면 이벤트 루프는 이벤트에 등록된 JavaScript 콜백을 실행하고 네트워크 I/O와 같은 비차단 비동기 요청을 수행하는 역할도 합니다.</p><h3 id="작업자-풀에서-실행되는-코드는-무엇입니까" tabindex="-1">작업자 풀에서 실행되는 코드는 무엇입니까? <a class="header-anchor" href="#작업자-풀에서-실행되는-코드는-무엇입니까" aria-label="Permalink to “작업자 풀에서 실행되는 코드는 무엇입니까?”">​</a></h3><p>Node.js의 작업자 풀은 일반적인 작업 제출 API를 노출하는 libuv(<a href="http://docs.libuv.org/en/v1.x/threadpool.html" target="_blank" rel="noreferrer">문서</a>)에서 구현됩니다.</p><p>Node.js는 작업자 풀을 사용하여 &quot;비용이 많이 드는&quot; 작업을 처리합니다. 여기에는 운영 체제가 비차단 버전을 제공하지 않는 I/O와 특히 CPU 집약적인 작업이 포함됩니다.</p><p>다음은 이 작업자 풀을 사용하는 Node.js 모듈 API입니다.</p><ol><li>I/O 집약적 <ol><li><a href="/ko/nodejs/api/dns">DNS</a>: <code>dns.lookup()</code>, <code>dns.lookupService()</code>.</li><li>[파일 시스템][/api/fs]: <code>fs.FSWatcher()</code>와 명시적으로 동기적인 API를 제외한 모든 파일 시스템 API는 libuv의 스레드 풀을 사용합니다.</li></ol></li><li>CPU 집약적 <ol><li><a href="/ko/nodejs/api/crypto">Crypto</a>: <code>crypto.pbkdf2()</code>, <code>crypto.scrypt()</code>, <code>crypto.randomBytes()</code>, <code>crypto.randomFill()</code>, <code>crypto.generateKeyPair()</code>.</li><li><a href="/ko/nodejs/api/zlib">Zlib</a>: 명시적으로 동기적인 API를 제외한 모든 zlib API는 libuv의 스레드 풀을 사용합니다.</li></ol></li></ol><p>많은 Node.js 애플리케이션에서 이러한 API는 작업자 풀에 대한 유일한 작업 소스입니다. <a href="/ko/nodejs/api/addons">C++ 애드온</a>을 사용하는 애플리케이션 및 모듈은 작업자 풀에 다른 작업을 제출할 수 있습니다.</p><p>완전성을 위해 이벤트 루프의 콜백에서 이러한 API 중 하나를 호출하면 이벤트 루프가 해당 API에 대한 Node.js C++ 바인딩에 들어가 작업자 풀에 작업을 제출할 때 약간의 설정 비용을 지불한다는 점에 주목합니다. 이러한 비용은 작업의 전체 비용에 비해 무시할 만하므로 이벤트 루프에서 오프로딩하는 이유입니다. 이러한 작업을 작업자 풀에 제출할 때 Node.js는 Node.js C++ 바인딩에서 해당 C++ 함수에 대한 포인터를 제공합니다.</p><h3 id="node-js는-다음에-실행할-코드를-어떻게-결정합니까" tabindex="-1">Node.js는 다음에 실행할 코드를 어떻게 결정합니까? <a class="header-anchor" href="#node-js는-다음에-실행할-코드를-어떻게-결정합니까" aria-label="Permalink to “Node.js는 다음에 실행할 코드를 어떻게 결정합니까?”">​</a></h3><p>추상적으로, 이벤트 루프와 워커 풀은 각각 대기 중인 이벤트와 대기 중인 작업에 대한 큐를 유지합니다.</p><p>사실, 이벤트 루프는 실제로 큐를 유지하지 않습니다. 대신, <a href="http://man7.org/linux/man-pages/man7/epoll.7.html" target="_blank" rel="noreferrer">epoll</a> (Linux), <a href="https://developer.apple.com/library/content/documentation/Darwin/Conceptual/FSEvents_ProgGuide/KernelQueues/KernelQueues.html" target="_blank" rel="noreferrer">kqueue</a> (OSX), 이벤트 포트 (Solaris) 또는 <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa365198.aspx" target="_blank" rel="noreferrer">IOCP</a> (Windows)와 같은 메커니즘을 사용하여 운영 체제에 모니터링하도록 요청하는 파일 디스크립터의 모음을 가지고 있습니다. 이러한 파일 디스크립터는 네트워크 소켓, 감시하는 모든 파일 등에 해당합니다. 운영 체제가 이러한 파일 디스크립터 중 하나가 준비되었다고 말하면 이벤트 루프는 이를 적절한 이벤트로 변환하고 해당 이벤트와 관련된 콜백을 호출합니다. 이 프로세스에 대한 자세한 내용은 <a href="https://www.youtube.com/watch?v=P9csgxBgaZ8" target="_blank" rel="noreferrer">여기</a>에서 확인할 수 있습니다.</p><p>반대로, 워커 풀은 처리할 작업이 항목인 실제 큐를 사용합니다. 워커는 이 큐에서 작업을 팝하고 작업을 수행하며, 완료되면 워커는 이벤트 루프에 대해 &quot;최소한 하나의 작업이 완료되었습니다&quot; 이벤트를 발생시킵니다.</p><h3 id="이것이-애플리케이션-설계에-의미하는-바는-무엇입니까" tabindex="-1">이것이 애플리케이션 설계에 의미하는 바는 무엇입니까? <a class="header-anchor" href="#이것이-애플리케이션-설계에-의미하는-바는-무엇입니까" aria-label="Permalink to “이것이 애플리케이션 설계에 의미하는 바는 무엇입니까?”">​</a></h3><p>Apache와 같은 클라이언트당 하나의 스레드 시스템에서는 각 대기 중인 클라이언트에 자체 스레드가 할당됩니다. 한 클라이언트를 처리하는 스레드가 차단되면 운영 체제는 해당 스레드를 중단하고 다른 클라이언트에게 차례를 넘깁니다. 따라서 운영 체제는 소량의 작업이 필요한 클라이언트가 더 많은 작업이 필요한 클라이언트로 인해 불이익을 받지 않도록 합니다.</p><p>Node.js는 적은 수의 스레드로 많은 클라이언트를 처리하므로 한 스레드가 한 클라이언트의 요청을 처리하는 동안 차단되면 대기 중인 클라이언트 요청은 스레드가 콜백 또는 작업을 완료할 때까지 차례를 얻지 못할 수 있습니다. 따라서 클라이언트에 대한 공정한 처리는 애플리케이션의 책임입니다. 이는 콜백이나 작업에서 단일 클라이언트에 대해 너무 많은 작업을 수행해서는 안 된다는 의미입니다.</p><p>이것이 Node.js가 잘 확장될 수 있는 이유 중 하나이지만 공정한 스케줄링을 보장하는 것은 귀하의 책임이기도 합니다. 다음 섹션에서는 이벤트 루프 및 워커 풀에 대한 공정한 스케줄링을 보장하는 방법에 대해 설명합니다.</p><h2 id="이벤트-루프를-차단하지-마세요" tabindex="-1">이벤트 루프를 차단하지 마세요 <a class="header-anchor" href="#이벤트-루프를-차단하지-마세요" aria-label="Permalink to “이벤트 루프를 차단하지 마세요”">​</a></h2><p>이벤트 루프는 각 새 클라이언트 연결을 감지하고 응답 생성을 조율합니다. 들어오는 모든 요청과 나가는 모든 응답은 이벤트 루프를 통과합니다. 즉, 이벤트 루프가 특정 지점에서 너무 오래 머무르면 현재 및 새로운 클라이언트 모두 기회를 얻지 못합니다.</p><p>이벤트 루프를 절대 차단하지 않도록 해야 합니다. 즉, 각 JavaScript 콜백이 빠르게 완료되어야 합니다. 물론 이는 <code>await</code>, <code>Promise.then</code> 등에도 적용됩니다.</p><p>이를 보장하는 좋은 방법은 콜백의 <a href="https://en.wikipedia.org/wiki/Time_complexity" target="_blank" rel="noreferrer">&quot;계산 복잡도&quot;</a>를 추론하는 것입니다. 콜백이 인수에 관계없이 일정한 단계 수를 취하면 모든 대기 중인 클라이언트에게 공정한 기회를 제공합니다. 콜백이 인수에 따라 다른 단계 수를 취하면 인수의 길이가 얼마나 될지 고려해야 합니다.</p><p>예제 1: 상수 시간 콜백.</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/constant-time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sendStatus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>예제 2: <code>O(n)</code> 콜백. 이 콜백은 작은 <code>n</code>의 경우 빠르게 실행되고 큰 <code>n</code>의 경우 더 느리게 실행됩니다.</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/countToN&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> req.query.n;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 다른 사람에게 기회를 주기 전에 n번 반복</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`Iter ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sendStatus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>예제 3: <code>O(n^2)</code> 콜백. 이 콜백은 여전히 작은 <code>n</code>의 경우 빠르게 실행되지만 큰 <code>n</code>의 경우 이전 <code>O(n)</code> 예제보다 훨씬 느리게 실행됩니다.</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/countToN2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> req.query.n;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 다른 사람에게 기회를 주기 전에 n^2번 반복</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n; j</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`Iter ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}.${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">j</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sendStatus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="얼마나-주의해야-할까요" tabindex="-1">얼마나 주의해야 할까요? <a class="header-anchor" href="#얼마나-주의해야-할까요" aria-label="Permalink to “얼마나 주의해야 할까요?”">​</a></h3><p>Node.js는 JavaScript에 Google V8 엔진을 사용하며, 이는 많은 일반적인 작업에 매우 빠릅니다. 이 규칙의 예외는 아래에서 설명하는 정규 표현식 및 JSON 작업입니다.</p><p>그러나 복잡한 작업의 경우 입력을 제한하고 너무 긴 입력을 거부하는 것을 고려해야 합니다. 이렇게 하면 콜백의 복잡성이 크더라도 입력을 제한하여 콜백이 가장 긴 허용 가능한 입력에서 최악의 시간보다 오래 걸릴 수 없도록 할 수 있습니다. 그런 다음 이 콜백의 최악의 비용을 평가하고 해당 실행 시간이 컨텍스트에서 허용 가능한지 여부를 결정할 수 있습니다.</p><h2 id="이벤트-루프-차단-redos" tabindex="-1">이벤트 루프 차단: REDOS <a class="header-anchor" href="#이벤트-루프-차단-redos" aria-label="Permalink to “이벤트 루프 차단: REDOS”">​</a></h2><p>이벤트 루프를 끔찍하게 차단하는 일반적인 방법 중 하나는 &quot;취약한&quot; <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank" rel="noreferrer">정규 표현식</a>을 사용하는 것입니다.</p><h3 id="취약한-정규-표현식-피하기" tabindex="-1">취약한 정규 표현식 피하기 <a class="header-anchor" href="#취약한-정규-표현식-피하기" aria-label="Permalink to “취약한 정규 표현식 피하기”">​</a></h3><p>정규 표현식(regexp)은 입력 문자열을 패턴과 비교합니다. 일반적으로 정규 표현식 일치는 입력 문자열을 한 번만 통과하는 데 걸리는 시간 <code>--- O(n)</code>(여기서 <code>n</code>은 입력 문자열의 길이)으로 생각합니다. 대부분의 경우 한 번의 통과로 충분합니다. 불행히도, 어떤 경우에는 정규 표현식 일치에 입력 문자열을 통과하는 데 지수 횟수가 필요할 수 있습니다. <code>--- O(2^n)</code> 시간. 지수 횟수의 통과는 엔진이 일치를 결정하는 데 x번의 통과가 필요한 경우 입력 문자열에 문자를 하나만 더 추가하면 <code>2*x</code>번의 통과가 필요함을 의미합니다. 통과 횟수는 필요한 시간과 선형적으로 관련되므로 이 평가의 효과는 이벤트 루프를 차단하는 것입니다.</p><p><em>취약한 정규 표현식</em>은 정규 표현식 엔진이 지수 시간을 사용할 수 있어 &quot;악의적인 입력&quot;에 대한 <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS" target="_blank" rel="noreferrer">REDOS</a>에 노출될 수 있는 정규 표현식입니다. 정규 표현식 패턴이 취약한지 여부(예: 정규 표현식 엔진이 지수 시간을 사용할 수 있는지 여부)는 실제로 대답하기 어려운 질문이며 Perl, Python, Ruby, Java, JavaScript 등을 사용하는지 여부에 따라 다르지만 다음은 이러한 모든 언어에 적용되는 몇 가지 경험 법칙입니다.</p><ol><li><code>(a+)*</code>와 같은 중첩된 수량자를 피하십시오. V8의 정규 표현식 엔진은 이러한 수량자 중 일부를 빠르게 처리할 수 있지만 다른 수량자는 취약합니다.</li><li><code>(a|a)*</code>와 같이 겹치는 절이 있는 OR를 피하십시오. 다시 말하지만, 이들은 때로는 빠릅니다.</li><li><code>(a.*) \1</code>과 같은 역참조를 사용하지 마십시오. 어떤 정규 표현식 엔진도 선형 시간으로 이러한 역참조를 평가할 수 있다고 보장할 수 없습니다.</li><li>간단한 문자열 일치를 수행하는 경우 <code>indexOf</code> 또는 로컬에 해당하는 것을 사용하십시오. 더 저렴하고 <code>O(n)</code> 이상 걸리지 않습니다.</li></ol><p>정규 표현식이 취약한지 확실하지 않은 경우 Node.js는 일반적으로 취약한 정규 표현식과 긴 입력 문자열에 대해서도 일치를 보고하는 데 어려움이 없다는 점을 기억하십시오. 지수 동작은 불일치가 있지만 Node.js가 입력 문자열을 통해 여러 경로를 시도할 때까지 확신할 수 없을 때 트리거됩니다.</p><h3 id="redos-예시" tabindex="-1">REDOS 예시 <a class="header-anchor" href="#redos-예시" aria-label="Permalink to “REDOS 예시”">​</a></h3><p>다음은 서버를 REDOS에 노출시키는 취약한 정규 표현식의 예입니다.</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/redos-me&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> filePath </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> req.query.filePath;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // REDOS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (filePath.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">(</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;valid path&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;invalid path&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sendStatus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>이 예제의 취약한 정규 표현식은 (나쁜!) Linux에서 유효한 경로를 확인하는 방법입니다. &quot;<code>/a/b/c</code>&quot;와 같이 &quot;/&quot;로 구분된 이름의 시퀀스인 문자열과 일치합니다. 규칙 1을 위반하므로 위험합니다. 이중으로 중첩된 수량자가 있습니다.</p><p>클라이언트가 <code>///.../\n</code> (100개의 &#39;/&#39;와 정규 표현식의 &quot;.&quot;와 일치하지 않는 줄 바꿈 문자)으로 filePath를 쿼리하면 이벤트 루프는 사실상 영원히 걸려 이벤트 루프를 차단합니다. 이 클라이언트의 REDOS 공격으로 인해 다른 모든 클라이언트는 정규 표현식 일치가 완료될 때까지 차례를 얻지 못합니다.</p><p>이러한 이유로 복잡한 정규 표현식을 사용하여 사용자 입력을 검증하는 것을 경계해야 합니다.</p><h3 id="안티-redos-리소스" tabindex="-1">안티 REDOS 리소스 <a class="header-anchor" href="#안티-redos-리소스" aria-label="Permalink to “안티 REDOS 리소스”">​</a></h3><p>다음과 같이 정규 표현식의 안전성을 검사하는 도구가 있습니다.</p><ul><li><a href="https://github.com/davisjam/safe-regex" target="_blank" rel="noreferrer">safe-regex</a></li><li><a href="https://github.com/superhuman/rxxr2" target="_blank" rel="noreferrer">rxxr2</a></li></ul><p>그러나 이들 중 어느 것도 모든 취약한 정규 표현식을 잡지는 못합니다.</p><p>또 다른 접근 방식은 다른 정규 표현식 엔진을 사용하는 것입니다. Google의 매우 빠른 <a href="https://github.com/google/re2" target="_blank" rel="noreferrer">RE2</a> 정규 표현식 엔진을 사용하는 <a href="https://github.com/uhop/node-re2" target="_blank" rel="noreferrer">node-re2</a> 모듈을 사용할 수 있습니다. 그러나 RE2는 V8의 정규 표현식과 100% 호환되지 않으므로 node-re2 모듈을 교체하여 정규 표현식을 처리하는 경우 회귀가 있는지 확인하십시오. 그리고 특히 복잡한 정규 표현식은 node-re2에서 지원되지 않습니다.</p><p>URL 또는 파일 경로와 같이 &quot;명확한&quot; 것을 일치시키려는 경우 <a href="http://www.regexlib.com/" target="_blank" rel="noreferrer">정규 표현식 라이브러리</a>에서 예제를 찾거나 npm 모듈 (예 : <a href="https://www.npmjs.com/package/ip-regex" target="_blank" rel="noreferrer">ip-regex</a>)을 사용하십시오.</p><h3 id="이벤트-루프-차단-node-js-핵심-모듈" tabindex="-1">이벤트 루프 차단 : Node.js 핵심 모듈 <a class="header-anchor" href="#이벤트-루프-차단-node-js-핵심-모듈" aria-label="Permalink to “이벤트 루프 차단 : Node.js 핵심 모듈”">​</a></h3><p>여러 Node.js 핵심 모듈에는 다음과 같은 동기식으로 비용이 많이 드는 API가 있습니다.</p><ul><li><a href="/ko/nodejs/api/crypto">암호화</a></li><li><a href="/ko/nodejs/api/zlib">압축</a></li><li><a href="/ko/nodejs/api/fs">파일 시스템</a></li><li><a href="/ko/nodejs/api/child_process">자식 프로세스</a></li></ul><p>이러한 API는 상당한 계산 (암호화, 압축)을 포함하거나 I/O (파일 I/O)가 필요하거나 잠재적으로 둘 다 (자식 프로세스) 필요하므로 비용이 많이 듭니다. 이러한 API는 스크립팅 편의를 위한 것이지만 서버 컨텍스트에서 사용하기 위한 것은 아닙니다. 이벤트 루프에서 실행하면 일반적인 JavaScript 명령어보다 완료하는 데 훨씬 오래 걸려 이벤트 루프를 차단합니다.</p><p>서버에서는 이러한 모듈에서 다음 동기식 API를 사용해서는 안됩니다.</p><ul><li>암호화 : <ul><li><code>crypto.randomBytes</code> (동기식 버전)</li><li><code>crypto.randomFillSync</code></li><li><code>crypto.pbkdf2Sync</code></li><li>또한 암호화 및 해독 루틴에 큰 입력을 제공하는 데주의해야합니다.</li></ul></li><li>압축 : <ul><li><code>zlib.inflateSync</code></li><li><code>zlib.deflateSync</code></li></ul></li><li>파일 시스템 : <ul><li>동기식 파일 시스템 API를 사용하지 마십시오. 예를 들어 액세스하는 파일이 <a href="https://en.wikipedia.org/wiki/Network_File_System" target="_blank" rel="noreferrer">NFS</a>와 같은 <a href="https://en.wikipedia.org/wiki/Clustered_file_system#Distributed_file_systems" target="_blank" rel="noreferrer">분산 파일 시스템</a>에있는 경우 액세스 시간이 크게 다를 수 있습니다.</li></ul></li><li>자식 프로세스 : <ul><li><code>child_process.spawnSync</code></li><li><code>child_process.execSync</code></li><li><code>child_process.execFileSync</code></li></ul></li></ul><p>이 목록은 Node.js v9를 기준으로 상당히 완전합니다.</p><h2 id="이벤트-루프-차단-json-dos" tabindex="-1">이벤트 루프 차단: JSON DOS <a class="header-anchor" href="#이벤트-루프-차단-json-dos" aria-label="Permalink to “이벤트 루프 차단: JSON DOS”">​</a></h2><p><code>JSON.parse</code> 및 <code>JSON.stringify</code>는 잠재적으로 비용이 많이 드는 또 다른 작업입니다. 입력 길이 n에 대해 O(n)이지만, n이 클 경우 예상보다 오래 걸릴 수 있습니다.</p><p>서버가 JSON 객체, 특히 클라이언트에서 온 객체를 조작하는 경우, 이벤트 루프에서 작업하는 객체 또는 문자열의 크기에 주의해야 합니다.</p><p>예제: JSON 차단. 크기가 2^21인 객체 <code>obj</code>를 생성하고 <code>JSON.stringify</code>를 사용하여 문자열로 변환하고, 해당 문자열에서 indexOf를 실행한 다음 <code>JSON.parse</code>를 사용하여 다시 객체로 변환합니다. <code>JSON.stringify</code>된 문자열의 크기는 50MB입니다. 객체를 문자열로 변환하는 데 0.7초, 50MB 문자열에서 indexOf를 실행하는 데 0.03초, 문자열을 파싱하는 데 1.3초가 걸립니다.</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> obj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { a: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> niter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> before, str, pos, res, took;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> niter; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  obj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { obj1: obj, obj2: obj }; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 각 반복마다 크기가 두 배로 증가</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">before </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> process.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">str </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obj);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">took </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> process.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(before);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;JSON.stringify took &#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> took);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">before </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> process.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> str.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">indexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;nomatch&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">took </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> process.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(before);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Pure indexof took &#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> took);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">before </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> process.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(str);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">took </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> process.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(before);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;JSON.parse took &#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> took);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>비동기 JSON API를 제공하는 npm 모듈이 있습니다. 예를 들어 다음을 참조하십시오.</p><ul><li>스트림 API를 제공하는 <a href="https://www.npmjs.com/package/JSONStream" target="_blank" rel="noreferrer">JSONStream</a></li><li>스트림 API와 아래에 설명된 이벤트 루프 분할 패러다임을 사용하는 표준 JSON API의 비동기 버전을 제공하는 <a href="https://www.npmjs.com/package/bfj" target="_blank" rel="noreferrer">Big-Friendly JSON</a></li></ul><h2 id="이벤트-루프를-차단하지-않고-복잡한-계산-수행" tabindex="-1">이벤트 루프를 차단하지 않고 복잡한 계산 수행 <a class="header-anchor" href="#이벤트-루프를-차단하지-않고-복잡한-계산-수행" aria-label="Permalink to “이벤트 루프를 차단하지 않고 복잡한 계산 수행”">​</a></h2><p>이벤트 루프를 차단하지 않고 JavaScript에서 복잡한 계산을 수행하려는 경우, 분할 또는 오프로딩의 두 가지 옵션이 있습니다.</p><h3 id="분할" tabindex="-1">분할 <a class="header-anchor" href="#분할" aria-label="Permalink to “분할”">​</a></h3><p>계산을 <em>분할</em>하여 각 계산이 이벤트 루프에서 실행되지만 정기적으로 다른 보류 중인 이벤트에 양보(차례를 넘겨줌)하도록 할 수 있습니다. JavaScript에서는 아래 예제 2에서와 같이 진행 중인 작업의 상태를 클로저에 쉽게 저장할 수 있습니다.</p><p>간단한 예로, 숫자 <code>1</code>부터 <code>n</code>까지의 평균을 계산하려는 경우를 가정해 보겠습니다.</p><p>예제 1: 분할되지 않은 평균, 비용은 <code>O(n)</code></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> avg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;avg: &#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> avg);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>예제 2: 분할된 평균, 각 <code>n</code>개의 비동기 단계는 <code>O(1)</code>의 비용이 듭니다.</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> asyncAvg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">avgCB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 진행 중인 합계를 JS 클로저에 저장합니다.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> help</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sum);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // &quot;비동기 재귀&quot;.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 다음 작업을 비동기적으로 예약합니다.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    setImmediate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(help.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, cb));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // avgCB를 호출하는 CB로 헬퍼를 시작합니다.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  help</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> avg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    avgCB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(avg);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">asyncAvg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">avg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;avg of 1-n: &#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> avg);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>이 원칙을 배열 반복 등에 적용할 수 있습니다.</p><h3 id="오프로딩" tabindex="-1">오프로딩 <a class="header-anchor" href="#오프로딩" aria-label="Permalink to “오프로딩”">​</a></h3><p>더 복잡한 작업을 해야 하는 경우, 파티셔닝은 좋은 선택이 아닙니다. 파티셔닝은 이벤트 루프만 사용하며, 여러분의 머신에서 거의 확실하게 사용 가능한 다중 코어의 이점을 얻을 수 없기 때문입니다. <strong>이벤트 루프는 클라이언트 요청을 오케스트레이션해야 하며, 자체적으로 이를 수행해서는 안 된다는 점을 기억하십시오.</strong> 복잡한 작업의 경우, 작업을 이벤트 루프에서 워커 풀로 옮기십시오.</p><h4 id="오프로드-방법" tabindex="-1">오프로드 방법 <a class="header-anchor" href="#오프로드-방법" aria-label="Permalink to “오프로드 방법”">​</a></h4><p>작업을 오프로드할 대상 워커 풀에는 두 가지 옵션이 있습니다.</p><ol><li><a href="/ko/nodejs/api/addons">C++ 애드온</a>을 개발하여 내장된 Node.js 워커 풀을 사용할 수 있습니다. 이전 버전의 Node에서는 <a href="https://github.com/nodejs/nan" target="_blank" rel="noreferrer">NAN</a>을 사용하여 <a href="/ko/nodejs/api/addons">C++ 애드온</a>을 빌드하고, 최신 버전에서는 <a href="/ko/nodejs/api/n-api">N-API</a>를 사용하십시오. <a href="https://www.npmjs.com/package/webworker-threads" target="_blank" rel="noreferrer">node-webworker-threads</a>는 JavaScript만으로 Node.js 워커 풀에 액세스하는 방법을 제공합니다.</li><li>Node.js I/O 테마 워커 풀이 아닌 계산 전용 워커 풀을 직접 생성하고 관리할 수 있습니다. 이를 수행하는 가장 간단한 방법은 <a href="/ko/nodejs/api/child_process">자식 프로세스</a> 또는 <a href="/ko/nodejs/api/cluster">클러스터</a>를 사용하는 것입니다.</li></ol><p>모든 클라이언트에 대해 단순히 <a href="/ko/nodejs/api/child_process">자식 프로세스</a>를 생성해서는 안 됩니다. 자식을 생성하고 관리하는 속도보다 클라이언트 요청을 더 빠르게 받을 수 있으며, 서버가 <a href="https://en.wikipedia.org/wiki/Fork_bomb" target="_blank" rel="noreferrer">포크 폭탄</a>이 될 수 있습니다.</p><p>오프로딩의 단점 오프로딩 접근 방식의 단점은 통신 비용 형태의 오버헤드가 발생한다는 것입니다. 이벤트 루프만이 애플리케이션의 &quot;네임스페이스&quot;(JavaScript 상태)를 볼 수 있습니다. 워커에서는 이벤트 루프 네임스페이스의 JavaScript 객체를 조작할 수 없습니다. 대신, 공유하려는 모든 객체를 직렬화 및 역직렬화해야 합니다. 그러면 워커는 이러한 객체의 자체 복사본에서 작동하고 수정된 객체(또는 &quot;패치&quot;)를 이벤트 루프로 반환할 수 있습니다.</p><p>직렬화 관련 사항은 JSON DOS 섹션을 참조하십시오.</p><h4 id="오프로딩을-위한-몇-가지-제안-사항" tabindex="-1">오프로딩을 위한 몇 가지 제안 사항 <a class="header-anchor" href="#오프로딩을-위한-몇-가지-제안-사항" aria-label="Permalink to “오프로딩을 위한 몇 가지 제안 사항”">​</a></h4><p>CPU 집약적인 작업과 I/O 집약적인 작업은 특성이 상당히 다르므로 구분하는 것이 좋습니다.</p><p>CPU 집약적인 작업은 해당 워커가 스케줄링될 때만 진행되며, 워커는 머신의 <a href="/ko/nodejs/api/os">논리 코어</a> 중 하나에 스케줄링되어야 합니다. 논리 코어가 4개 있고 워커가 5개 있는 경우, 이러한 워커 중 하나는 진행할 수 없습니다. 결과적으로 이 워커에 대한 오버헤드(메모리 및 스케줄링 비용)를 지불하지만 아무런 수익을 얻지 못합니다.</p><p>I/O 집약적인 작업은 외부 서비스 제공자(DNS, 파일 시스템 등)를 쿼리하고 응답을 기다리는 작업을 포함합니다. I/O 집약적인 작업이 있는 워커가 응답을 기다리는 동안에는 다른 할 일이 없으며 운영 체제에서 스케줄링을 해제하여 다른 워커가 요청을 제출할 기회를 줄 수 있습니다. 따라서 I/O 집약적인 작업은 관련 스레드가 실행되지 않는 동안에도 진행됩니다. 데이터베이스 및 파일 시스템과 같은 외부 서비스 제공자는 많은 보류 중인 요청을 동시에 처리하도록 고도로 최적화되었습니다. 예를 들어 파일 시스템은 충돌하는 업데이트를 병합하고 최적의 순서로 파일을 검색하기 위해 많은 보류 중인 쓰기 및 읽기 요청 세트를 검사합니다.</p><p>Node.js 워커 풀과 같이 하나의 워커 풀에만 의존하는 경우, CPU 바운드 및 I/O 바운드 작업의 서로 다른 특성이 애플리케이션 성능을 저해할 수 있습니다.</p><p>이러한 이유로 별도의 계산 워커 풀을 유지하는 것이 좋습니다.</p><h3 id="오프로딩-결론" tabindex="-1">오프로딩: 결론 <a class="header-anchor" href="#오프로딩-결론" aria-label="Permalink to “오프로딩: 결론”">​</a></h3><p>임의의 길이의 배열의 요소를 반복하는 것과 같은 간단한 작업의 경우, 파티셔닝이 좋은 선택일 수 있습니다. 계산이 더 복잡한 경우, 오프로딩이 더 나은 접근 방식입니다. 통신 비용, 즉 이벤트 루프와 워커 풀 간에 직렬화된 객체를 전달하는 오버헤드는 여러 코어를 사용하는 이점으로 상쇄됩니다.</p><p>그러나 서버가 복잡한 계산에 크게 의존하는 경우, Node.js가 정말 적합한지 생각해 봐야 합니다. Node.js는 I/O 바운드 작업에 탁월하지만, 비용이 많이 드는 계산에는 최상의 선택이 아닐 수 있습니다.</p><p>오프로딩 접근 방식을 취하는 경우, 워커 풀을 차단하지 않는 방법에 대한 섹션을 참조하십시오.</p><h3 id="워커-풀을-차단하지-마십시오" tabindex="-1">워커 풀을 차단하지 마십시오 <a class="header-anchor" href="#워커-풀을-차단하지-마십시오" aria-label="Permalink to “워커 풀을 차단하지 마십시오”">​</a></h3><p>Node.js는 k개의 워커로 구성된 워커 풀을 가지고 있습니다. 위에서 논의한 오프로딩 패러다임을 사용하는 경우, 별도의 계산 워커 풀을 가질 수 있으며, 동일한 원칙이 적용됩니다. 어느 경우든, k가 동시에 처리할 수 있는 클라이언트 수보다 훨씬 작다고 가정해 보겠습니다. 이는 Node.js의 확장성의 비결인 &quot;많은 클라이언트를 위한 하나의 스레드&quot; 철학과 일치합니다.</p><p>위에서 논의한 바와 같이, 각 워커는 워커 풀 대기열에서 다음 작업으로 진행하기 전에 현재 작업을 완료합니다.</p><p>이제 클라이언트 요청을 처리하는 데 필요한 작업 비용에 변동이 있을 것입니다. 일부 작업은 빠르게 완료될 수 있고(예: 짧거나 캐시된 파일 읽기 또는 적은 수의 임의 바이트 생성), 다른 작업은 더 오래 걸립니다(예: 더 크거나 캐시되지 않은 파일 읽기 또는 더 많은 임의 바이트 생성). 목표는 작업 시간의 변동을 최소화하는 것이어야 하며, 이를 위해 작업 파티셔닝을 사용해야 합니다.</p><h4 id="작업-시간의-변동-최소화" tabindex="-1">작업 시간의 변동 최소화 <a class="header-anchor" href="#작업-시간의-변동-최소화" aria-label="Permalink to “작업 시간의 변동 최소화”">​</a></h4><p>워커의 현재 작업이 다른 작업보다 훨씬 더 비싼 경우, 다른 보류 중인 작업을 수행할 수 없게 됩니다. 즉, 비교적 긴 각 작업은 완료될 때까지 워커 풀의 크기를 효과적으로 1씩 줄입니다. 이는 바람직하지 않습니다. 왜냐하면 어느 시점까지는 워커 풀에 있는 워커가 많을수록 워커 풀 처리량(작업/초)이 커지고, 따라서 서버 처리량(클라이언트 요청/초)이 커지기 때문입니다. 상대적으로 비싼 작업을 가진 한 클라이언트는 워커 풀의 처리량을 감소시키고, 결과적으로 서버의 처리량을 감소시킵니다.</p><p>이를 방지하려면 워커 풀에 제출하는 작업의 길이 변동을 최소화해야 합니다. I/O 요청(DB, FS 등)에 의해 액세스되는 외부 시스템을 블랙 박스로 취급하는 것이 적절하지만, 이러한 I/O 요청의 상대적인 비용을 인식하고 특히 오래 걸릴 것으로 예상되는 요청은 제출하지 않아야 합니다.</p><p>두 가지 예는 작업 시간의 가능한 변동을 보여줍니다.</p><h4 id="변동성-예시-장시간-실행되는-파일-시스템-읽기" tabindex="-1">변동성 예시: 장시간 실행되는 파일 시스템 읽기 <a class="header-anchor" href="#변동성-예시-장시간-실행되는-파일-시스템-읽기" aria-label="Permalink to “변동성 예시: 장시간 실행되는 파일 시스템 읽기”">​</a></h4><p>서버가 일부 클라이언트 요청을 처리하기 위해 파일을 읽어야 한다고 가정해 보겠습니다. Node.js <a href="/ko/nodejs/api/fs">파일 시스템</a> API를 참조한 후 단순성을 위해 <code>fs.readFile()</code>을 사용하기로 했습니다. 그러나 <code>fs.readFile()</code>은 (현재) 분할되지 않습니다. 전체 파일을 포함하는 단일 <code>fs.read()</code> 작업을 제출합니다. 일부 사용자는 더 짧은 파일을 읽고 다른 사용자는 더 긴 파일을 읽는 경우, <code>fs.readFile()</code>은 작업자 풀 처리량에 해로운 작업 길이의 상당한 변동성을 초래할 수 있습니다.</p><p>최악의 시나리오의 경우, 공격자가 서버가 임의의 파일을 읽도록 설득할 수 있다고 가정합니다(이는 <a href="https://www.owasp.org/index.php/Path_Traversal" target="_blank" rel="noreferrer">디렉터리 순회 취약점</a>입니다). 서버가 Linux에서 실행 중인 경우 공격자는 매우 느린 파일인 <code>/dev/random</code>을 지정할 수 있습니다. 실제로 <code>/dev/random</code>은 무한히 느리며, <code>/dev/random</code>에서 읽도록 요청받은 모든 작업자는 해당 작업을 완료하지 못합니다. 그러면 공격자는 각 작업자에 대해 하나씩 k개의 요청을 제출하고 작업자 풀을 사용하는 다른 클라이언트 요청은 진행되지 않습니다.</p><h4 id="변동성-예시-장시간-실행되는-암호화-작업" tabindex="-1">변동성 예시: 장시간 실행되는 암호화 작업 <a class="header-anchor" href="#변동성-예시-장시간-실행되는-암호화-작업" aria-label="Permalink to “변동성 예시: 장시간 실행되는 암호화 작업”">​</a></h4><p>서버가 <code>crypto.randomBytes()</code>를 사용하여 암호화 방식으로 안전한 임의 바이트를 생성한다고 가정합니다. <code>crypto.randomBytes()</code>는 분할되지 않습니다. 요청한 만큼 많은 바이트를 생성하는 단일 <code>randomBytes()</code> 작업을 만듭니다. 일부 사용자는 더 적은 바이트를 만들고 다른 사용자는 더 많은 바이트를 만드는 경우, <code>crypto.randomBytes()</code>는 작업 길이의 또 다른 변동성 원인이 됩니다.</p><h3 id="작업-분할" tabindex="-1">작업 분할 <a class="header-anchor" href="#작업-분할" aria-label="Permalink to “작업 분할”">​</a></h3><p>가변적인 시간 비용이 드는 작업은 작업자 풀의 처리량을 저해할 수 있습니다. 작업 시간의 변동성을 최소화하기 위해 각 작업을 유사한 비용의 하위 작업으로 최대한 분할해야 합니다. 각 하위 작업이 완료되면 다음 하위 작업을 제출하고, 최종 하위 작업이 완료되면 제출자에게 알립니다.</p><p><code>fs.readFile()</code> 예제를 계속 진행하려면 <code>fs.read()</code>(수동 분할) 또는 <code>ReadStream</code>(자동 분할)을 대신 사용해야 합니다.</p><p>CPU 바운드 작업에도 동일한 원칙이 적용됩니다. <code>asyncAvg</code> 예제는 이벤트 루프에 적합하지 않을 수 있지만 작업자 풀에는 적합합니다.</p><p>작업을 하위 작업으로 분할하면 더 짧은 작업은 적은 수의 하위 작업으로 확장되고 더 긴 작업은 더 많은 수의 하위 작업으로 확장됩니다. 더 긴 작업의 각 하위 작업 사이에서 해당 작업이 할당된 작업자는 다른 더 짧은 작업의 하위 작업을 수행할 수 있으므로 작업자 풀의 전체 작업 처리량이 향상됩니다.</p><p>완료된 하위 작업의 수는 작업자 풀의 처리량에 대한 유용한 메트릭이 아닙니다. 대신 완료된 작업의 수에 관심을 가지십시오.</p><h3 id="작업-분할-방지" tabindex="-1">작업 분할 방지 <a class="header-anchor" href="#작업-분할-방지" aria-label="Permalink to “작업 분할 방지”">​</a></h3><p>작업 분할의 목적은 작업 시간의 변동을 최소화하는 것임을 상기하십시오. 짧은 작업과 긴 작업을 구별할 수 있다면 (예: 배열 합산 vs. 배열 정렬), 각 작업 종류에 대해 하나의 워커 풀을 만들 수 있습니다. 짧은 작업과 긴 작업을 별도의 워커 풀로 라우팅하는 것도 작업 시간 변동을 최소화하는 또 다른 방법입니다.</p><p>이러한 접근 방식을 선호하는 이유는 작업 분할은 오버헤드(워커 풀 작업 표현 생성 비용 및 워커 풀 큐 조작 비용)를 발생시키고, 분할을 피하면 워커 풀로의 추가 이동 비용을 절약할 수 있기 때문입니다. 또한 작업 분할 시 실수를 방지할 수 있습니다.</p><p>이 접근 방식의 단점은 이러한 모든 워커 풀의 워커가 공간 및 시간 오버헤드를 발생시키고 CPU 시간을 두고 서로 경쟁한다는 것입니다. 각 CPU 바운드 작업은 스케줄될 때만 진행된다는 점을 기억하십시오. 따라서 신중한 분석 후에만 이 접근 방식을 고려해야 합니다.</p><h3 id="워커-풀-결론" tabindex="-1">워커 풀: 결론 <a class="header-anchor" href="#워커-풀-결론" aria-label="Permalink to “워커 풀: 결론”">​</a></h3><p>Node.js 워커 풀만 사용하든 별도의 워커 풀을 유지하든 풀의 작업 처리량을 최적화해야 합니다.</p><p>이를 위해 작업 분할을 사용하여 작업 시간의 변동을 최소화하십시오.</p><h2 id="npm-모듈의-위험" tabindex="-1">npm 모듈의 위험 <a class="header-anchor" href="#npm-모듈의-위험" aria-label="Permalink to “npm 모듈의 위험”">​</a></h2><p>Node.js 코어 모듈은 다양한 애플리케이션을 위한 빌딩 블록을 제공하지만 때로는 더 많은 것이 필요합니다. Node.js 개발자는 개발 프로세스를 가속화하는 기능을 제공하는 수십만 개의 모듈이 있는 npm 생태계에서 엄청난 이점을 얻습니다.</p><p>그러나 이러한 모듈의 대부분은 타사 개발자가 작성했으며 일반적으로 최선을 다한 보증만 제공된다는 점을 기억하십시오. npm 모듈을 사용하는 개발자는 두 가지 사항에 대해 우려해야 하지만 후자는 종종 잊혀집니다.</p><ol><li>API를 준수하는가?</li><li>API가 이벤트 루프 또는 워커를 차단할 수 있는가? 많은 모듈이 커뮤니티에 해를 끼치도록 API 비용을 표시하지 않습니다.</li></ol><p>간단한 API의 경우 API 비용을 추정할 수 있습니다. 문자열 조작 비용은 파악하기 어렵지 않습니다. 그러나 많은 경우 API 비용이 얼마나 될지 불분명합니다.</p><p>비용이 많이 들 수 있는 API를 호출하는 경우 비용을 다시 확인하십시오. 개발자에게 문서화를 요청하거나 소스 코드를 직접 검사하십시오 (비용을 문서화하는 PR 제출).</p><p>API가 비동기적이라도 각 파티션에서 워커 또는 이벤트 루프에서 얼마나 많은 시간을 소비할지 알 수 없습니다. 예를 들어 위에서 제공된 <code>asyncAvg</code> 예제에서 헬퍼 함수에 대한 각 호출이 숫자 중 하나가 아닌 절반을 합산한다고 가정합니다. 그러면 이 함수는 여전히 비동기적이지만 각 파티션의 비용은 <code>O(1)</code>이 아닌 <code>O(n)</code>이 되어 임의의 <code>n</code> 값에 대해 사용하기에 훨씬 덜 안전합니다.</p><h2 id="결론" tabindex="-1">결론 <a class="header-anchor" href="#결론" aria-label="Permalink to “결론”">​</a></h2><p>Node.js에는 두 가지 유형의 스레드가 있습니다. 하나는 이벤트 루프이고 다른 하나는 k개의 워커입니다. 이벤트 루프는 JavaScript 콜백 및 비차단 I/O를 담당하고, 워커는 차단 I/O 및 CPU 집약적인 작업을 포함하여 비동기 요청을 완료하는 C++ 코드에 해당하는 작업을 실행합니다. 두 유형의 스레드는 한 번에 하나의 활동만 수행합니다. 콜백 또는 작업에 시간이 오래 걸리면 해당 작업을 실행하는 스레드가 차단됩니다. 애플리케이션이 차단 콜백 또는 작업을 수행하면 최악의 경우 처리량(클라이언트/초)이 저하되고 최악의 경우 서비스 거부(DoS)가 발생할 수 있습니다.</p><p>높은 처리량과 더 나은 DoS 방지 웹 서버를 작성하려면 정상적인 입력과 악성 입력 모두에서 이벤트 루프나 워커가 차단되지 않도록 해야 합니다.</p></div></div></main><footer class="VPDocFooter" data-v-d668f7cc data-v-1bcd8184><!--[--><!--]--><div class="edit-info" data-v-1bcd8184><!----><div class="last-updated" data-v-1bcd8184><p class="VPLastUpdated" data-v-1bcd8184 data-v-1bb0c8a8>마지막 업데이트: <time datetime="2025-06-09T10:21:38.000Z" data-v-1bb0c8a8></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/ko/nodejs/guide/understanding-setimmediate" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>이전 페이지</span><span class="title" data-v-1bcd8184>setImmediate() 이해하기</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/ko/nodejs/guide/nodejs-file-stats" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>다음 페이지</span><span class="title" data-v-1bcd8184>Node.js 파일 통계</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-4539713c data-v-5b9946f5><div class="container" data-v-5b9946f5><p class="message" data-v-5b9946f5><a href="https://idoc.dev/ko/privacy">개인정보 처리방침</a></p><p class="copyright" data-v-5b9946f5>저작권 © 2024-present <a href="https://idoc.dev/ko/">iDoc.dev</a></p></div></footer><!--[--><!--]--></div></div>
    
    
  </body>
</html>