<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>توثيق N-API في Node.js | API &amp; الدليل &amp; للمطورين</title>
    <meta name="description" content="توفر واجهة N-API (واجهة برمجة التطبيقات في Node.js) واجهة مستقرة ومتسقة للإضافات الأصلية، مما يسمح للمطورين بإنشاء وحدات متوافقة عبر إصدارات مختلفة من Node.js.">
    <meta name="generator" content="VitePress v2.0.0-alpha.5">
    <link rel="preload stylesheet" href="/assets/style.BOW9Aqd_.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    <script type="module" src="/assets/chunks/metadata.f006ef31.js"></script>
    <script type="module" src="/assets/app.BOiumQCo.js"></script>
    <link rel="modulepreload" href="/assets/chunks/plugin-vue_export-helper.Bts1mPc7.js">
    <link rel="modulepreload" href="/assets/chunks/translation.CRvAmi0k.js">
    <link rel="modulepreload" href="/assets/chunks/VPLocalSearchBox.CpAM03QS.js">
    <link rel="modulepreload" href="/assets/ar_nodejs_api_n-api.md.C52qwl9C.lean.js">
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
    <link rel="icon" type="image/png" href="/logo.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="theme-color" content="#5f67ee">
    <meta property="og:type" content="website">
    <meta property="og:title" content="iDoc | API &amp; Guide for Developers">
    <meta property="og:site_name" content="iDoc">
    <meta property="og:image" content="https://idoc.dev/logo.svg">
    <meta property="og:url" content="https://idoc.dev/ar/nodejs/api/n-api">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="idoc.dev">
    <meta name="twitter:image" content="https://idoc.dev/logo.svg">
    <meta name="twitter:title" content="توثيق N-API في Node.js | Node.js - iDoc.dev">
    <meta name="twitter:creator" content="neo@idoc.dev">
    <meta name="twitter:url" content="https://node.idoc.dev/">
    <meta name="twitter:description" content="توفر واجهة N-API (واجهة برمجة التطبيقات في Node.js) واجهة مستقرة ومتسقة للإضافات الأصلية، مما يسمح للمطورين بإنشاء وحدات متوافقة عبر إصدارات مختلفة من Node.js.">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-X0C67TVVXR"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-X0C67TVVXR");</script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3961359407117622" crossorigin="anonymous"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <meta name="og:title" content="توثيق N-API في Node.js | Node.js - iDoc.dev">
    <meta name="og:description" content="توفر واجهة N-API (واجهة برمجة التطبيقات في Node.js) واجهة مستقرة ومتسقة للإضافات الأصلية، مما يسمح للمطورين بإنشاء وحدات متوافقة عبر إصدارات مختلفة من Node.js.">
    <link rel="canonical" href="https://idoc.dev/ar/nodejs/api/n-api">
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-4539713c><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-4539713c data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-cb5e22fa><div class="wrapper" data-v-cb5e22fa><div class="container" data-v-cb5e22fa><div class="title" data-v-cb5e22fa><div class="VPNavBarTitle has-sidebar" data-v-cb5e22fa data-v-d4488dd0><a class="title" href="/ar/" data-v-d4488dd0><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.svg" width="24" height="24" alt="iDoc.dev" data-v-ab19afbb><!--]--><span data-v-d4488dd0>iDoc</span><!--[--><!--]--></a></div></div><div class="content" data-v-cb5e22fa><div class="content-body" data-v-cb5e22fa><!--[--><!--]--><div class="VPNavBarSearch search" data-v-cb5e22fa><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-cb5e22fa data-v-020be4db><span id="main-nav-aria-label" class="visually-hidden" data-v-020be4db> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/ar/nodejs/api/synopsis" tabindex="0" data-v-020be4db data-v-815115f5><!--[--><span data-v-815115f5>مرجع API</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/ar/nodejs/guide/what-is-nodejs" tabindex="0" data-v-020be4db data-v-815115f5><!--[--><span data-v-815115f5>دليل</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-cb5e22fa data-v-acee064b data-v-9bb987dd><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="اللغات" data-v-9bb987dd><span class="text" data-v-9bb987dd><span class="vpi-languages option-icon" data-v-9bb987dd></span><!----><span class="vpi-chevron-down text-icon" data-v-9bb987dd></span></span></button><div class="menu" data-v-9bb987dd><div class="VPMenu" data-v-9bb987dd data-v-2f78439e><!----><!--[--><!--[--><div class="items" data-v-acee064b><p class="title" data-v-acee064b>العربية</p><!--[--><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>English</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/zh/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>简体中文</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/es/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Español</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/fr/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Français</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/pt/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Português</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/de/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Deutsch</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/it/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Italiano</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/ja/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>日本語</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/ko/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>한국어</span><!--]--></a></div><div class="VPMenuLink" data-v-acee064b data-v-7eeeb2dc><a class="VPLink link" href="/ru/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Русский</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-cb5e22fa data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-cb5e22fa data-v-f953d92f data-v-9bb987dd><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-9bb987dd><span class="vpi-more-horizontal icon" data-v-9bb987dd></span></button><div class="menu" data-v-9bb987dd><div class="VPMenu" data-v-9bb987dd data-v-2f78439e><!----><!--[--><!--[--><div class="group translations" data-v-f953d92f><p class="trans-title" data-v-f953d92f>العربية</p><!--[--><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>English</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/zh/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>简体中文</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/es/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Español</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/fr/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Français</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/pt/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Português</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/de/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Deutsch</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/it/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Italiano</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/ja/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>日本語</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/ko/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>한국어</span><!--]--></a></div><div class="VPMenuLink" data-v-f953d92f data-v-7eeeb2dc><a class="VPLink link" href="/ru/nodejs/api/n-api" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Русский</span><!--]--></a></div><!--]--></div><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>الوضع الداكن</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-cb5e22fa data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-cb5e22fa><div class="divider-line" data-v-cb5e22fa></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-4539713c data-v-6c0451ca><div class="container" data-v-6c0451ca><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-6c0451ca><span class="vpi-align-left menu-icon" data-v-6c0451ca></span><span class="menu-text" data-v-6c0451ca>القائمة</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-6c0451ca data-v-92b7576c><button data-v-92b7576c>الرجوع إلى الأعلى</button><!----></div></div></div><aside class="VPSidebar" data-v-4539713c data-v-606f96d3><div class="curtain" data-v-606f96d3></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-606f96d3><span class="visually-hidden" id="sidebar-aria-label" data-v-606f96d3> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>دليل البدء</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/documentation" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>حول هذه الوثيقة</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/synopsis" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>الاستخدام والأمثلة</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>الوحدات</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/module" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>API node:module</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/modules" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>الوحدات CommonJS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/typescript" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>وحدات TypeScript</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/esm" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>وحدات ECMAScript</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/packages" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>إدارة الحزم</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/corepack" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Corepack</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>HTTP والشبكات</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/http" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>HTTP</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/http2" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>HTTP/2</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/https" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>HTTPS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/net" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Net</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/tls" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>TLS (SSL)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/dgram" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>UDP/مقابس داتاغرام</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/dns" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>DNS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/tty" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>TTY</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/url" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>URL</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/domain" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>النطاق</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>نظام الملفات والمسارات</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/fs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>نظام الملفات</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/path" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>المسارات</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>التدفقات، المخازن وWASI</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/stream" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>التدفقات</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/webstreams" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>API التدفقات الويب</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/buffer" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>المخزن</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/wasi" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>واجهة WebAssembly System (WASI)</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>الأحداث، القنوات والمزالج غير المتزامنة</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/events" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>الأحداث</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/tracing" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>تتبع الأحداث</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/diagnostics_channel" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>قناة التشخيص</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/async_hooks" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>المزالج غير المتزامنة</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/async_context" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>تتبع السياق غير المتزامن</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>العمليات، العنقود والخيوط</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/process" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>العمليات</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/child_process" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>العمليات الفرعية</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/cluster" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>العنقود</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/worker_threads" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>خيوط العمل</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/permissions" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>الأذونات</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed has-active" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>إضافات C++ وAPI التكامل</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/addons" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>إضافات C++</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/n-api" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>إضافات C/C++ باستخدام Node-API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/embedding" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>API التكامل C++</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>الاختبارات وتصحيح الأخطاء</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/cli" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>خيارات سطر الأوامر</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/test" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>منفذ الاختبارات</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/assert" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>اختبارات التحقق</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/debugger" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>أداة التصحيح</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/console" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>وحدة التحكم</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/errors" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>إدارة الأخطاء</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/timers" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>مؤقتات</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/inspector" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>أداة الفحص</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/report" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>التقرير</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/repl" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>REPL</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/readline" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Readline</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/perf_hooks" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>المزالج الخاصة بالأداء</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>الأدوات والمرافق</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/util" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>المرافق</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/crypto" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>التشفير</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/webcrypto" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>تشفير الويب</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/zlib" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Zlib</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/querystring" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>سلسلة الاستعلام</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/string_decoder" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>أداة فك الشيفرة النصية</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/sqlite" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>SQLite</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>أخرى</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/intl" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>التدويل</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/globals" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>الكائنات العالمية</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/single-executable-applications" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>التطبيقات التنفيذية الوحيدة</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/os" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>نظام التشغيل</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/v8" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>محرك V8</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/vm" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>وحدة VM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/punycode" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Punycode</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/ar/nodejs/api/deprecations" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>API المتقادمة</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-4539713c data-v-2652e39a><div class="VPDoc has-sidebar has-aside" data-v-2652e39a data-v-d668f7cc><!--[--><!--]--><div class="container" data-v-d668f7cc><div class="aside" data-v-d668f7cc><div class="aside-curtain" data-v-d668f7cc></div><div class="aside-container" data-v-d668f7cc><div class="aside-content" data-v-d668f7cc><div class="VPDocAside" data-v-d668f7cc data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-c8b19031><div class="content" data-v-c8b19031><div class="outline-marker" data-v-c8b19031></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-c8b19031>تنقل الصفحة</div><ul class="VPDocOutlineItem root" data-v-c8b19031 data-v-b7d7ef80><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-d668f7cc><div class="content-container" data-v-d668f7cc><!--[--><!--]--><main class="main" data-v-d668f7cc><div style="position:relative;" class="vp-doc _ar_nodejs_api_n-api" data-v-d668f7cc><div><h1 id="node-api" tabindex="-1">Node-API <a class="header-anchor" href="#node-api" aria-label="Permalink to “Node-API”">​</a></h1><div class="tip custom-block"><p class="custom-block-title">[Stable: 2 - Stable]</p><p><a href="/ar/nodejs/api/documentation#stability-index">مستقر: 2</a> <a href="/ar/nodejs/api/documentation#stability-index">الاستقرار: 2</a> - مستقر</p></div><p>Node-API (سابقًا N-API) هي واجهة برمجة تطبيقات لبناء الإضافات الأصلية. وهي مستقلة عن وقت تشغيل JavaScript الأساسي (على سبيل المثال، V8) ويتم صيانتها كجزء من Node.js نفسه. ستكون واجهة برمجة التطبيقات هذه واجهة تطبيق ثنائية (ABI) مستقرة عبر إصدارات Node.js. وهي تهدف إلى عزل الإضافات عن التغييرات في محرك JavaScript الأساسي والسماح للوحدات النمطية التي تم تجميعها لإصدار رئيسي واحد بالتشغيل على الإصدارات الرئيسية اللاحقة من Node.js دون إعادة التجميع. يوفر دليل <a href="https://nodejs.org/en/docs/guides/abi-stability/" target="_blank" rel="noreferrer">استقرار ABI</a> شرحًا أكثر تعمقًا.</p><p>يتم إنشاء/تعبئة الإضافات بنفس النهج/الأدوات الموضحة في القسم المعنون <a href="/ar/nodejs/api/addons">إضافات C++‎</a>. والفرق الوحيد هو مجموعة واجهات برمجة التطبيقات التي يستخدمها الرمز الأصلي. بدلاً من استخدام V8 أو <a href="https://github.com/nodejs/nan" target="_blank" rel="noreferrer">التجريدات الأصلية لـ Node.js</a> APIs، يتم استخدام الوظائف المتوفرة في Node-API.</p><p>تُستخدم واجهات برمجة التطبيقات التي تعرضها Node-API بشكل عام لإنشاء قيم JavaScript ومعالجتها. تتوافق المفاهيم والعمليات عمومًا مع الأفكار المحددة في مواصفات لغة ECMA-262. تتمتع واجهات برمجة التطبيقات بالخصائص التالية:</p><ul><li>تُرجع جميع استدعاءات Node-API رمز حالة من النوع <code>napi_status</code>. تشير هذه الحالة إلى ما إذا كان استدعاء واجهة برمجة التطبيقات قد نجح أم فشل.</li><li>يتم تمرير قيمة إرجاع واجهة برمجة التطبيقات عبر معلمة إخراج.</li><li>يتم تجريد جميع قيم JavaScript خلف نوع معتم يسمى <code>napi_value</code>.</li><li>في حالة رمز حالة خطأ، يمكن الحصول على معلومات إضافية باستخدام <code>napi_get_last_error_info</code>. يمكن العثور على مزيد من المعلومات في قسم معالجة الأخطاء <a href="/ar/nodejs/api/n-api#error-handling">معالجة الأخطاء</a>.</li></ul><p>Node-API هي واجهة برمجة تطبيقات C تضمن استقرار ABI عبر إصدارات Node.js ومستويات المترجم المختلفة. يمكن أن تكون واجهة برمجة تطبيقات C++‎ أسهل في الاستخدام. لدعم استخدام C++‎، يحتفظ المشروع بوحدة تغليف C++‎ تسمى <a href="https://github.com/nodejs/node-addon-api" target="_blank" rel="noreferrer"><code>node-addon-api</code></a>. يوفر هذا الغلاف واجهة برمجة تطبيقات C++‎ مضمنة. تعتمد الملفات الثنائية التي تم إنشاؤها باستخدام <code>node-addon-api</code> على الرموز الخاصة بوظائف Node-API المستندة إلى C التي تصدرها Node.js. <code>node-addon-api</code> هي طريقة أكثر كفاءة لكتابة التعليمات البرمجية التي تستدعي Node-API. على سبيل المثال، التعليمات البرمجية التالية <code>node-addon-api</code>. يعرض القسم الأول التعليمات البرمجية <code>node-addon-api</code> ويعرض القسم الثاني ما يتم استخدامه بالفعل في الإضافة.</p><div class="language-C++ line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C++</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Object obj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-C++ line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C++</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value object, string;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">object);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  napi_throw_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, ...);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_string_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, NAPI_AUTO_LENGTH, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">string);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  napi_throw_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, ...);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, object, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, string);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  napi_throw_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, ...);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>والنتيجة النهائية هي أن الإضافة تستخدم فقط واجهات برمجة تطبيقات C المصدرة. ونتيجة لذلك، فإنه لا يزال يحصل على فوائد استقرار ABI التي توفرها واجهة برمجة تطبيقات C.</p><p>عند استخدام <code>node-addon-api</code> بدلاً من واجهات برمجة تطبيقات C، ابدأ بـ <a href="https://github.com/nodejs/node-addon-api#api-documentation" target="_blank" rel="noreferrer">وثائق</a> واجهة برمجة التطبيقات لـ <code>node-addon-api</code>.</p><p>يوفر <a href="https://nodejs.github.io/node-addon-examples/" target="_blank" rel="noreferrer">مورد Node-API</a> توجيهات ونصائح ممتازة للمطورين الذين بدأوا للتو في استخدام Node-API و <code>node-addon-api</code>. يمكن العثور على موارد وسائط إضافية في صفحة <a href="https://github.com/nodejs/abi-stable-node/blob/HEAD/node-api-media.md" target="_blank" rel="noreferrer">وسائط Node-API</a>.</p><h2 id="implications-of-abi-stability" tabindex="-1">آثار استقرار ABI <a class="header-anchor" href="#implications-of-abi-stability" aria-label="Permalink to “آثار استقرار ABI”">​</a></h2><p>على الرغم من أن Node-API يوفر ضمانًا لاستقرار ABI، إلا أن أجزاء أخرى من Node.js لا تفعل ذلك، وقد لا تفعل أي مكتبات خارجية مستخدمة من الملحق. على وجه الخصوص، لا يوفر أي من واجهات برمجة التطبيقات التالية ضمانًا لاستقرار ABI عبر الإصدارات الرئيسية:</p><ul><li>واجهات برمجة تطبيقات C++ الخاصة بـ Node.js المتوفرة عبر أي من</li><li>واجهات برمجة تطبيقات libuv المضمنة أيضًا مع Node.js والمتوفرة عبر</li><li>واجهة برمجة تطبيقات V8 المتوفرة عبر</li></ul><p>وبالتالي، لكي يظل الملحق متوافقًا مع ABI عبر إصدارات Node.js الرئيسية، يجب أن يستخدم Node-API حصريًا عن طريق تقييد نفسه باستخدام</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>وعن طريق التحقق، بالنسبة لجميع المكتبات الخارجية التي يستخدمها، من أن المكتبة الخارجية تقدم ضمانات استقرار ABI مماثلة لـ Node-API.</p><h2 id="building" tabindex="-1">بناء <a class="header-anchor" href="#building" aria-label="Permalink to “بناء”">​</a></h2><p>بخلاف الوحدات النمطية المكتوبة بلغة JavaScript، يتطلب تطوير ونشر ملحقات Node.js الأصلية باستخدام Node-API مجموعة إضافية من الأدوات. بالإضافة إلى الأدوات الأساسية المطلوبة للتطوير لـ Node.js، يحتاج مطور الملحق الأصلي إلى سلسلة أدوات يمكنها تجميع كود C و C++ في ملف ثنائي. بالإضافة إلى ذلك، اعتمادًا على كيفية نشر الملحق الأصلي، سيحتاج <em>مستخدم</em> الملحق الأصلي أيضًا إلى تثبيت سلسلة أدوات C/C++.</p><p>بالنسبة لمطوري Linux، تتوفر حزم أدوات C/C++ الضرورية بسهولة. يستخدم <a href="https://gcc.gnu.org/" target="_blank" rel="noreferrer">GCC</a> على نطاق واسع في مجتمع Node.js للبناء والاختبار عبر مجموعة متنوعة من الأنظمة الأساسية. بالنسبة للعديد من المطورين، فإن البنية التحتية للمترجم <a href="https://llvm.org/" target="_blank" rel="noreferrer">LLVM</a> هي أيضًا خيار جيد.</p><p>بالنسبة لمطوري Mac، يوفر <a href="https://developer.apple.com/xcode/" target="_blank" rel="noreferrer">Xcode</a> جميع أدوات المترجم المطلوبة. ومع ذلك، ليس من الضروري تثبيت Xcode IDE بأكمله. يقوم الأمر التالي بتثبيت سلسلة الأدوات الضرورية:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xcode-select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --install</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>بالنسبة لمطوري Windows، يوفر <a href="https://visualstudio.microsoft.com/" target="_blank" rel="noreferrer">Visual Studio</a> جميع أدوات المترجم المطلوبة. ومع ذلك، ليس من الضروري تثبيت Visual Studio IDE بأكمله. يقوم الأمر التالي بتثبيت سلسلة الأدوات الضرورية:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> windows-build-tools</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>تصف الأقسام أدناه الأدوات الإضافية المتاحة لتطوير ونشر ملحقات Node.js الأصلية.</p><h3 id="build-tools" tabindex="-1">أدوات البناء <a class="header-anchor" href="#build-tools" aria-label="Permalink to “أدوات البناء”">​</a></h3><p>تتطلب كلتا الأداتين المذكورتين هنا أن يكون لدى <em>مستخدمي</em> الوظيفة الإضافية الأصلية سلسلة أدوات C/C++ مثبتة لكي يتمكنوا من تثبيت الوظيفة الإضافية الأصلية بنجاح.</p><h4 id="node-gyp" tabindex="-1">node-gyp <a class="header-anchor" href="#node-gyp" aria-label="Permalink to “node-gyp”">​</a></h4><p><a href="https://github.com/nodejs/node-gyp" target="_blank" rel="noreferrer">node-gyp</a> هو نظام بناء يعتمد على <a href="https://github.com/nodejs/gyp-next" target="_blank" rel="noreferrer">gyp-next</a> وهي نسخة معدلة من أداة <a href="https://gyp.gsrc.io/" target="_blank" rel="noreferrer">GYP</a> الخاصة بـ Google، ويأتي مدمجًا مع npm. يتطلب GYP، وبالتالي node-gyp، تثبيت Python.</p><p>تاريخيًا، كانت node-gyp هي الأداة المفضلة لبناء الوظائف الإضافية الأصلية. لديها اعتماد وتوثيق واسع النطاق. ومع ذلك، واجه بعض المطورين قيودًا في node-gyp.</p><h4 id="cmakejs" tabindex="-1">CMake.js <a class="header-anchor" href="#cmakejs" aria-label="Permalink to “CMake.js”">​</a></h4><p><a href="https://github.com/cmake-js/cmake-js" target="_blank" rel="noreferrer">CMake.js</a> هو نظام بناء بديل يعتمد على <a href="https://cmake.org/" target="_blank" rel="noreferrer">CMake</a>.</p><p>CMake.js هو خيار جيد للمشاريع التي تستخدم بالفعل CMake أو للمطورين المتأثرين بالقيود الموجودة في node-gyp. <a href="https://github.com/nodejs/node-addon-examples/tree/main/src/8-tooling/build_with_cmake" target="_blank" rel="noreferrer"><code>build_with_cmake</code></a> هو مثال على مشروع وظيفة إضافية أصلية يعتمد على CMake.</p><h3 id="uploading-precompiled-binaries" tabindex="-1">تحميل الثنائيات المترجمة مسبقًا <a class="header-anchor" href="#uploading-precompiled-binaries" aria-label="Permalink to “تحميل الثنائيات المترجمة مسبقًا”">​</a></h3><p>تسمح الأدوات الثلاث المذكورة هنا لمطوري ومشرفي الوظائف الإضافية الأصلية بإنشاء وتحميل الثنائيات إلى خوادم عامة أو خاصة. عادةً ما يتم دمج هذه الأدوات مع أنظمة بناء CI/CD مثل <a href="https://travis-ci.org/" target="_blank" rel="noreferrer">Travis CI</a> و <a href="https://www.appveyor.com/" target="_blank" rel="noreferrer">AppVeyor</a> لبناء وتحميل الثنائيات لمجموعة متنوعة من المنصات والبنى. تصبح هذه الثنائيات متاحة للتنزيل من قبل المستخدمين الذين لا يحتاجون إلى تثبيت سلسلة أدوات C/C++.</p><h4 id="node-pre-gyp" tabindex="-1">node-pre-gyp <a class="header-anchor" href="#node-pre-gyp" aria-label="Permalink to “node-pre-gyp”">​</a></h4><p><a href="https://github.com/mapbox/node-pre-gyp" target="_blank" rel="noreferrer">node-pre-gyp</a> هي أداة تعتمد على node-gyp تضيف القدرة على تحميل الثنائيات إلى خادم من اختيار المطور. تتمتع node-pre-gyp بدعم جيد بشكل خاص لتحميل الثنائيات إلى Amazon S3.</p><h4 id="prebuild" tabindex="-1">prebuild <a class="header-anchor" href="#prebuild" aria-label="Permalink to “prebuild”">​</a></h4><p><a href="https://github.com/prebuild/prebuild" target="_blank" rel="noreferrer">prebuild</a> هي أداة تدعم عمليات البناء باستخدام node-gyp أو CMake.js. على عكس node-pre-gyp التي تدعم مجموعة متنوعة من الخوادم، فإن prebuild تقوم بتحميل الثنائيات فقط إلى <a href="https://help.github.com/en/github/administering-a-repository/about-releases" target="_blank" rel="noreferrer">إصدارات GitHub</a>. يعد prebuild خيارًا جيدًا لمشاريع GitHub التي تستخدم CMake.js.</p><h4 id="prebuildify" tabindex="-1">prebuildify <a class="header-anchor" href="#prebuildify" aria-label="Permalink to “prebuildify”">​</a></h4><p><a href="https://github.com/prebuild/prebuildify" target="_blank" rel="noreferrer">prebuildify</a> هي أداة تستند إلى node-gyp. ميزة prebuildify هي أن الثنائيات المبنية يتم تجميعها مع الوظيفة الإضافية الأصلية عند تحميلها إلى npm. يتم تنزيل الثنائيات من npm وتكون متاحة على الفور لمستخدم الوحدة النمطية عند تثبيت الوظيفة الإضافية الأصلية.</p><h2 id="usage" tabindex="-1">الاستخدام <a class="header-anchor" href="#usage" aria-label="Permalink to “الاستخدام”">​</a></h2><p>لاستخدام وظائف Node-API، قم بتضمين الملف <a href="https://github.com/nodejs/node/blob/HEAD/src/node_api.h" target="_blank" rel="noreferrer"><code>node_api.h</code></a> الموجود في دليل src في شجرة تطوير node:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>سيؤدي هذا إلى الاشتراك في <code>NAPI_VERSION</code> الافتراضي للإصدار المحدد من Node.js. لضمان التوافق مع إصدارات معينة من Node-API، يمكن تحديد الإصدار بشكل صريح عند تضمين الرأس:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NAPI_VERSION</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>يقيد هذا سطح Node-API للوظائف التي كانت متاحة في الإصدارات المحددة (والإصدارات السابقة) فقط.</p><p>بعض سطح Node-API تجريبي ويتطلب الاشتراك الصريح:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NAPI_EXPERIMENTAL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>في هذه الحالة، سيكون سطح API بأكمله، بما في ذلك أي واجهات برمجة تطبيقات تجريبية، متاحًا لرمز الوحدة النمطية.</p><p>في بعض الأحيان، يتم تقديم ميزات تجريبية تؤثر على واجهات برمجة التطبيقات المستقرة التي تم إصدارها بالفعل. يمكن تعطيل هذه الميزات عن طريق الانسحاب:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NAPI_EXPERIMENTAL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NODE_API_EXPERIMENTAL_</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FEATURE_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_OPT_OUT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>حيث <code>\&lt;FEATURE_NAME\&gt;</code> هو اسم ميزة تجريبية تؤثر على كل من واجهات برمجة التطبيقات التجريبية والمستقرة.</p><h2 id="node-api-version-matrix" tabindex="-1">مصفوفة إصدار Node-API <a class="header-anchor" href="#node-api-version-matrix" aria-label="Permalink to “مصفوفة إصدار Node-API”">​</a></h2><p>حتى الإصدار 9، كانت إصدارات Node-API تراكمية ويتم إصدارها بشكل مستقل عن Node.js. هذا يعني أن أي إصدار كان امتدادًا للإصدار السابق من حيث أنه يحتوي على جميع واجهات برمجة التطبيقات من الإصدار السابق مع بعض الإضافات. دعم كل إصدار من Node.js إصدارًا واحدًا فقط من Node-API. على سبيل المثال، يدعم v18.15.0 إصدار Node-API 8 فقط. تم تحقيق استقرار ABI لأن 8 كانت مجموعة فرعية صارمة من جميع الإصدارات السابقة.</p><p>اعتبارًا من الإصدار 9، على الرغم من أن إصدارات Node-API تستمر في إصدارها بشكل مستقل، فقد تحتاج وظيفة إضافية تعمل مع إصدار Node-API 9 إلى تحديثات التعليمات البرمجية للتشغيل مع إصدار Node-API 10. يتم الحفاظ على استقرار ABI، ومع ذلك، لأن إصدارات Node.js التي تدعم إصدارات Node-API أعلى من 8 ستدعم جميع الإصدارات بين 8 وأعلى إصدار تدعمه وستعرض افتراضيًا واجهات برمجة التطبيقات للإصدار 8 ما لم تشترك وظيفة إضافية في إصدار Node-API أعلى. يوفر هذا النهج مرونة تحسين وظائف Node-API الحالية بشكل أفضل مع الحفاظ على استقرار ABI. يمكن أن تستمر الوظائف الإضافية الموجودة في التشغيل دون إعادة تجميع باستخدام إصدار سابق من Node-API. إذا كانت وظيفة إضافية تحتاج إلى وظائف من إصدار Node-API أحدث، فستكون هناك حاجة إلى تغييرات في التعليمات البرمجية الموجودة وإعادة التجميع لاستخدام هذه الوظائف الجديدة على أي حال.</p><p>في إصدارات Node.js التي تدعم إصدار Node-API 9 والإصدارات الأحدث، سيؤدي تحديد <code>NAPI_VERSION=X</code> واستخدام وحدات الماكرو لتهيئة الوظائف الإضافية الموجودة إلى تضمين إصدار Node-API المطلوب الذي سيتم استخدامه في وقت التشغيل في الوظيفة الإضافية. إذا لم يتم تعيين <code>NAPI_VERSION</code>، فسيكون افتراضيًا 8.</p><p>قد لا يكون هذا الجدول محدثًا في التدفقات الأقدم، وأحدث المعلومات موجودة في أحدث وثائق API في: <a href="/ar/nodejs/api/n-api#node-api-version-matrix">مصفوفة إصدار Node-API</a></p><table tabindex="0"><thead><tr><th>إصدار Node-API</th><th>مدعوم في</th></tr></thead><tbody><tr><td>9</td><td>v18.17.0+, 20.3.0+, 21.0.0 وجميع الإصدارات اللاحقة</td></tr><tr><td>8</td><td>v12.22.0+, v14.17.0+, v15.12.0+, 16.0.0 وجميع الإصدارات اللاحقة</td></tr><tr><td>7</td><td>v10.23.0+, v12.19.0+, v14.12.0+, 15.0.0 وجميع الإصدارات اللاحقة</td></tr><tr><td>6</td><td>v10.20.0+, v12.17.0+, 14.0.0 وجميع الإصدارات اللاحقة</td></tr><tr><td>5</td><td>v10.17.0+, v12.11.0+, 13.0.0 وجميع الإصدارات اللاحقة</td></tr><tr><td>4</td><td>v10.16.0+, v11.8.0+, 12.0.0 وجميع الإصدارات اللاحقة</td></tr><tr><td>3</td><td>v6.14.2*, 8.11.2+, v9.11.0+*, 10.0.0 وجميع الإصدارات اللاحقة</td></tr><tr><td>2</td><td>v8.10.0+<em>, v9.3.0+</em>, 10.0.0 وجميع الإصدارات اللاحقة</td></tr><tr><td>1</td><td>v8.6.0+**, v9.0.0+*, 10.0.0 وجميع الإصدارات اللاحقة</td></tr></tbody></table><ul><li>كان Node-API تجريبيًا.</li></ul><p>** تضمن Node.js 8.0.0 Node-API كتجريبي. تم إصداره كإصدار Node-API 1 ولكن استمر في التطور حتى Node.js 8.6.0. تختلف واجهة برمجة التطبيقات في الإصدارات قبل Node.js 8.6.0. نوصي بإصدار Node-API 3 أو أحدث.</p><p>سيكون لكل واجهة برمجة تطبيقات موثقة لـ Node-API رأس يسمى <code>added in:</code>، وستحتوي واجهات برمجة التطبيقات المستقرة على رأس إضافي <code>Node-API version:</code>. تكون واجهات برمجة التطبيقات قابلة للاستخدام مباشرة عند استخدام إصدار Node.js يدعم إصدار Node-API الموضح في <code>Node-API version:</code> أو أعلى. عند استخدام إصدار Node.js لا يدعم <code>Node-API version:</code> المدرجة أو إذا لم تكن هناك <code>Node-API version:</code> مدرجة، فستكون واجهة برمجة التطبيقات متاحة فقط إذا <code>#define NAPI_EXPERIMENTAL</code> تسبق تضمين <code>node_api.h</code> أو <code>js_native_api.h</code>. إذا بدا أن واجهة برمجة التطبيقات غير متوفرة في إصدار من Node.js أحدث من الإصدار الموضح في <code>added in:</code>، فمن المرجح أن يكون هذا هو سبب الغياب الظاهر.</p><p>يمكن العثور على Node-APIs المرتبطة بشكل صارم بالوصول إلى ميزات ECMAScript من التعليمات البرمجية الأصلية بشكل منفصل في <code>js_native_api.h</code> و <code>js_native_api_types.h</code>. يتم تضمين واجهات برمجة التطبيقات المحددة في هذه الرؤوس في <code>node_api.h</code> و <code>node_api_types.h</code>. يتم تنظيم الرؤوس بهذه الطريقة للسماح بتنفيذ Node-API خارج Node.js. بالنسبة لهذه التطبيقات، قد لا تكون واجهات برمجة التطبيقات الخاصة بـ Node.js قابلة للتطبيق.</p><p>يمكن فصل الأجزاء الخاصة بـ Node.js من وظيفة إضافية عن التعليمات البرمجية التي تعرض الوظائف الفعلية لبيئة JavaScript بحيث يمكن استخدام الأخير مع تطبيقات متعددة لـ Node-API. في المثال أدناه، يشير <code>addon.c</code> و <code>addon.h</code> فقط إلى <code>js_native_api.h</code>. هذا يضمن أنه يمكن إعادة استخدام <code>addon.c</code> للترجمة مقابل إما تطبيق Node.js لـ Node-API أو أي تطبيق لـ Node-API خارج Node.js.</p><p><code>addon_node.c</code> هو ملف منفصل يحتوي على نقطة الدخول الخاصة بـ Node.js إلى الوظيفة الإضافية والتي تقوم بإنشاء الوظيفة الإضافية عن طريق الاتصال بـ <code>addon.c</code> عند تحميل الوظيفة الإضافية في بيئة Node.js.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// addon.h</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifndef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _ADDON_H_</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _ADDON_H_</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;js_native_api.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create_addon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // _ADDON_H_</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// addon.c</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;addon.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NODE_API_CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                                  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {                                                            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (call);                                  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {                                      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_extended_error_info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      napi_get_last_error_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((env), </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">error_info);               </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err_message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error_info-&gt;error_message;        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> is_pending;                                            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      napi_is_exception_pending</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((env), </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_pending);              </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      /* If an exception is already pending, don&#39;t rethrow it */</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  \</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_pending) {                                          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (err_message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)               </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;empty error message&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                               \</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            :</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err_message;                                        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        napi_throw_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((env), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, message);                   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }                                                           </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                                </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }                                                             </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_value</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DoSomethingUseful</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Do something useful.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create_addon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value result;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  NODE_API_CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value exported_function;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  NODE_API_CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                          &quot;doSomethingUseful&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          NAPI_AUTO_LENGTH,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          DoSomethingUseful,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                          NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                          &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">exported_function));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  NODE_API_CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                             result,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                             &quot;doSomethingUseful&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                             exported_function));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// addon_node.c</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;addon.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAPI_MODULE_INIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* napi_env env, napi_value exports */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // This function body is expected to return a `napi_value`.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // The variables `napi_env env` and `napi_value exports` may be used within</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // the body, as they are provided by the definition of `NAPI_MODULE_INIT()`.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> create_addon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="environment-life-cycle-apis" tabindex="-1">دورة حياة بيئات APIs <a class="header-anchor" href="#environment-life-cycle-apis" aria-label="Permalink to “دورة حياة بيئات APIs”">​</a></h2><p><a href="https://tc39.es/ecma262/#sec-agents" target="_blank" rel="noreferrer">القسم 8.7</a> من <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">مواصفات لغة ECMAScript</a> يحدد مفهوم &quot;وكيل&quot; على أنه بيئة قائمة بذاتها يتم فيها تشغيل كود JavaScript. يمكن بدء وإنهاء العديد من هذه الوكلاء إما بشكل متزامن أو بالتسلسل بواسطة العملية.</p><p>تتوافق بيئة Node.js مع وكيل ECMAScript. في العملية الرئيسية، يتم إنشاء بيئة عند بدء التشغيل، ويمكن إنشاء بيئات إضافية على سلاسل رسائل منفصلة لتعمل بمثابة <a href="https://nodejs.org/api/worker_threads" target="_blank" rel="noreferrer">سلاسل رسائل عاملة</a>. عندما يتم تضمين Node.js في تطبيق آخر، قد يقوم السلسلة الرئيسية للتطبيق أيضًا بإنشاء وتدمير بيئة Node.js عدة مرات خلال دورة حياة عملية التطبيق بحيث أن كل بيئة Node.js يتم إنشاؤها بواسطة التطبيق قد تقوم بدورها، خلال دورة حياتها، بإنشاء وتدمير بيئات إضافية كسلاسل رسائل عاملة.</p><p>من منظور ملحق أصلي، هذا يعني أن الارتباطات التي يوفرها قد يتم استدعاؤها عدة مرات، من سياقات متعددة، وحتى بشكل متزامن من سلاسل رسائل متعددة.</p><p>قد تحتاج الملحقات الأصلية إلى تخصيص حالة عامة تستخدمها خلال دورة حياتها لبيئة Node.js بحيث تكون الحالة فريدة لكل مثيل من الملحق.</p><p>لهذه الغاية، توفر Node-API طريقة لربط البيانات بحيث تكون دورة حياتها مرتبطة بدورة حياة بيئة Node.js.</p><h3 id="napi_set_instance_data" tabindex="-1"><code>napi_set_instance_data</code> <a class="header-anchor" href="#napi_set_instance_data" aria-label="Permalink to “napi_set_instance_data”">​</a></h3><p><strong>أضيف في: v12.8.0, v10.20.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_set_instance_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء استدعاء Node-API ضمنها.</li><li><code>[in] data</code>: عنصر البيانات لإتاحته للارتباطات الخاصة بهذا المثيل.</li><li><code>[in] finalize_cb</code>: الدالة التي سيتم استدعاؤها عند إنهاء البيئة. تتلقى الدالة <code>data</code> حتى تتمكن من تحريرها. توفر <a href="/ar/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> مزيدًا من التفاصيل.</li><li><code>[in] finalize_hint</code>: تلميح اختياري لتمريره إلى معاودة الاتصال النهائية أثناء التجميع.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يربط هذا API <code>data</code> ببيئة Node.js قيد التشغيل حاليًا. يمكن استرداد <code>data</code> لاحقًا باستخدام <code>napi_get_instance_data()</code>. سيتم استبدال أي بيانات موجودة مرتبطة ببيئة Node.js قيد التشغيل حاليًا والتي تم تعيينها عن طريق استدعاء سابق لـ <code>napi_set_instance_data()</code>. إذا تم توفير <code>finalize_cb</code> بواسطة الاستدعاء السابق، فلن يتم استدعاؤه.</p><h3 id="napi_get_instance_data" tabindex="-1"><code>napi_get_instance_data</code> <a class="header-anchor" href="#napi_get_instance_data" aria-label="Permalink to “napi_get_instance_data”">​</a></h3><p><strong>أُضيف في: الإصدار 12.8.0، 10.20.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_instance_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء Node-API ضمنها.</li><li><code>[out] data</code>: عنصر البيانات الذي تم ربطه مسبقًا ببيئة Node.js قيد التشغيل حاليًا عن طريق استدعاء <code>napi_set_instance_data()</code>.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح الـ API.</p><p>يسترجع هذا الـ API البيانات التي تم ربطها مسبقًا ببيئة Node.js قيد التشغيل حاليًا عبر <code>napi_set_instance_data()</code>. إذا لم يتم تعيين أي بيانات، فسوف ينجح الاستدعاء وسيتم تعيين <code>data</code> إلى <code>NULL</code>.</p><h2 id="basic-node-api-data-types" tabindex="-1">أنواع بيانات Node-API الأساسية <a class="header-anchor" href="#basic-node-api-data-types" aria-label="Permalink to “أنواع بيانات Node-API الأساسية”">​</a></h2><p>تكشف Node-API عن أنواع البيانات الأساسية التالية كخلاصات تستهلكها الـ APIs المختلفة. يجب التعامل مع هذه الـ APIs على أنها مبهمة، ويمكن فحصها فقط باستخدام استدعاءات Node-API الأخرى.</p><h3 id="napi_status" tabindex="-1"><code>napi_status</code> <a class="header-anchor" href="#napi_status" aria-label="Permalink to “napi_status”">​</a></h3><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><p>رمز حالة متكامل يشير إلى نجاح أو فشل استدعاء Node-API. حاليًا، يتم دعم رموز الحالة التالية.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_ok,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_invalid_arg,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_object_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_string_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_name_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_function_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_number_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_boolean_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_array_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_generic_failure,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_pending_exception,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_cancelled,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_escape_called_twice,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_handle_scope_mismatch,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_callback_scope_mismatch,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_queue_full,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_closing,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_bigint_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_date_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_arraybuffer_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_detachable_arraybuffer_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_would_deadlock,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* غير مستخدم */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_no_external_buffers_allowed,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_cannot_run_js</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_status;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>إذا كانت هناك حاجة إلى معلومات إضافية عند إرجاع API لحالة فاشلة، فيمكن الحصول عليها عن طريق استدعاء <code>napi_get_last_error_info</code>.</p><h3 id="napi_extended_error_info" tabindex="-1"><code>napi_extended_error_info</code> <a class="header-anchor" href="#napi_extended_error_info" aria-label="Permalink to “napi_extended_error_info”">​</a></h3><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error_message;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> engine_reserved;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> engine_error_code;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status error_code;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_extended_error_info;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>error_message</code>: سلسلة بترميز UTF8 تحتوي على وصف محايد للـ VM للخطأ.</li><li><code>engine_reserved</code>: محجوز لتفاصيل خطأ خاصة بالـ VM. هذا غير مُنفَّذ حاليًا لأي VM.</li><li><code>engine_error_code</code>: رمز خطأ خاص بالـ VM. هذا غير مُنفَّذ حاليًا لأي VM.</li><li><code>error_code</code>: رمز حالة Node-API الذي نشأ مع الخطأ الأخير.</li></ul><p>راجع قسم <a href="/ar/nodejs/api/n-api#error-handling">التعامل مع الأخطاء</a> للحصول على معلومات إضافية.</p><h3 id="napi_env" tabindex="-1"><code>napi_env</code> <a class="header-anchor" href="#napi_env" aria-label="Permalink to “napi_env”">​</a></h3><p>يُستخدم <code>napi_env</code> لتمثيل سياق يمكن لتنفيذ Node-API الأساسي استخدامه للاحتفاظ بحالة خاصة بـ VM. يتم تمرير هذا الهيكل إلى الوظائف الأصلية عند استدعاؤها، ويجب تمريره مرة أخرى عند إجراء استدعاءات Node-API. على وجه التحديد، يجب تمرير نفس <code>napi_env</code> الذي تم تمريره عند استدعاء الوظيفة الأصلية الأولية إلى أي استدعاءات Node-API متداخلة لاحقة. لا يُسمح بتخزين <code>napi_env</code> مؤقتًا لغرض إعادة الاستخدام العام، وتمرير <code>napi_env</code> بين مثيلات نفس الملحق الذي يعمل على سلاسل رسائل <a href="/ar/nodejs/api/worker_threads#class-worker"><code>Worker</code></a> مختلفة. يصبح <code>napi_env</code> غير صالح عند إلغاء تحميل مثيل لملحق أصلي. يتم تسليم الإخطار بهذا الحدث من خلال عمليات الاسترجاع التي تم إعطاؤها لـ <a href="/ar/nodejs/api/n-api#napi-add-env-cleanup-hook"><code>napi_add_env_cleanup_hook</code></a> و <a href="/ar/nodejs/api/n-api#napi-set-instance-data"><code>napi_set_instance_data</code></a>.</p><h3 id="node_api_basic_env" tabindex="-1"><code>node_api_basic_env</code> <a class="header-anchor" href="#node_api_basic_env" aria-label="Permalink to “node_api_basic_env”">​</a></h3><div class="warning custom-block"><p class="custom-block-title">[مستقر: 1 - تجريبي]</p><p><a href="/ar/nodejs/api/documentation#stability-index">مستقر: 1</a> <a href="/ar/nodejs/api/documentation#stability-index">الاستقرار: 1</a> - تجريبي</p></div><p>يتم تمرير هذا المتغير من <code>napi_env</code> إلى المصفيات النهائية المتزامنة (<a href="/ar/nodejs/api/n-api#node-api-basic-finalize"><code>node_api_basic_finalize</code></a>). هناك مجموعة فرعية من Node-APIs التي تقبل معاملًا من النوع <code>node_api_basic_env</code> كمعاملها الأول. لا تصل هذه APIs إلى حالة محرك JavaScript وبالتالي فهي آمنة للاستدعاء من المصفيات النهائية المتزامنة. يُسمح بتمرير معامل من النوع <code>napi_env</code> إلى هذه APIs، ومع ذلك، لا يُسمح بتمرير معامل من النوع <code>node_api_basic_env</code> إلى APIs التي تصل إلى حالة محرك JavaScript. محاولة القيام بذلك بدون تحويل سينتج عنه تحذير من المترجم أو خطأ عند تجميع الوظائف الإضافية بعلامات تتسبب في إصدارها تحذيرات و/أو أخطاء عند تمرير أنواع مؤشرات غير صحيحة إلى دالة. سيؤدي استدعاء مثل هذه APIs من مصفي نهائي متزامن في النهاية إلى إنهاء التطبيق.</p><h3 id="napi_value" tabindex="-1"><code>napi_value</code> <a class="header-anchor" href="#napi_value" aria-label="Permalink to “napi_value”">​</a></h3><p>هذا مؤشر معتم يستخدم لتمثيل قيمة JavaScript.</p><h3 id="napi_threadsafe_function" tabindex="-1"><code>napi_threadsafe_function</code> <a class="header-anchor" href="#napi_threadsafe_function" aria-label="Permalink to “napi_threadsafe_function”">​</a></h3><p><strong>أُضيف في: الإصدار 10.6.0</strong></p><p><strong>إصدار N-API: 4</strong></p><p>هذا مؤشر غير شفاف يمثل وظيفة JavaScript يمكن استدعاؤها بشكل غير متزامن من عدة سلاسل رسائل عبر <code>napi_call_threadsafe_function()</code>.</p><h3 id="napi_threadsafe_function_release_mode" tabindex="-1"><code>napi_threadsafe_function_release_mode</code> <a class="header-anchor" href="#napi_threadsafe_function_release_mode" aria-label="Permalink to “napi_threadsafe_function_release_mode”">​</a></h3><p><strong>أُضيف في: الإصدار 10.6.0</strong></p><p><strong>إصدار N-API: 4</strong></p><p>قيمة تُعطى إلى <code>napi_release_threadsafe_function()</code> للإشارة إلى ما إذا كان سيتم إغلاق الوظيفة الآمنة لسلاسل الرسائل على الفور (<code>napi_tsfn_abort</code>) أو مجرد تحريرها (<code>napi_tsfn_release</code>) وبالتالي ستكون متاحة للاستخدام اللاحق عبر <code>napi_acquire_threadsafe_function()</code> و <code>napi_call_threadsafe_function()</code>.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_tsfn_release,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_tsfn_abort</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_threadsafe_function_release_mode;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="napi_threadsafe_function_call_mode" tabindex="-1"><code>napi_threadsafe_function_call_mode</code> <a class="header-anchor" href="#napi_threadsafe_function_call_mode" aria-label="Permalink to “napi_threadsafe_function_call_mode”">​</a></h3><p><strong>أُضيف في: الإصدار 10.6.0</strong></p><p><strong>إصدار N-API: 4</strong></p><p>قيمة تُعطى إلى <code>napi_call_threadsafe_function()</code> للإشارة إلى ما إذا كان يجب أن يحظر الاستدعاء كلما كان الطابور المرتبط بالوظيفة الآمنة لسلاسل الرسائل ممتلئًا.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_tsfn_nonblocking,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_tsfn_blocking</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_threadsafe_function_call_mode;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="node-api-memory-management-types" tabindex="-1">أنواع إدارة الذاكرة في Node-API <a class="header-anchor" href="#node-api-memory-management-types" aria-label="Permalink to “أنواع إدارة الذاكرة في Node-API”">​</a></h3><h4 id="napi_handle_scope" tabindex="-1"><code>napi_handle_scope</code> <a class="header-anchor" href="#napi_handle_scope" aria-label="Permalink to “napi_handle_scope”">​</a></h4><p>هذا تجريد يُستخدم للتحكم في دورة حياة الكائنات التي يتم إنشاؤها داخل نطاق معين وتعديلها. بشكل عام، يتم إنشاء قيم Node-API في سياق نطاق المقبض. عند استدعاء طريقة أصلية من JavaScript، سيوجد نطاق مقبض افتراضي. إذا لم ينشئ المستخدم نطاق مقبض جديدًا بشكل صريح، فسيتم إنشاء قيم Node-API في نطاق المقبض الافتراضي. بالنسبة لأي استدعاءات للتعليمات البرمجية خارج تنفيذ الطريقة الأصلية (على سبيل المثال، أثناء استدعاء رد اتصال libuv)، يجب على الوحدة إنشاء نطاق قبل استدعاء أي وظائف يمكن أن تؤدي إلى إنشاء قيم JavaScript.</p><p>يتم إنشاء نطاقات المقبض باستخدام <a href="/ar/nodejs/api/n-api#napi-open-handle-scope"><code>napi_open_handle_scope</code></a> ويتم تدميرها باستخدام <a href="/ar/nodejs/api/n-api#napi-close-handle-scope"><code>napi_close_handle_scope</code></a>. يمكن أن يشير إغلاق النطاق إلى GC إلى أن جميع <code>napi_value</code>s التي تم إنشاؤها خلال دورة حياة نطاق المقبض لم تعد مُشار إليها من إطار المكدس الحالي.</p><p>لمزيد من التفاصيل، راجع <a href="/ar/nodejs/api/n-api#object-lifetime-management">إدارة دورة حياة الكائن</a>.</p><h4 id="napi_escapable_handle_scope" tabindex="-1">‏<code>napi_escapable_handle_scope</code> <a class="header-anchor" href="#napi_escapable_handle_scope" aria-label="Permalink to “‏napi_escapable_handle_scope”">​</a></h4><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><p>مجالات المقابض القابلة للهروب هي نوع خاص من مجالات المقابض لإرجاع القيم التي تم إنشاؤها داخل مجال مقبض معين إلى مجال أصلي.</p><h4 id="napi_ref" tabindex="-1">‏<code>napi_ref</code> <a class="header-anchor" href="#napi_ref" aria-label="Permalink to “‏napi_ref”">​</a></h4><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><p>هذا هو التجريد المستخدم للإشارة إلى <code>napi_value</code>. يتيح ذلك للمستخدمين إدارة دورات حياة قيم JavaScript، بما في ذلك تحديد الحد الأدنى لدورات حياتهم بشكل صريح.</p><p>لمزيد من التفاصيل، راجع <a href="/ar/nodejs/api/n-api#object-lifetime-management">إدارة دورة حياة الكائن</a>.</p><h4 id="napi_type_tag" tabindex="-1">‏<code>napi_type_tag</code> <a class="header-anchor" href="#napi_type_tag" aria-label="Permalink to “‏napi_type_tag”">​</a></h4><p><strong>أُضيف في: v14.8.0, v12.19.0</strong></p><p><strong>إصدار N-API: 8</strong></p><p>قيمة 128 بت مخزنة كعددين صحيحين غير موقعين 64 بت. إنها تعمل كمعرف فريد عالمي (UUID) يمكن من خلاله &quot;وسم&quot; كائنات JavaScript أو <a href="/ar/nodejs/api/n-api#napi-create-external">العناصر الخارجية</a> للتأكد من أنها من نوع معين. هذا فحص أقوى من <a href="/ar/nodejs/api/n-api#napi-instanceof"><code>napi_instanceof</code></a>، لأن الأخير يمكن أن يقدم نتيجة إيجابية خاطئة إذا تم التلاعب بنموذج الكائن. يكون وسم النوع أكثر فائدة بالاقتران مع <a href="/ar/nodejs/api/n-api#napi-wrap"><code>napi_wrap</code></a> لأنه يضمن إمكانية تحويل المؤشر الذي تم استرجاعه من كائن ملتف بأمان إلى النوع الأصلي المطابق لعلامة النوع التي تم تطبيقها مسبقًا على كائن JavaScript.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint64_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lower;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint64_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> upper;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_type_tag;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="napi_async_cleanup_hook_handle" tabindex="-1">‏<code>napi_async_cleanup_hook_handle</code> <a class="header-anchor" href="#napi_async_cleanup_hook_handle" aria-label="Permalink to “‏napi_async_cleanup_hook_handle”">​</a></h4><p><strong>أُضيف في: v14.10.0, v12.19.0</strong></p><p>قيمة مبهمة تم إرجاعها بواسطة <a href="/ar/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>. يجب تمريرها إلى <a href="/ar/nodejs/api/n-api#napi-remove-async-cleanup-hook"><code>napi_remove_async_cleanup_hook</code></a> عند اكتمال سلسلة أحداث التنظيف غير المتزامنة.</p><h3 id="node-api-callback-types" tabindex="-1">أنواع معاودة الاتصال Node-API <a class="header-anchor" href="#node-api-callback-types" aria-label="Permalink to “أنواع معاودة الاتصال Node-API”">​</a></h3><h4 id="napi_callback_info" tabindex="-1">‏<code>napi_callback_info</code> <a class="header-anchor" href="#napi_callback_info" aria-label="Permalink to “‏napi_callback_info”">​</a></h4><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><p>نوع بيانات مبهم يتم تمريره إلى دالة معاودة الاتصال. يمكن استخدامه للحصول على معلومات إضافية حول السياق الذي تم فيه استدعاء معاودة الاتصال.</p><h4 id="napi_callback" tabindex="-1">‏<code>napi_callback</code> <a class="header-anchor" href="#napi_callback" aria-label="Permalink to “‏napi_callback”">​</a></h4><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><p>نوع مؤشر الدالة للدوال الأصلية التي يوفرها المستخدم والتي سيتم عرضها على JavaScript عبر Node-API. يجب أن تفي دوال معاودة الاتصال بالتوقيع التالي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">napi_callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)(napi_env, napi_callback_info);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>باستثناء الأسباب التي تمت مناقشتها في <a href="/ar/nodejs/api/n-api#object-lifetime-management">إدارة دورة حياة الكائن</a>، ليس من الضروري إنشاء مجال مقبض و/أو معاودة اتصال داخل <code>napi_callback</code>.</p><h4 id="node_api_basic_finalize" tabindex="-1"><code>node_api_basic_finalize</code> <a class="header-anchor" href="#node_api_basic_finalize" aria-label="Permalink to “node_api_basic_finalize”">​</a></h4><p><strong>أُضيف في: v21.6.0, v20.12.0, v18.20.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[مستقر: 1 - تجريبي]</p><p><a href="/ar/nodejs/api/documentation#stability-index">مستقر: 1</a> <a href="/ar/nodejs/api/documentation#stability-index">الاستقرار: 1</a> - تجريبي</p></div><p>نوع مؤشر الوظيفة للوظائف التي يوفرها الملحق والتي تسمح للمستخدم بالإخطار عندما تكون البيانات المملوكة خارجيًا جاهزة للتنظيف لأن الكائن المرتبط بها قد تم جمعه بواسطة جامع القمامة. يجب على المستخدم توفير وظيفة تفي بالتوقيع التالي والتي سيتم استدعاؤها عند جمع الكائن. حاليًا، يمكن استخدام <code>node_api_basic_finalize</code> لمعرفة متى يتم جمع الكائنات التي تحتوي على بيانات خارجية.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">node_api_basic_finalize)(node_api_basic_env env,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> finalize_data,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> finalize_hint);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ما لم يكن لأسباب تمت مناقشتها في <a href="/ar/nodejs/api/n-api#object-lifetime-management">إدارة عمر الكائن</a>، فإن إنشاء معالج و/أو نطاق رد اتصال داخل نص الوظيفة ليس ضروريًا.</p><p>نظرًا لأن هذه الوظائف قد يتم استدعاؤها بينما يكون محرك JavaScript في حالة لا يمكنه فيها تنفيذ كود JavaScript، فلا يمكن استدعاء سوى واجهات برمجة تطبيقات Node التي تقبل <code>node_api_basic_env</code> كمعاملها الأول. يمكن استخدام <a href="/ar/nodejs/api/n-api#node-api-post-finalizer"><code>node_api_post_finalizer</code></a> لجدولة استدعاءات Node-API التي تتطلب الوصول إلى حالة محرك JavaScript ليتم تشغيلها بعد اكتمال دورة جمع القمامة الحالية.</p><p>في حالة <a href="/ar/nodejs/api/n-api#node-api-create-external-string-latin1"><code>node_api_create_external_string_latin1</code></a> و <a href="/ar/nodejs/api/n-api#node-api-create-external-string-utf16"><code>node_api_create_external_string_utf16</code></a> قد يكون المعامل <code>env</code> فارغًا، لأنه يمكن جمع السلاسل الخارجية خلال الجزء الأخير من إيقاف تشغيل البيئة.</p><p>سجل التغييرات:</p><ul><li>تجريبي (<code>NAPI_EXPERIMENTAL</code>): لا يمكن استدعاء سوى استدعاءات Node-API التي تقبل <code>node_api_basic_env</code> كمعاملها الأول، وإلا فسيتم إنهاء التطبيق برسالة خطأ مناسبة. يمكن إيقاف تشغيل هذه الميزة عن طريق تحديد <code>NODE_API_EXPERIMENTAL_BASIC_ENV_OPT_OUT</code>.</li></ul><h4 id="napi_finalize" tabindex="-1"><code>napi_finalize</code> <a class="header-anchor" href="#napi_finalize" aria-label="Permalink to “napi_finalize”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><p>نوع مؤشر دالة للدالة المقدمة من الملحق والتي تسمح للمستخدم بجدولة مجموعة من المكالمات إلى Node-APIs استجابةً لحدث جمع البيانات المهملة، بعد اكتمال دورة جمع البيانات المهملة. يمكن استخدام مؤشرات الدالة هذه مع <a href="/ar/nodejs/api/n-api#node-api-post-finalizer"><code>node_api_post_finalizer</code></a>.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_finalize)(napi_env env,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> finalize_data,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> finalize_hint);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>سجل التغييرات:</p><ul><li>تجريبي (<code>NAPI_EXPERIMENTAL</code> محدد): لم يعد من الممكن استخدام دالة من هذا النوع كـ finalizer، باستثناء <a href="/ar/nodejs/api/n-api#node-api-post-finalizer"><code>node_api_post_finalizer</code></a>. يجب استخدام <a href="/ar/nodejs/api/n-api#node-api-basic-finalize"><code>node_api_basic_finalize</code></a> بدلاً من ذلك. يمكن إيقاف تشغيل هذه الميزة عن طريق تحديد <code>NODE_API_EXPERIMENTAL_BASIC_ENV_OPT_OUT</code>.</li></ul><h4 id="napi_async_execute_callback" tabindex="-1"><code>napi_async_execute_callback</code> <a class="header-anchor" href="#napi_async_execute_callback" aria-label="Permalink to “napi_async_execute_callback”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><p>مؤشر دالة يستخدم مع الدوال التي تدعم العمليات غير المتزامنة. يجب أن تستوفي دوال الاستدعاء التوقيع التالي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_async_execute_callback)(napi_env env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>يجب أن تتجنب تطبيقات هذه الدالة إجراء مكالمات Node-API التي تنفذ JavaScript أو تتفاعل مع كائنات JavaScript. يجب أن تكون مكالمات Node-API في <code>napi_async_complete_callback</code> بدلاً من ذلك. لا تستخدم المعامل <code>napi_env</code> لأنه من المحتمل أن يؤدي إلى تنفيذ JavaScript.</p><h4 id="napi_async_complete_callback" tabindex="-1"><code>napi_async_complete_callback</code> <a class="header-anchor" href="#napi_async_complete_callback" aria-label="Permalink to “napi_async_complete_callback”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><p>مؤشر دالة يستخدم مع الدوال التي تدعم العمليات غير المتزامنة. يجب أن تستوفي دوال الاستدعاء التوقيع التالي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_async_complete_callback)(napi_env env,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                             napi_status status,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                             void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>إلا للأسباب التي نوقشت في <a href="/ar/nodejs/api/n-api#object-lifetime-management">إدارة دورة حياة الكائن</a>، ليس من الضروري إنشاء نطاق معالج و/أو استدعاء داخل نص الدالة.</p><h4 id="napi_threadsafe_function_call_js" tabindex="-1"><code>napi_threadsafe_function_call_js</code> <a class="header-anchor" href="#napi_threadsafe_function_call_js" aria-label="Permalink to “napi_threadsafe_function_call_js”">​</a></h4><p><strong>أضيف في: v10.6.0</strong></p><p><strong>إصدار N-API: 4</strong></p><p>مؤشر وظيفة يستخدم مع استدعاءات الوظائف غير المتزامنة الآمنة للمواضيع. سيتم استدعاء رد الاتصال على الموضوع الرئيسي. الغرض منه هو استخدام عنصر بيانات يصل عبر قائمة الانتظار من أحد المواضيع الثانوية لإنشاء المعلمات الضرورية لاستدعاء JavaScript، عادةً عبر <code>napi_call_function</code>، ثم إجراء الاستدعاء إلى JavaScript.</p><p>يتم إعطاء البيانات التي تصل من الموضوع الثانوي عبر قائمة الانتظار في معلمة <code>data</code> ويتم إعطاء وظيفة JavaScript التي سيتم استدعاؤها في معلمة <code>js_callback</code>.</p><p>يقوم Node-API بإعداد البيئة قبل استدعاء رد الاتصال هذا، لذلك يكفي استدعاء وظيفة JavaScript عبر <code>napi_call_function</code> بدلاً من عبر <code>napi_make_callback</code>.</p><p>يجب أن تستوفي وظائف رد الاتصال التوقيع التالي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_threadsafe_function_call_js)(napi_env env,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_value js_callback,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                 void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                 void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة المستخدمة لاستدعاءات API، أو <code>NULL</code> إذا كانت الوظيفة الآمنة للمواضيع قيد الإزالة وقد تحتاج <code>data</code> إلى التحرير.</li><li><code>[in] js_callback</code>: وظيفة JavaScript التي سيتم استدعاؤها، أو <code>NULL</code> إذا كانت الوظيفة الآمنة للمواضيع قيد الإزالة وقد تحتاج <code>data</code> إلى التحرير. قد تكون أيضًا <code>NULL</code> إذا تم إنشاء الوظيفة الآمنة للمواضيع بدون <code>js_callback</code>.</li><li><code>[in] context</code>: البيانات الاختيارية التي تم إنشاء الوظيفة الآمنة للمواضيع بها.</li><li><code>[in] data</code>: البيانات التي تم إنشاؤها بواسطة الموضوع الثانوي. تقع على عاتق رد الاتصال مسؤولية تحويل هذه البيانات الأصلية إلى قيم JavaScript (باستخدام وظائف Node-API) التي يمكن تمريرها كمعلمات عند استدعاء <code>js_callback</code>. تتم إدارة هذا المؤشر بالكامل بواسطة المواضيع ورد الاتصال هذا. وبالتالي يجب على رد الاتصال هذا تحرير البيانات.</li></ul><p>ما لم يكن ذلك لأسباب تمت مناقشتها في <a href="/ar/nodejs/api/n-api#object-lifetime-management">إدارة دورة حياة الكائن</a>، فإن إنشاء معالج و / أو نطاق رد اتصال داخل نص الوظيفة ليس ضروريًا.</p><h4 id="napi_cleanup_hook" tabindex="-1"><code>napi_cleanup_hook</code> <a class="header-anchor" href="#napi_cleanup_hook" aria-label="Permalink to “napi_cleanup_hook”">​</a></h4><p><strong>أُضيف في: الإصدار v19.2.0، الإصدار v18.13.0</strong></p><p><strong>إصدار N-API: 3</strong></p><p>مؤشر الدالة المستخدم مع <a href="/ar/nodejs/api/n-api#napi-add-env-cleanup-hook"><code>napi_add_env_cleanup_hook</code></a>. سيتم استدعاؤه عند إيقاف تشغيل البيئة.</p><p>يجب أن تستوفي دوال الاستدعاء التوقيع التالي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_cleanup_hook)(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] data</code>: البيانات التي تم تمريرها إلى <a href="/ar/nodejs/api/n-api#napi-add-env-cleanup-hook"><code>napi_add_env_cleanup_hook</code></a>.</li></ul><h4 id="napi_async_cleanup_hook" tabindex="-1"><code>napi_async_cleanup_hook</code> <a class="header-anchor" href="#napi_async_cleanup_hook" aria-label="Permalink to “napi_async_cleanup_hook”">​</a></h4><p><strong>أُضيف في: الإصدار v14.10.0، الإصدار v12.19.0</strong></p><p>مؤشر الدالة المستخدم مع <a href="/ar/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>. سيتم استدعاؤه عند إيقاف تشغيل البيئة.</p><p>يجب أن تستوفي دوال الاستدعاء التوقيع التالي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_async_cleanup_hook)(napi_async_cleanup_hook_handle handle,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] handle</code>: المقبض الذي يجب تمريره إلى <a href="/ar/nodejs/api/n-api#napi-remove-async-cleanup-hook"><code>napi_remove_async_cleanup_hook</code></a> بعد الانتهاء من التنظيف غير المتزامن.</li><li><code>[in] data</code>: البيانات التي تم تمريرها إلى <a href="/ar/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>.</li></ul><p>يجب أن يبدأ نص الدالة إجراءات التنظيف غير المتزامنة وفي نهايتها يجب تمرير <code>handle</code> في استدعاء إلى <a href="/ar/nodejs/api/n-api#napi-remove-async-cleanup-hook"><code>napi_remove_async_cleanup_hook</code></a>.</p><h2 id="error-handling" tabindex="-1">معالجة الأخطاء <a class="header-anchor" href="#error-handling" aria-label="Permalink to “معالجة الأخطاء”">​</a></h2><p>تستخدم Node-API كلاً من قيم الإرجاع واستثناءات JavaScript لمعالجة الأخطاء. تشرح الأقسام التالية النهج المتبع لكل حالة.</p><h3 id="return-values" tabindex="-1">قيم الإرجاع <a class="header-anchor" href="#return-values" aria-label="Permalink to “قيم الإرجاع”">​</a></h3><p>تتشابه جميع دوال Node-API في نمط معالجة الأخطاء نفسه. نوع الإرجاع لجميع دوال API هو <code>napi_status</code>.</p><p>ستكون قيمة الإرجاع <code>napi_ok</code> إذا كان الطلب ناجحًا ولم يتم طرح أي استثناء JavaScript غير مُعالج. إذا حدث خطأ وتم طرح استثناء، فسيتم إرجاع قيمة <code>napi_status</code> للخطأ. إذا تم طرح استثناء ولم يحدث أي خطأ، فسيتم إرجاع <code>napi_pending_exception</code>.</p><p>في الحالات التي يتم فيها إرجاع قيمة إرجاع بخلاف <code>napi_ok</code> أو <code>napi_pending_exception</code>، يجب استدعاء <a href="/ar/nodejs/api/n-api#napi-is-exception-pending"><code>napi_is_exception_pending</code></a> للتحقق مما إذا كان هناك استثناء معلق. راجع قسم الاستثناءات لمزيد من التفاصيل.</p><p>يتم تحديد المجموعة الكاملة لقيم <code>napi_status</code> المحتملة في <code>napi_api_types.h</code>.</p><p>توفر قيمة الإرجاع <code>napi_status</code> تمثيلًا مستقلاً عن الجهاز الظاهري للخطأ الذي حدث. في بعض الحالات، يكون من المفيد أن تكون قادرًا على الحصول على معلومات أكثر تفصيلاً، بما في ذلك سلسلة تمثل الخطأ بالإضافة إلى معلومات خاصة بالجهاز الظاهري (المحرك).</p><p>من أجل استرداد هذه المعلومات، يتم توفير <a href="/ar/nodejs/api/n-api#napi-get-last-error-info"><code>napi_get_last_error_info</code></a> الذي يُرجع بنية <code>napi_extended_error_info</code>. تنسيق بنية <code>napi_extended_error_info</code> هو كما يلي:</p><p><strong>أُضيف في: الإصدار v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_extended_error_info {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error_message;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> engine_reserved;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> engine_error_code;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status error_code;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>error_message</code>: تمثيل نصي للخطأ الذي حدث.</li><li><code>engine_reserved</code>: مقبض مبهم محجوز لاستخدام المحرك فقط.</li><li><code>engine_error_code</code>: رمز خطأ خاص بالجهاز الظاهري.</li><li><code>error_code</code>: رمز حالة Node-API للخطأ الأخير.</li></ul><p>تُرجع <a href="/ar/nodejs/api/n-api#napi-get-last-error-info"><code>napi_get_last_error_info</code></a> معلومات آخر استدعاء Node-API تم إجراؤه.</p><p>لا تعتمد على محتوى أو تنسيق أي من المعلومات الموسعة لأنها لا تخضع لـ SemVer وقد تتغير في أي وقت. الغرض منه هو لأغراض التسجيل فقط.</p><h4 id="napi_get_last_error_info" tabindex="-1"><code>napi_get_last_error_info</code> <a class="header-anchor" href="#napi_get_last_error_info" aria-label="Permalink to “napi_get_last_error_info”">​</a></h4><p><strong>أضيف في: الإصدار v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_last_error_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                         const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_extended_error_info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[out] result</code>: هيكل <code>napi_extended_error_info</code> الذي يحتوي على مزيد من المعلومات حول الخطأ.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات.</p><p>تسترجع واجهة برمجة التطبيقات (API) هذه هيكل <code>napi_extended_error_info</code> الذي يحتوي على معلومات حول آخر خطأ حدث.</p><p>يكون محتوى <code>napi_extended_error_info</code> الذي تم إرجاعه صالحًا فقط حتى يتم استدعاء دالة Node-API على نفس <code>env</code>. يتضمن هذا استدعاءً لـ <code>napi_is_exception_pending</code> لذلك قد يكون من الضروري غالبًا عمل نسخة من المعلومات بحيث يمكن استخدامها لاحقًا. يشير المؤشر الذي تم إرجاعه في <code>error_message</code> إلى سلسلة محددة بشكل ثابت لذلك من الآمن استخدام هذا المؤشر إذا قمت بنسخه من حقل <code>error_message</code> (الذي سيتم تجاوزه) قبل استدعاء دالة Node-API أخرى.</p><p>لا تعتمد على محتوى أو تنسيق أي من المعلومات الموسعة لأنها لا تخضع لـ SemVer وقد تتغير في أي وقت. الغرض منه هو لأغراض التسجيل فقط.</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه حتى إذا كان هناك استثناء JavaScript معلق.</p><h3 id="exceptions" tabindex="-1">الاستثناءات <a class="header-anchor" href="#exceptions" aria-label="Permalink to “الاستثناءات”">​</a></h3><p>قد يؤدي أي استدعاء لدالة Node-API إلى استثناء JavaScript معلق. هذا هو الحال بالنسبة لأي من وظائف واجهة برمجة التطبيقات، حتى تلك التي قد لا تتسبب في تنفيذ JavaScript.</p><p>إذا كانت قيمة <code>napi_status</code> التي تم إرجاعها بواسطة دالة هي <code>napi_ok</code>، فلا يوجد استثناء معلق ولا يلزم اتخاذ أي إجراء إضافي. إذا كانت قيمة <code>napi_status</code> التي تم إرجاعها أي شيء آخر غير <code>napi_ok</code> أو <code>napi_pending_exception</code>، من أجل محاولة الاسترداد والمتابعة بدلاً من مجرد الإرجاع على الفور، يجب استدعاء <a href="/ar/nodejs/api/n-api#napi-is-exception-pending"><code>napi_is_exception_pending</code></a> لتحديد ما إذا كان هناك استثناء معلق أم لا.</p><p>في كثير من الحالات، عند استدعاء دالة Node-API وكان هناك استثناء معلق بالفعل، فسترجع الدالة على الفور بقيمة <code>napi_status</code> هي <code>napi_pending_exception</code>. ومع ذلك، هذا ليس هو الحال بالنسبة لجميع الوظائف. تسمح Node-API باستدعاء مجموعة فرعية من الوظائف للسماح ببعض التنظيف البسيط قبل العودة إلى JavaScript. في هذه الحالة، ستعكس <code>napi_status</code> حالة الوظيفة. لن تعكس الاستثناءات المعلقة السابقة. لتجنب الالتباس، تحقق من حالة الخطأ بعد كل استدعاء للدالة.</p><p>عندما يكون هناك استثناء معلق، يمكن استخدام أحد نهجين.</p><p>النهج الأول هو إجراء أي تنظيف مناسب ثم الإرجاع بحيث يعود التنفيذ إلى JavaScript. كجزء من الانتقال مرة أخرى إلى JavaScript، سيتم طرح الاستثناء في النقطة الموجودة في كود JavaScript حيث تم استدعاء الطريقة الأصلية. سلوك معظم استدعاءات Node-API غير محدد أثناء وجود استثناء معلق، وسيعود العديد منها ببساطة <code>napi_pending_exception</code>، لذا قم بأقل قدر ممكن ثم ارجع إلى JavaScript حيث يمكن معالجة الاستثناء.</p><p>النهج الثاني هو محاولة معالجة الاستثناء. ستكون هناك حالات يمكن فيها للكود الأصلي التقاط الاستثناء واتخاذ الإجراء المناسب ثم المتابعة. يوصى بهذا فقط في حالات محددة حيث من المعروف أنه يمكن معالجة الاستثناء بأمان. في هذه الحالات، يمكن استخدام <a href="/ar/nodejs/api/n-api#napi-get-and-clear-last-exception"><code>napi_get_and_clear_last_exception</code></a> للحصول على الاستثناء ومسحه. عند النجاح، ستحتوي النتيجة على مقبض لآخر JavaScript <code>Object</code> تم طرحه. إذا تم تحديد، بعد استرداد الاستثناء، أنه لا يمكن معالجة الاستثناء على الإطلاق، فيمكن إعادة طرحه باستخدام <a href="/ar/nodejs/api/n-api#napi-throw"><code>napi_throw</code></a> حيث يكون الخطأ هو قيمة JavaScript التي سيتم طرحها.</p><p>تتوفر أيضًا وظائف الأداة المساعدة التالية في حالة احتياج الكود الأصلي إلى طرح استثناء أو تحديد ما إذا كانت <code>napi_value</code> هي مثيل لكائن JavaScript <code>Error</code>: <a href="/ar/nodejs/api/n-api#napi-throw-error"><code>napi_throw_error</code></a>، <a href="/ar/nodejs/api/n-api#napi-throw-type-error"><code>napi_throw_type_error</code></a>، <a href="/ar/nodejs/api/n-api#napi-throw-range-error"><code>napi_throw_range_error</code></a>، <a href="/ar/nodejs/api/n-api#node-api-throw-syntax-error"><code>node_api_throw_syntax_error</code></a> و <a href="/ar/nodejs/api/n-api#napi-is-error"><code>napi_is_error</code></a>.</p><p>تتوفر أيضًا وظائف الأداة المساعدة التالية في حالة احتياج الكود الأصلي إلى إنشاء كائن <code>Error</code>: <a href="/ar/nodejs/api/n-api#napi-create-error"><code>napi_create_error</code></a>، <a href="/ar/nodejs/api/n-api#napi-create-type-error"><code>napi_create_type_error</code></a>، <a href="/ar/nodejs/api/n-api#napi-create-range-error"><code>napi_create_range_error</code></a> و <a href="/ar/nodejs/api/n-api#node-api-create-syntax-error"><code>node_api_create_syntax_error</code></a>، حيث النتيجة هي <code>napi_value</code> التي تشير إلى كائن JavaScript <code>Error</code> الذي تم إنشاؤه حديثًا.</p><p>يضيف مشروع Node.js رموز خطأ إلى جميع الأخطاء التي يتم إنشاؤها داخليًا. الهدف هو أن تستخدم التطبيقات رموز الخطأ هذه لجميع عمليات التحقق من الأخطاء. ستبقى رسائل الخطأ المرتبطة بها، ولكنها ستكون مخصصة فقط للاستخدام في التسجيل والعرض مع توقع أن الرسالة يمكن أن تتغير دون تطبيق SemVer. لدعم هذا النموذج باستخدام Node-API، سواء في الوظائف الداخلية أو لوظائف الوحدة النمطية المحددة (كممارسة جيدة)، تأخذ وظائف <code>throw_</code> و <code>create_</code> معلمة رمز اختيارية وهي السلسلة الخاصة بالرمز المراد إضافتها إلى كائن الخطأ. إذا كانت المعلمة الاختيارية <code>NULL</code>، فلن يتم ربط أي رمز بالخطأ. إذا تم توفير رمز، فسيتم أيضًا تحديث الاسم المرتبط بالخطأ ليكون:</p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>originalName [code]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>حيث <code>originalName</code> هو الاسم الأصلي المرتبط بالخطأ و <code>code</code> هو الرمز الذي تم توفيره. على سبيل المثال، إذا كان الرمز هو <code>&#39;ERR_ERROR_1&#39;</code> ويتم إنشاء <code>TypeError</code>، فسيكون الاسم:</p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>TypeError [ERR_ERROR_1]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="napi_throw" tabindex="-1"><code>napi_throw</code> <a class="header-anchor" href="#napi_throw" aria-label="Permalink to “napi_throw”">​</a></h4><p><strong>أُضيف في:</strong> v8.0.0</p><p><strong>إصدار N-API:</strong> 1</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] error</code>: قيمة JavaScript المراد طرحها.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بطرح قيمة JavaScript المقدمة.</p><h4 id="napi_throw_error" tabindex="-1"><code>napi_throw_error</code> <a class="header-anchor" href="#napi_throw_error" aria-label="Permalink to “napi_throw_error”">​</a></h4><p><strong>أُضيف في:</strong> v8.0.0</p><p><strong>إصدار N-API:</strong> 1</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_throw_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] code</code>: رمز خطأ اختياري ليتم تعيينه على الخطأ.</li><li><code>[in] msg</code>: سلسلة C تمثل النص المراد إقرانه بالخطأ.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بطرح <code>Error</code> في JavaScript مع النص المقدم.</p><h4 id="napi_throw_type_error" tabindex="-1"><code>napi_throw_type_error</code> <a class="header-anchor" href="#napi_throw_type_error" aria-label="Permalink to “napi_throw_type_error”">​</a></h4><p><strong>أُضيف في:</strong> v8.0.0</p><p><strong>إصدار N-API:</strong> 1</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_throw_type_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                              const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                              const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] code</code>: رمز خطأ اختياري ليتم تعيينه على الخطأ.</li><li><code>[in] msg</code>: سلسلة C تمثل النص المراد إقرانه بالخطأ.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بطرح <code>TypeError</code> في JavaScript مع النص المقدم.</p><h4 id="napi_throw_range_error" tabindex="-1"><code>napi_throw_range_error</code> <a class="header-anchor" href="#napi_throw_range_error" aria-label="Permalink to “napi_throw_range_error”">​</a></h4><p><strong>أُضيف في:</strong> v8.0.0</p><p><strong>إصدار N-API:</strong> 1</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_throw_range_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                               const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                               const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] code</code>: رمز خطأ اختياري ليتم تعيينه على الخطأ.</li><li><code>[in] msg</code>: سلسلة C تمثل النص المراد إقرانه بالخطأ.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بطرح <code>RangeError</code> في JavaScript مع النص المقدم.</p><h4 id="node_api_throw_syntax_error" tabindex="-1"><code>node_api_throw_syntax_error</code> <a class="header-anchor" href="#node_api_throw_syntax_error" aria-label="Permalink to “node_api_throw_syntax_error”">​</a></h4><p><strong>أُضيف في: الإصدار v17.2.0، v16.14.0</strong></p><p><strong>إصدار N-API: 9</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_throw_syntax_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يُستدعى فيها API.</li><li><code>[in] code</code>: رمز خطأ اختياري ليُعيَّن على الخطأ.</li><li><code>[in] msg</code>: سلسلة C تمثل النص المراد ربطه بالخطأ.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يُطلق API هذا <code>SyntaxError</code> لجافاسكربت مع النص المقدم.</p><h4 id="napi_is_error" tabindex="-1"><code>napi_is_error</code> <a class="header-anchor" href="#napi_is_error" aria-label="Permalink to “napi_is_error”">​</a></h4><p><strong>أُضيف في: الإصدار v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يُستدعى فيها API.</li><li><code>[in] value</code>: <code>napi_value</code> المراد التحقق منه.</li><li><code>[out] result</code>: قيمة منطقية تُعيَّن إلى true إذا كان <code>napi_value</code> يمثل خطأ، أو false بخلاف ذلك.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يستعلم API هذا عن <code>napi_value</code> للتحقق مما إذا كان يمثل كائن خطأ.</p><h4 id="napi_create_error" tabindex="-1"><code>napi_create_error</code> <a class="header-anchor" href="#napi_create_error" aria-label="Permalink to “napi_create_error”">​</a></h4><p><strong>أُضيف في: الإصدار v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يُستدعى فيها API.</li><li><code>[in] code</code>: <code>napi_value</code> اختياري مع السلسلة لرمز الخطأ المراد ربطه بالخطأ.</li><li><code>[in] msg</code>: <code>napi_value</code> يشير إلى <code>string</code> في جافاسكربت لاستخدامه كرسالة لـ <code>Error</code>.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل الخطأ الذي تم إنشاؤه.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يُرجع API هذا <code>Error</code> جافاسكربت مع النص المقدم.</p><h4 id="napi_create_type_error" tabindex="-1"><code>napi_create_type_error</code> <a class="header-anchor" href="#napi_create_type_error" aria-label="Permalink to “napi_create_type_error”">​</a></h4><p><strong>أُضيف في: الإصدار v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_type_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                               napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يُستدعى فيها API.</li><li><code>[in] code</code>: <code>napi_value</code> اختياري مع السلسلة لرمز الخطأ المراد ربطه بالخطأ.</li><li><code>[in] msg</code>: <code>napi_value</code> يشير إلى <code>string</code> في جافاسكربت لاستخدامه كرسالة لـ <code>Error</code>.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل الخطأ الذي تم إنشاؤه.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يُرجع API هذا <code>TypeError</code> جافاسكربت مع النص المقدم.</p><h4 id="napi_create_range_error" tabindex="-1"><code>napi_create_range_error</code> <a class="header-anchor" href="#napi_create_range_error" aria-label="Permalink to “napi_create_range_error”">​</a></h4><p><strong>أُضيف في: الإصدار v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_range_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] code</code>: قيمة <code>napi_value</code> اختيارية مع سلسلة رمز الخطأ المراد ربطها بالخطأ.</li><li><code>[in] msg</code>: <code>napi_value</code> يشير إلى <code>string</code> جافاسكربت لاستخدامه كرسالة للخطأ <code>Error</code>.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل الخطأ الذي تم إنشاؤه.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بإرجاع <code>RangeError</code> جافاسكربت مع النص المقدم.</p><h4 id="node_api_create_syntax_error" tabindex="-1"><code>node_api_create_syntax_error</code> <a class="header-anchor" href="#node_api_create_syntax_error" aria-label="Permalink to “node_api_create_syntax_error”">​</a></h4><p><strong>أُضيف في: الإصدار v17.2.0، v16.14.0</strong></p><p><strong>إصدار N-API: 9</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_syntax_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                     napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                     napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                     napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] code</code>: قيمة <code>napi_value</code> اختيارية مع سلسلة رمز الخطأ المراد ربطها بالخطأ.</li><li><code>[in] msg</code>: <code>napi_value</code> يشير إلى <code>string</code> جافاسكربت لاستخدامه كرسالة للخطأ <code>Error</code>.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل الخطأ الذي تم إنشاؤه.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بإرجاع <code>SyntaxError</code> جافاسكربت مع النص المقدم.</p><h4 id="napi_get_and_clear_last_exception" tabindex="-1"><code>napi_get_and_clear_last_exception</code> <a class="header-anchor" href="#napi_get_and_clear_last_exception" aria-label="Permalink to “napi_get_and_clear_last_exception”">​</a></h4><p><strong>أُضيف في: الإصدار v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_and_clear_last_exception</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[out] result</code>: الاستثناء إذا كان معلقًا، وإلا <code>NULL</code>.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه حتى إذا كان هناك استثناء جافاسكربت معلق.</p><h4 id="napi_is_exception_pending" tabindex="-1"><code>napi_is_exception_pending</code> <a class="header-anchor" href="#napi_is_exception_pending" aria-label="Permalink to “napi_is_exception_pending”">​</a></h4><p><strong>أضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_exception_pending</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[out] result</code>: قيمة منطقية يتم تعيينها على &quot;true&quot; إذا كان هناك استثناء معلق.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه حتى لو كان هناك استثناء JavaScript معلق.</p><h4 id="napi_fatal_exception" tabindex="-1"><code>napi_fatal_exception</code> <a class="header-anchor" href="#napi_fatal_exception" aria-label="Permalink to “napi_fatal_exception”">​</a></h4><p><strong>أضيف في: v9.10.0</strong></p><p><strong>إصدار N-API: 3</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_fatal_exception</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] err</code>: الخطأ الذي يتم تمريره إلى <code>&#39;uncaughtException&#39;</code>.</li></ul><p>تشغيل <code>&#39;uncaughtException&#39;</code> في JavaScript. مفيد إذا ألقى استدعاء غير متزامن (async callback) استثناءً دون طريقة للاسترداد.</p><h3 id="fatal-errors" tabindex="-1">أخطاء فادحة <a class="header-anchor" href="#fatal-errors" aria-label="Permalink to “أخطاء فادحة”">​</a></h3><p>في حالة حدوث خطأ غير قابل للاسترداد في إضافة أصلية، يمكن إرسال خطأ فادح لإنهاء العملية على الفور.</p><h4 id="napi_fatal_error" tabindex="-1"><code>napi_fatal_error</code> <a class="header-anchor" href="#napi_fatal_error" aria-label="Permalink to “napi_fatal_error”">​</a></h4><p><strong>أضيف في: v8.2.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_NO_RETURN </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_fatal_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> location_len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message_len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] location</code>: موقع اختياري حدث فيه الخطأ.</li><li><code>[in] location_len</code>: طول الموقع بالبايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كان منتهيًا بصفر.</li><li><code>[in] message</code>: الرسالة المرتبطة بالخطأ.</li><li><code>[in] message_len</code>: طول الرسالة بالبايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كانت منتهية بصفر.</li></ul><p>لا تعود استدعاء الدالة، سيتم إنهاء العملية.</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه حتى لو كان هناك استثناء JavaScript معلق.</p><h2 id="object-lifetime-management" tabindex="-1">إدارة دورة حياة الكائن <a class="header-anchor" href="#object-lifetime-management" aria-label="Permalink to “إدارة دورة حياة الكائن”">​</a></h2><p>عند إجراء استدعاءات Node-API، يمكن إرجاع معالجات للكائنات في الكومة الخاصة بـ VM الأساسي على هيئة <code>napi_values</code>. يجب أن تحافظ هذه المعالجات على الكائنات &#39;حية&#39; حتى لا تعود مطلوبة بواسطة التعليمات البرمجية الأصلية، وإلا فقد يتم جمع الكائنات قبل أن تنتهي التعليمات البرمجية الأصلية من استخدامها.</p><p>عند إرجاع معالجات الكائنات، فإنها ترتبط بـ &quot;نطاق&quot;. ترتبط دورة حياة النطاق الافتراضي بدورة حياة استدعاء الطريقة الأصلية. والنتيجة هي أنه، بشكل افتراضي، تظل المعالجات صالحة وستبقى الكائنات المرتبطة بهذه المعالجات حية طوال دورة حياة استدعاء الطريقة الأصلية.</p><p>ومع ذلك، في كثير من الحالات، من الضروري أن تظل المعالجات صالحة إما لفترة أقصر أو أطول من دورة حياة الطريقة الأصلية. تصف الأقسام التالية وظائف Node-API التي يمكن استخدامها لتغيير دورة حياة المعالج من الوضع الافتراضي.</p><h3 id="making-handle-lifespan-shorter-than-that-of-the-native-method" tabindex="-1">جعل مدة صلاحية المعالج أقصر من مدة صلاحية الطريقة الأصلية <a class="header-anchor" href="#making-handle-lifespan-shorter-than-that-of-the-native-method" aria-label="Permalink to “جعل مدة صلاحية المعالج أقصر من مدة صلاحية الطريقة الأصلية”">​</a></h3><p>غالبًا ما يكون من الضروري جعل مدة صلاحية المعالجات أقصر من مدة صلاحية الطريقة الأصلية. على سبيل المثال، ضع في اعتبارك طريقة أصلية تحتوي على حلقة تتكرر خلال العناصر الموجودة في مصفوفة كبيرة:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, object, i, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // do something with element</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>سيؤدي هذا إلى إنشاء عدد كبير من المعالجات، مما يستهلك موارد كبيرة. بالإضافة إلى ذلك، على الرغم من أن التعليمات البرمجية الأصلية يمكن أن تستخدم فقط أحدث معالج، إلا أن جميع الكائنات المرتبطة سيتم الاحتفاظ بها أيضًا لأنها تشترك جميعًا في نفس النطاق.</p><p>للتعامل مع هذه الحالة، يوفر Node-API القدرة على إنشاء &quot;نطاق&quot; جديد سيتم ربط المعالجات التي تم إنشاؤها حديثًا به. بمجرد عدم الحاجة إلى هذه المعالجات، يمكن &quot;إغلاق&quot; النطاق وإبطال أي معالجات مرتبطة بالنطاق. الطرق المتاحة لفتح/إغلاق النطاقات هي <a href="/ar/nodejs/api/n-api#napi-open-handle-scope"><code>napi_open_handle_scope</code></a> و <a href="/ar/nodejs/api/n-api#napi-close-handle-scope"><code>napi_close_handle_scope</code></a>.</p><p>يدعم Node-API فقط تسلسلًا متداخلًا واحدًا من النطاقات. يوجد نطاق نشط واحد فقط في أي وقت، وسيتم ربط جميع المعالجات الجديدة بهذا النطاق أثناء نشاطه. يجب إغلاق النطاقات بترتيب عكسي لترتيب فتحها. بالإضافة إلى ذلك، يجب إغلاق جميع النطاقات التي تم إنشاؤها داخل طريقة أصلية قبل العودة من تلك الطريقة.</p><p>مع أخذ المثال السابق، فإن إضافة استدعاءات إلى <a href="/ar/nodejs/api/n-api#napi-open-handle-scope"><code>napi_open_handle_scope</code></a> و <a href="/ar/nodejs/api/n-api#napi-close-handle-scope"><code>napi_close_handle_scope</code></a> ستضمن صلاحية معالج واحد على الأكثر طوال تنفيذ الحلقة:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_handle_scope scope;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_open_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scope);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, object, i, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // do something with element</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_close_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, scope);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>عند تداخل النطاقات، هناك حالات تحتاج فيها معالجة من نطاق داخلي إلى البقاء على قيد الحياة بعد مدة صلاحية هذا النطاق. يدعم Node-API &quot;نطاقًا قابلاً للهروب&quot; لدعم هذه الحالة. يسمح النطاق القابل للهروب بترقية معالج واحد بحيث &quot;يهرب&quot; من النطاق الحالي وتتغير مدة صلاحية المعالج من النطاق الحالي إلى النطاق الخارجي.</p><p>الطرق المتاحة لفتح/إغلاق النطاقات القابلة للهروب هي <a href="/ar/nodejs/api/n-api#napi-open-escapable-handle-scope"><code>napi_open_escapable_handle_scope</code></a> و <a href="/ar/nodejs/api/n-api#napi-close-escapable-handle-scope"><code>napi_close_escapable_handle_scope</code></a>.</p><p>يتم تقديم طلب ترقية المعالج من خلال <a href="/ar/nodejs/api/n-api#napi-escape-handle"><code>napi_escape_handle</code></a> والذي لا يمكن استدعاؤه إلا مرة واحدة.</p><h4 id="napi_open_handle_scope" tabindex="-1"><code>napi_open_handle_scope</code> <a class="header-anchor" href="#napi_open_handle_scope" aria-label="Permalink to “napi_open_handle_scope”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_open_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                               napi_handle_scope</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API فيها.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل النطاق الجديد.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يفتح API هذا نطاقًا جديدًا.</p><h4 id="napi_close_handle_scope" tabindex="-1"><code>napi_close_handle_scope</code> <a class="header-anchor" href="#napi_close_handle_scope" aria-label="Permalink to “napi_close_handle_scope”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_close_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                napi_handle_scope </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API فيها.</li><li><code>[in] scope</code>: <code>napi_value</code> تمثل النطاق المراد إغلاقه.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يغلق API هذا النطاق الذي تم تمريره. يجب إغلاق النطاقات بالترتيب العكسي لترتيب إنشائها.</p><p>يمكن استدعاء API هذا حتى في حالة وجود استثناء JavaScript معلق.</p><h4 id="napi_open_escapable_handle_scope" tabindex="-1"><code>napi_open_escapable_handle_scope</code> <a class="header-anchor" href="#napi_open_escapable_handle_scope" aria-label="Permalink to “napi_open_escapable_handle_scope”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    napi_open_escapable_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_handle_scope</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API فيها.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل النطاق الجديد.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يفتح API هذا نطاقًا جديدًا يمكن من خلاله ترقية كائن واحد إلى النطاق الخارجي.</p><h4 id="napi_close_escapable_handle_scope" tabindex="-1"><code>napi_close_escapable_handle_scope</code> <a class="header-anchor" href="#napi_close_escapable_handle_scope" aria-label="Permalink to “napi_close_escapable_handle_scope”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    napi_close_escapable_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_handle_scope </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API فيها.</li><li><code>[in] scope</code>: <code>napi_value</code> تمثل النطاق المراد إغلاقه.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يغلق API هذا النطاق الذي تم تمريره. يجب إغلاق النطاقات بالترتيب العكسي لترتيب إنشائها.</p><p>يمكن استدعاء API هذا حتى في حالة وجود استثناء JavaScript معلق.</p><h4 id="napi_escape_handle" tabindex="-1"><code>napi_escape_handle</code> <a class="header-anchor" href="#napi_escape_handle" aria-label="Permalink to “napi_escape_handle”">​</a></h4><p><strong>تمت الإضافة في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_escape_handle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_escapable_handle_scope </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">escapee</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] scope</code>: <code>napi_value</code> يمثل النطاق الحالي.</li><li><code>[in] escapee</code>: <code>napi_value</code> يمثل JavaScript <code>Object</code> المراد تهريبه.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل مقبض <code>Object</code> الذي تم تهريبه في النطاق الخارجي.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بترقية المقبض إلى كائن JavaScript بحيث يكون صالحًا طوال مدة صلاحية النطاق الخارجي. لا يمكن استدعاؤها إلا مرة واحدة لكل نطاق. إذا تم استدعاؤها أكثر من مرة، فسيتم إرجاع خطأ.</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه حتى إذا كان هناك استثناء JavaScript معلق.</p><h3 id="references-to-values-with-a-lifespan-longer-than-that-of-the-native-method" tabindex="-1">مراجع إلى القيم بمدى حياة أطول من مدى حياة الطريقة الأصلية <a class="header-anchor" href="#references-to-values-with-a-lifespan-longer-than-that-of-the-native-method" aria-label="Permalink to “مراجع إلى القيم بمدى حياة أطول من مدى حياة الطريقة الأصلية”">​</a></h3><p>في بعض الحالات، سيحتاج الملحق إلى أن يكون قادرًا على إنشاء قيم والإشارة إليها بمدى حياة أطول من مدى حياة استدعاء طريقة أصلية واحدة. على سبيل المثال، لإنشاء منشئ ولاحقًا استخدام هذا المنشئ في طلب لإنشاء مثيلات، يجب أن يكون من الممكن الإشارة إلى كائن المنشئ عبر العديد من طلبات إنشاء المثيلات المختلفة. لن يكون هذا ممكنًا باستخدام مقبض عادي يتم إرجاعه كـ <code>napi_value</code> كما هو موضح في القسم السابق. تتم إدارة مدى حياة المقبض العادي بواسطة النطاقات ويجب إغلاق جميع النطاقات قبل نهاية الطريقة الأصلية.</p><p>توفر Node-API طرقًا لإنشاء مراجع دائمة للقيم. تسمح Node-API حاليًا بإنشاء مراجع فقط لمجموعة محدودة من أنواع القيم، بما في ذلك الكائن والخارجي والدالة والرمز.</p><p>لكل مرجع عدد مرتبط بقيمة 0 أو أعلى، والذي يحدد ما إذا كان المرجع سيحافظ على القيمة المقابلة حية. المراجع التي لها عدد 0 لا تمنع جمع القيم. أصبحت قيم أنواع الكائنات (كائن، دالة، خارجي) والرمز مراجع &quot;ضعيفة&quot; ولا يزال من الممكن الوصول إليها أثناء عدم جمعها. أي عدد أكبر من 0 سيمنع جمع القيم.</p><p>توجد أنواع مختلفة من قيم الرموز. يتم دعم سلوك المرجع الضعيف الحقيقي فقط بواسطة الرموز المحلية التي تم إنشاؤها باستخدام الدالة <code>napi_create_symbol</code> أو استدعاءات منشئ JavaScript <code>Symbol()</code>. تظل الرموز المسجلة عالميًا التي تم إنشاؤها باستخدام الدالة <code>node_api_symbol_for</code> أو استدعاءات دالة JavaScript <code>Symbol.for()</code> دائمًا مراجع قوية لأن جامع البيانات المهملة لا يجمعها. وينطبق الشيء نفسه على الرموز المعروفة مثل <code>Symbol.iterator</code>. كما أنها لا يتم جمعها أبدًا بواسطة جامع البيانات المهملة.</p><p>يمكن إنشاء المراجع بعدد مراجع أولي. يمكن بعد ذلك تعديل العدد من خلال <a href="/ar/nodejs/api/n-api#napi-reference-ref"><code>napi_reference_ref</code></a> و <a href="/ar/nodejs/api/n-api#napi-reference-unref"><code>napi_reference_unref</code></a>. إذا تم جمع كائن أثناء أن يكون العدد للمرجع هو 0، فسترجع جميع الاستدعاءات اللاحقة للحصول على الكائن المرتبط بالمرجع <a href="/ar/nodejs/api/n-api#napi-get-reference-value"><code>napi_get_reference_value</code></a> قيمة <code>NULL</code> لـ <code>napi_value</code> التي تم إرجاعها. محاولة استدعاء <a href="/ar/nodejs/api/n-api#napi-reference-ref"><code>napi_reference_ref</code></a> لمرجع تم جمع الكائن الخاص به تؤدي إلى حدوث خطأ.</p><p>يجب حذف المراجع بمجرد عدم الحاجة إليها بواسطة الملحق. عند حذف مرجع، فإنه لن يمنع الكائن المقابل من التجميع بعد الآن. يؤدي الفشل في حذف مرجع دائم إلى حدوث &quot;تسرب للذاكرة&quot; مع الاحتفاظ بالذاكرة الأصلية للمرجع الدائم والكائن المقابل على الكومة إلى الأبد.</p><p>يمكن إنشاء مراجع دائمة متعددة تشير إلى نفس الكائن، وسيحافظ كل منها على الكائن حيًا أو لا يعتمد على عدده الفردي. يمكن أن تؤدي المراجع الدائمة المتعددة لنفس الكائن إلى الاحتفاظ بالذاكرة الأصلية بشكل غير متوقع. يجب الحفاظ على الهياكل الأصلية لمرجع دائم حيًا حتى يتم تنفيذ أدوات الإنهاء للكائن المشار إليه. إذا تم إنشاء مرجع دائم جديد لنفس الكائن، فلن يتم تشغيل أدوات الإنهاء لهذا الكائن ولن يتم تحرير الذاكرة الأصلية التي يشير إليها المرجع الدائم السابق. يمكن تجنب ذلك عن طريق استدعاء <code>napi_delete_reference</code> بالإضافة إلى <code>napi_reference_unref</code> قدر الإمكان.</p><p><strong>سجل التغييرات:</strong></p><ul><li>تجريبي (تم تعريف <code>NAPI_EXPERIMENTAL</code>): يمكن إنشاء مراجع لجميع أنواع القيم. لا تدعم أنواع القيم المدعومة الجديدة الدلالات المرجعية الضعيفة ويتم تحرير قيم هذه الأنواع عندما يصبح عدد المراجع 0 ولا يمكن الوصول إليها من المرجع بعد الآن.</li></ul><h4 id="napi_create_reference" tabindex="-1"><code>napi_create_reference</code> <a class="header-anchor" href="#napi_create_reference" aria-label="Permalink to “napi_create_reference”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_reference</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                              uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> initial_refcount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                              napi_ref</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: ‏<code>napi_value</code> الذي يتم إنشاء مرجع له.</li><li><code>[in] initial_refcount</code>: عدد المراجع الأولي للمرجع الجديد.</li><li><code>[out] result</code>: ‏<code>napi_ref</code> يشير إلى المرجع الجديد.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بإنشاء مرجع جديد بعدد المراجع المحدد للقيمة التي تم تمريرها.</p><h4 id="napi_delete_reference" tabindex="-1"><code>napi_delete_reference</code> <a class="header-anchor" href="#napi_delete_reference" aria-label="Permalink to “napi_delete_reference”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_delete_reference</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_ref </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] ref</code>: ‏<code>napi_ref</code> المراد حذفه.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بحذف المرجع الذي تم تمريره.</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه حتى إذا كان هناك استثناء JavaScript معلق.</p><h4 id="napi_reference_ref" tabindex="-1"><code>napi_reference_ref</code> <a class="header-anchor" href="#napi_reference_ref" aria-label="Permalink to “napi_reference_ref”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_reference_ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_ref </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                           uint32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] ref</code>: ‏<code>napi_ref</code> الذي سيتم زيادة عدد المراجع له.</li><li><code>[out] result</code>: عدد المراجع الجديد.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بزيادة عدد المراجع للمرجع الذي تم تمريره وإرجاع عدد المراجع الناتج.</p><h4 id="napi_reference_unref" tabindex="-1"><code>napi_reference_unref</code> <a class="header-anchor" href="#napi_reference_unref" aria-label="Permalink to “napi_reference_unref”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_reference_unref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                             napi_ref </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                             uint32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] ref</code>: ‏<code>napi_ref</code> الذي سيتم تقليل عدد المراجع له.</li><li><code>[out] result</code>: عدد المراجع الجديد.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بتقليل عدد المراجع للمرجع الذي تم تمريره وإرجاع عدد المراجع الناتج.</p><h4 id="napi_get_reference_value" tabindex="-1"><code>napi_get_reference_value</code> <a class="header-anchor" href="#napi_get_reference_value" aria-label="Permalink to “napi_get_reference_value”">​</a></h4><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_reference_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_ref </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم فيها استدعاء واجهة برمجة التطبيقات.</li><li><code>[in] ref</code>: ‏<code>napi_ref</code> الذي يتم طلب القيمة المقابلة له.</li><li><code>[out] result</code>: ‏<code>napi_value</code> الذي يشير إليه <code>napi_ref</code>.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات.</p><p>إذا كانت لا تزال صالحة، تُرجع واجهة برمجة التطبيقات هذه <code>napi_value</code> الذي يمثل قيمة JavaScript المرتبطة بـ <code>napi_ref</code>. وإلا، سيكون result هو <code>NULL</code>.</p><h3 id="cleanup-on-exit-of-the-current-nodejs-environment" tabindex="-1">التنظيف عند الخروج من بيئة Node.js الحالية <a class="header-anchor" href="#cleanup-on-exit-of-the-current-nodejs-environment" aria-label="Permalink to “التنظيف عند الخروج من بيئة Node.js الحالية”">​</a></h3><p>في حين أن عملية Node.js عادة ما تحرر جميع مواردها عند الخروج، فإن مُضمِّني Node.js، أو دعم العامل المستقبلي، قد يتطلبون من الوظائف الإضافية تسجيل خطافات التنظيف التي سيتم تشغيلها بمجرد خروج بيئة Node.js الحالية.</p><p>توفر Node-API وظائف لتسجيل وإلغاء تسجيل عمليات الاسترجاع هذه. عند تشغيل عمليات الاسترجاع هذه، يجب تحرير جميع الموارد التي تحتفظ بها الوظيفة الإضافية.</p><h4 id="napi_add_env_cleanup_hook" tabindex="-1"><code>napi_add_env_cleanup_hook</code> <a class="header-anchor" href="#napi_add_env_cleanup_hook" aria-label="Permalink to “napi_add_env_cleanup_hook”">​</a></h4><p><strong>أُضيف في: الإصدار 10.2.0</strong></p><p><strong>إصدار N-API: 3</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NODE_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_add_env_cleanup_hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                  napi_cleanup_hook </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fun</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                  void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>يسجل <code>fun</code> كوظيفة يتم تشغيلها مع معلمة <code>arg</code> بمجرد خروج بيئة Node.js الحالية.</p><p>يمكن تحديد وظيفة بأمان عدة مرات بقيم <code>arg</code> مختلفة. في هذه الحالة، سيتم استدعاؤها عدة مرات أيضًا. لا يُسمح بتوفير نفس قيم <code>fun</code> و <code>arg</code> عدة مرات وسيؤدي إلى إجهاض العملية.</p><p>سيتم استدعاء الخطافات بترتيب عكسي، أي سيتم استدعاء آخر خطاف تمت إضافته أولاً.</p><p>يمكن إزالة هذا الخطاف باستخدام <a href="/ar/nodejs/api/n-api#napi-remove-env-cleanup-hook"><code>napi_remove_env_cleanup_hook</code></a>. عادةً ما يحدث ذلك عندما يتم بالفعل هدم المورد الذي تمت إضافة هذا الخطاف من أجله.</p><p>للتنظيف غير المتزامن، يتوفر <a href="/ar/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>.</p><h4 id="napi_remove_env_cleanup_hook" tabindex="-1"><code>napi_remove_env_cleanup_hook</code> <a class="header-anchor" href="#napi_remove_env_cleanup_hook" aria-label="Permalink to “napi_remove_env_cleanup_hook”">​</a></h4><p><strong>أُضيف في: v10.2.0</strong></p><p><strong>إصدار N-API: 3</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_remove_env_cleanup_hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                     void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fun)(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arg),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                     void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>إلغاء تسجيل <code>fun</code> كدالة ليتم تشغيلها مع معامل <code>arg</code> بمجرد خروج بيئة Node.js الحالية. يجب أن تكون كل من قيمة الوسيطة وقيمة الدالة متطابقة تمامًا.</p><p>يجب أن تكون الدالة قد سُجلت في الأصل باستخدام <code>napi_add_env_cleanup_hook</code>، وإلا فسيتم إنهاء العملية.</p><h4 id="napi_add_async_cleanup_hook" tabindex="-1"><code>napi_add_async_cleanup_hook</code> <a class="header-anchor" href="#napi_add_async_cleanup_hook" aria-label="Permalink to “napi_add_async_cleanup_hook”">​</a></h4><div class="info custom-block"><p class="custom-block-title">[سجل التغييرات]</p><table tabindex="0"><thead><tr><th>الإصدار</th><th>التغييرات</th></tr></thead><tbody><tr><td>v14.10.0, v12.19.0</td><td>تغيير توقيع استدعاء <code>hook</code>.</td></tr><tr><td>v14.8.0, v12.19.0</td><td>أُضيف في: v14.8.0, v12.19.0</td></tr></tbody></table></div><p><strong>إصدار N-API: 8</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_add_async_cleanup_hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    napi_async_cleanup_hook </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    napi_async_cleanup_hook_handle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> remove_handle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] hook</code>: مؤشر الدالة المراد استدعاؤها عند إنهاء البيئة.</li><li><code>[in] arg</code>: المؤشر المراد تمريره إلى <code>hook</code> عند استدعائها.</li><li><code>[out] remove_handle</code>: مُعالج اختياري يشير إلى خطاف التنظيف غير المتزامن.</li></ul><p>يسجل <code>hook</code>، وهي دالة من النوع <a href="/ar/nodejs/api/n-api#napi-async-cleanup-hook"><code>napi_async_cleanup_hook</code></a>، كدالة ليتم تشغيلها مع المعاملين <code>remove_handle</code> و <code>arg</code> بمجرد خروج بيئة Node.js الحالية.</p><p>على عكس <a href="/ar/nodejs/api/n-api#napi-add-env-cleanup-hook"><code>napi_add_env_cleanup_hook</code></a>، يُسمح للخطاف بأن يكون غير متزامن.</p><p>بخلاف ذلك، يتطابق السلوك بشكل عام مع سلوك <a href="/ar/nodejs/api/n-api#napi-add-env-cleanup-hook"><code>napi_add_env_cleanup_hook</code></a>.</p><p>إذا لم يكن <code>remove_handle</code> ‏<code>NULL</code>، فسيتم تخزين قيمة مبهمة فيه يجب تمريرها لاحقًا إلى <a href="/ar/nodejs/api/n-api#napi-remove-async-cleanup-hook"><code>napi_remove_async_cleanup_hook</code></a>، بغض النظر عما إذا كان الخطاف قد تم استدعاؤه بالفعل. يحدث هذا عادةً عندما يتم تفكيك المورد الذي تمت إضافة هذا الخطاف له على أي حال.</p><h4 id="napi_remove_async_cleanup_hook" tabindex="-1"><code>napi_remove_async_cleanup_hook</code> <a class="header-anchor" href="#napi_remove_async_cleanup_hook" aria-label="Permalink to “napi_remove_async_cleanup_hook”">​</a></h4><div class="info custom-block"><p class="custom-block-title">[السجل]</p><table tabindex="0"><thead><tr><th>الإصدار</th><th>التغييرات</th></tr></thead><tbody><tr><td>الإصدار v14.10.0, v12.19.0</td><td>تمت إزالة المعامل <code>env</code>.</td></tr><tr><td>الإصدار v14.8.0, v12.19.0</td><td>أضيف في: v14.8.0, v12.19.0</td></tr></tbody></table></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_remove_async_cleanup_hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    napi_async_cleanup_hook_handle </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">remove_handle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] remove_handle</code>: المقبض لخطاف تنظيف غير متزامن تم إنشاؤه باستخدام <a href="/ar/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>.</li></ul><p>يقوم بإلغاء تسجيل خطاف التنظيف المطابق لـ <code>remove_handle</code>. سيمنع هذا الخطاف من التنفيذ، ما لم يكن قد بدأ التنفيذ بالفعل. يجب استدعاء هذا على أي قيمة <code>napi_async_cleanup_hook_handle</code> تم الحصول عليها من <a href="/ar/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>.</p><h3 id="finalization-on-the-exit-of-the-nodejs-environment" tabindex="-1">الإنهاء عند الخروج من بيئة Node.js <a class="header-anchor" href="#finalization-on-the-exit-of-the-nodejs-environment" aria-label="Permalink to “الإنهاء عند الخروج من بيئة Node.js”">​</a></h3><p>قد يتم تفكيك بيئة Node.js في أي وقت ممكن بمجرد عدم السماح بتنفيذ JavaScript، كما هو الحال بناءً على طلب <a href="/ar/nodejs/api/worker_threads#workerterminate"><code>worker.terminate()</code></a>. عندما يتم تفكيك البيئة، يتم استدعاء استدعاءات <code>napi_finalize</code> المسجلة لكائنات JavaScript ووظائف آمنة للخيوط وبيانات مثيل البيئة على الفور وبشكل مستقل.</p><p>يتم جدولة استدعاءات <code>napi_finalize</code> بعد خطافات التنظيف المسجلة يدويًا. لضمان الترتيب الصحيح لإنهاء الوظائف الإضافية أثناء إغلاق البيئة لتجنب الاستخدام بعد التحرير في استدعاء <code>napi_finalize</code>، يجب على الوظائف الإضافية تسجيل خطاف تنظيف باستخدام <code>napi_add_env_cleanup_hook</code> و <code>napi_add_async_cleanup_hook</code> لتحرير المورد المخصص يدويًا بترتيب صحيح.</p><h2 id="module-registration" tabindex="-1">تسجيل الوحدة <a class="header-anchor" href="#module-registration" aria-label="Permalink to “تسجيل الوحدة”">​</a></h2><p>يتم تسجيل وحدات Node-API بطريقة مماثلة للوحدات الأخرى باستثناء أنه بدلاً من استخدام الماكرو <code>NODE_MODULE</code> يتم استخدام ما يلي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAPI_MODULE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NODE_GYP_MODULE_NAME, Init)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>الاختلاف التالي هو التوقيع لطريقة <code>Init</code>. بالنسبة لوحدة Node-API، يكون كما يلي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>تتم معاملة القيمة المرجعة من <code>Init</code> على أنها كائن <code>exports</code> للوحدة. يتم تمرير طريقة <code>Init</code> بكائن فارغ عبر المعامل <code>exports</code> كراحة. إذا أرجعت <code>Init</code> قيمة <code>NULL</code>، فسيتم تصدير المعامل الذي تم تمريره كـ <code>exports</code> بواسطة الوحدة. لا يمكن لوحدات Node-API تعديل كائن <code>module</code> ولكن يمكنها تحديد أي شيء كخاصية <code>exports</code> للوحدة.</p><p>لإضافة الطريقة <code>hello</code> كوظيفة بحيث يمكن استدعاؤها كطريقة توفرها الوظيفة الإضافية:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_property_descriptor desc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Method,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_enumerable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_configurable,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    NULL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_define_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, exports, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">desc);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> exports;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>لتعيين وظيفة ليتم إرجاعها بواسطة <code>require()</code> للوظيفة الإضافية:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value method;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;exports&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, NAPI_AUTO_LENGTH, Method, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">method);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> method;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>لتعريف فئة بحيث يمكن إنشاء مثيلات جديدة (غالبًا ما تستخدم مع <a href="/ar/nodejs/api/n-api#object-wrap">تغليف الكائن</a>):</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ملاحظة: مثال جزئي، ليس كل الرمز المشار إليه مضمنًا</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_property_descriptor properties</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, GetValue, SetValue, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_configurable, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    DECLARE_NAPI_METHOD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;plusOne&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, PlusOne),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    DECLARE_NAPI_METHOD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;multiply&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Multiply),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value cons;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      napi_define_class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyObject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, New, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, properties, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cons);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_reference</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, cons, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">constructor);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, exports, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyObject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, cons);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> exports;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>يمكنك أيضًا استخدام الماكرو <code>NAPI_MODULE_INIT</code>، الذي يعمل كاختصار لـ <code>NAPI_MODULE</code> وتحديد وظيفة <code>Init</code>:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAPI_MODULE_INIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* napi_env env, napi_value exports */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value answer;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status result;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">answer);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, exports, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, answer);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> exports;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>يتم توفير المعاملات <code>env</code> و <code>exports</code> إلى نص الماكرو <code>NAPI_MODULE_INIT</code>.</p><p>جميع وظائف Node-API الإضافية مدركة للسياق، مما يعني أنه يمكن تحميلها عدة مرات. هناك بعض الاعتبارات التصميمية عند الإعلان عن مثل هذه الوحدة. توفر الوثائق الخاصة بـ <a href="/ar/nodejs/api/addons#context-aware-addons">الوظائف الإضافية المدركة للسياق</a> مزيدًا من التفاصيل.</p><p>ستكون المتغيرات <code>env</code> و <code>exports</code> متاحة داخل نص الدالة بعد استدعاء الماكرو.</p><p>لمزيد من التفاصيل حول تعيين الخصائص على الكائنات، راجع القسم الخاص بـ <a href="/ar/nodejs/api/n-api#working-with-javascript-properties">العمل مع خصائص JavaScript</a>.</p><p>لمزيد من التفاصيل حول إنشاء وحدات الوظائف الإضافية بشكل عام، راجع واجهة برمجة التطبيقات الحالية.</p><h2 id="working-with-javascript-values" tabindex="-1">التعامل مع قيم JavaScript <a class="header-anchor" href="#working-with-javascript-values" aria-label="Permalink to “التعامل مع قيم JavaScript”">​</a></h2><p>تكشف Node-API عن مجموعة من واجهات برمجة التطبيقات لإنشاء جميع أنواع قيم JavaScript. بعض هذه الأنواع موثقة في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values" target="_blank" rel="noreferrer">القسم 6</a> من <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">مواصفات لغة ECMAScript</a>.</p><p>بشكل أساسي، تُستخدم واجهات برمجة التطبيقات هذه للقيام بأحد الإجراءات التالية:</p><p>يتم تمثيل قيم Node-API بواسطة النوع <code>napi_value</code>. أي استدعاء Node-API يتطلب قيمة JavaScript يأخذ <code>napi_value</code>. في بعض الحالات، يتحقق واجهة برمجة التطبيقات من نوع <code>napi_value</code> مقدمًا. ومع ذلك، للحصول على أداء أفضل، من الأفضل للمتصل التأكد من أن <code>napi_value</code> المعني هو من نوع JavaScript الذي تتوقعه واجهة برمجة التطبيقات.</p><h3 id="enum-types" tabindex="-1">أنواع التعداد <a class="header-anchor" href="#enum-types" aria-label="Permalink to “أنواع التعداد”">​</a></h3><h4 id="napi_key_collection_mode" tabindex="-1"><code>napi_key_collection_mode</code> <a class="header-anchor" href="#napi_key_collection_mode" aria-label="Permalink to “napi_key_collection_mode”">​</a></h4><p><strong>تمت الإضافة في: v13.7.0، v12.17.0، v10.20.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_include_prototypes,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_own_only</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_key_collection_mode;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>يصف تعدادات مرشح <code>Keys/Properties</code>:</p><p><code>napi_key_collection_mode</code> يحد من نطاق الخصائص التي تم جمعها.</p><p><code>napi_key_own_only</code> يحد من الخصائص التي تم جمعها إلى الكائن المحدد فقط. سيشمل <code>napi_key_include_prototypes</code> جميع مفاتيح سلسلة النموذج الأولي للكائنات أيضًا.</p><h4 id="napi_key_filter" tabindex="-1"><code>napi_key_filter</code> <a class="header-anchor" href="#napi_key_filter" aria-label="Permalink to “napi_key_filter”">​</a></h4><p><strong>تمت الإضافة في: v13.7.0، v12.17.0، v10.20.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_all_properties </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_enumerable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_configurable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_skip_strings </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_skip_symbols </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_key_filter;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>بتات مرشح الخصائص. يمكن ربطها منطقيًا لإنشاء مرشح مركب.</p><h4 id="napi_key_conversion" tabindex="-1"><code>napi_key_conversion</code> <a class="header-anchor" href="#napi_key_conversion" aria-label="Permalink to “napi_key_conversion”">​</a></h4><p><strong>تمت الإضافة في: v13.7.0، v12.17.0، v10.20.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_keep_numbers,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_numbers_to_strings</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_key_conversion;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>سيقوم <code>napi_key_numbers_to_strings</code> بتحويل الفهارس الصحيحة إلى سلاسل. سيعيد <code>napi_key_keep_numbers</code> أرقامًا للفهارس الصحيحة.</p><h4 id="napi_valuetype" tabindex="-1"><code>napi_valuetype</code> <a class="header-anchor" href="#napi_valuetype" aria-label="Permalink to “napi_valuetype”">​</a></h4><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // أنواع ES6 (تتوافق مع typeof)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_undefined,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_null,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_boolean,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_number,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_string,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_symbol,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_object,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_function,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_external,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_bigint,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_valuetype;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>يصف نوع <code>napi_value</code>. يتوافق هذا عمومًا مع الأنواع الموصوفة في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types" target="_blank" rel="noreferrer">القسم 6.1</a> من مواصفات لغة ECMAScript. بالإضافة إلى الأنواع الموجودة في هذا القسم، يمكن أن يمثل <code>napi_valuetype</code> أيضًا <code>Function</code> و <code>Object</code> ببيانات خارجية.</p><p>تظهر قيمة JavaScript من النوع <code>napi_external</code> في JavaScript ككائن عادي بحيث لا يمكن تعيين أي خصائص عليه ولا يوجد نموذج أولي.</p><h4 id="napi_typedarray_type" tabindex="-1"><code>napi_typedarray_type</code> <a class="header-anchor" href="#napi_typedarray_type" aria-label="Permalink to “napi_typedarray_type”">​</a></h4><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_int8_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_uint8_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_uint8_clamped_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_int16_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_uint16_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_int32_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_uint32_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_float32_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_float64_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_bigint64_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_biguint64_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_typedarray_type;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>يمثل هذا نوع البيانات العددية الثنائية الأساسية لـ <code>TypedArray</code>. تتوافق عناصر هذا التعداد مع <a href="https://tc39.github.io/ecma262/#sec-typedarray-objects" target="_blank" rel="noreferrer">القسم 22.2</a> من <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">مواصفات لغة ECMAScript</a>.</p><h3 id="object-creation-functions" tabindex="-1">وظائف إنشاء الكائنات <a class="header-anchor" href="#object-creation-functions" aria-label="Permalink to “وظائف إنشاء الكائنات”">​</a></h3><h4 id="napi_create_array" tabindex="-1"><code>napi_create_array</code> <a class="header-anchor" href="#napi_create_array" aria-label="Permalink to “napi_create_array”">​</a></h4><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء Node-API ضمنها.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل <code>Array</code> JavaScript.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجح الـ API.</p><p>يُرجع هذا الـ API قيمة Node-API تتوافق مع نوع <code>Array</code> JavaScript. يتم وصف مصفوفات JavaScript في <a href="https://tc39.github.io/ecma262/#sec-array-objects" target="_blank" rel="noreferrer">القسم 22.1</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_array_with_length" tabindex="-1"><code>napi_create_array_with_length</code> <a class="header-anchor" href="#napi_create_array_with_length" aria-label="Permalink to “napi_create_array_with_length”">​</a></h4><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_array_with_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                          size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء الـ API ضمنها.</li><li><code>[in] length</code>: الطول الأولي للـ <code>Array</code>.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل <code>Array</code> JavaScript.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجح الـ API.</p><p>يُرجع هذا الـ API قيمة Node-API تتوافق مع نوع <code>Array</code> JavaScript. يتم تعيين خاصية الطول لـ <code>Array</code> إلى معلمة الطول التي تم تمريرها. ومع ذلك، لا يتم ضمان تخصيص المخزن المؤقت الأساسي مسبقًا بواسطة VM عند إنشاء المصفوفة. يتم ترك هذا السلوك لتنفيذ VM الأساسي. إذا كان يجب أن يكون المخزن المؤقت عبارة عن كتلة متجاورة من الذاكرة يمكن قراءتها و/أو كتابتها مباشرةً عبر C، ففكر في استخدام <a href="/ar/nodejs/api/n-api#napi-create-external-arraybuffer"><code>napi_create_external_arraybuffer</code></a>.</p><p>يتم وصف مصفوفات JavaScript في <a href="https://tc39.github.io/ecma262/#sec-array-objects" target="_blank" rel="noreferrer">القسم 22.1</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_arraybuffer" tabindex="-1"><code>napi_create_arraybuffer</code> <a class="header-anchor" href="#napi_create_arraybuffer" aria-label="Permalink to “napi_create_arraybuffer”">​</a></h4><p><strong>تمت الإضافة في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] length</code>: طول مخزن المصفوفة المراد إنشاؤه بالبايت.</li><li><code>[out] data</code>: مؤشر إلى مخزن البايت الأساسي لـ <code>ArrayBuffer</code>. يمكن تجاهل <code>data</code> اختياريًا عن طريق تمرير <code>NULL</code>.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل <code>ArrayBuffer</code> JavaScript.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تُرجع واجهة برمجة التطبيقات (API) هذه قيمة Node-API تتوافق مع JavaScript <code>ArrayBuffer</code>. تُستخدم <code>ArrayBuffer</code>s لتمثيل مخازن بيانات ثنائية ذات طول ثابت. عادةً ما تُستخدم كمخزن احتياطي لكائنات <code>TypedArray</code>. سيحتوي <code>ArrayBuffer</code> الذي تم تخصيصه على مخزن بايت أساسي يحدد حجمه بواسطة المعلمة <code>length</code> التي تم تمريرها. يتم إرجاع المخزن الأساسي اختياريًا إلى المتصل في حالة ما إذا كان المتصل يريد معالجة المخزن مباشرةً. يمكن الكتابة في هذا المخزن مباشرةً من الكود الأصلي فقط. للكتابة في هذا المخزن من JavaScript، يجب إنشاء مصفوفة ذات نوع أو كائن <code>DataView</code>.</p><p>تم وصف كائنات JavaScript <code>ArrayBuffer</code> في <a href="https://tc39.github.io/ecma262/#sec-arraybuffer-objects" target="_blank" rel="noreferrer">القسم 24.1</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_buffer" tabindex="-1"><code>napi_create_buffer</code> <a class="header-anchor" href="#napi_create_buffer" aria-label="Permalink to “napi_create_buffer”">​</a></h4><p><strong>تمت الإضافة في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                               size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                               void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] size</code>: حجم المخزن الأساسي بالبايت.</li><li><code>[out] data</code>: مؤشر خام إلى المخزن الأساسي. يمكن تجاهل <code>data</code> اختياريًا عن طريق تمرير <code>NULL</code>.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل <code>node::Buffer</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تخصص واجهة برمجة التطبيقات (API) هذه كائن <code>node::Buffer</code>. على الرغم من أن هذا لا يزال بنية بيانات مدعومة بالكامل، إلا أن استخدام <code>TypedArray</code> سيكفي في معظم الحالات.</p><h4 id="napi_create_buffer_copy" tabindex="-1"><code>napi_create_buffer_copy</code> <a class="header-anchor" href="#napi_create_buffer_copy" aria-label="Permalink to “napi_create_buffer_copy”">​</a></h4><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_buffer_copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] size</code>: حجم المخزن المؤقت للإدخال بالبايت (يجب أن يكون هو نفسه حجم المخزن المؤقت الجديد).</li><li><code>[in] data</code>: مؤشر أولي إلى المخزن المؤقت الأساسي المراد نسخه منه.</li><li><code>[out] result_data</code>: مؤشر إلى المخزن المؤقت للبيانات الأساسية لـ <code>Buffer</code> الجديد. يمكن تجاهل <code>result_data</code> اختياريًا عن طريق تمرير <code>NULL</code>.</li><li><code>[out] result</code>: قيمة <code>napi_value</code> تمثل <code>node::Buffer</code>.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تخصص واجهة برمجة التطبيقات (API) هذه كائن <code>node::Buffer</code> وتهيئه بالبيانات المنسوخة من المخزن المؤقت الذي تم تمريره. على الرغم من أن هذا لا يزال هيكل بيانات مدعومًا بالكامل، إلا أنه في معظم الحالات سيكون استخدام <code>TypedArray</code> كافيًا.</p><h4 id="napi_create_date" tabindex="-1"><code>napi_create_date</code> <a class="header-anchor" href="#napi_create_date" aria-label="Permalink to “napi_create_date”">​</a></h4><p><strong>أُضيف في: v11.11.0, v10.17.0</strong></p><p><strong>إصدار N-API: 5</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             double</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] time</code>: قيمة وقت ECMAScript بالمللي ثانية منذ 01 يناير 1970 بالتوقيت العالمي المنسق (UTC).</li><li><code>[out] result</code>: قيمة <code>napi_value</code> تمثل <code>Date</code> JavaScript.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>لا تراعي واجهة برمجة التطبيقات (API) هذه الثواني الكبيسة؛ يتم تجاهلها، حيث تتوافق ECMAScript مع مواصفات وقت POSIX.</p><p>تخصص واجهة برمجة التطبيقات (API) هذه كائن <code>Date</code> JavaScript.</p><p>يتم وصف كائنات <code>Date</code> JavaScript في <a href="https://tc39.github.io/ecma262/#sec-date-objects" target="_blank" rel="noreferrer">القسم 20.3</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_external" tabindex="-1"><code>napi_create_external</code> <a class="header-anchor" href="#napi_create_external" aria-label="Permalink to “napi_create_external”">​</a></h4><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_external</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] data</code>: مؤشر أولي إلى البيانات الخارجية.</li><li><code>[in] finalize_cb</code>: استدعاء اختياري للاتصال به عند تجميع القيمة الخارجية. يوفر <a href="/ar/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> مزيدًا من التفاصيل.</li><li><code>[in] finalize_hint</code>: تلميح اختياري لتمريره إلى استدعاء الإنهاء أثناء التجميع.</li><li><code>[out] result</code>: قيمة <code>napi_value</code> تمثل قيمة خارجية.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تخصص واجهة برمجة التطبيقات (API) هذه قيمة JavaScript مع بيانات خارجية مرفقة بها. يتم استخدام هذا لتمرير البيانات الخارجية عبر كود JavaScript، بحيث يمكن استردادها لاحقًا بواسطة الكود الأصلي باستخدام <a href="/ar/nodejs/api/n-api#napi-get-value-external"><code>napi_get_value_external</code></a>.</p><p>تضيف واجهة برمجة التطبيقات (API) استدعاء <code>napi_finalize</code> الذي سيتم استدعاؤه عند جمع كائن JavaScript الذي تم إنشاؤه للتو بواسطة جامع البيانات المهملة.</p><p>القيمة التي تم إنشاؤها ليست كائنًا، وبالتالي لا تدعم خصائص إضافية. تعتبر نوع قيمة مميز: استدعاء <code>napi_typeof()</code> بقيمة خارجية ينتج <code>napi_external</code>.</p><h4 id="napi_create_external_arraybuffer" tabindex="-1"><code>napi_create_external_arraybuffer</code> <a class="header-anchor" href="#napi_create_external_arraybuffer" aria-label="Permalink to “napi_create_external_arraybuffer”">​</a></h4><p><strong>تمت الإضافة في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_external_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> external_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] external_data</code>: مؤشر إلى مخزن البايت الأساسي لـ <code>ArrayBuffer</code>.</li><li><code>[in] byte_length</code>: طول المخزن الأساسي بالبايت.</li><li><code>[in] finalize_cb</code>: استدعاء اختياري ليتم استدعاؤه عند تجميع <code>ArrayBuffer</code>. توفر <a href="/ar/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> مزيدًا من التفاصيل.</li><li><code>[in] finalize_hint</code>: تلميح اختياري لتمريره إلى استدعاء الإنهاء أثناء التجميع.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل JavaScript <code>ArrayBuffer</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p><strong>أسقطت بعض أوقات التشغيل بخلاف Node.js دعم المخازن المؤقتة الخارجية</strong>. في أوقات التشغيل بخلاف Node.js، قد تُرجع هذه الطريقة <code>napi_no_external_buffers_allowed</code> للإشارة إلى أن المخازن المؤقتة الخارجية غير مدعومة. أحد أوقات التشغيل هذه هو Electron كما هو موضح في هذه المشكلة <a href="https://github.com/electron/electron/issues/35801" target="_blank" rel="noreferrer">electron/issues/35801</a>.</p><p>للحفاظ على أوسع توافق مع جميع أوقات التشغيل، يمكنك تحديد <code>NODE_API_NO_EXTERNAL_BUFFERS_ALLOWED</code> في الملحق الخاص بك قبل تضمين رؤوس node-api. سيؤدي القيام بذلك إلى إخفاء الدالتين اللتين تنشئان مخازن مؤقتة خارجية. سيضمن ذلك حدوث خطأ في الترجمة إذا استخدمت إحدى هذه الطرق عن طريق الخطأ.</p><p>ترجع واجهة برمجة التطبيقات (API) هذه قيمة Node-API تتوافق مع JavaScript <code>ArrayBuffer</code>. يتم تخصيص وإدارة مخزن البايت الأساسي لـ <code>ArrayBuffer</code> خارجيًا. يجب على المتصل التأكد من أن مخزن البايت يظل صالحًا حتى يتم استدعاء استدعاء الإنهاء.</p><p>تضيف واجهة برمجة التطبيقات (API) استدعاء <code>napi_finalize</code> سيتم استدعاؤه عندما يتم جمع الكائن JavaScript الذي تم إنشاؤه للتو بواسطة جامع القمامة.</p><p>تم وصف JavaScript <code>ArrayBuffer</code> في <a href="https://tc39.github.io/ecma262/#sec-arraybuffer-objects" target="_blank" rel="noreferrer">القسم 24.1</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_external_buffer" tabindex="-1"><code>napi_create_external_buffer</code> <a class="header-anchor" href="#napi_create_external_buffer" aria-label="Permalink to “napi_create_external_buffer”">​</a></h4><p><strong>تمت إضافتها في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_external_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) تحتها.</li><li><code>[in] length</code>: حجم المخزن المؤقت للإدخال بالبايت (يجب أن يكون هو نفسه حجم المخزن المؤقت الجديد).</li><li><code>[in] data</code>: مؤشر أولي إلى المخزن المؤقت الأساسي المراد عرضه على JavaScript.</li><li><code>[in] finalize_cb</code>: استدعاء اختياري يتم استدعاؤه عند تجميع <code>ArrayBuffer</code>. يوفر <a href="/ar/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> مزيدًا من التفاصيل.</li><li><code>[in] finalize_hint</code>: تلميح اختياري لتمريره إلى استدعاء الإنهاء أثناء التجميع.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل <code>node::Buffer</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p><strong>أسقطت بعض أوقات التشغيل بخلاف Node.js دعم المخازن المؤقتة الخارجية</strong>. في أوقات التشغيل بخلاف Node.js، قد تُرجع هذه الطريقة <code>napi_no_external_buffers_allowed</code> للإشارة إلى أن المخازن المؤقتة الخارجية غير مدعومة. أحد أوقات التشغيل هذه هو Electron كما هو موضح في هذه المشكلة <a href="https://github.com/electron/electron/issues/35801" target="_blank" rel="noreferrer">electron/issues/35801</a>.</p><p>للحفاظ على أوسع توافق مع جميع أوقات التشغيل، يمكنك تحديد <code>NODE_API_NO_EXTERNAL_BUFFERS_ALLOWED</code> في الملحق الخاص بك قبل تضمين رؤوس node-api. سيؤدي القيام بذلك إلى إخفاء الدالتين اللتين تنشئان مخازن مؤقتة خارجية. سيضمن ذلك حدوث خطأ في الترجمة إذا استخدمت إحدى هذه الطرق عن طريق الخطأ.</p><p>تخصص واجهة برمجة التطبيقات (API) كائن <code>node::Buffer</code> وتهيئه ببيانات مدعومة بواسطة المخزن المؤقت الذي تم تمريره. على الرغم من أن هذا لا يزال بنية بيانات مدعومة بالكامل، إلا أنه في معظم الحالات سيكون استخدام <code>TypedArray</code> كافيًا.</p><p>تضيف واجهة برمجة التطبيقات (API) استدعاء <code>napi_finalize</code> الذي سيتم استدعاؤه عندما يتم جمع كائن JavaScript الذي تم إنشاؤه للتو بواسطة جامع البيانات المهملة.</p><p>بالنسبة إلى Node.js &gt;=4، تكون <code>Buffers</code> عبارة عن <code>Uint8Array</code>s.</p><h4 id="napi_create_object" tabindex="-1"><code>napi_create_object</code> <a class="header-anchor" href="#napi_create_object" aria-label="Permalink to “napi_create_object”">​</a></h4><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[out] result</code>: ‏<code>napi_value</code> يمثل كائن JavaScript ‏<code>Object</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات.</p><p>تقوم واجهة برمجة التطبيقات هذه بتخصيص كائن JavaScript ‏<code>Object</code> افتراضي. وهو ما يعادل تنفيذ <code>new Object()</code> في JavaScript.</p><p>يتم وصف نوع JavaScript ‏<code>Object</code> في <a href="https://tc39.github.io/ecma262/#sec-object-type" target="_blank" rel="noreferrer">القسم 6.1.7</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_symbol" tabindex="-1"><code>napi_create_symbol</code> <a class="header-anchor" href="#napi_create_symbol" aria-label="Permalink to “napi_create_symbol”">​</a></h4><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_symbol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] description</code>: ‏<code>napi_value</code> اختياري يشير إلى JavaScript ‏<code>string</code> ليتم تعيينه كوصف للرمز.</li><li><code>[out] result</code>: ‏<code>napi_value</code> يمثل JavaScript ‏<code>symbol</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات.</p><p>تقوم واجهة برمجة التطبيقات هذه بإنشاء قيمة JavaScript ‏<code>symbol</code> من سلسلة C بترميز UTF8.</p><p>يتم وصف نوع JavaScript ‏<code>symbol</code> في <a href="https://tc39.github.io/ecma262/#sec-symbol-objects" target="_blank" rel="noreferrer">القسم 19.4</a> من مواصفات لغة ECMAScript.</p><h4 id="node_api_symbol_for" tabindex="-1"><code>node_api_symbol_for</code> <a class="header-anchor" href="#node_api_symbol_for" aria-label="Permalink to “node_api_symbol_for”">​</a></h4><p><strong>أُضيف في: الإصدار 17.5.0، الإصدار 16.15.0</strong></p><p><strong>إصدار N-API: 9</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_symbol_for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] utf8description</code>: سلسلة C بترميز UTF-8 تمثل النص المراد استخدامه كوصف للرمز.</li><li><code>[in] length</code>: طول سلسلة الوصف بالبايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كانت منتهية بصفر.</li><li><code>[out] result</code>: ‏<code>napi_value</code> يمثل JavaScript ‏<code>symbol</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات.</p><p>تبحث واجهة برمجة التطبيقات هذه في السجل العام عن رمز موجود بالوصف المحدد. إذا كان الرمز موجودًا بالفعل، فسيتم إرجاعه، وإلا فسيتم إنشاء رمز جديد في السجل.</p><p>يتم وصف نوع JavaScript ‏<code>symbol</code> في <a href="https://tc39.github.io/ecma262/#sec-symbol-objects" target="_blank" rel="noreferrer">القسم 19.4</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_typedarray" tabindex="-1"><code>napi_create_typedarray</code> <a class="header-anchor" href="#napi_create_typedarray" aria-label="Permalink to “napi_create_typedarray”">​</a></h4><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_typedarray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_typedarray_type </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_offset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] type</code>: نوع البيانات العددية للعناصر الموجودة داخل <code>TypedArray</code>.</li><li><code>[in] length</code>: عدد العناصر في <code>TypedArray</code>.</li><li><code>[in] arraybuffer</code>: <code>ArrayBuffer</code> التي تقوم عليها المصفوفة المكتوبة (typed array).</li><li><code>[in] byte_offset</code>: إزاحة البايت داخل <code>ArrayBuffer</code> التي يتم من خلالها بدء عرض <code>TypedArray</code>.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل <code>TypedArray</code> في JavaScript.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بإنشاء كائن <code>TypedArray</code> في JavaScript عبر <code>ArrayBuffer</code> موجود. توفر كائنات <code>TypedArray</code> عرضًا شبيهًا بالمصفوفة عبر مخزن بيانات أساسي حيث يكون لكل عنصر نفس نوع البيانات العددية الثنائية الأساسية.</p><p>يُشترط أن يكون <code>(length * size_of_element) + byte_offset</code> &lt;= حجم المصفوفة التي تم تمريرها بالبايت. إذا لم يكن الأمر كذلك، فسيتم رفع استثناء <code>RangeError</code>.</p><p>تم وصف كائنات <code>TypedArray</code> في JavaScript في <a href="https://tc39.github.io/ecma262/#sec-typedarray-objects" target="_blank" rel="noreferrer">القسم 22.2</a> من مواصفات لغة ECMAScript.</p><h4 id="node_api_create_buffer_from_arraybuffer" tabindex="-1"><code>node_api_create_buffer_from_arraybuffer</code> <a class="header-anchor" href="#node_api_create_buffer_from_arraybuffer" aria-label="Permalink to “node_api_create_buffer_from_arraybuffer”">​</a></h4><p><strong>أُضيف في: الإصدار 23.0.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[مستقر: 1 - تجريبي]</p><p><a href="/ar/nodejs/api/documentation#stability-index">مستقر: 1</a> <a href="/ar/nodejs/api/documentation#stability-index">الاستقرار: 1</a> - تجريبي</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status NAPI_CDECL </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_buffer_from_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                              size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_offset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                              size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><strong><code>[in] env</code></strong>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><strong><code>[in] arraybuffer</code></strong>: <code>ArrayBuffer</code> التي سيتم إنشاء المخزن المؤقت (buffer) منها.</li><li><strong><code>[in] byte_offset</code></strong>: إزاحة البايت داخل <code>ArrayBuffer</code> التي سيتم من خلالها بدء إنشاء المخزن المؤقت (buffer).</li><li><strong><code>[in] byte_length</code></strong>: طول المخزن المؤقت (buffer) بالبايت المراد إنشاؤه من <code>ArrayBuffer</code>.</li><li><strong><code>[out] result</code></strong>: <code>napi_value</code> تمثل كائن <code>Buffer</code> في JavaScript الذي تم إنشاؤه.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بإنشاء كائن <code>Buffer</code> في JavaScript من <code>ArrayBuffer</code> موجود. كائن <code>Buffer</code> هو فئة خاصة بـ Node.js توفر طريقة للتعامل مع البيانات الثنائية مباشرةً في JavaScript.</p><p>يجب أن يكون نطاق البايت <code>[byte_offset, byte_offset + byte_length)</code> ضمن حدود <code>ArrayBuffer</code>. إذا تجاوز <code>byte_offset + byte_length</code> حجم <code>ArrayBuffer</code>، فسيتم رفع استثناء <code>RangeError</code>.</p><h4 id="napi_create_dataview" tabindex="-1"><code>napi_create_dataview</code> <a class="header-anchor" href="#napi_create_dataview" aria-label="Permalink to “napi_create_dataview”">​</a></h4><p><strong>تمت الإضافة في: v8.3.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_dataview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_offset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] length</code>: عدد العناصر في <code>DataView</code>.</li><li><code>[in] arraybuffer</code>: <code>ArrayBuffer</code> الأساسية لـ <code>DataView</code>.</li><li><code>[in] byte_offset</code>: إزاحة البايت داخل <code>ArrayBuffer</code> التي سيتم بدء عرض <code>DataView</code> منها.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل <code>DataView</code> JavaScript.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بإنشاء كائن JavaScript <code>DataView</code> على <code>ArrayBuffer</code> موجود. توفر كائنات <code>DataView</code> عرضًا يشبه المصفوفة على مخزن بيانات أساسي، ولكن يسمح بعناصر ذات أحجام وأنواع مختلفة في <code>ArrayBuffer</code>.</p><p>من الضروري أن يكون <code>byte_length + byte_offset</code> أقل من أو يساوي الحجم بالبايت للمصفوفة التي تم تمريرها. إذا لم يكن الأمر كذلك، فسيتم رفع استثناء <code>RangeError</code>.</p><p>تم وصف كائنات <code>DataView</code> JavaScript في <a href="https://tc39.github.io/ecma262/#sec-dataview-objects" target="_blank" rel="noreferrer">القسم 24.3</a> من مواصفات لغة ECMAScript.</p><h3 id="functions-to-convert-from-c-types-to-node-api" tabindex="-1">وظائف للتحويل من أنواع C إلى Node-API <a class="header-anchor" href="#functions-to-convert-from-c-types-to-node-api" aria-label="Permalink to “وظائف للتحويل من أنواع C إلى Node-API”">​</a></h3><h4 id="napi_create_int32" tabindex="-1"><code>napi_create_int32</code> <a class="header-anchor" href="#napi_create_int32" aria-label="Permalink to “napi_create_int32”">​</a></h4><p><strong>تمت الإضافة في: v8.4.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: قيمة عدد صحيح ليتم تمثيلها في JavaScript.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل <code>number</code> JavaScript.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تُستخدم واجهة برمجة التطبيقات (API) هذه للتحويل من نوع C <code>int32_t</code> إلى نوع JavaScript <code>number</code>.</p><p>تم وصف نوع JavaScript <code>number</code> في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-number-type" target="_blank" rel="noreferrer">القسم 6.1.6</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_uint32" tabindex="-1"><code>napi_create_uint32</code> <a class="header-anchor" href="#napi_create_uint32" aria-label="Permalink to “napi_create_uint32”">​</a></h4><p><strong>أضيف في: v8.4.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_uint32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات فيها.</li><li><code>[in] value</code>: قيمة عدد صحيح غير موقعة ليتم تمثيلها في JavaScript.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل <code>number</code> في JavaScript.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات.</p><p>تستخدم واجهة برمجة التطبيقات هذه للتحويل من النوع <code>uint32_t</code> في C إلى النوع <code>number</code> في JavaScript.</p><p>تم وصف النوع <code>number</code> في JavaScript في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-number-type" target="_blank" rel="noreferrer">القسم 6.1.6</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_int64" tabindex="-1"><code>napi_create_int64</code> <a class="header-anchor" href="#napi_create_int64" aria-label="Permalink to “napi_create_int64”">​</a></h4><p><strong>أضيف في: v8.4.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int64_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات فيها.</li><li><code>[in] value</code>: قيمة عدد صحيح ليتم تمثيلها في JavaScript.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل <code>number</code> في JavaScript.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات.</p><p>تستخدم واجهة برمجة التطبيقات هذه للتحويل من النوع <code>int64_t</code> في C إلى النوع <code>number</code> في JavaScript.</p><p>تم وصف النوع <code>number</code> في JavaScript في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-number-type" target="_blank" rel="noreferrer">القسم 6.1.6</a> من مواصفات لغة ECMAScript. لاحظ أن النطاق الكامل لـ <code>int64_t</code> لا يمكن تمثيله بدقة كاملة في JavaScript. القيم الصحيحة خارج نطاق <a href="https://tc39.github.io/ecma262/#sec-number.min_safe_integer" target="_blank" rel="noreferrer"><code>Number.MIN_SAFE_INTEGER</code></a> <code>-(2**53 - 1)</code> - <a href="https://tc39.github.io/ecma262/#sec-number.max_safe_integer" target="_blank" rel="noreferrer"><code>Number.MAX_SAFE_INTEGER</code></a> <code>(2**53 - 1)</code> ستفقد الدقة.</p><h4 id="napi_create_double" tabindex="-1"><code>napi_create_double</code> <a class="header-anchor" href="#napi_create_double" aria-label="Permalink to “napi_create_double”">​</a></h4><p><strong>أضيف في: v8.4.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">double</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات فيها.</li><li><code>[in] value</code>: قيمة مزدوجة الدقة ليتم تمثيلها في JavaScript.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل <code>number</code> في JavaScript.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات.</p><p>تستخدم واجهة برمجة التطبيقات هذه للتحويل من النوع <code>double</code> في C إلى النوع <code>number</code> في JavaScript.</p><p>تم وصف النوع <code>number</code> في JavaScript في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-number-type" target="_blank" rel="noreferrer">القسم 6.1.6</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_bigint_int64" tabindex="-1"><code>napi_create_bigint_int64</code> <a class="header-anchor" href="#napi_create_bigint_int64" aria-label="Permalink to “napi_create_bigint_int64”">​</a></h4><p><strong>أضيف في: الإصدار 10.7.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_bigint_int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     int64_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: قيمة عدد صحيح ليتم تمثيلها في JavaScript.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل <code>BigInt</code> JavaScript.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تحول واجهة برمجة التطبيقات (API) هذه النوع <code>int64_t</code> C إلى النوع <code>BigInt</code> JavaScript.</p><h4 id="napi_create_bigint_uint64" tabindex="-1"><code>napi_create_bigint_uint64</code> <a class="header-anchor" href="#napi_create_bigint_uint64" aria-label="Permalink to “napi_create_bigint_uint64”">​</a></h4><p><strong>أضيف في: الإصدار 10.7.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_bigint_uint64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      uint64_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: قيمة عدد صحيح غير موقّع ليتم تمثيلها في JavaScript.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل <code>BigInt</code> JavaScript.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تحول واجهة برمجة التطبيقات (API) هذه النوع <code>uint64_t</code> C إلى النوع <code>BigInt</code> JavaScript.</p><h4 id="napi_create_bigint_words" tabindex="-1"><code>napi_create_bigint_words</code> <a class="header-anchor" href="#napi_create_bigint_words" aria-label="Permalink to “napi_create_bigint_words”">​</a></h4><p><strong>أضيف في: الإصدار 10.7.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_bigint_words</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> sign_bit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> word_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> uint64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> words</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] sign_bit</code>: يحدد ما إذا كان <code>BigInt</code> الناتج سيكون موجبًا أم سالبًا.</li><li><code>[in] word_count</code>: طول مصفوفة <code>words</code>.</li><li><code>[in] words</code>: مصفوفة من كلمات 64 بت ذات ترتيبendian الصغير <code>uint64_t</code>.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل <code>BigInt</code> JavaScript.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تحول واجهة برمجة التطبيقات (API) هذه مصفوفة من الكلمات غير الموقعة ذات 64 بت إلى قيمة <code>BigInt</code> واحدة.</p><p>يتم حساب <code>BigInt</code> الناتج على النحو التالي: (–1) (<code>words[0]</code> × (2) + <code>words[1]</code> × (2) + …)</p><h4 id="napi_create_string_latin1" tabindex="-1"><code>napi_create_string_latin1</code> <a class="header-anchor" href="#napi_create_string_latin1" aria-label="Permalink to “napi_create_string_latin1”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_string_latin1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] str</code>: مخزن مؤقت للأحرف يمثل سلسلة مشفرة بـ ISO-8859-1.</li><li><code>[in] length</code>: طول السلسلة بالبايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كانت منتهية بقيمة فارغة.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل <code>string</code> JavaScript.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يقوم هذا API بإنشاء قيمة <code>string</code> JavaScript من سلسلة C مشفرة بـ ISO-8859-1. يتم نسخ السلسلة الأصلية.</p><p>تم وصف نوع <code>string</code> JavaScript في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">القسم 6.1.4</a> من مواصفات لغة ECMAScript.</p><h4 id="node_api_create_external_string_latin1" tabindex="-1"><code>node_api_create_external_string_latin1</code> <a class="header-anchor" href="#node_api_create_external_string_latin1" aria-label="Permalink to “node_api_create_external_string_latin1”">​</a></h4><p><strong>تمت الإضافة في: v20.4.0, v18.18.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[مستقر: 1 - تجريبي]</p><p><a href="/ar/nodejs/api/documentation#stability-index">مستقر: 1</a> <a href="/ar/nodejs/api/documentation#stability-index">الاستقرار: 1</a> - تجريبي</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_external_string_latin1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                       napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                       napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> copied</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><p><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</p></li><li><p><code>[in] str</code>: مخزن مؤقت للأحرف يمثل سلسلة مشفرة بـ ISO-8859-1.</p></li><li><p><code>[in] length</code>: طول السلسلة بالبايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كانت منتهية بقيمة فارغة.</p></li><li><p><code>[in] finalize_callback</code>: الدالة التي سيتم استدعاؤها عند جمع السلسلة. سيتم استدعاء الدالة مع المعلمات التالية:</p><ul><li><code>[in] env</code>: البيئة التي يتم فيها تشغيل الوظيفة الإضافية. قد تكون هذه القيمة فارغة إذا تم جمع السلسلة كجزء من إنهاء العامل أو مثيل Node.js الرئيسي.</li><li><code>[in] data</code>: هذه هي القيمة <code>str</code> كمؤشر <code>void*</code>.</li><li><code>[in] finalize_hint</code>: هذه هي القيمة <code>finalize_hint</code> التي تم تقديمها إلى API. يوفر <a href="/ar/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> مزيدًا من التفاصيل. هذه المعلمة اختيارية. يعني تمرير قيمة فارغة أن الوظيفة الإضافية لا تحتاج إلى أن يتم إعلامها عند جمع سلسلة JavaScript المقابلة.</li></ul></li><li><p><code>[in] finalize_hint</code>: تلميح اختياري لتمريره إلى استدعاء الإنهاء أثناء التجميع.</p></li><li><p><code>[out] result</code>: <code>napi_value</code> يمثل <code>string</code> JavaScript.</p></li><li><p><code>[out] copied</code>: ما إذا تم نسخ السلسلة. إذا كان الأمر كذلك، فسيتم بالفعل استدعاء الدالة النهائية لتدمير <code>str</code>.</p></li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يقوم هذا API بإنشاء قيمة <code>string</code> JavaScript من سلسلة C مشفرة بـ ISO-8859-1. قد لا يتم نسخ السلسلة الأصلية وبالتالي يجب أن توجد طوال دورة حياة قيمة JavaScript بالكامل.</p><p>تم وصف نوع <code>string</code> JavaScript في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">القسم 6.1.4</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_string_utf16" tabindex="-1"><code>napi_create_string_utf16</code> <a class="header-anchor" href="#napi_create_string_utf16" aria-label="Permalink to “napi_create_string_utf16”">​</a></h4><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_string_utf16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> char16_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API فيها.</li><li><code>[in] str</code>: مخزن مؤقت للأحرف يمثل سلسلة مشفرة بـ UTF16-LE.</li><li><code>[in] length</code>: طول السلسلة بوحدات رمزية ثنائية البايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كانت منتهية بصفر.</li><li><code>[out] result</code>: قيمة <code>napi_value</code> تمثل <code>string</code> JavaScript.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>ينشئ هذا API قيمة <code>string</code> JavaScript من سلسلة C مشفرة بـ UTF16-LE. يتم نسخ السلسلة الأصلية.</p><p>يتم وصف نوع <code>string</code> JavaScript في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">القسم 6.1.4</a> من مواصفات لغة ECMAScript.</p><h4 id="node_api_create_external_string_utf16" tabindex="-1"><code>node_api_create_external_string_utf16</code> <a class="header-anchor" href="#node_api_create_external_string_utf16" aria-label="Permalink to “node_api_create_external_string_utf16”">​</a></h4><p><strong>أُضيف في: v20.4.0، v18.18.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[مستقر: 1 - تجريبي]</p><p><a href="/ar/nodejs/api/documentation#stability-index">مستقر: 1</a> <a href="/ar/nodejs/api/documentation#stability-index">الاستقرار: 1</a> - تجريبي</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_external_string_utf16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                      char16_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> copied</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><p><code>[in] env</code>: البيئة التي يتم استدعاء API فيها.</p></li><li><p><code>[in] str</code>: مخزن مؤقت للأحرف يمثل سلسلة مشفرة بـ UTF16-LE.</p></li><li><p><code>[in] length</code>: طول السلسلة بوحدات رمزية ثنائية البايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كانت منتهية بصفر.</p></li><li><p><code>[in] finalize_callback</code>: الدالة التي سيتم استدعاؤها عند جمع السلسلة. سيتم استدعاء الدالة بالمعلمات التالية:</p><ul><li><code>[in] env</code>: البيئة التي يتم فيها تشغيل الوظيفة الإضافية. قد تكون هذه القيمة خالية إذا تم جمع السلسلة كجزء من إنهاء العامل أو مثيل Node.js الرئيسي.</li><li><code>[in] data</code>: هذه هي القيمة <code>str</code> كمؤشر <code>void*</code>.</li><li><code>[in] finalize_hint</code>: هذه هي القيمة <code>finalize_hint</code> التي تم إعطاؤها إلى API. <a href="/ar/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> يوفر مزيدًا من التفاصيل. هذه المعلمة اختيارية. يعني تمرير قيمة خالية أن الوظيفة الإضافية ليست بحاجة إلى أن يتم إشعارها عند جمع سلسلة JavaScript المقابلة.</li></ul></li><li><p><code>[in] finalize_hint</code>: تلميح اختياري لتمريره إلى رد الاتصال النهائي أثناء الجمع.</p></li><li><p><code>[out] result</code>: قيمة <code>napi_value</code> تمثل <code>string</code> JavaScript.</p></li><li><p><code>[out] copied</code>: ما إذا تم نسخ السلسلة. إذا كان الأمر كذلك، فسيتم بالفعل استدعاء الدالة النهائية لتدمير <code>str</code>.</p></li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>ينشئ هذا API قيمة <code>string</code> JavaScript من سلسلة C مشفرة بـ UTF16-LE. قد لا يتم نسخ السلسلة الأصلية وبالتالي يجب أن توجد طوال دورة حياة قيمة JavaScript.</p><p>يتم وصف نوع <code>string</code> JavaScript في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">القسم 6.1.4</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_create_string_utf8" tabindex="-1"><code>napi_create_string_utf8</code> <a class="header-anchor" href="#napi_create_string_utf8" aria-label="Permalink to “napi_create_string_utf8”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_string_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] str</code>: مخزن مؤقت للأحرف يمثل سلسلة بترميز UTF8.</li><li><code>[in] length</code>: طول السلسلة بالبايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كانت منتهية بقيمة فارغة.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل <code>string</code> JavaScript.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بإنشاء قيمة <code>string</code> JavaScript من سلسلة C بترميز UTF8. يتم نسخ السلسلة الأصلية.</p><p>يتم وصف نوع <code>string</code> JavaScript في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">القسم 6.1.4</a> من مواصفات لغة ECMAScript.</p><h3 id="functions-to-create-optimized-property-keys" tabindex="-1">وظائف لإنشاء مفاتيح خصائص محسنة <a class="header-anchor" href="#functions-to-create-optimized-property-keys" aria-label="Permalink to “وظائف لإنشاء مفاتيح خصائص محسنة”">​</a></h3><p>تستخدم العديد من محركات JavaScript بما في ذلك V8 سلاسل داخلية كمفاتيح لتعيين قيم الخصائص والحصول عليها. عادةً ما يستخدمون جدول تجزئة لإنشاء هذه السلاسل والبحث عنها. على الرغم من أنه يضيف بعض التكلفة لكل إنشاء مفتاح، إلا أنه يحسن الأداء بعد ذلك من خلال تمكين مقارنة مؤشرات السلسلة بدلاً من السلاسل بأكملها.</p><p>إذا كان من المفترض استخدام سلسلة JavaScript جديدة كمفتاح للخاصية، فسيكون استخدام الوظائف الموجودة في هذا القسم أكثر كفاءة لبعض محركات JavaScript. بخلاف ذلك، استخدم وظائف <code>napi_create_string_utf8</code> أو <code>node_api_create_external_string_utf8</code> نظرًا لوجود نفقات عامة إضافية في إنشاء/تخزين السلاسل باستخدام طرق إنشاء مفتاح الخاصية.</p><h4 id="node_api_create_property_key_latin1" tabindex="-1"><code>node_api_create_property_key_latin1</code> <a class="header-anchor" href="#node_api_create_property_key_latin1" aria-label="Permalink to “node_api_create_property_key_latin1”">​</a></h4><p><strong>تمت الإضافة في: v22.9.0، v20.18.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[ثابت: 1 - تجريبي]</p><p><a href="/ar/nodejs/api/documentation#stability-index">ثابت: 1</a> <a href="/ar/nodejs/api/documentation#stability-index">الاستقرار: 1</a> - تجريبي</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status NAPI_CDECL </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_property_key_latin1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                           const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                           size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                           napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] str</code>: مخزن مؤقت للأحرف يمثل سلسلة بترميز ISO-8859-1.</li><li><code>[in] length</code>: طول السلسلة بالبايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كانت منتهية بقيمة فارغة.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل <code>string</code> JavaScript مُحسَّن لاستخدامه كمفتاح خاصية للكائنات.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بإنشاء قيمة <code>string</code> JavaScript مُحسَّنة من سلسلة C بترميز ISO-8859-1 لاستخدامها كمفتاح خاصية للكائنات. يتم نسخ السلسلة الأصلية. على عكس <code>napi_create_string_latin1</code>، قد تستفيد الاستدعاءات اللاحقة لهذه الدالة بنفس مؤشر <code>str</code> من تسريع في إنشاء <code>napi_value</code> المطلوب، اعتمادًا على المحرك.</p><p>يتم وصف نوع <code>string</code> JavaScript في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">القسم 6.1.4</a> من مواصفات لغة ECMAScript.</p><h4 id="node_api_create_property_key_utf16" tabindex="-1"><code>node_api_create_property_key_utf16</code> <a class="header-anchor" href="#node_api_create_property_key_utf16" aria-label="Permalink to “node_api_create_property_key_utf16”">​</a></h4><p><strong>أُضيف في: الإصدار 21.7.0، 20.12.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[مستقر: 1 - تجريبي]</p><p><a href="/ar/nodejs/api/documentation#stability-index">مستقر: 1</a> <a href="/ar/nodejs/api/documentation#stability-index">مستقر: 1</a> - تجريبي</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status NAPI_CDECL </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_property_key_utf16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                          const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> char16_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                          size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                          napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] str</code>: مخزن الأحرف الذي يمثل سلسلة مشفرة بـ UTF16-LE.</li><li><code>[in] length</code>: طول السلسلة بوحدات التعليمات البرمجية ثنائية البايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كانت تنتهي بـ null.</li><li><code>[out] result</code>: قيمة <code>napi_value</code> تمثل <code>string</code> JavaScript مُحسَّنة لاستخدامها كمفتاح خاصية للكائنات.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تنشئ واجهة برمجة التطبيقات (API) هذه قيمة <code>string</code> JavaScript مُحسَّنة من سلسلة C مشفرة بـ UTF16-LE لاستخدامها كمفتاح خاصية للكائنات. يتم نسخ السلسلة الأصلية.</p><p>يوصف نوع <code>string</code> JavaScript في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">القسم 6.1.4</a> من مواصفات لغة ECMAScript.</p><h4 id="node_api_create_property_key_utf8" tabindex="-1"><code>node_api_create_property_key_utf8</code> <a class="header-anchor" href="#node_api_create_property_key_utf8" aria-label="Permalink to “node_api_create_property_key_utf8”">​</a></h4><p><strong>أُضيف في: الإصدار 22.9.0، 20.18.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[مستقر: 1 - تجريبي]</p><p><a href="/ar/nodejs/api/documentation#stability-index">مستقر: 1</a> <a href="/ar/nodejs/api/documentation#stability-index">مستقر: 1</a> - تجريبي</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status NAPI_CDECL </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_property_key_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                         const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                         size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                         napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] str</code>: مخزن الأحرف الذي يمثل سلسلة مشفرة بـ UTF8.</li><li><code>[in] length</code>: طول السلسلة بوحدات التعليمات البرمجية ثنائية البايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كانت تنتهي بـ null.</li><li><code>[out] result</code>: قيمة <code>napi_value</code> تمثل <code>string</code> JavaScript مُحسَّنة لاستخدامها كمفتاح خاصية للكائنات.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تنشئ واجهة برمجة التطبيقات (API) هذه قيمة <code>string</code> JavaScript مُحسَّنة من سلسلة C مشفرة بـ UTF8 لاستخدامها كمفتاح خاصية للكائنات. يتم نسخ السلسلة الأصلية.</p><p>يوصف نوع <code>string</code> JavaScript في <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">القسم 6.1.4</a> من مواصفات لغة ECMAScript.</p><h3 id="functions-to-convert-from-node-api-to-c-types" tabindex="-1">وظائف للتحويل من Node-API إلى أنواع C <a class="header-anchor" href="#functions-to-convert-from-node-api-to-c-types" aria-label="Permalink to “وظائف للتحويل من Node-API إلى أنواع C”">​</a></h3><h4 id="napi_get_array_length" tabindex="-1"><code>napi_get_array_length</code> <a class="header-anchor" href="#napi_get_array_length" aria-label="Permalink to “napi_get_array_length”">​</a></h4><p><strong>أُضيفت في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_array_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                  uint32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] value</code>: <code>napi_value</code> تمثل JavaScript <code>Array</code> التي يتم الاستعلام عن طولها.</li><li><code>[out] result</code>: <code>uint32</code> يمثل طول المصفوفة.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>تقوم واجهة برمجة التطبيقات هذه بإرجاع طول المصفوفة.</p><p>تم وصف طول <code>Array</code> في <a href="https://tc39.github.io/ecma262/#sec-properties-of-array-instances-length" target="_blank" rel="noreferrer">القسم 22.1.4.1</a> من مواصفات لغة ECMAScript.</p><h4 id="napi_get_arraybuffer_info" tabindex="-1"><code>napi_get_arraybuffer_info</code> <a class="header-anchor" href="#napi_get_arraybuffer_info" aria-label="Permalink to “napi_get_arraybuffer_info”">​</a></h4><p><strong>أُضيفت في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_arraybuffer_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] arraybuffer</code>: <code>napi_value</code> تمثل <code>ArrayBuffer</code> التي يتم الاستعلام عنها.</li><li><code>[out] data</code>: مخزن البيانات الأساسي لـ <code>ArrayBuffer</code>. إذا كان byte_length هو <code>0</code>، فقد يكون هذا <code>NULL</code> أو أي قيمة مؤشر أخرى.</li><li><code>[out] byte_length</code>: طول مخزن البيانات الأساسي بالبايت.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>تُستخدم واجهة برمجة التطبيقات هذه لاسترداد مخزن البيانات الأساسي لـ <code>ArrayBuffer</code> وطوله.</p><p><em>تحذير</em>: توخ الحذر أثناء استخدام واجهة برمجة التطبيقات هذه. تتم إدارة دورة حياة مخزن البيانات الأساسي بواسطة <code>ArrayBuffer</code> حتى بعد إرجاعه. إحدى الطرق الآمنة المحتملة لاستخدام واجهة برمجة التطبيقات هذه هي بالاقتران مع <a href="/ar/nodejs/api/n-api#napi-create-reference"><code>napi_create_reference</code></a>، والتي يمكن استخدامها لضمان التحكم في دورة حياة <code>ArrayBuffer</code>. من الآمن أيضًا استخدام مخزن البيانات الذي تم إرجاعه داخل نفس رد الاتصال طالما لا توجد استدعاءات لواجهات برمجة تطبيقات أخرى قد تؤدي إلى تشغيل GC.</p><h4 id="napi_get_buffer_info" tabindex="-1"><code>napi_get_buffer_info</code> <a class="header-anchor" href="#napi_get_buffer_info" aria-label="Permalink to “napi_get_buffer_info”">​</a></h4><p><strong>أضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_buffer_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: <code>napi_value</code> تمثل <code>node::Buffer</code> أو <code>Uint8Array</code> التي يتم الاستعلام عنها.</li><li><code>[out] data</code>: مخزن البيانات الأساسي لـ <code>node::Buffer</code> أو <code>Uint8Array</code>. إذا كان الطول <code>0</code>، فقد يكون هذا <code>NULL</code> أو أي قيمة مؤشر أخرى.</li><li><code>[out] length</code>: طول مخزن البيانات الأساسي بالبايت.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تُرجع هذه الطريقة نفس <code>data</code> و <code>byte_length</code> الموجودة في <a href="/ar/nodejs/api/n-api#napi-get-typedarray-info"><code>napi_get_typedarray_info</code></a>. وتقبل <code>napi_get_typedarray_info</code> أيضًا <code>node::Buffer</code> (Uint8Array) كقيمة.</p><p>تستخدم واجهة برمجة التطبيقات (API) هذه لاسترداد مخزن البيانات الأساسي لـ <code>node::Buffer</code> وطوله.</p><p><em>تحذير</em>: استخدم الحذر أثناء استخدام واجهة برمجة التطبيقات (API) هذه نظرًا لأن عمر مخزن البيانات الأساسي غير مضمون إذا تمت إدارته بواسطة الجهاز الظاهري (VM).</p><h4 id="napi_get_prototype" tabindex="-1"><code>napi_get_prototype</code> <a class="header-anchor" href="#napi_get_prototype" aria-label="Permalink to “napi_get_prototype”">​</a></h4><p><strong>أضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_prototype</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] object</code>: <code>napi_value</code> تمثل JavaScript <code>Object</code> التي سيتم إرجاع النموذج الأولي لها. هذا يُرجع ما يعادل <code>Object.getPrototypeOf</code> (وهو ليس نفس خاصية <code>prototype</code> للدالة).</li><li><code>[out] result</code>: <code>napi_value</code> تمثل النموذج الأولي للكائن المحدد.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><h4 id="napi_get_typedarray_info" tabindex="-1"><code>napi_get_typedarray_info</code> <a class="header-anchor" href="#napi_get_typedarray_info" aria-label="Permalink to “napi_get_typedarray_info”">​</a></h4><p><strong>أضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_typedarray_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">typedarray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_typedarray_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_offset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] typedarray</code>: <code>napi_value</code> تمثل <code>TypedArray</code> التي سيتم الاستعلام عن خصائصها.</li><li><code>[out] type</code>: نوع البيانات العددية للعناصر داخل <code>TypedArray</code>.</li><li><code>[out] length</code>: عدد العناصر في <code>TypedArray</code>.</li><li><code>[out] data</code>: مخزن البيانات الأساسي لـ <code>TypedArray</code> المعدل بواسطة قيمة <code>byte_offset</code> بحيث يشير إلى العنصر الأول في <code>TypedArray</code>. إذا كان طول المصفوفة <code>0</code>، فقد يكون هذا <code>NULL</code> أو أي قيمة مؤشر أخرى.</li><li><code>[out] arraybuffer</code>: <code>ArrayBuffer</code> الأساسي لـ <code>TypedArray</code>.</li><li><code>[out] byte_offset</code>: إزاحة البايت داخل المصفوفة الأصلية الأساسية التي يوجد عندها العنصر الأول من المصفوفات. تم بالفعل تعديل قيمة معلمة البيانات بحيث تشير البيانات إلى العنصر الأول في المصفوفة. لذلك، سيكون البايت الأول من المصفوفة الأصلية في <code>data - byte_offset</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تُرجع واجهة برمجة التطبيقات (API) هذه خصائص مختلفة لمصفوفة ذات نوع محدد.</p><p>قد تكون أي من معلمات الإخراج <code>NULL</code> إذا كانت هذه الخاصية غير ضرورية.</p><p><em>تحذير</em>: استخدم الحذر أثناء استخدام واجهة برمجة التطبيقات (API) هذه نظرًا لأن مخزن البيانات الأساسي تتم إدارته بواسطة الجهاز الظاهري (VM).</p><h4 id="napi_get_dataview_info" tabindex="-1"><code>napi_get_dataview_info</code> <a class="header-anchor" href="#napi_get_dataview_info" aria-label="Permalink to “napi_get_dataview_info”">​</a></h4><p><strong>تمت إضافته في: v8.3.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_dataview_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dataview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_offset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] dataview</code>: <code>napi_value</code> تمثل <code>DataView</code> التي سيتم الاستعلام عن خصائصها.</li><li><code>[out] byte_length</code>: عدد البايتات في <code>DataView</code>.</li><li><code>[out] data</code>: مخزن البيانات الأساسي لـ <code>DataView</code>. إذا كان byte_length يساوي <code>0</code>، فقد يكون هذا <code>NULL</code> أو أي قيمة مؤشر أخرى.</li><li><code>[out] arraybuffer</code>: <code>ArrayBuffer</code> الأساسي لـ <code>DataView</code>.</li><li><code>[out] byte_offset</code>: إزاحة البايت داخل مخزن البيانات التي سيتم منها بدء عرض <code>DataView</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يمكن أن تكون أي من المعلمات الخارجية <code>NULL</code> إذا لم تكن هذه الخاصية مطلوبة.</p><p>يقوم هذا API بإرجاع خصائص مختلفة لـ <code>DataView</code>.</p><h4 id="napi_get_date_value" tabindex="-1"><code>napi_get_date_value</code> <a class="header-anchor" href="#napi_get_date_value" aria-label="Permalink to “napi_get_date_value”">​</a></h4><p><strong>تمت إضافته في: v11.11.0, v10.17.0</strong></p><p><strong>إصدار N-API: 5</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_date_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                double*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] value</code>: <code>napi_value</code> تمثل <code>Date</code> JavaScript.</li><li><code>[out] result</code>: قيمة الوقت كـ <code>double</code> ممثلة بالمللي ثانية منذ منتصف الليل في بداية 01 يناير 1970 بالتوقيت العالمي المنسق.</li></ul><p>لا يلاحظ هذا API الثواني الكبيسة؛ يتم تجاهلها، حيث يتوافق ECMAScript مع مواصفات وقت POSIX.</p><p>إرجاع <code>napi_ok</code> إذا نجح API. إذا تم تمرير <code>napi_value</code> غير تاريخي، فإنه يُرجع <code>napi_date_expected</code>.</p><p>يقوم هذا API بإرجاع C double primitive لقيمة الوقت لـ JavaScript <code>Date</code> المحدد.</p><h4 id="napi_get_value_bool" tabindex="-1"><code>napi_get_value_bool</code> <a class="header-anchor" href="#napi_get_value_bool" aria-label="Permalink to “napi_get_value_bool”">​</a></h4><p><strong>تمت إضافته في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] value</code>: <code>napi_value</code> تمثل <code>Boolean</code> JavaScript.</li><li><code>[out] result</code>: C boolean primitive المكافئ لـ <code>Boolean</code> JavaScript المحدد.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API. إذا تم تمرير <code>napi_value</code> غير منطقي، فإنه يُرجع <code>napi_boolean_expected</code>.</p><p>يقوم هذا API بإرجاع C boolean primitive المكافئ لـ <code>Boolean</code> JavaScript المحدد.</p><h4 id="napi_get_value_double" tabindex="-1"><code>napi_get_value_double</code> <a class="header-anchor" href="#napi_get_value_double" aria-label="Permalink to “napi_get_value_double”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                  double*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: ‏<code>napi_value</code> تمثل ‏JavaScript ‏<code>number</code>.</li><li><code>[out] result</code>: مكافئ C من النوع الأولي double لرقم JavaScript المحدد.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API). إذا تم تمرير ‏<code>napi_value</code> غير رقمي، فسيتم إرجاع <code>napi_number_expected</code>.</p><p>تُرجع واجهة برمجة التطبيقات (API) هذه مكافئ C من النوع الأولي double لرقم JavaScript المحدد.</p><h4 id="napi_get_value_bigint_int64" tabindex="-1"><code>napi_get_value_bigint_int64</code> <a class="header-anchor" href="#napi_get_value_bigint_int64" aria-label="Permalink to “napi_get_value_bigint_int64”">​</a></h4><p><strong>تمت الإضافة في: v10.7.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_bigint_int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        int64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> lossless</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: ‏<code>napi_value</code> تمثل ‏JavaScript ‏<code>BigInt</code>.</li><li><code>[out] result</code>: مكافئ C من النوع الأولي <code>int64_t</code> لـ JavaScript ‏<code>BigInt</code> المحدد.</li><li><code>[out] lossless</code>: يشير إلى ما إذا كان قد تم تحويل قيمة <code>BigInt</code> دون فقدان.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API). إذا تم تمرير قيمة ليست <code>BigInt</code>، فسيتم إرجاع <code>napi_bigint_expected</code>.</p><p>تُرجع واجهة برمجة التطبيقات (API) هذه مكافئ C من النوع الأولي <code>int64_t</code> لـ JavaScript ‏<code>BigInt</code> المحدد. إذا لزم الأمر، ستقوم باقتطاع القيمة، وتعيين <code>lossless</code> إلى <code>false</code>.</p><h4 id="napi_get_value_bigint_uint64" tabindex="-1"><code>napi_get_value_bigint_uint64</code> <a class="header-anchor" href="#napi_get_value_bigint_uint64" aria-label="Permalink to “napi_get_value_bigint_uint64”">​</a></h4><p><strong>تمت الإضافة في: v10.7.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_bigint_uint64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        uint64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> lossless</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: ‏<code>napi_value</code> تمثل ‏JavaScript ‏<code>BigInt</code>.</li><li><code>[out] result</code>: مكافئ C من النوع الأولي <code>uint64_t</code> لـ JavaScript ‏<code>BigInt</code> المحدد.</li><li><code>[out] lossless</code>: يشير إلى ما إذا كان قد تم تحويل قيمة <code>BigInt</code> دون فقدان.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API). إذا تم تمرير قيمة ليست <code>BigInt</code>، فسيتم إرجاع <code>napi_bigint_expected</code>.</p><p>تُرجع واجهة برمجة التطبيقات (API) هذه مكافئ C من النوع الأولي <code>uint64_t</code> لـ JavaScript ‏<code>BigInt</code> المحدد. إذا لزم الأمر، ستقوم باقتطاع القيمة، وتعيين <code>lossless</code> إلى <code>false</code>.</p><h4 id="napi_get_value_bigint_words" tabindex="-1"><code>napi_get_value_bigint_words</code> <a class="header-anchor" href="#napi_get_value_bigint_words" aria-label="Permalink to “napi_get_value_bigint_words”">​</a></h4><p><strong>تمت الإضافة في: v10.7.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_bigint_words</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        int*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> sign_bit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> word_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        uint64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> words</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API تحتها.</li><li><code>[in] value</code>: <code>napi_value</code> تمثل JavaScript <code>BigInt</code>.</li><li><code>[out] sign_bit</code>: عدد صحيح يمثل ما إذا كان JavaScript <code>BigInt</code> موجبًا أم سالبًا.</li><li><code>[in/out] word_count</code>: يجب تهيئته لطول مصفوفة <code>words</code>. عند الإرجاع ، سيتم تعيينه على العدد الفعلي للكلمات التي ستكون مطلوبة لتخزين هذا <code>BigInt</code>.</li><li><code>[out] words</code>: مؤشر إلى مصفوفة كلمات 64 بت مخصصة مسبقًا.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يقوم هذا API بتحويل قيمة <code>BigInt</code> واحدة إلى بت إشارة ، ومصفوفة ذات نهاية صغيرة 64 بت ، وعدد العناصر في المصفوفة. يمكن تعيين كل من <code>sign_bit</code> و <code>words</code> على <code>NULL</code> ، للحصول على <code>word_count</code> فقط.</p><h4 id="napi_get_value_external" tabindex="-1"><code>napi_get_value_external</code> <a class="header-anchor" href="#napi_get_value_external" aria-label="Permalink to “napi_get_value_external”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_external</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API تحتها.</li><li><code>[in] value</code>: <code>napi_value</code> يمثل قيمة JavaScript الخارجية.</li><li><code>[out] result</code>: مؤشر إلى البيانات المغلفة بواسطة قيمة JavaScript الخارجية.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API. إذا تم تمرير <code>napi_value</code> غير خارجي ، فإنه يرجع <code>napi_invalid_arg</code>.</p><p>يسترجع هذا API مؤشر البيانات الخارجية الذي تم تمريره مسبقًا إلى <code>napi_create_external()</code>.</p><h4 id="napi_get_value_int32" tabindex="-1"><code>napi_get_value_int32</code> <a class="header-anchor" href="#napi_get_value_int32" aria-label="Permalink to “napi_get_value_int32”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 int32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API تحتها.</li><li><code>[in] value</code>: <code>napi_value</code> يمثل JavaScript <code>number</code>.</li><li><code>[out] result</code>: C <code>int32</code> البدائي المكافئ لـ JavaScript <code>number</code> المحدد.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API. إذا تم تمرير <code>napi_value</code> غير رقمي ، فسيتم إرجاع <code>napi_number_expected</code>.</p><p>يقوم هذا API بإرجاع C <code>int32</code> البدائي المكافئ لـ JavaScript <code>number</code> المحدد.</p><p>إذا تجاوز الرقم نطاق العدد الصحيح 32 بت ، فسيتم اقتطاع النتيجة لتكون مكافئة لأقل 32 بت. يمكن أن يؤدي هذا إلى أن يصبح الرقم الموجب الكبير رقمًا سالبًا إذا كانت القيمة &gt; 2 - 1.</p><p>تقوم قيم الأرقام غير المحدودة (<code>NaN</code> أو <code>+Infinity</code> أو <code>-Infinity</code>) بتعيين النتيجة إلى الصفر.</p><h4 id="napi_get_value_int64" tabindex="-1"><code>napi_get_value_int64</code> <a class="header-anchor" href="#napi_get_value_int64" aria-label="Permalink to “napi_get_value_int64”">​</a></h4><p><strong>تمت الإضافة في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 int64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] value</code>: <code>napi_value</code> تمثل JavaScript <code>number</code>.</li><li><code>[out] result</code>: C <code>int64</code> البدائي المكافئ لـ JavaScript <code>number</code> المعطاة.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجح API. إذا تم تمرير <code>napi_value</code> غير رقمي، فإنها تُرجع <code>napi_number_expected</code>.</p><p>يقوم هذا API بإرجاع C <code>int64</code> البدائي المكافئ لـ JavaScript <code>number</code> المعطاة.</p><p>ستفقد قيم <code>number</code> خارج نطاق <a href="https://tc39.github.io/ecma262/#sec-number.min_safe_integer" target="_blank" rel="noreferrer"><code>Number.MIN_SAFE_INTEGER</code></a> <code>-(2**53 - 1)</code> - <a href="https://tc39.github.io/ecma262/#sec-number.max_safe_integer" target="_blank" rel="noreferrer"><code>Number.MAX_SAFE_INTEGER</code></a> <code>(2**53 - 1)</code> الدقة.</p><p>تقوم قيم الأرقام غير المنتهية (<code>NaN</code> أو <code>+Infinity</code> أو <code>-Infinity</code>) بتعيين النتيجة إلى الصفر.</p><h4 id="napi_get_value_string_latin1" tabindex="-1"><code>napi_get_value_string_latin1</code> <a class="header-anchor" href="#napi_get_value_string_latin1" aria-label="Permalink to “napi_get_value_string_latin1”">​</a></h4><p><strong>تمت الإضافة في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_string_latin1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                         napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> bufsize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] value</code>: <code>napi_value</code> تمثل سلسلة JavaScript.</li><li><code>[in] buf</code>: المخزن المؤقت لكتابة السلسلة المشفرة بـ ISO-8859-1 فيه. إذا تم تمرير <code>NULL</code>، فسيتم إرجاع طول السلسلة بالبايتات باستثناء فاصلة النهاية الصفرية في <code>result</code>.</li><li><code>[in] bufsize</code>: حجم المخزن المؤقت الوجهة. عندما تكون هذه القيمة غير كافية، يتم اقتطاع السلسلة المرجعة وإنهاؤها بصفر.</li><li><code>[out] result</code>: عدد البايتات التي تم نسخها إلى المخزن المؤقت، باستثناء فاصلة النهاية الصفرية.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجح API. إذا تم تمرير <code>napi_value</code> غير <code>string</code>، فإنها تُرجع <code>napi_string_expected</code>.</p><p>يقوم هذا API بإرجاع السلسلة المشفرة بـ ISO-8859-1 المطابقة للقيمة التي تم تمريرها.</p><h4 id="napi_get_value_string_utf8" tabindex="-1"><code>napi_get_value_string_utf8</code> <a class="header-anchor" href="#napi_get_value_string_utf8" aria-label="Permalink to “napi_get_value_string_utf8”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_string_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                       napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> bufsize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: <code>napi_value</code> يمثل سلسلة JavaScript.</li><li><code>[in] buf</code>: المخزن المؤقت لكتابة السلسلة المشفرة بـ UTF8 فيه. إذا تم تمرير <code>NULL</code>، يتم إرجاع طول السلسلة بالبايتات باستثناء فاصلة النهاية الخالية في <code>result</code>.</li><li><code>[in] bufsize</code>: حجم المخزن المؤقت الوجهة. عندما تكون هذه القيمة غير كافية، يتم اقتطاع السلسلة المرجعة وإنهاؤها بقيمة فارغة.</li><li><code>[out] result</code>: عدد البايتات المنسوخة في المخزن المؤقت، باستثناء فاصلة النهاية الخالية.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API). إذا تم تمرير <code>napi_value</code> غير <code>string</code>، فإنها ترجع <code>napi_string_expected</code>.</p><p>ترجع واجهة برمجة التطبيقات (API) هذه السلسلة المشفرة بـ UTF8 المقابلة للقيمة التي تم تمريرها.</p><h4 id="napi_get_value_string_utf16" tabindex="-1"><code>napi_get_value_string_utf16</code> <a class="header-anchor" href="#napi_get_value_string_utf16" aria-label="Permalink to “napi_get_value_string_utf16”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_string_utf16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                        char16_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> bufsize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: <code>napi_value</code> يمثل سلسلة JavaScript.</li><li><code>[in] buf</code>: المخزن المؤقت لكتابة السلسلة المشفرة بـ UTF16-LE فيه. إذا تم تمرير <code>NULL</code>، يتم إرجاع طول السلسلة بوحدات التعليمات البرمجية المكونة من بايتين باستثناء فاصلة النهاية الخالية.</li><li><code>[in] bufsize</code>: حجم المخزن المؤقت الوجهة. عندما تكون هذه القيمة غير كافية، يتم اقتطاع السلسلة المرجعة وإنهاؤها بقيمة فارغة.</li><li><code>[out] result</code>: عدد وحدات التعليمات البرمجية المكونة من بايتين المنسوخة في المخزن المؤقت، باستثناء فاصلة النهاية الخالية.</li></ul><p>ترجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API). إذا تم تمرير <code>napi_value</code> غير <code>string</code>، فإنها ترجع <code>napi_string_expected</code>.</p><p>ترجع واجهة برمجة التطبيقات (API) هذه السلسلة المشفرة بـ UTF16 المقابلة للقيمة التي تم تمريرها.</p><h4 id="napi_get_value_uint32" tabindex="-1"><code>napi_get_value_uint32</code> <a class="header-anchor" href="#napi_get_value_uint32" aria-label="Permalink to “napi_get_value_uint32”">​</a></h4><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_uint32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                  uint32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] value</code>: <code>napi_value</code> تمثل JavaScript <code>number</code>.</li><li><code>[out] result</code>: معادل C بدائي لـ <code>napi_value</code> المعطاة كـ <code>uint32_t</code>.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجح API. إذا تم تمرير <code>napi_value</code> ليست رقمًا، فإنها تُرجع <code>napi_number_expected</code>.</p><p>يُرجع هذا API المعادل C البدائي لـ <code>napi_value</code> المعطاة كـ <code>uint32_t</code>.</p><h3 id="functions-to-get-global-instances" tabindex="-1">دوال للحصول على النسخ العمومية <a class="header-anchor" href="#functions-to-get-global-instances" aria-label="Permalink to “دوال للحصول على النسخ العمومية”">​</a></h3><h4 id="napi_get_boolean" tabindex="-1"><code>napi_get_boolean</code> <a class="header-anchor" href="#napi_get_boolean" aria-label="Permalink to “napi_get_boolean”">​</a></h4><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] value</code>: قيمة boolean المراد استرجاعها.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل JavaScript <code>Boolean</code> المفردة المراد استرجاعها.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجح API.</p><p>يُستخدم هذا API لإرجاع كائن JavaScript المفردة الذي يُستخدم لتمثيل قيمة boolean المعطاة.</p><h4 id="napi_get_global" tabindex="-1"><code>napi_get_global</code> <a class="header-anchor" href="#napi_get_global" aria-label="Permalink to “napi_get_global”">​</a></h4><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل كائن JavaScript <code>global</code>.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجح API.</p><p>يُرجع هذا API الكائن <code>global</code>.</p><h4 id="napi_get_null" tabindex="-1"><code>napi_get_null</code> <a class="header-anchor" href="#napi_get_null" aria-label="Permalink to “napi_get_null”">​</a></h4><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل كائن JavaScript <code>null</code>.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجح API.</p><p>يُرجع هذا API الكائن <code>null</code>.</p><h4 id="napi_get_undefined" tabindex="-1"><code>napi_get_undefined</code> <a class="header-anchor" href="#napi_get_undefined" aria-label="Permalink to “napi_get_undefined”">​</a></h4><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل قيمة JavaScript Undefined.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجح API.</p><p>يُرجع هذا API الكائن Undefined.</p><h2 id="working-with-javascript-values-and-abstract-operations" tabindex="-1">التعامل مع قيم JavaScript والعمليات المجردة <a class="header-anchor" href="#working-with-javascript-values-and-abstract-operations" aria-label="Permalink to “التعامل مع قيم JavaScript والعمليات المجردة”">​</a></h2><p>تعرض Node-API مجموعة من واجهات برمجة التطبيقات (APIs) لإجراء بعض العمليات المجردة على قيم JavaScript. تم توثيق بعض هذه العمليات تحت <a href="https://tc39.github.io/ecma262/#sec-abstract-operations" target="_blank" rel="noreferrer">القسم 7</a> من <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">مواصفات لغة ECMAScript</a>.</p><p>تدعم واجهات برمجة التطبيقات (APIs) هذه القيام بأحد الإجراءات التالية:</p><h3 id="napi_coerce_to_bool" tabindex="-1"><code>napi_coerce_to_bool</code> <a class="header-anchor" href="#napi_coerce_to_bool" aria-label="Permalink to “napi_coerce_to_bool”">​</a></h3><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_coerce_to_bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: قيمة JavaScript المراد تحويلها.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل <code>Boolean</code> JavaScript المحول.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تنفذ واجهة برمجة التطبيقات (API) هذه العملية المجردة <code>ToBoolean()</code> كما هو محدد في <a href="https://tc39.github.io/ecma262/#sec-toboolean" target="_blank" rel="noreferrer">القسم 7.1.2</a> من مواصفات لغة ECMAScript.</p><h3 id="napi_coerce_to_number" tabindex="-1"><code>napi_coerce_to_number</code> <a class="header-anchor" href="#napi_coerce_to_number" aria-label="Permalink to “napi_coerce_to_number”">​</a></h3><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_coerce_to_number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: قيمة JavaScript المراد تحويلها.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل <code>number</code> JavaScript المحول.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تنفذ واجهة برمجة التطبيقات (API) هذه العملية المجردة <code>ToNumber()</code> كما هو محدد في <a href="https://tc39.github.io/ecma262/#sec-tonumber" target="_blank" rel="noreferrer">القسم 7.1.3</a> من مواصفات لغة ECMAScript. قد يقوم هذا الدالة بتشغيل كود JS إذا كانت القيمة التي تم تمريرها عبارة عن كائن.</p><h3 id="napi_coerce_to_object" tabindex="-1"><code>napi_coerce_to_object</code> <a class="header-anchor" href="#napi_coerce_to_object" aria-label="Permalink to “napi_coerce_to_object”">​</a></h3><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_coerce_to_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: قيمة JavaScript المراد تحويلها.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل <code>Object</code> JavaScript المحول.</li></ul><p>تُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تنفذ واجهة برمجة التطبيقات (API) هذه العملية المجردة <code>ToObject()</code> كما هو محدد في <a href="https://tc39.github.io/ecma262/#sec-toobject" target="_blank" rel="noreferrer">القسم 7.1.13</a> من مواصفات لغة ECMAScript.</p><h3 id="napi_coerce_to_string" tabindex="-1">‏<code>napi_coerce_to_string</code> <a class="header-anchor" href="#napi_coerce_to_string" aria-label="Permalink to “‏napi_coerce_to_string”">​</a></h3><p><strong>تمت إضافته في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_coerce_to_string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: قيمة JavaScript المراد إجبارها.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل JavaScript <code>string</code> المجبرة.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تنفذ واجهة برمجة التطبيقات (API) هذه العملية المجردة <code>ToString()</code> كما هو محدد في <a href="https://tc39.github.io/ecma262/#sec-toobject" target="_blank" rel="noreferrer">القسم 7.1.13</a> من مواصفات لغة ECMAScript. قد تقوم هذه الدالة بتشغيل كود JS إذا كانت القيمة التي تم تمريرها عبارة عن كائن.</p><h3 id="napi_typeof" tabindex="-1">‏<code>napi_typeof</code> <a class="header-anchor" href="#napi_typeof" aria-label="Permalink to “‏napi_typeof”">​</a></h3><p><strong>تمت إضافته في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_valuetype</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] value</code>: قيمة JavaScript التي سيتم الاستعلام عن نوعها.</li><li><code>[out] result</code>: نوع قيمة JavaScript.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><ul><li><code>napi_invalid_arg</code> إذا كان نوع <code>value</code> ليس نوع ECMAScript معروفًا و <code>value</code> ليس قيمة خارجية.</li></ul><p>تمثل واجهة برمجة التطبيقات (API) هذه سلوكًا مشابهًا لاستدعاء عامل التشغيل <code>typeof</code> على الكائن كما هو محدد في <a href="https://tc39.github.io/ecma262/#sec-typeof-operator" target="_blank" rel="noreferrer">القسم 12.5.5</a> من مواصفات لغة ECMAScript. ومع ذلك، هناك بعض الاختلافات:</p><p>إذا كانت <code>value</code> تحتوي على نوع غير صالح، فسيتم إرجاع خطأ.</p><h3 id="napi_instanceof" tabindex="-1">‏<code>napi_instanceof</code> <a class="header-anchor" href="#napi_instanceof" aria-label="Permalink to “‏napi_instanceof”">​</a></h3><p><strong>تمت إضافته في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_instanceof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                            bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] object</code>: قيمة JavaScript المراد التحقق منها.</li><li><code>[in] constructor</code>: كائن دالة JavaScript لدالة الإنشاء المراد التحقق منها.</li><li><code>[out] result</code>: قيمة منطقية يتم تعيينها على صواب إذا كانت <code>object instanceof constructor</code> صحيحة.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تمثل واجهة برمجة التطبيقات (API) هذه استدعاء عامل التشغيل <code>instanceof</code> على الكائن كما هو محدد في <a href="https://tc39.github.io/ecma262/#sec-instanceofoperator" target="_blank" rel="noreferrer">القسم 12.10.4</a> من مواصفات لغة ECMAScript.</p><h3 id="napi_is_array" tabindex="-1"><code>napi_is_array</code> <a class="header-anchor" href="#napi_is_array" aria-label="Permalink to “napi_is_array”">​</a></h3><p><strong>أُضيف في:</strong> v8.0.0</p><p><strong>إصدار N-API:</strong> 1</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) فيها.</li><li><code>[in] value</code>: قيمة JavaScript المراد التحقق منها.</li><li><code>[out] result</code>: ما إذا كان الكائن المعطى عبارة عن مصفوفة.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تمثل واجهة برمجة التطبيقات (API) هذه استدعاء عملية <code>IsArray</code> على الكائن كما هو محدد في <a href="https://tc39.github.io/ecma262/#sec-isarray" target="_blank" rel="noreferrer">القسم 7.2.2</a> من مواصفات لغة ECMAScript.</p><h3 id="napi_is_arraybuffer" tabindex="-1"><code>napi_is_arraybuffer</code> <a class="header-anchor" href="#napi_is_arraybuffer" aria-label="Permalink to “napi_is_arraybuffer”">​</a></h3><p><strong>أُضيف في:</strong> v8.0.0</p><p><strong>إصدار N-API:</strong> 1</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) فيها.</li><li><code>[in] value</code>: قيمة JavaScript المراد التحقق منها.</li><li><code>[out] result</code>: ما إذا كان الكائن المعطى عبارة عن <code>ArrayBuffer</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تتحقق واجهة برمجة التطبيقات (API) هذه مما إذا كان الكائن <code>Object</code> الذي تم تمريره هو مخزن مؤقت للمصفوفة (array buffer).</p><h3 id="napi_is_buffer" tabindex="-1"><code>napi_is_buffer</code> <a class="header-anchor" href="#napi_is_buffer" aria-label="Permalink to “napi_is_buffer”">​</a></h3><p><strong>أُضيف في:</strong> v8.0.0</p><p><strong>إصدار N-API:</strong> 1</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) فيها.</li><li><code>[in] value</code>: قيمة JavaScript المراد التحقق منها.</li><li><code>[out] result</code>: ما إذا كانت <code>napi_value</code> المعطاة تمثل كائن <code>node::Buffer</code> أو <code>Uint8Array</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تتحقق واجهة برمجة التطبيقات (API) هذه مما إذا كان الكائن <code>Object</code> الذي تم تمريره عبارة عن مخزن مؤقت أو Uint8Array. يجب تفضيل <a href="/ar/nodejs/api/n-api#napi-is-typedarray"><code>napi_is_typedarray</code></a> إذا كان المتصل بحاجة إلى التحقق مما إذا كانت القيمة عبارة عن Uint8Array.</p><h3 id="napi_is_date" tabindex="-1"><code>napi_is_date</code> <a class="header-anchor" href="#napi_is_date" aria-label="Permalink to “napi_is_date”">​</a></h3><p><strong>أُضيف في:</strong> v11.11.0, v10.17.0</p><p><strong>إصدار N-API:</strong> 5</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) فيها.</li><li><code>[in] value</code>: قيمة JavaScript المراد التحقق منها.</li><li><code>[out] result</code>: ما إذا كانت <code>napi_value</code> المعطاة تمثل كائن <code>Date</code> JavaScript.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تتحقق واجهة برمجة التطبيقات (API) هذه مما إذا كان الكائن <code>Object</code> الذي تم تمريره هو تاريخ.</p><h3 id="napi_is_error_1" tabindex="-1"><code>napi_is_error</code> <a class="header-anchor" href="#napi_is_error_1" aria-label="Permalink to “napi_is_error”">​</a></h3><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] value</code>: قيمة JavaScript المراد فحصها.</li><li><code>[out] result</code>: ما إذا كانت <code>napi_value</code> المعطاة تمثل كائن <code>Error</code>.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح API.</p><p>يتحقق API هذا مما إذا كان <code>Object</code> الذي تم تمريره هو <code>Error</code>.</p><h3 id="napi_is_typedarray" tabindex="-1"><code>napi_is_typedarray</code> <a class="header-anchor" href="#napi_is_typedarray" aria-label="Permalink to “napi_is_typedarray”">​</a></h3><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_typedarray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] value</code>: قيمة JavaScript المراد فحصها.</li><li><code>[out] result</code>: ما إذا كانت <code>napi_value</code> المعطاة تمثل <code>TypedArray</code>.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح API.</p><p>يتحقق API هذا مما إذا كان <code>Object</code> الذي تم تمريره هو مصفوفة مكتوبة.</p><h3 id="napi_is_dataview" tabindex="-1"><code>napi_is_dataview</code> <a class="header-anchor" href="#napi_is_dataview" aria-label="Permalink to “napi_is_dataview”">​</a></h3><p><strong>أُضيف في: v8.3.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_dataview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] value</code>: قيمة JavaScript المراد فحصها.</li><li><code>[out] result</code>: ما إذا كانت <code>napi_value</code> المعطاة تمثل <code>DataView</code>.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح API.</p><p>يتحقق API هذا مما إذا كان <code>Object</code> الذي تم تمريره هو <code>DataView</code>.</p><h3 id="napi_strict_equals" tabindex="-1"><code>napi_strict_equals</code> <a class="header-anchor" href="#napi_strict_equals" aria-label="Permalink to “napi_strict_equals”">​</a></h3><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_strict_equals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">lhs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">rhs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                               bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] lhs</code>: قيمة JavaScript المراد فحصها.</li><li><code>[in] rhs</code>: قيمة JavaScript المراد التحقق منها.</li><li><code>[out] result</code>: ما إذا كان كائنا <code>napi_value</code> متساويين.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح API.</p><p>يمثل API هذا استدعاء خوارزمية المساواة الصارمة كما هو محدد في <a href="https://tc39.github.io/ecma262/#sec-strict-equality-comparison" target="_blank" rel="noreferrer">القسم 7.2.14</a> من مواصفات لغة ECMAScript.</p><h3 id="napi_detach_arraybuffer" tabindex="-1">‏<code>napi_detach_arraybuffer</code> <a class="header-anchor" href="#napi_detach_arraybuffer" aria-label="Permalink to “‏napi_detach_arraybuffer”">​</a></h3><p><strong>تمت إضافته في: الإصدار v13.0.0، v12.16.0، v10.22.0</strong></p><p><strong>إصدار N-API: 7</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_detach_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>‏<code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) تحتها.</li><li>‏<code>[in] arraybuffer</code>: JavaScript ‏<code>ArrayBuffer</code> المراد فصلها.</li></ul><p>إرجاع ‏<code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API). إذا تم تمرير ‏<code>ArrayBuffer</code> غير قابلة للفصل، فإنه يُرجع ‏<code>napi_detachable_arraybuffer_expected</code>.</p><p>بشكل عام، تكون ‏<code>ArrayBuffer</code> غير قابلة للفصل إذا تم فصلها من قبل. قد يفرض المحرك شروطًا إضافية على ما إذا كانت ‏<code>ArrayBuffer</code> قابلة للفصل. على سبيل المثال، يتطلب V8 أن تكون ‏<code>ArrayBuffer</code> خارجية، أي تم إنشاؤها باستخدام ‏<a href="/ar/nodejs/api/n-api#napi-create-external-arraybuffer"><code>napi_create_external_arraybuffer</code></a>.</p><p>تمثل واجهة برمجة التطبيقات (API) هذه استدعاء عملية فصل ‏<code>ArrayBuffer</code> كما هو محدد في <a href="https://tc39.es/ecma262/#sec-detacharraybuffer" target="_blank" rel="noreferrer">القسم 24.1.1.3</a> من مواصفات لغة ECMAScript.</p><h3 id="napi_is_detached_arraybuffer" tabindex="-1">‏<code>napi_is_detached_arraybuffer</code> <a class="header-anchor" href="#napi_is_detached_arraybuffer" aria-label="Permalink to “‏napi_is_detached_arraybuffer”">​</a></h3><p><strong>تمت إضافته في: الإصدار v13.3.0، v12.16.0، v10.22.0</strong></p><p><strong>إصدار N-API: 7</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_detached_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                         napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>‏<code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) تحتها.</li><li>‏<code>[in] arraybuffer</code>: JavaScript ‏<code>ArrayBuffer</code> المراد فحصها.</li><li>‏<code>[out] result</code>: ما إذا كانت ‏<code>arraybuffer</code> مفصولة.</li></ul><p>إرجاع ‏<code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تعتبر ‏<code>ArrayBuffer</code> مفصولة إذا كانت بياناتها الداخلية ‏<code>null</code>.</p><p>تمثل واجهة برمجة التطبيقات (API) هذه استدعاء عملية ‏<code>IsDetachedBuffer</code> الخاصة بـ ‏<code>ArrayBuffer</code> كما هو محدد في <a href="https://tc39.es/ecma262/#sec-isdetachedbuffer" target="_blank" rel="noreferrer">القسم 24.1.1.2</a> من مواصفات لغة ECMAScript.</p><h2 id="working-with-javascript-properties" tabindex="-1">‏العمل مع خصائص JavaScript <a class="header-anchor" href="#working-with-javascript-properties" aria-label="Permalink to “‏العمل مع خصائص JavaScript”">​</a></h2><p>تعرض Node-API مجموعة من واجهات برمجة التطبيقات (APIs) للحصول على الخصائص وتعيينها في كائنات JavaScript. تم توثيق بعض هذه الأنواع ضمن <a href="https://tc39.github.io/ecma262/#sec-abstract-operations" target="_blank" rel="noreferrer">القسم 7</a> من <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">مواصفات لغة ECMAScript</a>.</p><p>يتم تمثيل الخصائص في JavaScript على أنها مجموعة من مفتاح وقيمة. بشكل أساسي، يمكن تمثيل جميع مفاتيح الخصائص في Node-API في أحد الأشكال التالية:</p><ul><li>‏باسم: سلسلة UTF8 بسيطة ومشفرة</li><li>‏مفهرسة بالأعداد الصحيحة: قيمة فهرس ممثلة بـ ‏<code>uint32_t</code></li><li>‏قيمة JavaScript: يتم تمثيلها في Node-API بواسطة ‏<code>napi_value</code>. يمكن أن تكون هذه ‏<code>napi_value</code> تمثل ‏<code>string</code> أو ‏<code>number</code> أو ‏<code>symbol</code>.</li></ul><p>يتم تمثيل قيم Node-API بواسطة النوع ‏<code>napi_value</code>. أي استدعاء Node-API يتطلب قيمة JavaScript يأخذ ‏<code>napi_value</code>. ومع ذلك، تقع على عاتق المتصل مسؤولية التأكد من أن ‏<code>napi_value</code> المعنية هي من نوع JavaScript الذي تتوقعه واجهة برمجة التطبيقات (API).</p><p>توفر واجهات برمجة التطبيقات (APIs) الموثقة في هذا القسم واجهة بسيطة للحصول على الخصائص وتعيينها في كائنات JavaScript عشوائية ممثلة بـ ‏<code>napi_value</code>.</p><p>على سبيل المثال، ضع في اعتبارك مقتطف كود JavaScript التالي:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj.myProp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>يمكن القيام بالمكافئ باستخدام قيم Node-API مع مقتطف الكود التالي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_generic_failure;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const obj = {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value obj, value;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">obj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Create a napi_value for 123</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// obj.myProp = 123</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, obj, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;myProp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, value);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>يمكن تعيين الخصائص المفهرسة بطريقة مماثلة. ضع في اعتبارك مقتطف كود JavaScript التالي:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> arr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">arr[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>يمكن القيام بالمكافئ باستخدام قيم Node-API مع مقتطف الكود التالي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_generic_failure;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const arr = [];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value arr, value;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Create a napi_value for &#39;hello&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_string_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, NAPI_AUTO_LENGTH, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// arr[123] = &#39;hello&#39;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, arr, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, value);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>يمكن استرداد الخصائص باستخدام واجهات برمجة التطبيقات (APIs) الموضحة في هذا القسم. ضع في اعتبارك مقتطف كود JavaScript التالي:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> arr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>فيما يلي المكافئ التقريبي لنظيره Node-API:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_generic_failure;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const arr = []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value arr, value;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const value = arr[123]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, arr, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>أخيرًا، يمكن أيضًا تحديد خصائص متعددة في كائن واحد لأسباب تتعلق بالأداء. ضع في اعتبارك JavaScript التالي:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Object.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">defineProperties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obj, {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;foo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { value: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, writable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, configurable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, enumerable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;bar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { value: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, writable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, configurable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, enumerable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>فيما يلي المكافئ التقريبي لنظيره Node-API:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_status_generic_failure;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const obj = {};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value obj;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">obj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Create napi_values for 123 and 456</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value fooValue, barValue;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fooValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">barValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Set the properties</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_property_descriptor descriptors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fooValue, napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_configurable, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, barValue, napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_configurable, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_define_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                obj,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(descriptors) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">descriptors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                descriptors);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="structures" tabindex="-1">هياكل البيانات <a class="header-anchor" href="#structures" aria-label="Permalink to “هياكل البيانات”">​</a></h3><h4 id="napi_property_attributes" tabindex="-1"><code>napi_property_attributes</code> <a class="header-anchor" href="#napi_property_attributes" aria-label="Permalink to “napi_property_attributes”">​</a></h4><div class="info custom-block"><p class="custom-block-title">[السجل]</p><table tabindex="0"><thead><tr><th>الإصدار</th><th>التغييرات</th></tr></thead><tbody><tr><td>v14.12.0</td><td>تمت إضافة <code>napi_default_method</code> و <code>napi_default_property</code>.</td></tr></tbody></table></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_default </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_enumerable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_configurable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // يستخدم مع napi_define_class للتمييز بين الخصائص الثابتة</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // من خصائص المثيل. يتم تجاهله بواسطة napi_define_properties.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_static </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // الافتراضي لطرق الفئة.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_default_method </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_configurable,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // الافتراضي لخصائص الكائن، كما في JS obj[prop].</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_default_jsproperty </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                          napi_enumerable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                          napi_configurable,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_property_attributes;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><code>napi_property_attributes</code> هي علامات تُستخدم للتحكم في سلوك الخصائص المعينة على كائن JavaScript. باستثناء <code>napi_static</code> فإنها تتوافق مع السمات المذكورة في <a href="https://tc39.github.io/ecma262/#table-2" target="_blank" rel="noreferrer">القسم 6.1.7.1</a> من <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">مواصفات لغة ECMAScript</a>. يمكن أن تكون علامة واحدة أو أكثر من العلامات التالية:</p><ul><li><code>napi_default</code>: لم يتم تعيين أي سمات صريحة على الخاصية. بشكل افتراضي، تكون الخاصية للقراءة فقط، وغير قابلة للتعداد وغير قابلة للتهيئة.</li><li><code>napi_writable</code>: الخاصية قابلة للكتابة.</li><li><code>napi_enumerable</code>: الخاصية قابلة للتعداد.</li><li><code>napi_configurable</code>: الخاصية قابلة للتهيئة كما هو محدد في <a href="https://tc39.github.io/ecma262/#table-2" target="_blank" rel="noreferrer">القسم 6.1.7.1</a> من <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">مواصفات لغة ECMAScript</a>.</li><li><code>napi_static</code>: سيتم تعريف الخاصية كخاصية ثابتة في فئة بدلاً من خاصية مثيل، وهو الإعداد الافتراضي. يتم استخدامه فقط بواسطة <a href="/ar/nodejs/api/n-api#napi-define-class"><code>napi_define_class</code></a>. يتم تجاهله بواسطة <code>napi_define_properties</code>.</li><li><code>napi_default_method</code>: مثل الطريقة في فئة JS، تكون الخاصية قابلة للتهيئة وقابلة للكتابة، ولكنها غير قابلة للتعداد.</li><li><code>napi_default_jsproperty</code>: مثل خاصية تم تعيينها عبر التعيين في JavaScript، تكون الخاصية قابلة للكتابة وقابلة للتعداد وقابلة للتهيئة.</li></ul><h4 id="napi_property_descriptor" tabindex="-1"><code>napi_property_descriptor</code> <a class="header-anchor" href="#napi_property_descriptor" aria-label="Permalink to “napi_property_descriptor”">​</a></h4><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // One of utf8name or name should be NULL.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> utf8name;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value name;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_callback method;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_callback getter;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_callback setter;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value value;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_property_attributes attributes;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_property_descriptor;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li><code>utf8name</code>: سلسلة اختيارية تصف المفتاح الخاصية، مرمزة بـ UTF8. يجب توفير إما <code>utf8name</code> أو <code>name</code> للخاصية.</li><li><code>name</code>: <code>napi_value</code> اختيارية تشير إلى سلسلة JavaScript أو رمز ليتم استخدامه كمفتاح للخاصية. يجب توفير إما <code>utf8name</code> أو <code>name</code> للخاصية.</li><li><code>value</code>: القيمة التي يتم استرجاعها عن طريق الوصول إلى الخاصية إذا كانت الخاصية خاصية بيانات. إذا تم تمرير هذا، اضبط <code>getter</code> و <code>setter</code> و <code>method</code> و <code>data</code> على <code>NULL</code> (لأن هذه الأعضاء لن يتم استخدامها).</li><li><code>getter</code>: دالة يتم استدعاؤها عند إجراء الوصول إلى الخاصية. إذا تم تمرير هذا، اضبط <code>value</code> و <code>method</code> على <code>NULL</code> (لأن هذه الأعضاء لن يتم استخدامها). يتم استدعاء الدالة المحددة ضمنيًا بواسطة وقت التشغيل عندما يتم الوصول إلى الخاصية من كود JavaScript (أو إذا تم إجراء الحصول على الخاصية باستخدام استدعاء Node-API). <a href="/ar/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a> يوفر مزيدًا من التفاصيل.</li><li><code>setter</code>: دالة يتم استدعاؤها عند إجراء تعيين للوصول إلى الخاصية. إذا تم تمرير هذا، اضبط <code>value</code> و <code>method</code> على <code>NULL</code> (لأن هذه الأعضاء لن يتم استخدامها). يتم استدعاء الدالة المحددة ضمنيًا بواسطة وقت التشغيل عندما يتم تعيين الخاصية من كود JavaScript (أو إذا تم إجراء تعيين على الخاصية باستخدام استدعاء Node-API). <a href="/ar/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a> يوفر مزيدًا من التفاصيل.</li><li><code>method</code>: قم بتعيين هذا لجعل الخاصية <code>value</code> الخاصة بكائن واصف الخاصية دالة JavaScript تمثلها <code>method</code>. إذا تم تمرير هذا، اضبط <code>value</code> و <code>getter</code> و <code>setter</code> على <code>NULL</code> (لأن هذه الأعضاء لن يتم استخدامها). <a href="/ar/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a> يوفر مزيدًا من التفاصيل.</li><li><code>attributes</code>: السمات المرتبطة بالخاصية المعينة. انظر <a href="/ar/nodejs/api/n-api#napi-property-attributes"><code>napi_property_attributes</code></a>.</li><li><code>data</code>: بيانات الاستدعاء التي يتم تمريرها إلى <code>method</code> و <code>getter</code> و <code>setter</code> إذا تم استدعاء هذه الدالة.</li></ul><h3 id="functions" tabindex="-1">الدوال <a class="header-anchor" href="#functions" aria-label="Permalink to “الدوال”">​</a></h3><h4 id="napi_get_property_names" tabindex="-1"><code>napi_get_property_names</code> <a class="header-anchor" href="#napi_get_property_names" aria-label="Permalink to “napi_get_property_names”">​</a></h4><p><strong>أضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_property_names</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء استدعاء Node-API تحتها.</li><li><code>[in] object</code>: الكائن الذي سيتم استرداد الخصائص منه.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل مصفوفة من قيم JavaScript التي تمثل أسماء خصائص الكائن. يمكن استخدام واجهة برمجة التطبيقات للتكرار على <code>result</code> باستخدام <a href="/ar/nodejs/api/n-api#napi-get-array-length"><code>napi_get_array_length</code></a> و <a href="/ar/nodejs/api/n-api#napi-get-element"><code>napi_get_element</code></a>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات.</p><p>تعيد واجهة برمجة التطبيقات هذه أسماء الخصائص القابلة للتعداد لـ <code>object</code> كمصفوفة من السلاسل. لن يتم تضمين خصائص <code>object</code> التي يكون مفتاحها رمزًا.</p><h4 id="napi_get_all_property_names" tabindex="-1"><code>napi_get_all_property_names</code> <a class="header-anchor" href="#napi_get_all_property_names" aria-label="Permalink to “napi_get_all_property_names”">​</a></h4><p><strong>أضيف في: الإصدار 13.7.0, v12.17.0, v10.20.0</strong></p><p><strong>إصدار N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_all_property_names</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_key_collection_mode </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key_mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_key_filter </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key_filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_key_conversion </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key_conversion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء استدعاء Node-API تحتها.</li><li><code>[in] object</code>: الكائن الذي سيتم استرداد الخصائص منه.</li><li><code>[in] key_mode</code>: ما إذا كان سيتم استرداد خصائص النموذج الأولي أيضًا.</li><li><code>[in] key_filter</code>: الخصائص التي سيتم استردادها (قابلة للتعداد/قابلة للقراءة/قابلة للكتابة).</li><li><code>[in] key_conversion</code>: ما إذا كان سيتم تحويل مفاتيح الخصائص المرقمة إلى سلاسل.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل مصفوفة من قيم JavaScript التي تمثل أسماء خصائص الكائن. يمكن استخدام <a href="/ar/nodejs/api/n-api#napi-get-array-length"><code>napi_get_array_length</code></a> و <a href="/ar/nodejs/api/n-api#napi-get-element"><code>napi_get_element</code></a> للتكرار على <code>result</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات.</p><p>تعيد واجهة برمجة التطبيقات هذه مصفوفة تحتوي على أسماء الخصائص المتاحة لهذا الكائن.</p><h4 id="napi_set_property" tabindex="-1"><code>napi_set_property</code> <a class="header-anchor" href="#napi_set_property" aria-label="Permalink to “napi_set_property”">​</a></h4><p><strong>أضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_set_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء استدعاء Node-API تحتها.</li><li><code>[in] object</code>: الكائن المراد تعيين الخاصية عليه.</li><li><code>[in] key</code>: اسم الخاصية المراد تعيينها.</li><li><code>[in] value</code>: قيمة الخاصية.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>تعيين واجهة برمجة التطبيقات (API) هذه خاصية على <code>Object</code> التي تم تمريرها.</p><h4 id="napi_get_property" tabindex="-1"><code>napi_get_property</code> <a class="header-anchor" href="#napi_get_property" aria-label="Permalink to “napi_get_property”">​</a></h4><p><strong>أضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء استدعاء Node-API تحتها.</li><li><code>[in] object</code>: الكائن المراد استرداد الخاصية منه.</li><li><code>[in] key</code>: اسم الخاصية المراد استردادها.</li><li><code>[out] result</code>: قيمة الخاصية.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>تحصل واجهة برمجة التطبيقات (API) هذه على الخاصية المطلوبة من <code>Object</code> التي تم تمريرها.</p><h4 id="napi_has_property" tabindex="-1"><code>napi_has_property</code> <a class="header-anchor" href="#napi_has_property" aria-label="Permalink to “napi_has_property”">​</a></h4><p><strong>أضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_has_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء استدعاء Node-API تحتها.</li><li><code>[in] object</code>: الكائن المراد الاستعلام عنه.</li><li><code>[in] key</code>: اسم الخاصية المراد التحقق من وجودها.</li><li><code>[out] result</code>: ما إذا كانت الخاصية موجودة على الكائن أم لا.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>تتحقق واجهة برمجة التطبيقات (API) هذه مما إذا كان <code>Object</code> الذي تم تمريره يحتوي على الخاصية المسماة.</p><h4 id="napi_delete_property" tabindex="-1"><code>napi_delete_property</code> <a class="header-anchor" href="#napi_delete_property" aria-label="Permalink to “napi_delete_property”">​</a></h4><p><strong>أضيف في: v8.2.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_delete_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء استدعاء Node-API تحتها.</li><li><code>[in] object</code>: الكائن المراد الاستعلام عنه.</li><li><code>[in] key</code>: اسم الخاصية المراد حذفها.</li><li><code>[out] result</code>: ما إذا نجح حذف الخاصية أم لا. يمكن تجاهل <code>result</code> اختياريًا عن طريق تمرير <code>NULL</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>تحاول واجهة برمجة التطبيقات (API) هذه حذف الخاصية الخاصة <code>key</code> من <code>object</code>.</p><h4 id="napi_has_own_property" tabindex="-1"><code>napi_has_own_property</code> <a class="header-anchor" href="#napi_has_own_property" aria-label="Permalink to “napi_has_own_property”">​</a></h4><p><strong>أُضيف في: الإصدار 8.2.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_has_own_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                  bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء استدعاء Node-API ضمنها.</li><li><code>[in] object</code>: الكائن المراد الاستعلام عنه.</li><li><code>[in] key</code>: اسم الخاصية الخاصة المراد التحقق من وجودها.</li><li><code>[out] result</code>: ما إذا كانت الخاصية الخاصة موجودة في الكائن أم لا.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>تتحقق واجهة برمجة التطبيقات (API) هذه مما إذا كان <code>Object</code> الذي تم تمريره يحتوي على الخاصية الخاصة المسماة. يجب أن يكون <code>key</code> إما <code>string</code> أو <code>symbol</code>، وإلا سيتم طرح خطأ. لن تقوم Node-API بإجراء أي تحويل بين أنواع البيانات.</p><h4 id="napi_set_named_property" tabindex="-1"><code>napi_set_named_property</code> <a class="header-anchor" href="#napi_set_named_property" aria-label="Permalink to “napi_set_named_property”">​</a></h4><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء استدعاء Node-API ضمنها.</li><li><code>[in] object</code>: الكائن المراد تعيين الخاصية عليه.</li><li><code>[in] utf8Name</code>: اسم الخاصية المراد تعيينها.</li><li><code>[in] value</code>: قيمة الخاصية.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>هذه الطريقة مكافئة لاستدعاء <a href="/ar/nodejs/api/n-api#napi-set-property"><code>napi_set_property</code></a> مع <code>napi_value</code> تم إنشاؤه من السلسلة التي تم تمريرها كـ <code>utf8Name</code>.</p><h4 id="napi_get_named_property" tabindex="-1"><code>napi_get_named_property</code> <a class="header-anchor" href="#napi_get_named_property" aria-label="Permalink to “napi_get_named_property”">​</a></h4><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء استدعاء Node-API ضمنها.</li><li><code>[in] object</code>: الكائن المراد استرداد الخاصية منه.</li><li><code>[in] utf8Name</code>: اسم الخاصية المراد الحصول عليها.</li><li><code>[out] result</code>: قيمة الخاصية.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>هذه الطريقة مكافئة لاستدعاء <a href="/ar/nodejs/api/n-api#napi-get-property"><code>napi_get_property</code></a> مع <code>napi_value</code> تم إنشاؤه من السلسلة التي تم تمريرها كـ <code>utf8Name</code>.</p><h4 id="napi_has_named_property" tabindex="-1"><code>napi_has_named_property</code> <a class="header-anchor" href="#napi_has_named_property" aria-label="Permalink to “napi_has_named_property”">​</a></h4><p><strong>تمت الإضافة في: الإصدار v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_has_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء Node-API تحتها.</li><li><code>[in] object</code>: الكائن المراد الاستعلام عنه.</li><li><code>[in] utf8Name</code>: اسم الخاصية التي يتم التحقق من وجودها.</li><li><code>[out] result</code>: ما إذا كانت الخاصية موجودة في الكائن أم لا.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>هذه الطريقة تعادل استدعاء <a href="/ar/nodejs/api/n-api#napi-has-property"><code>napi_has_property</code></a> مع <code>napi_value</code> تم إنشاؤه من السلسلة التي تم تمريرها كـ <code>utf8Name</code>.</p><h4 id="napi_set_element" tabindex="-1"><code>napi_set_element</code> <a class="header-anchor" href="#napi_set_element" aria-label="Permalink to “napi_set_element”">​</a></h4><p><strong>تمت الإضافة في: الإصدار v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_set_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء Node-API تحتها.</li><li><code>[in] object</code>: الكائن الذي سيتم تعيين الخصائص منه.</li><li><code>[in] index</code>: فهرس الخاصية المراد تعيينها.</li><li><code>[in] value</code>: قيمة الخاصية.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات هذه بتعيين عنصر على <code>Object</code> الذي تم تمريره.</p><h4 id="napi_get_element" tabindex="-1"><code>napi_get_element</code> <a class="header-anchor" href="#napi_get_element" aria-label="Permalink to “napi_get_element”">​</a></h4><p><strong>تمت الإضافة في: الإصدار v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء Node-API تحتها.</li><li><code>[in] object</code>: الكائن الذي سيتم استرداد الخاصية منه.</li><li><code>[in] index</code>: فهرس الخاصية المراد الحصول عليها.</li><li><code>[out] result</code>: قيمة الخاصية.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>تحصل واجهة برمجة التطبيقات هذه على العنصر في الفهرس المطلوب.</p><h4 id="napi_has_element" tabindex="-1"><code>napi_has_element</code> <a class="header-anchor" href="#napi_has_element" aria-label="Permalink to “napi_has_element”">​</a></h4><p><strong>تمت الإضافة في: الإصدار v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_has_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء Node-API تحتها.</li><li><code>[in] object</code>: الكائن المراد الاستعلام عنه.</li><li><code>[in] index</code>: فهرس الخاصية التي يتم التحقق من وجودها.</li><li><code>[out] result</code>: ما إذا كانت الخاصية موجودة في الكائن أم لا.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>تُرجع واجهة برمجة التطبيقات هذه ما إذا كان <code>Object</code> الذي تم تمريره يحتوي على عنصر في الفهرس المطلوب.</p><h4 id="napi_delete_element" tabindex="-1"><code>napi_delete_element</code> <a class="header-anchor" href="#napi_delete_element" aria-label="Permalink to “napi_delete_element”">​</a></h4><p><strong>تمت الإضافة في: v8.2.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_delete_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم فيها استدعاء استدعاء Node-API.</li><li><code>[in] object</code>: الكائن المراد الاستعلام عنه.</li><li><code>[in] index</code>: فهرس الخاصية المراد حذفها.</li><li><code>[out] result</code>: ما إذا كان حذف العنصر قد نجح أم لا. يمكن تجاهل <code>result</code> اختياريًا بتمرير <code>NULL</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>تحاول واجهة برمجة التطبيقات (API) هذه حذف <code>index</code> المحدد من <code>object</code>.</p><h4 id="napi_define_properties" tabindex="-1"><code>napi_define_properties</code> <a class="header-anchor" href="#napi_define_properties" aria-label="Permalink to “napi_define_properties”">​</a></h4><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_define_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> property_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_property_descriptor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم فيها استدعاء استدعاء Node-API.</li><li><code>[in] object</code>: الكائن المراد استرداد الخصائص منه.</li><li><code>[in] property_count</code>: عدد العناصر في مصفوفة <code>properties</code>.</li><li><code>[in] properties</code>: مصفوفة واصفات الخصائص.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>تسمح هذه الطريقة بالتعريف الفعال لخصائص متعددة على كائن معين. يتم تعريف الخصائص باستخدام واصفات الخصائص (راجع <a href="/ar/nodejs/api/n-api#napi-property-descriptor"><code>napi_property_descriptor</code></a>). نظرًا لوجود مصفوفة من واصفات الخصائص هذه، ستعين واجهة برمجة التطبيقات (API) هذه الخصائص على الكائن واحدًا تلو الآخر، كما هو محدد بواسطة <code>DefineOwnProperty()</code> (الموصوف في <a href="https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots-defineownproperty-p-desc" target="_blank" rel="noreferrer">القسم 9.1.6</a> من مواصفات ECMA-262).</p><h4 id="napi_object_freeze" tabindex="-1"><code>napi_object_freeze</code> <a class="header-anchor" href="#napi_object_freeze" aria-label="Permalink to “napi_object_freeze”">​</a></h4><p><strong>تمت الإضافة في: v14.14.0, v12.20.0</strong></p><p><strong>إصدار N-API: 8</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_object_freeze</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم فيها استدعاء استدعاء Node-API.</li><li><code>[in] object</code>: الكائن المراد تجميده.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح واجهة برمجة التطبيقات (API).</p><p>تجمد هذه الطريقة كائنًا معينًا. يمنع هذا إضافة خصائص جديدة إليه، ويمنع إزالة الخصائص الحالية، ويمنع تغيير إمكانية التعداد أو القابلية للتكوين أو القابلية للكتابة للخصائص الحالية، ويمنع تغيير قيم الخصائص الحالية. كما يمنع تغيير النموذج الأولي للكائن. تم وصف هذا في <a href="https://tc39.es/ecma262/#sec-object.freeze" target="_blank" rel="noreferrer">القسم 19.1.2.6</a> من مواصفات ECMA-262.</p><h4 id="napi_object_seal" tabindex="-1">‏<code>napi_object_seal</code> <a class="header-anchor" href="#napi_object_seal" aria-label="Permalink to “‏napi_object_seal”">​</a></h4><p><strong>تمت الإضافة في: v14.14.0، v12.20.0</strong></p><p><strong>إصدار N-API: 8</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_object_seal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء استدعاء Node-API ضمنها.</li><li><code>[in] object</code>: الكائن المراد إغلاقه.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح API.</p><p>تقوم هذه الطريقة بإغلاق كائن معين. يمنع هذا إضافة خصائص جديدة إليه، بالإضافة إلى تعليم جميع الخصائص الموجودة على أنها غير قابلة للتكوين. تم وصف ذلك في <a href="https://tc39.es/ecma262/#sec-object.seal" target="_blank" rel="noreferrer">القسم 19.1.2.20</a> من مواصفات ECMA-262.</p><h2 id="working-with-javascript-functions" tabindex="-1">‏العمل مع وظائف JavaScript <a class="header-anchor" href="#working-with-javascript-functions" aria-label="Permalink to “‏العمل مع وظائف JavaScript”">​</a></h2><p>يوفر Node-API مجموعة من واجهات برمجة التطبيقات التي تسمح لرمز JavaScript بالرجوع إلى الكود الأصلي. تستقبل Node-APIs التي تدعم معاودة الاتصال إلى الكود الأصلي وظائف معاودة الاتصال ممثلة بنوع <code>napi_callback</code>. عندما تقوم JavaScript VM بالرجوع إلى الكود الأصلي، يتم استدعاء دالة <code>napi_callback</code> المتوفرة. تسمح واجهات برمجة التطبيقات الموثقة في هذا القسم لدالة معاودة الاتصال بما يلي:</p><ul><li>الحصول على معلومات حول السياق الذي تم استدعاء معاودة الاتصال فيه.</li><li>الحصول على الوسائط التي تم تمريرها إلى معاودة الاتصال.</li><li>إرجاع <code>napi_value</code> من معاودة الاتصال.</li></ul><p>بالإضافة إلى ذلك، يوفر Node-API مجموعة من الوظائف التي تسمح باستدعاء وظائف JavaScript من الكود الأصلي. يمكن للمرء إما استدعاء دالة مثل استدعاء دالة JavaScript عادية، أو كوظيفة إنشاء.</p><p>يمكن ربط أي بيانات غير <code>NULL</code> يتم تمريرها إلى واجهة برمجة التطبيقات هذه عبر حقل <code>data</code> لعناصر <code>napi_property_descriptor</code> بـ <code>object</code> وتحريرها كلما تم جمع <code>object</code> بواسطة القمامة عن طريق تمرير كل من <code>object</code> والبيانات إلى <a href="/ar/nodejs/api/n-api#napi-add-finalizer"><code>napi_add_finalizer</code></a>.</p><h3 id="napi_call_function" tabindex="-1">‏<code>napi_call_function</code> <a class="header-anchor" href="#napi_call_function" aria-label="Permalink to “‏napi_call_function”">​</a></h3><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_call_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">recv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                           size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                           const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] recv</code>: قيمة <code>this</code> التي تم تمريرها إلى الدالة التي تم استدعاؤها.</li><li><code>[in] func</code>: <code>napi_value</code> تمثل دالة JavaScript المراد استدعاؤها.</li><li><code>[in] argc</code>: عدد العناصر في مصفوفة <code>argv</code>.</li><li><code>[in] argv</code>: مصفوفة من <code>napi_values</code> تمثل قيم JavaScript التي تم تمريرها كوسائط إلى الدالة.</li><li><code>[out] result</code>: <code>napi_value</code> تمثل كائن JavaScript الذي تم إرجاعه.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح API.</p><p>تسمح هذه الطريقة باستدعاء كائن دالة JavaScript من إضافة أصلية. هذه هي الآلية الأساسية لمعاودة الاتصال <em>من</em> الكود الأصلي للإضافة <em>إلى</em> JavaScript. للحالة الخاصة بالاستدعاء إلى JavaScript بعد عملية غير متزامنة، راجع <a href="/ar/nodejs/api/n-api#napi-make-callback"><code>napi_make_callback</code></a>.</p><p>قد تبدو حالة الاستخدام النموذجية كما يلي. ضع في اعتبارك مقتطف JavaScript التالي:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AddTwo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">num</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> num </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">global.AddTwo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AddTwo;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>بعد ذلك، يمكن استدعاء الدالة المذكورة أعلاه من إضافة أصلية باستخدام الكود التالي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Get the function named &quot;AddTwo&quot; on the global object</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value global, add_two, arg;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, global, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AddTwo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">add_two</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const arg = 1337</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1337</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">arg;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// AddTwo(arg);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value return_val;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_call_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, global, add_two, argc, argv, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">return_val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Convert the result back to a native type</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_value_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, return_val, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="napi_create_function" tabindex="-1">‏<code>napi_create_function</code> <a class="header-anchor" href="#napi_create_function" aria-label="Permalink to “‏napi_create_function”">​</a></h3><p><strong>تمت الإضافة في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_callback </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>‏<code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li>‏<code>[in] utf8Name</code>: اسم اختياري للدالة مشفر بصيغة UTF8. يظهر هذا داخل JavaScript كخاصية <code>name</code> لكائن الدالة الجديد.</li><li>‏<code>[in] length</code>: طول <code>utf8name</code> بالبايت، أو <code>NAPI_AUTO_LENGTH</code> إذا كان منتهيًا بقيمة خالية.</li><li>‏<code>[in] cb</code>: الدالة الأصلية التي يجب استدعاؤها عند استدعاء كائن هذه الدالة. يوفر <a href="/ar/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a> مزيدًا من التفاصيل.</li><li>‏<code>[in] data</code>: سياق بيانات مقدم من المستخدم. سيتم تمرير هذا مرة أخرى إلى الدالة عند استدعائها لاحقًا.</li><li>‏<code>[out] result</code>: ‏<code>napi_value</code> يمثل كائن دالة JavaScript للدالة التي تم إنشاؤها حديثًا.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تسمح واجهة برمجة التطبيقات (API) هذه لمؤلف الوظيفة الإضافية بإنشاء كائن دالة في التعليمات البرمجية الأصلية. هذه هي الآلية الأساسية للسماح بالاتصال <em>بالتعليمات البرمجية الأصلية</em> للوظيفة الإضافية <em>من</em> JavaScript.</p><p>الدالة التي تم إنشاؤها حديثًا ليست مرئية تلقائيًا من البرنامج النصي بعد هذا الاستدعاء. بدلاً من ذلك، يجب تعيين خاصية بشكل صريح على أي كائن مرئي لـ JavaScript، حتى يمكن الوصول إلى الدالة من البرنامج النصي.</p><p>لعرض دالة كجزء من عمليات تصدير وحدة الوظيفة الإضافية، قم بتعيين الدالة التي تم إنشاؤها حديثًا على كائن عمليات التصدير. قد تبدو وحدة نموذجية كما يلي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SayHello</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hello</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value fn;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, SayHello, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fn);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, exports, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sayHello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fn);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> exports;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAPI_MODULE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NODE_GYP_MODULE_NAME, Init)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>بالنظر إلى التعليمات البرمجية أعلاه، يمكن استخدام الوظيفة الإضافية من JavaScript كما يلي:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> myaddon</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./addon&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">myaddon.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sayHello</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>السلسلة التي تم تمريرها إلى <code>require()</code> هي اسم الهدف في <code>binding.gyp</code> المسؤول عن إنشاء ملف <code>.node</code>.</p><p>يمكن ربط أي بيانات غير <code>NULL</code> يتم تمريرها إلى واجهة برمجة التطبيقات (API) هذه عبر معلمة <code>data</code> بدالة JavaScript الناتجة (التي يتم إرجاعها في معلمة <code>result</code>) وتحريرها متى تم جمع البيانات المهملة للدالة عن طريق تمرير كل من دالة JavaScript والبيانات إلى <a href="/ar/nodejs/api/n-api#napi-add-finalizer"><code>napi_add_finalizer</code></a>.</p><p>يتم وصف <code>Function</code>s في JavaScript في <a href="https://tc39.github.io/ecma262/#sec-function-objects" target="_blank" rel="noreferrer">القسم 19.2</a> من مواصفات لغة ECMAScript.</p><h3 id="napi_get_cb_info" tabindex="-1"><code>napi_get_cb_info</code> <a class="header-anchor" href="#napi_get_cb_info" aria-label="Permalink to “napi_get_cb_info”">​</a></h3><p><strong>تمت الإضافة في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_cb_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cbinfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> thisArg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] cbinfo</code>: معلومات الاستدعاء التي تم تمريرها إلى دالة الاستدعاء.</li><li><code>[in-out] argc</code>: يحدد طول مصفوفة <code>argv</code> المتوفرة ويتلقى العدد الفعلي للوسائط. يمكن تجاهل <code>argc</code> اختياريًا عن طريق تمرير <code>NULL</code>.</li><li><code>[out] argv</code>: مصفوفة C من <code>napi_value</code> سيتم نسخ الوسائط إليها. إذا كان هناك وسائط أكثر من العدد المتوفر، فسيتم نسخ العدد المطلوب فقط من الوسائط. إذا كان هناك عدد أقل من الوسائط المتوفرة من العدد المطالب به، فسيتم ملء بقية <code>argv</code> بقيم <code>napi_value</code> تمثل <code>undefined</code>. يمكن تجاهل <code>argv</code> اختياريًا عن طريق تمرير <code>NULL</code>.</li><li><code>[out] thisArg</code>: يتلقى وسيطة JavaScript <code>this</code> للمكالمة. يمكن تجاهل <code>thisArg</code> اختياريًا عن طريق تمرير <code>NULL</code>.</li><li><code>[out] data</code>: يتلقى مؤشر البيانات للاستدعاء. يمكن تجاهل <code>data</code> اختياريًا عن طريق تمرير <code>NULL</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يتم استخدام هذه الطريقة داخل دالة استدعاء لاسترداد تفاصيل حول المكالمة مثل الوسائط ومؤشر <code>this</code> من معلومات استدعاء معينة.</p><h3 id="napi_get_new_target" tabindex="-1"><code>napi_get_new_target</code> <a class="header-anchor" href="#napi_get_new_target" aria-label="Permalink to “napi_get_new_target”">​</a></h3><p><strong>تمت الإضافة في: v8.6.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_new_target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cbinfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] cbinfo</code>: معلومات الاستدعاء التي تم تمريرها إلى دالة الاستدعاء.</li><li><code>[out] result</code>: <code>new.target</code> لمكالمة المُنشئ.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يعيد هذا API <code>new.target</code> لمكالمة المُنشئ. إذا لم يكن الاستدعاء الحالي مكالمة مُنشئ، فإن النتيجة هي <code>NULL</code>.</p><h3 id="napi_new_instance" tabindex="-1">‏<code>napi_new_instance</code> <a class="header-anchor" href="#napi_new_instance" aria-label="Permalink to “‏napi_new_instance”">​</a></h3><p><strong>تمت إضافته في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_new_instance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cons</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>‏<code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) تحتها.</li><li>‏<code>[in] cons</code>: ‏<code>napi_value</code> يمثل دالة JavaScript المراد استدعاؤها كمنشئ.</li><li>‏<code>[in] argc</code>: عدد العناصر الموجودة في مصفوفة ‏<code>argv</code>.</li><li>‏<code>[in] argv</code>: مصفوفة من قيم JavaScript كـ ‏<code>napi_value</code> تمثل وسيطات المنشئ. إذا كان ‏<code>argc</code> يساوي صفرًا، فيمكن حذف هذه المعلمة عن طريق تمرير ‏<code>NULL</code>.</li><li>‏<code>[out] result</code>: ‏<code>napi_value</code> يمثل كائن JavaScript الذي تم إرجاعه، والذي في هذه الحالة هو الكائن الذي تم إنشاؤه.</li></ul><p>تُستخدم هذه الطريقة لإنشاء قيمة JavaScript جديدة باستخدام ‏<code>napi_value</code> معطى يمثل المنشئ للكائن. على سبيل المثال، ضع في اعتبارك المقتطف التالي:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.param </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> param;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> arg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arg);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>يمكن تقريب ما يلي في Node-API باستخدام المقتطف التالي:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// احصل على دالة المنشئ MyObject</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value global, constructor, arg, value;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, global, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyObject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const arg = &quot;hello&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_string_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, NAPI_AUTO_LENGTH, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">arg;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const value = new MyObject(arg)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_new_instance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, constructor, argc, argv, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>إرجاع ‏<code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><h2 id="object-wrap" tabindex="-1">التفاف الكائن <a class="header-anchor" href="#object-wrap" aria-label="Permalink to “التفاف الكائن”">​</a></h2><p>يوفر Node-API طريقة &quot;لتغليف&quot; فئات C++ ومثيلاتها بحيث يمكن استدعاء مُنشئ الفئة وطرقها من JavaScript.</p><p>بالنسبة للكائنات المغلفة، قد يكون من الصعب التمييز بين دالة يتم استدعاؤها على نموذج أولي للفئة ودالة يتم استدعاؤها على مثيل لفئة. أحد الأنماط الشائعة المستخدمة لمعالجة هذه المشكلة هو حفظ مرجع دائم لمنشئ الفئة لفحوصات ‏<code>instanceof</code> اللاحقة.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value MyClass_constructor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_reference_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, MyClass::es_constructor, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">MyClass_constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_ok </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> is_instance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_instanceof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, es_this, MyClass_constructor, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">is_instance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_ok </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (is_instance) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // napi_unwrap() ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // خلاف ذلك...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>يجب تحرير المرجع بمجرد عدم الحاجة إليه.</p><p>هناك مناسبات تكون فيها ‏<code>napi_instanceof()</code> غير كافية لضمان أن كائن JavaScript هو غلاف لنوع أصلي معين. هذا هو الحال بشكل خاص عندما يتم تمرير كائنات JavaScript المغلفة مرة أخرى إلى الوظيفة الإضافية عبر طرق ثابتة بدلاً من قيمة ‏<code>this</code> لطرق النموذج الأولي. في مثل هذه الحالات، هناك احتمال أن يتم فكها بشكل غير صحيح.</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> myAddon</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./build/Release/my_addon.node&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// تُرجع `openDatabase()` كائن JavaScript يقوم بتغليف مؤشر قاعدة بيانات أصلي.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> dbHandle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myAddon.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// تُرجع `query()` كائن JavaScript يقوم بتغليف مؤشر استعلام أصلي.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> queryHandle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myAddon.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dbHandle, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Gimme ALL the things!&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// يوجد خطأ غير مقصود في السطر أدناه. يجب أن تكون المعلمة الأولى لـ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// `myAddon.queryHasRecords()` هي مؤشر قاعدة البيانات (`dbHandle`)، وليس</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// مؤشر الاستعلام (`query`)، لذا يجب أن يكون الشرط الصحيح للحلقة while</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// myAddon.queryHasRecords(dbHandle, queryHandle)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (myAddon.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">queryHasRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(queryHandle, dbHandle)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // استرداد السجلات</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>في المثال أعلاه، ‏<code>myAddon.queryHasRecords()</code> هي طريقة تقبل وسيطتين. الأول هو مؤشر قاعدة بيانات والثاني هو مؤشر استعلام. داخليًا، تقوم بفك الوسيطة الأولى وإرسال المؤشر الناتج إلى مؤشر قاعدة بيانات أصلي. ثم تقوم بفك الوسيطة الثانية وإرسال المؤشر الناتج إلى مؤشر استعلام. إذا تم تمرير الوسيطات بترتيب خاطئ، فستعمل الإرسالات، ومع ذلك، هناك فرصة جيدة لفشل عملية قاعدة البيانات الأساسية، أو حتى التسبب في الوصول إلى ذاكرة غير صالح.</p><p>لضمان أن المؤشر الذي تم استرداده من الوسيطة الأولى هو بالفعل مؤشر إلى مؤشر قاعدة بيانات، وبالمثل، أن المؤشر الذي تم استرداده من الوسيطة الثانية هو بالفعل مؤشر إلى مؤشر استعلام، يجب أن ينفذ تنفيذ ‏<code>queryHasRecords()</code> التحقق من النوع. يمكن أن يساعد الاحتفاظ بمنشئ فئة JavaScript الذي تم إنشاء مؤشر قاعدة البيانات منه والمنشئ الذي تم إنشاء مؤشر الاستعلام منه في ‏<code>napi_ref</code>، لأنه يمكن بعد ذلك استخدام ‏<code>napi_instanceof()</code> لضمان أن المثيلات التي تم تمريرها إلى ‏<code>queryHashRecords()</code> هي بالفعل من النوع الصحيح.</p><p>لسوء الحظ، لا تحمي ‏<code>napi_instanceof()</code> من التلاعب بالنماذج الأولية. على سبيل المثال، يمكن تعيين النموذج الأولي لمثيل مؤشر قاعدة البيانات إلى النموذج الأولي لمنشئ مثيلات مؤشر الاستعلام. في هذه الحالة، يمكن أن يظهر مثيل مؤشر قاعدة البيانات كمثيل لمؤشر استعلام، وسيجتاز اختبار ‏<code>napi_instanceof()</code> لمثيل مؤشر استعلام، مع الاستمرار في احتواء مؤشر إلى مؤشر قاعدة بيانات.</p><p>لهذه الغاية، يوفر Node-API إمكانات وضع علامات على النوع.</p><p>علامة النوع هي عدد صحيح مكون من 128 بتًا فريدًا للوظيفة الإضافية. يوفر Node-API بنية ‏<code>napi_type_tag</code> لتخزين علامة النوع. عند تمرير هذه القيمة مع كائن JavaScript أو <a href="/ar/nodejs/api/n-api#napi-create-external">خارجي</a> مخزن في ‏<code>napi_value</code> إلى ‏<code>napi_type_tag_object()</code>، سيتم &quot;تأشير&quot; كائن JavaScript بعلامة النوع. العلامة &quot;غير مرئية&quot; على جانب JavaScript. عندما يصل كائن JavaScript إلى ربط أصلي، يمكن استخدام ‏<code>napi_check_object_type_tag()</code> مع علامة النوع الأصلية لتحديد ما إذا كان كائن JavaScript قد تم &quot;تأشيره&quot; مسبقًا بعلامة النوع. يؤدي هذا إلى إنشاء إمكانية فحص نوع بدقة أعلى مما يمكن أن توفره ‏<code>napi_instanceof()</code>، لأن وضع علامات النوع هذا ينجو من التلاعب بالنماذج الأولية وإلغاء تحميل/إعادة تحميل الوظيفة الإضافية.</p><p>استمرارًا للمثال أعلاه، يوضح تنفيذ الوظيفة الإضافية الهيكلية التالية استخدام ‏<code>napi_type_tag_object()</code> و ‏<code>napi_check_object_type_tag()</code>.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// هذه القيمة هي علامة النوع لمؤشر قاعدة بيانات. الأمر</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//   uuidgen | sed -r -e &#39;s/-//g&#39; -e &#39;s/(.{16})(.*)/0x\1, 0x\2/&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// يمكن استخدامه للحصول على القيمتين اللتين يتم بهما تهيئة البنية.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_type_tag DatabaseHandleTypeTag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1edf75a38336451d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">a5ed9ce2e4c00c38</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// هذه القيمة هي علامة النوع لمؤشر استعلام.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_type_tag QueryHandleTypeTag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9c73317f9fad44a3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">93c3920bf3b0ad6a</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_value</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value result;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // تنفيذ الإجراء الأساسي الذي ينتج عنه مؤشر قاعدة بيانات.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  DatabaseHandle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dbHandle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> open_database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // إنشاء كائن JS جديد فارغ.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // تأشير الكائن للإشارة إلى أنه يحمل مؤشرًا إلى `DatabaseHandle`.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_type_tag_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, result, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DatabaseHandleTypeTag);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // تخزين المؤشر إلى بنية `DatabaseHandle` داخل كائن JS.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_wrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, result, dbHandle, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// لاحقًا عندما نتلقى كائن JavaScript يزعم أنه مؤشر قاعدة بيانات</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// يمكننا استخدام `napi_check_object_type_tag()` للتأكد من أنه بالفعل كذلك</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// مؤشر.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_value</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  size_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> is_db_handle;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_cb_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, info, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">argc, argv, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // تحقق من أن الكائن الذي تم تمريره كمعلمة أولى لديه علامة تم تطبيقها مسبقًا.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_check_object_type_tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">                                      argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DatabaseHandleTypeTag,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_db_handle);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // اطرح `TypeError` إذا لم يكن كذلك.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_db_handle) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // اطرح TypeError.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><h3 id="napi_define_class" tabindex="-1"><code>napi_define_class</code> <a class="header-anchor" href="#napi_define_class" aria-label="Permalink to “napi_define_class”">​</a></h3><p><strong>أُضيف في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_define_class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_callback </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> property_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_property_descriptor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء الـ API تحتها.</li><li><code>[in] utf8name</code>: اسم دالة JavaScript البانية. للوضوح، يُوصى باستخدام اسم صنف C++ عند تغليف صنف C++.</li><li><code>[in] length</code>: طول <code>utf8name</code> بالبايتات، أو <code>NAPI_AUTO_LENGTH</code> إذا كانت تنتهي بصفر.</li><li><code>[in] constructor</code>: دالة رد الاتصال التي تعالج إنشاء نسخ من الصنف. عند تغليف صنف C++، يجب أن تكون هذه الطريقة عضوًا ثابتًا بتوقيع <a href="/ar/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a>. لا يمكن استخدام بانٍ صنف C++. يوفر <a href="/ar/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a> مزيدًا من التفاصيل.</li><li><code>[in] data</code>: بيانات اختيارية يتم تمريرها إلى رد الاتصال الباني كخاصية <code>data</code> لمعلومات رد الاتصال.</li><li><code>[in] property_count</code>: عدد العناصر في وسيطة مصفوفة <code>properties</code>.</li><li><code>[in] properties</code>: مصفوفة من واصفات الخصائص التي تصف خصائص بيانات ثابتة ونسخ، ووظائف الوصول، وطرق في الصنف. انظر <code>napi_property_descriptor</code>.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل دالة البناء للصنف.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح الـ API.</p><p>يحدد صنف JavaScript، بما في ذلك:</p><ul><li>دالة JavaScript البانية التي تحمل اسم الصنف. عند تغليف صنف C++ مطابق، يمكن استخدام رد الاتصال الذي تم تمريره عبر <code>constructor</code> لإنشاء نسخة جديدة من صنف C++، والتي يمكن بعد ذلك وضعها داخل نسخة كائن JavaScript التي يتم إنشاؤها باستخدام <a href="/ar/nodejs/api/n-api#napi-wrap"><code>napi_wrap</code></a>.</li><li>خصائص في دالة البناء التي يمكن لتنفيذها استدعاء خصائص بيانات <em>ثابتة</em> ووظائف الوصول وطرق صنف C++ المطابقة (المحددة بواسطة واصفات الخصائص مع سمة <code>napi_static</code>).</li><li>خصائص في كائن <code>prototype</code> الخاص بدالة البناء. عند تغليف صنف C++، يمكن استدعاء خصائص بيانات <em>غير ثابتة</em> ووظائف الوصول وطرق صنف C++ من الوظائف الثابتة المعطاة في واصفات الخصائص بدون سمة <code>napi_static</code> بعد استرداد نسخة صنف C++ الموضوعة داخل نسخة كائن JavaScript باستخدام <a href="/ar/nodejs/api/n-api#napi-unwrap"><code>napi_unwrap</code></a>.</li></ul><p>عند تغليف صنف C++، يجب أن يكون رد اتصال C++ الباني الذي تم تمريره عبر <code>constructor</code> طريقة ثابتة في الصنف تستدعي الباني الفعلي للصنف، ثم تغلف نسخة C++ الجديدة في كائن JavaScript، وتعيد كائن التغليف. انظر <a href="/ar/nodejs/api/n-api#napi-wrap"><code>napi_wrap</code></a> للحصول على التفاصيل.</p><p>غالبًا ما يتم حفظ دالة JavaScript البانية التي تم إرجاعها من <a href="/ar/nodejs/api/n-api#napi-define-class"><code>napi_define_class</code></a> واستخدامها لاحقًا لإنشاء نسخ جديدة من الصنف من التعليمات البرمجية الأصلية، و/أو للتحقق مما إذا كانت القيم المقدمة هي نسخ من الصنف. في هذه الحالة، لمنع جمع قيمة الدالة المهملة، يمكن إنشاء مرجع دائم قوي لها باستخدام <a href="/ar/nodejs/api/n-api#napi-create-reference"><code>napi_create_reference</code></a>، مما يضمن الحفاظ على عدد المراجع &gt;= 1.</p><p>يمكن ربط أي بيانات غير <code>NULL</code> يتم تمريرها إلى هذا الـ API عبر معلمة <code>data</code> أو عبر حقل <code>data</code> لعناصر مصفوفة <code>napi_property_descriptor</code> مع بانٍ JavaScript الناتج (الذي يتم إرجاعه في معلمة <code>result</code>) وتحريره متى تم جمع الصنف بواسطة جامع المهملات عن طريق تمرير كل من دالة JavaScript والبيانات إلى <a href="/ar/nodejs/api/n-api#napi-add-finalizer"><code>napi_add_finalizer</code></a>.</p><h3 id="napi_wrap" tabindex="-1"><code>napi_wrap</code> <a class="header-anchor" href="#napi_wrap" aria-label="Permalink to “napi_wrap”">​</a></h3><p><strong>أضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_wrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                      napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                      void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> native_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                      napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                      void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                      napi_ref</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] js_object</code>: كائن JavaScript الذي سيكون بمثابة غلاف للكائن الأصلي.</li><li><code>[in] native_object</code>: المثيل الأصلي الذي سيتم تغليفه في كائن JavaScript.</li><li><code>[in] finalize_cb</code>: استدعاء أصلي اختياري يمكن استخدامه لتحرير المثيل الأصلي عند تجميع كائن JavaScript بواسطة جامع البيانات المهملة (garbage-collected). توفر <a href="/ar/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> مزيدًا من التفاصيل.</li><li><code>[in] finalize_hint</code>: تلميح سياقي اختياري يتم تمريره إلى استدعاء الإنهاء.</li><li><code>[out] result</code>: مرجع اختياري إلى الكائن المغلف.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>يقوم بتغليف مثيل أصلي في كائن JavaScript. يمكن استرداد المثيل الأصلي لاحقًا باستخدام <code>napi_unwrap()</code>.</p><p>عندما يستدعي كود JavaScript منشئًا لفئة تم تعريفها باستخدام <code>napi_define_class()</code>، يتم استدعاء <code>napi_callback</code> للمنشئ. بعد إنشاء مثيل للفئة الأصلية، يجب أن يستدعي الاستدعاء بعد ذلك <code>napi_wrap()</code> لتغليف المثيل الذي تم إنشاؤه حديثًا في كائن JavaScript الذي تم إنشاؤه بالفعل والذي يمثل وسيطة <code>this</code> لاستدعاء المنشئ. (تم إنشاء كائن <code>this</code> من <code>prototype</code> لوظيفة المنشئ، لذلك لديه بالفعل تعريفات لجميع خصائص وأساليب المثيل.)</p><p>عادةً عند تغليف مثيل فئة، يجب توفير استدعاء إنهاء يقوم ببساطة بحذف المثيل الأصلي الذي يتم استقباله كوسيطة <code>data</code> لاستدعاء الإنهاء.</p><p>المرجع الذي تم إرجاعه الاختياري هو في البداية مرجع ضعيف، مما يعني أن لديه عدد مراجع 0. عادةً ما يتم زيادة عدد المراجع هذا مؤقتًا أثناء العمليات غير المتزامنة التي تتطلب بقاء المثيل صالحًا.</p><p><em>تنبيه</em>: يجب حذف المرجع الذي تم إرجاعه الاختياري (إذا تم الحصول عليه) عبر <a href="/ar/nodejs/api/n-api#napi-delete-reference"><code>napi_delete_reference</code></a> فقط استجابةً لاستدعاء استدعاء الإنهاء. إذا تم حذفه قبل ذلك، فقد لا يتم استدعاء استدعاء الإنهاء أبدًا. لذلك، عند الحصول على مرجع، يكون استدعاء الإنهاء مطلوبًا أيضًا لتمكين التخلص الصحيح من المرجع.</p><p>قد يتم تأجيل استدعاءات الإنهاء، مما يترك نافذة حيث تم تجميع الكائن بواسطة جامع البيانات المهملة (وأصبح المرجع الضعيف غير صالح) ولكن لم يتم استدعاء المُنهي بعد. عند استخدام <code>napi_get_reference_value()</code> على المراجع الضعيفة التي تم إرجاعها بواسطة <code>napi_wrap()</code>، يجب عليك الاستمرار في التعامل مع النتيجة الفارغة.</p><p>سيؤدي استدعاء <code>napi_wrap()</code> مرة ثانية على كائن إلى إرجاع خطأ. لربط مثيل أصلي آخر بالكائن، استخدم <code>napi_remove_wrap()</code> أولاً.</p><h3 id="napi_unwrap" tabindex="-1"><code>napi_unwrap</code> <a class="header-anchor" href="#napi_unwrap" aria-label="Permalink to “napi_unwrap”">​</a></h3><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_unwrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                        void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] js_object</code>: الكائن المرتبط بالمثيل الأصلي.</li><li><code>[out] result</code>: مؤشر إلى المثيل الأصلي المغلف.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>يسترد مثيلاً أصليًا تم تغليفه مسبقًا في كائن JavaScript باستخدام <code>napi_wrap()</code>.</p><p>عندما يستدعي كود JavaScript طريقة أو محدد وصول خاصية في الفئة، يتم استدعاء <code>napi_callback</code> المقابل. إذا كان الاستدعاء لطريقة أو محدد وصول لمثيل، فإن وسيطة <code>this</code> للاستدعاء هي كائن التغليف؛ يمكن الحصول على مثيل C++ المغلف الذي هو هدف الاستدعاء بعد ذلك عن طريق استدعاء <code>napi_unwrap()</code> على كائن التغليف.</p><h3 id="napi_remove_wrap" tabindex="-1"><code>napi_remove_wrap</code> <a class="header-anchor" href="#napi_remove_wrap" aria-label="Permalink to “napi_remove_wrap”">​</a></h3><p><strong>أُضيف في: v8.5.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_remove_wrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] js_object</code>: الكائن المرتبط بالمثيل الأصلي.</li><li><code>[out] result</code>: مؤشر إلى المثيل الأصلي المغلف.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>يسترد مثيلاً أصليًا تم تغليفه مسبقًا في كائن JavaScript <code>js_object</code> باستخدام <code>napi_wrap()</code> ويزيل التغليف. إذا تم ربط استدعاء نهائي بالتغليف، فلن يتم استدعاؤه بعد الآن عندما يتم جمع كائن JavaScript كبيانات مهملة.</p><h3 id="napi_type_tag_object" tabindex="-1"><code>napi_type_tag_object</code> <a class="header-anchor" href="#napi_type_tag_object" aria-label="Permalink to “napi_type_tag_object”">​</a></h3><p><strong>أُضيف في: v14.8.0, v12.19.0</strong></p><p><strong>إصدار N-API: 8</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_type_tag_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_type_tag</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> type_tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] js_object</code>: كائن JavaScript أو <a href="/ar/nodejs/api/n-api#napi-create-external">خارجي</a> المراد وضع علامة عليه.</li><li><code>[in] type_tag</code>: العلامة التي سيتم وضع علامة على الكائن بها.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>يربط قيمة مؤشر <code>type_tag</code> بكائن JavaScript أو <a href="/ar/nodejs/api/n-api#napi-create-external">خارجي</a>. يمكن بعد ذلك استخدام <code>napi_check_object_type_tag()</code> لمقارنة العلامة المرفقة بالكائن بعلامة مملوكة للإضافة للتأكد من أن الكائن من النوع الصحيح.</p><p>إذا كان الكائن يحتوي بالفعل على علامة نوع مرتبطة به، فسترجع واجهة برمجة التطبيقات (API) هذه <code>napi_invalid_arg</code>.</p><h3 id="napi_check_object_type_tag" tabindex="-1"><code>napi_check_object_type_tag</code> <a class="header-anchor" href="#napi_check_object_type_tag" aria-label="Permalink to “napi_check_object_type_tag”">​</a></h3><p><strong>تمت إضافتها في: الإصدار 14.8.0، الإصدار 12.19.0</strong></p><p><strong>إصدار N-API: 8</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_check_object_type_tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                       napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_type_tag</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> type_tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] js_object</code>: كائن JavaScript أو <a href="/ar/nodejs/api/n-api#napi-create-external">خارجي</a> يتم فحص علامة النوع الخاصة به.</li><li><code>[in] type_tag</code>: العلامة التي ستتم مقارنتها بأي علامة موجودة على الكائن.</li><li><code>[out] result</code>: ما إذا كانت علامة النوع المعطاة تطابق علامة النوع الموجودة على الكائن. يتم إرجاع <code>false</code> أيضًا إذا لم يتم العثور على علامة نوع على الكائن.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>يقارن المؤشر المعطى كـ <code>type_tag</code> بأي مؤشر يمكن العثور عليه في <code>js_object</code>. إذا لم يتم العثور على علامة على <code>js_object</code> أو إذا تم العثور على علامة ولكنها لا تتطابق مع <code>type_tag</code>، فسيتم تعيين <code>result</code> على <code>false</code>. إذا تم العثور على علامة وكانت تتطابق مع <code>type_tag</code>، فسيتم تعيين <code>result</code> على <code>true</code>.</p><h3 id="napi_add_finalizer" tabindex="-1"><code>napi_add_finalizer</code> <a class="header-anchor" href="#napi_add_finalizer" aria-label="Permalink to “napi_add_finalizer”">​</a></h3><p><strong>تمت إضافتها في: الإصدار 8.0.0</strong></p><p><strong>إصدار N-API: 5</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_add_finalizer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                               void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               node_api_basic_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                               void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_ref</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] js_object</code>: كائن JavaScript الذي سيتم إرفاق البيانات الأصلية به.</li><li><code>[in] finalize_data</code>: بيانات اختيارية يتم تمريرها إلى <code>finalize_cb</code>.</li><li><code>[in] finalize_cb</code>: استدعاء أصلي سيتم استخدامه لتحرير البيانات الأصلية عندما يتم تجميع كائن JavaScript كقمامة. توفر <a href="/ar/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> مزيدًا من التفاصيل.</li><li><code>[in] finalize_hint</code>: تلميح سياقي اختياري يتم تمريره إلى استدعاء الإنهاء.</li><li><code>[out] result</code>: مرجع اختياري لكائن JavaScript.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>يضيف استدعاء <code>napi_finalize</code> الذي سيتم استدعاؤه عندما يتم تجميع كائن JavaScript في <code>js_object</code> كقمامة.</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه عدة مرات على كائن JavaScript واحد.</p><p><em>تنبيه</em>: يجب حذف المرجع الاختياري المرتجع (إذا تم الحصول عليه) عبر <a href="/ar/nodejs/api/n-api#napi-delete-reference"><code>napi_delete_reference</code></a> فقط استجابةً لاستدعاء استدعاء الإنهاء. إذا تم حذفه قبل ذلك، فقد لا يتم استدعاء استدعاء الإنهاء أبدًا. لذلك، عند الحصول على مرجع، يلزم أيضًا استدعاء إنهاء لتمكين التخلص الصحيح من المرجع.</p><h4 id="node_api_post_finalizer" tabindex="-1"><code>node_api_post_finalizer</code> <a class="header-anchor" href="#node_api_post_finalizer" aria-label="Permalink to “node_api_post_finalizer”">​</a></h4><p><strong>تمت إضافته في: الإصدار 21.0.0، الإصدار 20.10.0، الإصدار 18.19.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[مستقر: 1 - تجريبي]</p><p><a href="/ar/nodejs/api/documentation#stability-index">مستقر: 1</a> <a href="/ar/nodejs/api/documentation#stability-index">الاستقرار: 1</a> - تجريبي</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_post_finalizer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] finalize_cb</code>: وظيفة رد نداء أصلية سيتم استخدامها لتحرير البيانات الأصلية عندما يتم تجميع كائن JavaScript بواسطة جامع القمامة (garbage-collected). توفر <a href="/ar/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> مزيدًا من التفاصيل.</li><li><code>[in] finalize_data</code>: بيانات اختيارية يتم تمريرها إلى <code>finalize_cb</code>.</li><li><code>[in] finalize_hint</code>: تلميح سياقي اختياري يتم تمريره إلى وظيفة رد نداء الإنهاء.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>يجدول وظيفة رد نداء <code>napi_finalize</code> ليتم استدعاؤها بشكل غير متزامن في حلقة الأحداث.</p><p>عادةً ما يتم استدعاء أدوات الإنهاء أثناء قيام GC (جامع القمامة) بتجميع الكائنات. في هذه المرحلة، سيتم تعطيل استدعاء أي Node-API قد يتسبب في تغييرات في حالة GC وسيؤدي إلى تعطل Node.js.</p><p>يساعد <code>node_api_post_finalizer</code> على تجاوز هذا القيد من خلال السماح للإضافة بتأجيل استدعاءات Node-APIs إلى نقطة زمنية خارج إنهاء GC.</p><h2 id="simple-asynchronous-operations" tabindex="-1">عمليات غير متزامنة بسيطة <a class="header-anchor" href="#simple-asynchronous-operations" aria-label="Permalink to “عمليات غير متزامنة بسيطة”">​</a></h2><p>غالبًا ما تحتاج وحدات الإضافة إلى الاستفادة من مساعدي async من libuv كجزء من تنفيذها. يتيح لهم ذلك جدولة العمل ليتم تنفيذه بشكل غير متزامن بحيث يمكن لأساليبهم العودة قبل اكتمال العمل. هذا يسمح لهم بتجنب حظر التنفيذ العام لتطبيق Node.js.</p><p>يوفر Node-API واجهة مستقرة ABI لهذه الوظائف الداعمة التي تغطي حالات الاستخدام غير المتزامنة الأكثر شيوعًا.</p><p>يحدد Node-API هيكل <code>napi_async_work</code> الذي يستخدم لإدارة العمال غير المتزامنين. يتم إنشاء / حذف المثيلات باستخدام <a href="/ar/nodejs/api/n-api#napi-create-async-work"><code>napi_create_async_work</code></a> و <a href="/ar/nodejs/api/n-api#napi-delete-async-work"><code>napi_delete_async_work</code></a>.</p><p>وظائف رد نداء <code>execute</code> و <code>complete</code> هي وظائف سيتم استدعاؤها عندما يكون المنفذ جاهزًا للتنفيذ وعندما يكمل مهمته على التوالي.</p><p>يجب أن تتجنب وظيفة <code>execute</code> إجراء أي استدعاءات Node-API قد تؤدي إلى تنفيذ JavaScript أو التفاعل مع كائنات JavaScript. في معظم الأحيان، يجب إجراء أي رمز يحتاج إلى إجراء استدعاءات Node-API في وظيفة رد نداء <code>complete</code> بدلاً من ذلك. تجنب استخدام المعامل <code>napi_env</code> في وظيفة رد نداء التنفيذ لأنه من المحتمل أن يقوم بتنفيذ JavaScript.</p><p>تنفذ هذه الوظائف الواجهات التالية:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_async_execute_callback)(napi_env env,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                            void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_async_complete_callback)(napi_env env,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                             napi_status status,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                             void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>عندما يتم استدعاء هذه الأساليب، سيكون المعامل <code>data</code> الذي تم تمريره هو بيانات <code>void*</code> التي قدمتها الإضافة والتي تم تمريرها إلى استدعاء <code>napi_create_async_work</code>.</p><p>بمجرد إنشاء العامل غير المتزامن، يمكن وضعه في قائمة الانتظار للتنفيذ باستخدام الوظيفة <a href="/ar/nodejs/api/n-api#napi-queue-async-work"><code>napi_queue_async_work</code></a>:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_queue_async_work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_async_work </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>يمكن استخدام <a href="/ar/nodejs/api/n-api#napi-cancel-async-work"><code>napi_cancel_async_work</code></a> إذا كان العمل بحاجة إلى الإلغاء قبل أن يبدأ العمل في التنفيذ.</p><p>بعد استدعاء <a href="/ar/nodejs/api/n-api#napi-cancel-async-work"><code>napi_cancel_async_work</code></a>، سيتم استدعاء وظيفة رد نداء <code>complete</code> بقيمة حالة <code>napi_cancelled</code>. يجب عدم حذف العمل قبل استدعاء وظيفة رد نداء <code>complete</code>، حتى عندما تم إلغاؤه.</p><h3 id="napi_create_async_work" tabindex="-1"><code>napi_create_async_work</code> <a class="header-anchor" href="#napi_create_async_work" aria-label="Permalink to “napi_create_async_work”">​</a></h3><div class="info custom-block"><p class="custom-block-title">[السجل]</p><table tabindex="0"><thead><tr><th>الإصدار</th><th>التغييرات</th></tr></thead><tbody><tr><td>v8.6.0</td><td>تمت إضافة المعاملات <code>async_resource</code> و <code>async_resource_name</code>.</td></tr><tr><td>v8.0.0</td><td>تمت الإضافة في: v8.0.0</td></tr></tbody></table></div><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_async_work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_async_execute_callback </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_async_complete_callback </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">complete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_async_work</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] async_resource</code>: كائن اختياري مرتبط بالعمل غير المتزامن الذي سيتم تمريره إلى <code>async_hooks</code> المحتملة <a href="/ar/nodejs/api/async_hooks#initasyncid-type-triggerasyncid-resource"><code>init</code> hooks</a>.</li><li><code>[in] async_resource_name</code>: مُعرِّف لنوع المورد الذي يتم توفيره للحصول على معلومات تشخيصية مكشوفة بواسطة واجهة برمجة التطبيقات (API) <code>async_hooks</code>.</li><li><code>[in] execute</code>: الدالة الأصلية التي يجب استدعاؤها لتنفيذ المنطق بشكل غير متزامن. يتم استدعاء الدالة المعطاة من سلسلة عمليات تجمع العاملين ويمكن أن يتم تنفيذها بالتوازي مع سلسلة عمليات حلقة الأحداث الرئيسية.</li><li><code>[in] complete</code>: الدالة الأصلية التي سيتم استدعاؤها عند اكتمال المنطق غير المتزامن أو إلغائه. يتم استدعاء الدالة المعطاة من سلسلة عمليات حلقة الأحداث الرئيسية. <a href="/ar/nodejs/api/n-api#napi-async-complete-callback"><code>napi_async_complete_callback</code></a> يوفر المزيد من التفاصيل.</li><li><code>[in] data</code>: سياق البيانات المقدم من المستخدم. سيتم تمرير هذا مرة أخرى إلى دالتي التنفيذ والإكمال.</li><li><code>[out] result</code>: <code>napi_async_work*</code> وهو مقبض العمل غير المتزامن الذي تم إنشاؤه حديثًا.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تخصص واجهة برمجة التطبيقات (API) هذه كائن عمل يستخدم لتنفيذ المنطق بشكل غير متزامن. يجب تحريره باستخدام <a href="/ar/nodejs/api/n-api#napi-delete-async-work"><code>napi_delete_async_work</code></a> بمجرد أن يصبح العمل غير مطلوب.</p><p>يجب أن يكون <code>async_resource_name</code> سلسلة منتهية بصفر، ومشفرة بترميز UTF-8.</p><p>يتم توفير معرف <code>async_resource_name</code> من قبل المستخدم ويجب أن يكون ممثلاً لنوع العمل غير المتزامن الذي يتم تنفيذه. يوصى أيضًا بتطبيق مساحة اسم على المعرف، على سبيل المثال عن طريق تضمين اسم الوحدة النمطية. راجع <a href="/ar/nodejs/api/async_hooks#type"><code>async_hooks</code> documentation</a> لمزيد من المعلومات.</p><h3 id="napi_delete_async_work" tabindex="-1"><code>napi_delete_async_work</code> <a class="header-anchor" href="#napi_delete_async_work" aria-label="Permalink to “napi_delete_async_work”">​</a></h3><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_delete_async_work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_async_work </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] work</code>: المعالج الذي تم إرجاعه بواسطة استدعاء <code>napi_create_async_work</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تعمل واجهة برمجة التطبيقات (API) هذه على تحرير كائن العمل الذي تم تخصيصه مسبقًا.</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه حتى إذا كان هناك استثناء JavaScript معلق.</p><h3 id="napi_queue_async_work" tabindex="-1"><code>napi_queue_async_work</code> <a class="header-anchor" href="#napi_queue_async_work" aria-label="Permalink to “napi_queue_async_work”">​</a></h3><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_queue_async_work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_async_work </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] work</code>: المعالج الذي تم إرجاعه بواسطة استدعاء <code>napi_create_async_work</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تطلب واجهة برمجة التطبيقات (API) هذه جدولة العمل الذي تم تخصيصه مسبقًا للتنفيذ. بمجرد إرجاعها بنجاح، يجب عدم استدعاء واجهة برمجة التطبيقات (API) هذه مرة أخرى بنفس عنصر <code>napi_async_work</code> أو ستكون النتيجة غير محددة.</p><h3 id="napi_cancel_async_work" tabindex="-1"><code>napi_cancel_async_work</code> <a class="header-anchor" href="#napi_cancel_async_work" aria-label="Permalink to “napi_cancel_async_work”">​</a></h3><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_cancel_async_work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_async_work </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] work</code>: المعالج الذي تم إرجاعه بواسطة استدعاء <code>napi_create_async_work</code>.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تعمل واجهة برمجة التطبيقات (API) هذه على إلغاء العمل في قائمة الانتظار إذا لم يبدأ بعد. إذا بدأ التنفيذ بالفعل، فلا يمكن إلغاؤه وسيتم إرجاع <code>napi_generic_failure</code>. إذا نجح الأمر، فسيتم استدعاء رد الاتصال <code>complete</code> بقيمة حالة <code>napi_cancelled</code>. يجب عدم حذف العمل قبل استدعاء رد الاتصال <code>complete</code>، حتى إذا تم إلغاؤه بنجاح.</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه حتى إذا كان هناك استثناء JavaScript معلق.</p><h2 id="custom-asynchronous-operations" tabindex="-1">عمليات غير متزامنة مخصصة <a class="header-anchor" href="#custom-asynchronous-operations" aria-label="Permalink to “عمليات غير متزامنة مخصصة”">​</a></h2><p>قد لا تكون واجهات برمجة التطبيقات (API) البسيطة للعمل غير المتزامن المذكورة أعلاه مناسبة لكل سيناريو. عند استخدام أي آلية غير متزامنة أخرى، تكون واجهات برمجة التطبيقات (API) التالية ضرورية لضمان تتبع العملية غير المتزامنة بشكل صحيح بواسطة وقت التشغيل.</p><h3 id="napi_async_init" tabindex="-1"><code>napi_async_init</code> <a class="header-anchor" href="#napi_async_init" aria-label="Permalink to “napi_async_init”">​</a></h3><p><strong>تمت إضافتها في: v8.6.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_async_init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_async_context</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] async_resource</code>: الكائن المرتبط بالعمل غير المتزامن الذي سيتم تمريره إلى خطافات <code>async_hooks</code> <a href="/ar/nodejs/api/async_hooks#initasyncid-type-triggerasyncid-resource"><code>init</code></a> المحتملة ويمكن الوصول إليه بواسطة <a href="/ar/nodejs/api/async_hooks#async-hooksexecutionasyncresource"><code>async_hooks.executionAsyncResource()</code></a>.</li><li><code>[in] async_resource_name</code>: مُعرّف لنوع المورد الذي يتم توفيره للحصول على معلومات تشخيصية تعرضها واجهة برمجة التطبيقات <code>async_hooks</code>.</li><li><code>[out] result</code>: سياق غير المتزامن المهيأ.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>يجب الحفاظ على الكائن <code>async_resource</code> حيًا حتى <a href="/ar/nodejs/api/n-api#napi-async-destroy"><code>napi_async_destroy</code></a> للحفاظ على عمل واجهة برمجة التطبيقات (API) المتعلقة بـ <code>async_hooks</code> بشكل صحيح. من أجل الحفاظ على توافق ABI مع الإصدارات السابقة، لا تحتفظ <code>napi_async_context</code> بمراجع قوية للكائنات <code>async_resource</code> لتجنب التسبب في تسرب الذاكرة. ومع ذلك، إذا تم جمع القمامة للكائن <code>async_resource</code> بواسطة محرك JavaScript قبل تدمير <code>napi_async_context</code> بواسطة <code>napi_async_destroy</code>، فإن استدعاء واجهات برمجة التطبيقات (APIs) المتعلقة بـ <code>napi_async_context</code> مثل <a href="/ar/nodejs/api/n-api#napi-open-callback-scope"><code>napi_open_callback_scope</code></a> و<a href="/ar/nodejs/api/n-api#napi-make-callback"><code>napi_make_callback</code></a> يمكن أن يتسبب في مشاكل مثل فقدان سياق غير المتزامن عند استخدام واجهة برمجة التطبيقات (API) <code>AsyncLocalStorage</code>.</p><p>من أجل الحفاظ على توافق ABI مع الإصدارات السابقة، فإن تمرير <code>NULL</code> لـ <code>async_resource</code> لا يؤدي إلى حدوث خطأ. ومع ذلك، لا يوصى بذلك لأن هذا سيؤدي إلى سلوك غير مرغوب فيه مع <code>async_hooks</code> <a href="/ar/nodejs/api/async_hooks#initasyncid-type-triggerasyncid-resource"><code>init</code> hooks</a> و <code>async_hooks.executionAsyncResource()</code> حيث أن المورد مطلوب الآن من قبل تنفيذ <code>async_hooks</code> الأساسي من أجل توفير الارتباط بين عمليات الاسترجاع غير المتزامنة.</p><h3 id="napi_async_destroy" tabindex="-1"><code>napi_async_destroy</code> <a class="header-anchor" href="#napi_async_destroy" aria-label="Permalink to “napi_async_destroy”">​</a></h3><p><strong>أضيف في: v8.6.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_async_destroy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_async_context </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] async_context</code>: سياق عدم التزامن المراد تدميره.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>يمكن استدعاء API هذا حتى إذا كان هناك استثناء JavaScript معلق.</p><h3 id="napi_make_callback" tabindex="-1"><code>napi_make_callback</code> <a class="header-anchor" href="#napi_make_callback" aria-label="Permalink to “napi_make_callback”">​</a></h3><div class="info custom-block"><p class="custom-block-title">[سجل التغييرات]</p><table tabindex="0"><thead><tr><th>الإصدار</th><th>التغييرات</th></tr></thead><tbody><tr><td>v8.6.0</td><td>تمت إضافة المعامل <code>async_context</code>.</td></tr><tr><td>v8.0.0</td><td>أضيف في: v8.0.0</td></tr></tbody></table></div><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_make_callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_async_context </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">recv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                           size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                           const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء API ضمنها.</li><li><code>[in] async_context</code>: سياق لعملية عدم التزامن التي تستدعي الاستدعاء. يجب أن تكون هذه عادةً قيمة تم الحصول عليها مسبقًا من <a href="/ar/nodejs/api/n-api#napi-async-init"><code>napi_async_init</code></a>. من أجل الحفاظ على توافق ABI مع الإصدارات السابقة، فإن تمرير <code>NULL</code> لـ <code>async_context</code> لا يؤدي إلى حدوث خطأ. ومع ذلك، فإن هذا يؤدي إلى تشغيل غير صحيح لخطافات عدم التزامن. تتضمن المشكلات المحتملة فقدان سياق عدم التزامن عند استخدام API <code>AsyncLocalStorage</code>.</li><li><code>[in] recv</code>: قيمة <code>this</code> التي تم تمريرها إلى الدالة المستدعاة.</li><li><code>[in] func</code>: <code>napi_value</code> تمثل دالة JavaScript المراد استدعاؤها.</li><li><code>[in] argc</code>: عدد العناصر في مصفوفة <code>argv</code>.</li><li><code>[in] argv</code>: مصفوفة من قيم JavaScript كـ <code>napi_value</code> تمثل وسيطات الدالة. إذا كانت <code>argc</code> صفرًا، فيمكن حذف هذا المعامل عن طريق تمرير <code>NULL</code>.</li><li><code>[out] result</code>: <code>napi_value</code> يمثل كائن JavaScript الذي تم إرجاعه.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجح API.</p><p>تسمح هذه الطريقة باستدعاء كائن دالة JavaScript من إضافة أصلية. يشبه API هذا <code>napi_call_function</code>. ومع ذلك، يتم استخدامه للاتصال <em>من</em> التعليمات البرمجية الأصلية <em>إلى</em> JavaScript <em>بعد</em> العودة من عملية غير متزامنة (عندما لا يوجد برنامج نصي آخر في المكدس). إنه عبارة عن غلاف بسيط إلى حد ما حول <code>node::MakeCallback</code>.</p><p>لاحظ أنه <em>ليس</em> من الضروري استخدام <code>napi_make_callback</code> من داخل <code>napi_async_complete_callback</code> ؛ في هذا الموقف، تم بالفعل إعداد سياق عدم التزامن الخاص بالاستدعاء، لذا فإن الاستدعاء المباشر لـ <code>napi_call_function</code> كافٍ ومناسب. قد يكون استخدام الدالة <code>napi_make_callback</code> مطلوبًا عند تنفيذ سلوك غير متزامن مخصص لا يستخدم <code>napi_create_async_work</code>.</p><p>أي <code>process.nextTick</code>s أو Promises المجدولة في قائمة المهام الصغيرة بواسطة JavaScript أثناء الاستدعاء يتم تشغيلها قبل العودة إلى C/C++.</p><h3 id="napi_open_callback_scope" tabindex="-1">‏<code>napi_open_callback_scope</code> <a class="header-anchor" href="#napi_open_callback_scope" aria-label="Permalink to “‏napi_open_callback_scope”">​</a></h3><p><strong>أُضيف في: الإصدار 9.6.0</strong></p><p><strong>إصدار N-API: 3</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_open_callback_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">resource_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_async_context </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_callback_scope</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) فيها.</li><li><code>[in] resource_object</code>: كائن مرتبط بالعمل غير المتزامن الذي سيتم تمريره إلى <code>async_hooks</code> المحتملة <a href="/ar/nodejs/api/async_hooks#initasyncid-type-triggerasyncid-resource"><code>init</code> hooks</a>. تم إهمال هذه المعلمة ويتم تجاهلها في وقت التشغيل. استخدم المعلمة <code>async_resource</code> في <a href="/ar/nodejs/api/n-api#napi-async-init"><code>napi_async_init</code></a> بدلاً من ذلك.</li><li><code>[in] context</code>: سياق العملية غير المتزامنة التي تستدعي رد الاتصال. يجب أن تكون هذه قيمة تم الحصول عليها مسبقًا من <a href="/ar/nodejs/api/n-api#napi-async-init"><code>napi_async_init</code></a>.</li><li><code>[out] result</code>: النطاق الذي تم إنشاؤه حديثًا.</li></ul><p>هناك حالات (على سبيل المثال، حل الوعود) حيث يكون من الضروري أن يكون لديك ما يعادل النطاق المرتبط برد الاتصال في مكانه عند إجراء بعض استدعاءات Node-API. إذا لم يكن هناك برنامج نصي آخر في المكدس، فيمكن استخدام الوظائف <a href="/ar/nodejs/api/n-api#napi-open-callback-scope"><code>napi_open_callback_scope</code></a> و <a href="/ar/nodejs/api/n-api#napi-close-callback-scope"><code>napi_close_callback_scope</code></a> لفتح/إغلاق النطاق المطلوب.</p><h3 id="napi_close_callback_scope" tabindex="-1">‏<code>napi_close_callback_scope</code> <a class="header-anchor" href="#napi_close_callback_scope" aria-label="Permalink to “‏napi_close_callback_scope”">​</a></h3><p><strong>أُضيف في: الإصدار 9.6.0</strong></p><p><strong>إصدار N-API: 3</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_close_callback_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                  napi_callback_scope </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) فيها.</li><li><code>[in] scope</code>: النطاق المراد إغلاقه.</li></ul><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه حتى إذا كان هناك استثناء JavaScript معلق.</p><h2 id="version-management" tabindex="-1">إدارة الإصدار <a class="header-anchor" href="#version-management" aria-label="Permalink to “إدارة الإصدار”">​</a></h2><h3 id="napi_get_node_version" tabindex="-1">‏<code>napi_get_node_version</code> <a class="header-anchor" href="#napi_get_node_version" aria-label="Permalink to “‏napi_get_node_version”">​</a></h3><p><strong>أُضيف في: الإصدار 8.4.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> major;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minor;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> patch;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> release;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_node_version;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_node_version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_node_version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) فيها.</li><li><code>[out] version</code>: مؤشر إلى معلومات الإصدار الخاصة بـ Node.js نفسه.</li></ul><p>إرجاع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تملأ هذه الوظيفة البنية <code>version</code> بالإصدار الرئيسي والثانوي والتصحيحي لـ Node.js الذي يعمل حاليًا، والحقل <code>release</code> بقيمة <a href="/ar/nodejs/api/process#processrelease"><code>process.release.name</code></a>.</p><p>يتم تخصيص المخزن المؤقت الذي تم إرجاعه بشكل ثابت ولا يحتاج إلى تحرير.</p><h3 id="napi_get_version" tabindex="-1"><code>napi_get_version</code> <a class="header-anchor" href="#napi_get_version" aria-label="Permalink to “napi_get_version”">​</a></h3><p><strong>أُضيف في: v8.0.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             uint32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم فيها استدعاء API.</li><li><code>[out] result</code>: أعلى إصدار من Node-API مدعوم.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح API.</p><p>يُرجع هذا API أعلى إصدار من Node-API مدعوم بواسطة وقت تشغيل Node.js. من المخطط أن يكون Node-API تجميعيًا بحيث تدعم الإصدارات الأحدث من Node.js وظائف API إضافية. للسماح للملحق باستخدام دالة أحدث عند التشغيل بإصدارات من Node.js تدعمها، مع توفير سلوك احتياطي عند التشغيل بإصدارات Node.js التي لا تدعمها:</p><ul><li>استدعِ <code>napi_get_version()</code> لتحديد ما إذا كان API متاحًا.</li><li>إذا كان متاحًا، فقم بتحميل مؤشر إلى الدالة ديناميكيًا باستخدام <code>uv_dlsym()</code>.</li><li>استخدم المؤشر المحمل ديناميكيًا لاستدعاء الدالة.</li><li>إذا كانت الدالة غير متاحة، فقم بتوفير تنفيذ بديل لا يستخدم الدالة.</li></ul><h2 id="memory-management" tabindex="-1">إدارة الذاكرة <a class="header-anchor" href="#memory-management" aria-label="Permalink to “إدارة الذاكرة”">​</a></h2><h3 id="napi_adjust_external_memory" tabindex="-1"><code>napi_adjust_external_memory</code> <a class="header-anchor" href="#napi_adjust_external_memory" aria-label="Permalink to “napi_adjust_external_memory”">​</a></h3><p><strong>أُضيف في: v8.5.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_adjust_external_memory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                    int64_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> change_in_bytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                    int64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم فيها استدعاء API.</li><li><code>[in] change_in_bytes</code>: التغيير في الذاكرة المخصصة خارجيًا والتي يتم الحفاظ عليها بواسطة كائنات JavaScript.</li><li><code>[out] result</code>: القيمة المعدلة</li></ul><p>يُرجع <code>napi_ok</code> إذا نجح API.</p><p>تمنح هذه الدالة V8 إشارة إلى مقدار الذاكرة المخصصة خارجيًا التي يتم الحفاظ عليها بواسطة كائنات JavaScript (أي كائن JavaScript يشير إلى الذاكرة الخاصة به المخصصة بواسطة ملحق أصلي). سيؤدي تسجيل الذاكرة المخصصة خارجيًا إلى تشغيل عمليات تجميع البيانات المهملة العامة في كثير من الأحيان.</p><h2 id="promises" tabindex="-1">الوعود <a class="header-anchor" href="#promises" aria-label="Permalink to “الوعود”">​</a></h2><p>توفر Node-API تسهيلات لإنشاء كائنات <code>Promise</code> كما هو موضح في <a href="https://tc39.github.io/ecma262/#sec-promise-objects" target="_blank" rel="noreferrer">القسم 25.4</a> من مواصفات ECMA. تقوم بتنفيذ الوعود كزوج من الكائنات. عند إنشاء وعد بواسطة <code>napi_create_promise()</code>، يتم إنشاء كائن &quot;مؤجل&quot; وإرجاعه جنبًا إلى جنب مع <code>Promise</code>. يتم ربط الكائن المؤجل بالـ <code>Promise</code> الذي تم إنشاؤه وهو الوسيلة الوحيدة لحل أو رفض <code>Promise</code> باستخدام <code>napi_resolve_deferred()</code> أو <code>napi_reject_deferred()</code>. يتم تحرير الكائن المؤجل الذي تم إنشاؤه بواسطة <code>napi_create_promise()</code> بواسطة <code>napi_resolve_deferred()</code> أو <code>napi_reject_deferred()</code>. يمكن إرجاع كائن <code>Promise</code> إلى JavaScript حيث يمكن استخدامه بالطريقة المعتادة.</p><p>على سبيل المثال، لإنشاء وعد وتمريره إلى عامل غير متزامن:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_deferred deferred;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value promise;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Create the promise.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Pass the deferred to a function that performs an asynchronous action.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">do_something_asynchronous</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(deferred);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Return the promise to JS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> promise;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>ستقوم الدالة المذكورة أعلاه <code>do_something_asynchronous()</code> بتنفيذ الإجراء غير المتزامن الخاص بها ثم ستحل أو ترفض المؤجل، وبالتالي تختتم الوعد وتحرر المؤجل:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_deferred deferred;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value undefined;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Create a value with which to conclude the deferred.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Resolve or reject the promise associated with the deferred depending on</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// whether the asynchronous action succeeded.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (asynchronous_action_succeeded) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_resolve_deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, deferred, undefined);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_reject_deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, deferred, undefined);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// At this point the deferred has been freed, so we should assign NULL to it.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deferred </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="napi_create_promise" tabindex="-1">‏<code>napi_create_promise</code> <a class="header-anchor" href="#napi_create_promise" aria-label="Permalink to “‏napi_create_promise”">​</a></h3><p><strong>تمت الإضافة في: الإصدار 8.5.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_deferred</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[out] deferred</code>: كائن مؤجل تم إنشاؤه حديثًا ويمكن تمريره لاحقًا إلى <code>napi_resolve_deferred()</code> أو <code>napi_reject_deferred()</code> لحل أو رفض الوعد المرتبط به على التوالي.</li><li><code>[out] promise</code>: وعد JavaScript المرتبط بالكائن المؤجل.</li></ul><p>يُرجع <code>napi_ok</code> إذا نجحت واجهة برمجة التطبيقات (API).</p><p>تقوم واجهة برمجة التطبيقات (API) هذه بإنشاء كائن مؤجل ووعد JavaScript.</p><h3 id="napi_resolve_deferred" tabindex="-1">‏<code>napi_resolve_deferred</code> <a class="header-anchor" href="#napi_resolve_deferred" aria-label="Permalink to “‏napi_resolve_deferred”">​</a></h3><p><strong>تمت الإضافة في: الإصدار 8.5.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_resolve_deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_deferred </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">resolution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] deferred</code>: الكائن المؤجل الذي سيتم حل الوعد المرتبط به.</li><li><code>[in] resolution</code>: القيمة التي سيتم بها حل الوعد.</li></ul><p>تقوم واجهة برمجة التطبيقات (API) هذه بحل وعد JavaScript عن طريق الكائن المؤجل المرتبط به. وبالتالي، لا يمكن استخدامها إلا لحل وعود JavaScript التي يتوفر لها الكائن المؤجل المقابل. هذا يعني فعليًا أنه يجب إنشاء الوعد باستخدام <code>napi_create_promise()</code> ويجب الاحتفاظ بالكائن المؤجل الذي تم إرجاعه من هذه المكالمة من أجل تمريره إلى واجهة برمجة التطبيقات (API) هذه.</p><p>يتم تحرير الكائن المؤجل عند الانتهاء بنجاح.</p><h3 id="napi_reject_deferred" tabindex="-1">‏<code>napi_reject_deferred</code> <a class="header-anchor" href="#napi_reject_deferred" aria-label="Permalink to “‏napi_reject_deferred”">​</a></h3><p><strong>تمت الإضافة في: الإصدار 8.5.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_reject_deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_deferred </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">rejection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] deferred</code>: الكائن المؤجل الذي سيتم حل الوعد المرتبط به.</li><li><code>[in] rejection</code>: القيمة التي سيتم بها رفض الوعد.</li></ul><p>تقوم واجهة برمجة التطبيقات (API) هذه برفض وعد JavaScript عن طريق الكائن المؤجل المرتبط به. وبالتالي، لا يمكن استخدامها إلا لرفض وعود JavaScript التي يتوفر لها الكائن المؤجل المقابل. هذا يعني فعليًا أنه يجب إنشاء الوعد باستخدام <code>napi_create_promise()</code> ويجب الاحتفاظ بالكائن المؤجل الذي تم إرجاعه من هذه المكالمة من أجل تمريره إلى واجهة برمجة التطبيقات (API) هذه.</p><p>يتم تحرير الكائن المؤجل عند الانتهاء بنجاح.</p><h3 id="napi_is_promise" tabindex="-1">‏<code>napi_is_promise</code> <a class="header-anchor" href="#napi_is_promise" aria-label="Permalink to “‏napi_is_promise”">​</a></h3><p><strong>تمت إضافتها في: الإصدار 8.5.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                            bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> is_promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) تحتها.</li><li><code>[in] value</code>: القيمة المراد فحصها</li><li><code>[out] is_promise</code>: علامة تشير إلى ما إذا كانت <code>promise</code> كائن وعد أصلي (أي كائن وعد تم إنشاؤه بواسطة المحرك الأساسي).</li></ul><h2 id="script-execution" tabindex="-1">‏تنفيذ البرنامج النصي <a class="header-anchor" href="#script-execution" aria-label="Permalink to “‏تنفيذ البرنامج النصي”">​</a></h2><p>توفر Node-API واجهة برمجة تطبيقات لتنفيذ سلسلة نصية تحتوي على JavaScript باستخدام محرك JavaScript الأساسي.</p><h3 id="napi_run_script" tabindex="-1">‏<code>napi_run_script</code> <a class="header-anchor" href="#napi_run_script" aria-label="Permalink to “‏napi_run_script”">​</a></h3><p><strong>تمت إضافتها في: الإصدار 8.5.0</strong></p><p><strong>إصدار N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_run_script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) تحتها.</li><li><code>[in] script</code>: سلسلة JavaScript تحتوي على البرنامج النصي المراد تنفيذه.</li><li><code>[out] result</code>: القيمة الناتجة عن تنفيذ البرنامج النصي.</li></ul><p>تقوم هذه الدالة بتنفيذ سلسلة من تعليمات JavaScript البرمجية وإرجاع نتيجتها مع التحذيرات التالية:</p><ul><li>بخلاف <code>eval</code>، لا تسمح هذه الدالة للبرنامج النصي بالوصول إلى النطاق المعجمي الحالي، وبالتالي فهي لا تسمح أيضًا بالوصول إلى <a href="/ar/nodejs/api/modules#the-module-scope">نطاق الوحدة النمطية</a>، مما يعني أن العناصر الزائفة العامة مثل <code>require</code> لن تكون متاحة.</li><li>يمكن للبرنامج النصي الوصول إلى <a href="/ar/nodejs/api/globals">النطاق العام</a>. سيتم إضافة تعريفات الدوال و <code>var</code> في البرنامج النصي إلى كائن <a href="/ar/nodejs/api/globals#global"><code>global</code></a>. ستكون تعريفات المتغيرات التي تم إجراؤها باستخدام <code>let</code> و <code>const</code> مرئية عالميًا، ولكن لن تتم إضافتها إلى كائن <a href="/ar/nodejs/api/globals#global"><code>global</code></a>.</li><li>قيمة <code>this</code> هي <a href="/ar/nodejs/api/globals#global"><code>global</code></a> داخل البرنامج النصي.</li></ul><h2 id="libuv-event-loop" tabindex="-1">‏حلقة حدث libuv <a class="header-anchor" href="#libuv-event-loop" aria-label="Permalink to “‏حلقة حدث libuv”">​</a></h2><p>توفر Node-API دالة للحصول على حلقة الأحداث الحالية المرتبطة بـ <code>napi_env</code> محددة.</p><h3 id="napi_get_uv_event_loop" tabindex="-1">‏<code>napi_get_uv_event_loop</code> <a class="header-anchor" href="#napi_get_uv_event_loop" aria-label="Permalink to “‏napi_get_uv_event_loop”">​</a></h3><p><strong>تمت إضافتها في: الإصدار 9.3.0، الإصدار 8.10.0</strong></p><p><strong>إصدار N-API: 2</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_uv_event_loop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                               struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> uv_loop_s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> loop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) تحتها.</li><li><code>[out] loop</code>: مثيل حلقة libuv الحالية.</li></ul><p>ملاحظة: على الرغم من أن libuv كانت مستقرة نسبيًا بمرور الوقت، إلا أنها لا توفر ضمانًا لاستقرار ABI. يجب تجنب استخدام هذه الدالة. قد يؤدي استخدامه إلى إضافة لا تعمل عبر إصدارات Node.js. ‏<a href="/ar/nodejs/api/n-api#asynchronous-thread-safe-function-calls">asynchronous-thread-safe-function-calls</a> هي بديل للعديد من حالات الاستخدام.</p><h2 id="asynchronous-thread-safe-function-calls" tabindex="-1">استدعاءات الدوال الآمنة للخيوط غير المتزامنة <a class="header-anchor" href="#asynchronous-thread-safe-function-calls" aria-label="Permalink to “استدعاءات الدوال الآمنة للخيوط غير المتزامنة”">​</a></h2><p>لا يمكن استدعاء دوال JavaScript عادةً إلا من الخيط الرئيسي للإضافة الأصلية. إذا أنشأت إضافة خيوطًا إضافية، فلا يجب استدعاء دوال Node-API التي تتطلب <code>napi_env</code> أو <code>napi_value</code> أو <code>napi_ref</code> من هذه الخيوط.</p><p>عندما تحتوي إضافة على خيوط إضافية وتحتاج دوال JavaScript إلى استدعائها استنادًا إلى المعالجة التي أكملتها هذه الخيوط، يجب أن تتواصل هذه الخيوط مع الخيط الرئيسي للإضافة بحيث يمكن للخيط الرئيسي استدعاء دالة JavaScript نيابةً عنها. توفر واجهات برمجة تطبيقات الدوال الآمنة للخيوط طريقة سهلة للقيام بذلك.</p><p>توفر واجهات برمجة التطبيقات هذه النوع <code>napi_threadsafe_function</code> بالإضافة إلى واجهات برمجة التطبيقات لإنشاء وتدمير واستدعاء كائنات من هذا النوع. <code>napi_create_threadsafe_function()</code> تنشئ مرجعًا ثابتًا لـ <code>napi_value</code> يحمل دالة JavaScript يمكن استدعاؤها من خيوط متعددة. تحدث الاستدعاءات بشكل غير متزامن. هذا يعني أن القيم التي سيتم استدعاء JavaScript بها ستوضع في قائمة انتظار، وبالنسبة لكل قيمة في قائمة الانتظار، سيتم إجراء استدعاء في النهاية لدالة JavaScript.</p><p>عند إنشاء <code>napi_threadsafe_function</code>، يمكن توفير دالة استرجاع <code>napi_finalize</code>. سيتم استدعاء دالة الاسترجاع هذه على الخيط الرئيسي عندما تكون الدالة الآمنة للخيوط على وشك التدمير. تتلقى السياق وبيانات الإنهاء التي تم تقديمها أثناء الإنشاء، وتوفر فرصة للتنظيف بعد الخيوط، على سبيل المثال عن طريق استدعاء <code>uv_thread_join()</code>. <strong>بصرف النظر عن خيط الحلقة الرئيسية، لا ينبغي لأي خيوط استخدام الدالة الآمنة للخيوط بعد اكتمال دالة الاسترجاع النهائية.</strong></p><p>يمكن استرداد <code>context</code> الذي تم تقديمه أثناء استدعاء <code>napi_create_threadsafe_function()</code> من أي خيط باستدعاء <code>napi_get_threadsafe_function_context()</code>.</p><h3 id="calling-a-thread-safe-function" tabindex="-1">استدعاء دالة آمنة للخيوط <a class="header-anchor" href="#calling-a-thread-safe-function" aria-label="Permalink to “استدعاء دالة آمنة للخيوط”">​</a></h3><p>يمكن استخدام <code>napi_call_threadsafe_function()</code> لبدء استدعاء في JavaScript. تقبل <code>napi_call_threadsafe_function()</code> معلمة تتحكم في ما إذا كانت واجهة برمجة التطبيقات تتصرف بشكل حظر. إذا تم تعيينها على <code>napi_tsfn_nonblocking</code>، فإن واجهة برمجة التطبيقات تتصرف بطريقة غير حظر، وتعيد <code>napi_queue_full</code> إذا كانت قائمة الانتظار ممتلئة، مما يمنع إضافة البيانات بنجاح إلى قائمة الانتظار. إذا تم تعيينها على <code>napi_tsfn_blocking</code>، فإن واجهة برمجة التطبيقات تحظر حتى يصبح هناك مساحة متاحة في قائمة الانتظار. لا تحظر <code>napi_call_threadsafe_function()</code> أبدًا إذا تم إنشاء الدالة الآمنة للخيوط بحجم قائمة انتظار أقصى قدره 0.</p><p>يجب عدم استدعاء <code>napi_call_threadsafe_function()</code> مع <code>napi_tsfn_blocking</code> من خيط JavaScript، لأنه إذا كانت قائمة الانتظار ممتلئة، فقد يتسبب ذلك في توقف خيط JavaScript.</p><p>يتم التحكم في الاستدعاء الفعلي في JavaScript بواسطة دالة الاسترجاع التي يتم تقديمها عبر معلمة <code>call_js_cb</code>. يتم استدعاء <code>call_js_cb</code> على الخيط الرئيسي مرة واحدة لكل قيمة تم وضعها في قائمة الانتظار عن طريق استدعاء ناجح لـ <code>napi_call_threadsafe_function()</code>. إذا لم يتم تقديم دالة استرجاع كهذه، فسيتم استخدام دالة استرجاع افتراضية، ولن يحتوي استدعاء JavaScript الناتج على أي وسيطات. تتلقى دالة الاسترجاع <code>call_js_cb</code> دالة JavaScript المراد استدعاؤها كـ <code>napi_value</code> في معلماتها، بالإضافة إلى مؤشر سياق <code>void*</code> المستخدم عند إنشاء <code>napi_threadsafe_function</code>، ومؤشر البيانات التالي الذي تم إنشاؤه بواسطة أحد الخيوط الثانوية. يمكن لدالة الاسترجاع بعد ذلك استخدام واجهة برمجة تطبيقات مثل <code>napi_call_function()</code> للاستدعاء في JavaScript.</p><p>يمكن أيضًا استدعاء دالة الاسترجاع مع تعيين كل من <code>env</code> و <code>call_js_cb</code> على <code>NULL</code> للإشارة إلى أن الاستدعاءات في JavaScript لم تعد ممكنة، في حين تظل العناصر في قائمة الانتظار التي قد تحتاج إلى تحرير. يحدث هذا عادةً عندما تنتهي عملية Node.js أثناء وجود دالة آمنة للخيوط لا تزال نشطة.</p><p>ليس من الضروري الاستدعاء في JavaScript عبر <code>napi_make_callback()</code> لأن Node-API يقوم بتشغيل <code>call_js_cb</code> في سياق مناسب لعمليات الاسترجاع.</p><p>يمكن استدعاء صفر أو أكثر من العناصر الموجودة في قائمة الانتظار في كل نبضة من حلقة الأحداث. يجب ألا تعتمد التطبيقات على سلوك معين بخلاف إحراز تقدم في استدعاء عمليات الاسترجاع وسيتم استدعاء الأحداث مع تقدم الوقت.</p><h3 id="reference-counting-of-thread-safe-functions" tabindex="-1">تعداد المراجع إلى الدوال الآمنة مؤشرًا <a class="header-anchor" href="#reference-counting-of-thread-safe-functions" aria-label="Permalink to “تعداد المراجع إلى الدوال الآمنة مؤشرًا”">​</a></h3><p>يمكن إضافة سلاسل الرسائل وإزالتها من عنصر <code>napi_threadsafe_function</code> أثناء وجوده. وبالتالي، بالإضافة إلى تحديد عدد أولي من سلاسل الرسائل عند الإنشاء، يمكن استدعاء <code>napi_acquire_threadsafe_function</code> للإشارة إلى أن سلسلة رسائل جديدة ستبدأ في استخدام الدالة الآمنة مؤشرًا. وبالمثل، يمكن استدعاء <code>napi_release_threadsafe_function</code> للإشارة إلى أن سلسلة رسائل موجودة ستتوقف عن استخدام الدالة الآمنة مؤشرًا.</p><p>يتم تدمير عناصر <code>napi_threadsafe_function</code> عندما تستدعي كل سلسلة رسائل تستخدم العنصر <code>napi_release_threadsafe_function()</code> أو تتلقى حالة إرجاع <code>napi_closing</code> استجابةً لاستدعاء <code>napi_call_threadsafe_function</code>. يتم إفراغ قائمة الانتظار قبل تدمير <code>napi_threadsafe_function</code>. يجب أن يكون <code>napi_release_threadsafe_function()</code> هو آخر استدعاء API يتم إجراؤه جنبًا إلى جنب مع <code>napi_threadsafe_function</code> معينة، لأنه بعد اكتمال الاستدعاء، لا يوجد ضمان بأن <code>napi_threadsafe_function</code> لا تزال مخصصة. للسبب نفسه، لا تستخدم دالة آمنة مؤشرًا بعد تلقي قيمة إرجاع <code>napi_closing</code> استجابةً لاستدعاء <code>napi_call_threadsafe_function</code>. يمكن تحرير البيانات المرتبطة بـ <code>napi_threadsafe_function</code> في رد الاتصال <code>napi_finalize</code> الخاص بها والذي تم تمريره إلى <code>napi_create_threadsafe_function()</code>. تحدد المعلمة <code>initial_thread_count</code> لـ <code>napi_create_threadsafe_function</code> العدد الأولي لعمليات الاستحواذ على الدوال الآمنة مؤشرًا، بدلاً من استدعاء <code>napi_acquire_threadsafe_function</code> عدة مرات عند الإنشاء.</p><p>بمجرد أن يصل عدد سلاسل الرسائل التي تستخدم <code>napi_threadsafe_function</code> إلى الصفر، لا يمكن لأي سلاسل رسائل أخرى أن تبدأ في استخدامها عن طريق استدعاء <code>napi_acquire_threadsafe_function()</code>. في الواقع، ستعيد جميع استدعاءات API اللاحقة المرتبطة بها، باستثناء <code>napi_release_threadsafe_function()</code>، قيمة خطأ <code>napi_closing</code>.</p><p>يمكن &quot;إجهاض&quot; الدالة الآمنة مؤشرًا عن طريق إعطاء قيمة <code>napi_tsfn_abort</code> إلى <code>napi_release_threadsafe_function()</code>. سيؤدي ذلك إلى إعادة جميع واجهات برمجة التطبيقات اللاحقة المرتبطة بالدالة الآمنة مؤشرًا باستثناء <code>napi_release_threadsafe_function()</code> إلى <code>napi_closing</code> حتى قبل أن يصل عدد المراجع الخاص بها إلى الصفر. على وجه الخصوص، ستعيد <code>napi_call_threadsafe_function()</code> قيمة <code>napi_closing</code>، وبالتالي إعلام سلاسل الرسائل بأنه لم يعد من الممكن إجراء مكالمات غير متزامنة إلى الدالة الآمنة مؤشرًا. يمكن استخدام هذا كمعيار لإنهاء سلسلة الرسائل. <strong>عند تلقي قيمة إرجاع <code>napi_closing</code> من <code>napi_call_threadsafe_function()</code>، يجب ألا تستخدم سلسلة الرسائل الدالة الآمنة مؤشرًا بعد الآن لأنه لم يعد مضمونًا أنه تم تخصيصه.</strong></p><h3 id="deciding-whether-to-keep-the-process-running" tabindex="-1">تحديد ما إذا كان يجب إبقاء العملية قيد التشغيل <a class="header-anchor" href="#deciding-whether-to-keep-the-process-running" aria-label="Permalink to “تحديد ما إذا كان يجب إبقاء العملية قيد التشغيل”">​</a></h3><p>على غرار معالجات libuv، يمكن &quot;الإشارة&quot; إلى الدوال الآمنة مؤشرات الترابط و &quot;إلغاء الإشارة&quot; إليها. ستتسبب الدالة الآمنة مؤشرات الترابط &quot;المشار إليها&quot; في بقاء حلقة الأحداث على مؤشر الترابط الذي تم إنشاؤها عليه حية حتى يتم تدمير الدالة الآمنة مؤشرات الترابط. في المقابل، لن تمنع الدالة الآمنة مؤشرات الترابط &quot;غير المشار إليها&quot; حلقة الأحداث من الخروج. توجد واجهات برمجة التطبيقات <code>napi_ref_threadsafe_function</code> و <code>napi_unref_threadsafe_function</code> لهذا الغرض.</p><p>لا يحدد <code>napi_unref_threadsafe_function</code> الدوال الآمنة مؤشرات الترابط على أنها قابلة للتدمير ولا يمنع <code>napi_ref_threadsafe_function</code> تدميرها.</p><h3 id="napi_create_threadsafe_function" tabindex="-1"><code>napi_create_threadsafe_function</code> <a class="header-anchor" href="#napi_create_threadsafe_function" aria-label="Permalink to “napi_create_threadsafe_function”">​</a></h3><div class="info custom-block"><p class="custom-block-title">[التاريخ]</p><table tabindex="0"><thead><tr><th>الإصدار</th><th>التغييرات</th></tr></thead><tbody><tr><td>الإصدار 12.6.0، الإصدار 10.17.0</td><td>تم جعل المعلمة <code>func</code> اختيارية مع <code>call_js_cb</code> مخصصة.</td></tr><tr><td>الإصدار 10.6.0</td><td>تمت إضافته في: الإصدار 10.6.0</td></tr></tbody></table></div><p><strong>إصدار N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> max_queue_size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> initial_thread_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> thread_finalize_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">thread_finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_threadsafe_function_call_js </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">call_js_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_threadsafe_function</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات بموجبها.</li><li><code>[in] func</code>: دالة JavaScript اختيارية للاتصال بها من مؤشر ترابط آخر. يجب توفيرها إذا تم تمرير <code>NULL</code> إلى <code>call_js_cb</code>.</li><li><code>[in] async_resource</code>: كائن اختياري مرتبط بالعمل غير المتزامن الذي سيتم تمريره إلى <code>async_hooks</code> المحتملة <a href="/ar/nodejs/api/async_hooks#initasyncid-type-triggerasyncid-resource"><code>init</code> hooks</a>.</li><li><code>[in] async_resource_name</code>: سلسلة JavaScript لتوفير معرف لنوع المورد الذي يتم توفيره لمعلومات التشخيص التي تعرضها واجهة برمجة التطبيقات <code>async_hooks</code>.</li><li><code>[in] max_queue_size</code>: الحد الأقصى لحجم قائمة الانتظار. <code>0</code> بدون حد.</li><li><code>[in] initial_thread_count</code>: العدد الأولي لعمليات الاستحواذ، أي العدد الأولي للمؤشرات الترابطية، بما في ذلك المؤشر الترابطي الرئيسي، الذي سيستخدم هذه الدالة.</li><li><code>[in] thread_finalize_data</code>: بيانات اختيارية ليتم تمريرها إلى <code>thread_finalize_cb</code>.</li><li><code>[in] thread_finalize_cb</code>: دالة اختيارية للاتصال بها عند تدمير <code>napi_threadsafe_function</code>.</li><li><code>[in] context</code>: بيانات اختيارية لإرفاقها بـ <code>napi_threadsafe_function</code> الناتج.</li><li><code>[in] call_js_cb</code>: رد اتصال اختياري يستدعي دالة JavaScript استجابةً لطلب في مؤشر ترابط مختلف. سيتم استدعاء رد الاتصال هذا في المؤشر الترابطي الرئيسي. إذا لم يتم تقديمه، فسيتم استدعاء دالة JavaScript بدون معلمات ومع <code>undefined</code> كقيمة <code>this</code> الخاصة بها. <a href="/ar/nodejs/api/n-api#napi-threadsafe-function-call-js"><code>napi_threadsafe_function_call_js</code></a> يوفر المزيد من التفاصيل.</li><li><code>[out] result</code>: دالة JavaScript غير متزامنة وآمنة مؤشرات الترابط.</li></ul><p><strong>سجل التغييرات:</strong></p><ul><li>تجريبي (تم تعريف <code>NAPI_EXPERIMENTAL</code>): يتم التعامل مع الاستثناءات غير الملتقطة التي يتم طرحها في <code>call_js_cb</code> باستخدام حدث <a href="/ar/nodejs/api/process#event-uncaughtexception"><code>&#39;uncaughtException&#39;</code></a>، بدلاً من تجاهلها.</li></ul><h3 id="napi_get_threadsafe_function_context" tabindex="-1">‏<code>napi_get_threadsafe_function_context</code> <a class="header-anchor" href="#napi_get_threadsafe_function_context" aria-label="Permalink to “‏napi_get_threadsafe_function_context”">​</a></h3><p><strong>تمت الإضافة في: الإصدار v10.6.0</strong></p><p><strong>إصدار N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_threadsafe_function_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>‏<code>[in] func</code>: الدالة الآمنة للخيوط التي سيتم استرداد السياق لها.</li><li>‏<code>[out] result</code>: الموقع الذي سيتم فيه تخزين السياق.</li></ul><p>يمكن استدعاء هذا API من أي خيط يستخدم ‏<code>func</code>.</p><h3 id="napi_call_threadsafe_function" tabindex="-1">‏<code>napi_call_threadsafe_function</code> <a class="header-anchor" href="#napi_call_threadsafe_function" aria-label="Permalink to “‏napi_call_threadsafe_function”">​</a></h3><div class="info custom-block"><p class="custom-block-title">[سجل التغييرات]</p><table tabindex="0"><thead><tr><th>الإصدار</th><th>التغييرات</th></tr></thead><tbody><tr><td>v14.5.0</td><td>تم إرجاع دعم ‏<code>napi_would_deadlock</code>.</td></tr><tr><td>v14.1.0</td><td>إرجاع ‏<code>napi_would_deadlock</code> عند الاستدعاء مع ‏<code>napi_tsfn_blocking</code> من الخيط الرئيسي أو خيط العامل والصف ممتلئ.</td></tr><tr><td>v10.6.0</td><td>تمت الإضافة في: الإصدار v10.6.0</td></tr></tbody></table></div><p><strong>إصدار N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_call_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_threadsafe_function_call_mode </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">is_blocking</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>‏<code>[in] func</code>: دالة JavaScript غير المتزامنة الآمنة للخيوط التي سيتم استدعاؤها.</li><li>‏<code>[in] data</code>: البيانات التي سيتم إرسالها إلى JavaScript عبر رد الاتصال ‏<code>call_js_cb</code> المتوفر أثناء إنشاء دالة JavaScript الآمنة للخيوط.</li><li>‏<code>[in] is_blocking</code>: علامة يمكن أن تكون قيمتها إما ‏<code>napi_tsfn_blocking</code> للإشارة إلى أن الاستدعاء يجب أن يحظر إذا كان الصف ممتلئًا أو ‏<code>napi_tsfn_nonblocking</code> للإشارة إلى أن الاستدعاء يجب أن يعود على الفور بحالة ‏<code>napi_queue_full</code> متى كان الصف ممتلئًا.</li></ul><p>لا يجب استدعاء هذا API مع ‏<code>napi_tsfn_blocking</code> من خيط JavaScript، لأنه، إذا كان الصف ممتلئًا، فقد يتسبب في حدوث توقف تام لخيط JavaScript.</p><p>سيعيد هذا API ‏<code>napi_closing</code> إذا تم استدعاء ‏<code>napi_release_threadsafe_function()</code> مع تعيين ‏<code>abort</code> على ‏<code>napi_tsfn_abort</code> من أي خيط. تتم إضافة القيمة فقط إلى الصف إذا أعاد API ‏<code>napi_ok</code>.</p><p>يمكن استدعاء هذا API من أي خيط يستخدم ‏<code>func</code>.</p><h3 id="napi_acquire_threadsafe_function" tabindex="-1">‏<code>napi_acquire_threadsafe_function</code> <a class="header-anchor" href="#napi_acquire_threadsafe_function" aria-label="Permalink to “‏napi_acquire_threadsafe_function”">​</a></h3><p><strong>تمت الإضافة في: الإصدار v10.6.0</strong></p><p><strong>إصدار N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_acquire_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>‏<code>[in] func</code>: دالة JavaScript غير المتزامنة الآمنة للخيوط لبدء استخدامها.</li></ul><p>يجب أن يستدعي الخيط هذا API قبل تمرير ‏<code>func</code> إلى أي APIs أخرى آمنة للخيوط للإشارة إلى أنه سيستخدم ‏<code>func</code>. يمنع هذا تدمير ‏<code>func</code> عندما تتوقف جميع الخيوط الأخرى عن استخدامه.</p><p>يمكن استدعاء هذا API من أي خيط سيبدأ في استخدام ‏<code>func</code>.</p><h3 id="napi_release_threadsafe_function" tabindex="-1"><code>napi_release_threadsafe_function</code> <a class="header-anchor" href="#napi_release_threadsafe_function" aria-label="Permalink to “napi_release_threadsafe_function”">​</a></h3><p><strong>أضيف في: الإصدار v10.6.0</strong></p><p><strong>إصدار N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_release_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_threadsafe_function_release_mode </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] func</code>: دالة JavaScript غير متزامنة وآمنة لسلاسل العمليات سيتم تخفيض عدد مراجعها.</li><li><code>[in] mode</code>: علامة يمكن أن تكون قيمتها إما <code>napi_tsfn_release</code> للإشارة إلى أن سلسلة العمليات الحالية لن تجري أي مكالمات أخرى للدالة الآمنة لسلاسل العمليات، أو <code>napi_tsfn_abort</code> للإشارة إلى أنه بالإضافة إلى سلسلة العمليات الحالية، لا ينبغي لأي سلسلة عمليات أخرى إجراء أي مكالمات أخرى للدالة الآمنة لسلاسل العمليات. إذا تم تعيينها على <code>napi_tsfn_abort</code>، فسترجع المكالمات الأخرى إلى <code>napi_call_threadsafe_function()</code> قيمة <code>napi_closing</code>، ولن يتم وضع أي قيم أخرى في قائمة الانتظار.</li></ul><p>يجب على سلسلة العمليات استدعاء واجهة برمجة التطبيقات (API) هذه عندما تتوقف عن استخدام <code>func</code>. تمرير <code>func</code> إلى أي واجهات برمجة تطبيقات آمنة لسلاسل العمليات بعد استدعاء واجهة برمجة التطبيقات (API) هذه له نتائج غير محددة، حيث قد تكون <code>func</code> قد تم تدميرها.</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه من أي سلسلة عمليات ستتوقف عن استخدام <code>func</code>.</p><h3 id="napi_ref_threadsafe_function" tabindex="-1"><code>napi_ref_threadsafe_function</code> <a class="header-anchor" href="#napi_ref_threadsafe_function" aria-label="Permalink to “napi_ref_threadsafe_function”">​</a></h3><p><strong>أضيف في: الإصدار v10.6.0</strong></p><p><strong>إصدار N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_ref_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] func</code>: الدالة الآمنة لسلاسل العمليات المراد الإشارة إليها.</li></ul><p>تُستخدم واجهة برمجة التطبيقات (API) هذه للإشارة إلى أن حلقة الأحداث التي تعمل على سلسلة العمليات الرئيسية يجب ألا تخرج حتى يتم تدمير <code>func</code>. على غرار <a href="https://docs.libuv.org/en/v1.x/handle#c.uv_ref" target="_blank" rel="noreferrer"><code>uv_ref</code></a> فهي أيضًا عديمة التأثير.</p><p>لا تحدد <code>napi_unref_threadsafe_function</code> الدوال الآمنة لسلاسل العمليات على أنها قابلة للتدمير ولا تمنع <code>napi_ref_threadsafe_function</code> تدميرها. <code>napi_acquire_threadsafe_function</code> و <code>napi_release_threadsafe_function</code> متاحتان لهذا الغرض.</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه فقط من سلسلة العمليات الرئيسية.</p><h3 id="napi_unref_threadsafe_function" tabindex="-1"><code>napi_unref_threadsafe_function</code> <a class="header-anchor" href="#napi_unref_threadsafe_function" aria-label="Permalink to “napi_unref_threadsafe_function”">​</a></h3><p><strong>أضيف في: الإصدار v10.6.0</strong></p><p><strong>إصدار N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_unref_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[in] func</code>: الدالة الآمنة لسلاسل العمليات المراد إلغاء الإشارة إليها.</li></ul><p>تُستخدم واجهة برمجة التطبيقات (API) هذه للإشارة إلى أن حلقة الأحداث التي تعمل على سلسلة العمليات الرئيسية قد تخرج قبل تدمير <code>func</code>. على غرار <a href="https://docs.libuv.org/en/v1.x/handle#c.uv_unref" target="_blank" rel="noreferrer"><code>uv_unref</code></a> فهي أيضًا عديمة التأثير.</p><p>يمكن استدعاء واجهة برمجة التطبيقات (API) هذه فقط من سلسلة العمليات الرئيسية.</p><h2 id="miscellaneous-utilities" tabindex="-1">أدوات متنوعة <a class="header-anchor" href="#miscellaneous-utilities" aria-label="Permalink to “أدوات متنوعة”">​</a></h2><h3 id="node_api_get_module_file_name" tabindex="-1"><code>node_api_get_module_file_name</code> <a class="header-anchor" href="#node_api_get_module_file_name" aria-label="Permalink to “node_api_get_module_file_name”">​</a></h3><p><strong>تمت إضافته في: v15.9.0, v14.18.0, v12.22.0</strong></p><p><strong>إصدار N-API: 9</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_get_module_file_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: البيئة التي يتم استدعاء واجهة برمجة التطبيقات (API) ضمنها.</li><li><code>[out] result</code>: عنوان URL يحتوي على المسار المطلق للموقع الذي تم تحميل الوظيفة الإضافية منه. بالنسبة لملف على نظام الملفات المحلي، سيبدأ بـ <code>file://</code>. السلسلة منتهية بـ null ومملوكة لـ <code>env</code> وبالتالي يجب عدم تعديلها أو تحريرها.</li></ul><p>قد تكون <code>result</code> سلسلة فارغة إذا فشلت عملية تحميل الوظيفة الإضافية في تحديد اسم ملف الوظيفة الإضافية أثناء التحميل.</p></div></div></main><footer class="VPDocFooter" data-v-d668f7cc data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/ar/nodejs/api/addons" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>الصفحة السابقة</span><span class="title" data-v-1bcd8184>إضافات C++</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/ar/nodejs/api/embedding" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>الصفحة التالية</span><span class="title" data-v-1bcd8184>API التكامل C++</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-4539713c data-v-5b9946f5><div class="container" data-v-5b9946f5><p class="message" data-v-5b9946f5><a href="https://idoc.dev/ar/privacy">سياسة الخصوصية</a></p><p class="copyright" data-v-5b9946f5>جميع الحقوق محفوظة © 2024-الحاضر <a href="https://idoc.dev/ar/">iDoc.dev</a></p></div></footer><!--[--><!--]--></div></div>
    
    
  </body>
</html>