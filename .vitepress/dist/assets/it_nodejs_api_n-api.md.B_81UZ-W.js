import{__plugin_vue_export_helper_default as e,createElementBlock as t,createStaticVNode as n,openBlock as r}from"./chunks/plugin-vue_export-helper.Bts1mPc7.js";const i=JSON.parse(`{"title":"Documentazione N-API di Node.js","description":"L'N-API (Node.js API) fornisce un'interfaccia stabile e coerente per i moduli nativi, permettendo agli sviluppatori di creare moduli compatibili con diverse versioni di Node.js.","frontmatter":{"title":"Documentazione N-API di Node.js","description":"L'N-API (Node.js API) fornisce un'interfaccia stabile e coerente per i moduli nativi, permettendo agli sviluppatori di creare moduli compatibili con diverse versioni di Node.js.","head":[["meta",{"name":"og:title","content":"Documentazione N-API di Node.js | Node.js - iDoc.dev"}],["meta",{"name":"og:description","content":"L'N-API (Node.js API) fornisce un'interfaccia stabile e coerente per i moduli nativi, permettendo agli sviluppatori di creare moduli compatibili con diverse versioni di Node.js."}],["meta",{"name":"twitter:title","content":"Documentazione N-API di Node.js | Node.js - iDoc.dev"}],["meta",{"name":"twitter:description","content":"L'N-API (Node.js API) fornisce un'interfaccia stabile e coerente per i moduli nativi, permettendo agli sviluppatori di creare moduli compatibili con diverse versioni di Node.js."}],["link",{"rel":"canonical","href":"https://idoc.dev/it/nodejs/api/n-api"}],["meta",{"property":"og:url","content":"https://idoc.dev/it/nodejs/api/n-api"}]]},"headers":[],"relativePath":"it/nodejs/api/n-api.md","filePath":"it/nodejs/api/n-api.md","lastUpdated":null}`),a={name:`it/nodejs/api/n-api.md`};function o(e,i,a,o,s,c){return r(),t(`div`,null,i[0]||=[n(`<h1 id="node-api" tabindex="-1">Node-API <a class="header-anchor" href="#node-api" aria-label="Permalink to “Node-API”">​</a></h1><div class="tip custom-block"><p class="custom-block-title">[Stable: 2 - Stabile]</p><p><a href="/it/nodejs/api/documentation#stability-index">Stable: 2</a> <a href="/it/nodejs/api/documentation#stability-index">Stabilità: 2</a> - Stabile</p></div><p>Node-API (precedentemente N-API) è un&#39;API per la creazione di Addon nativi. È indipendente dal runtime JavaScript sottostante (ad esempio, V8) ed è gestita come parte di Node.js stesso. Questa API sarà Application Binary Interface (ABI) stabile tra le versioni di Node.js. Ha lo scopo di isolare gli addon dalle modifiche nel motore JavaScript sottostante e consentire ai moduli compilati per una versione principale di essere eseguiti su versioni principali successive di Node.js senza ricompilazione. La guida alla <a href="https://nodejs.org/en/docs/guides/abi-stability/" target="_blank" rel="noreferrer">Stabilità ABI</a> fornisce una spiegazione più approfondita.</p><p>Gli addon vengono creati/impacchettati con lo stesso approccio/strumenti descritti nella sezione intitolata <a href="/it/nodejs/api/addons">Addon C++</a>. L&#39;unica differenza è l&#39;insieme di API utilizzate dal codice nativo. Invece di utilizzare le API V8 o <a href="https://github.com/nodejs/nan" target="_blank" rel="noreferrer">Native Abstractions for Node.js</a>, vengono utilizzate le funzioni disponibili in Node-API.</p><p>Le API esposte da Node-API vengono generalmente utilizzate per creare e manipolare valori JavaScript. I concetti e le operazioni generalmente corrispondono a idee specificate nella specifica del linguaggio ECMA-262. Le API hanno le seguenti proprietà:</p><ul><li>Tutte le chiamate Node-API restituiscono un codice di stato di tipo <code>napi_status</code>. Questo stato indica se la chiamata API ha avuto successo o meno.</li><li>Il valore di ritorno dell&#39;API viene passato tramite un parametro out.</li><li>Tutti i valori JavaScript sono astratti dietro un tipo opaco denominato <code>napi_value</code>.</li><li>In caso di codice di stato di errore, è possibile ottenere ulteriori informazioni utilizzando <code>napi_get_last_error_info</code>. Ulteriori informazioni sono disponibili nella sezione sulla gestione degli errori <a href="/it/nodejs/api/n-api#error-handling">Gestione degli errori</a>.</li></ul><p>Node-API è una C API che garantisce la stabilità ABI tra le versioni di Node.js e diversi livelli di compilatore. Una C++ API può essere più facile da usare. Per supportare l&#39;uso di C++, il progetto gestisce un modulo wrapper C++ chiamato <a href="https://github.com/nodejs/node-addon-api" target="_blank" rel="noreferrer"><code>node-addon-api</code></a>. Questo wrapper fornisce una C++ API inlinable. I binari creati con <code>node-addon-api</code> dipenderanno dai simboli per le funzioni basate su C Node-API esportate da Node.js. <code>node-addon-api</code> è un modo più efficiente per scrivere codice che chiama Node-API. Si prenda, ad esempio, il seguente codice <code>node-addon-api</code>. La prima sezione mostra il codice <code>node-addon-api</code> e la seconda sezione mostra cosa viene effettivamente utilizzato nell&#39;addon.</p><div class="language-C++ line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C++</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Object obj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-C++ line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C++</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value object, string;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">object);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  napi_throw_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, ...);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_string_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, NAPI_AUTO_LENGTH, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">string);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  napi_throw_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, ...);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, object, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, string);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  napi_throw_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, ...);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>Il risultato finale è che l&#39;addon utilizza solo le API C esportate. Di conseguenza, ottiene comunque i vantaggi della stabilità ABI fornita dalla C API.</p><p>Quando si utilizza <code>node-addon-api</code> invece delle API C, iniziare con la <a href="https://github.com/nodejs/node-addon-api#api-documentation" target="_blank" rel="noreferrer">documentazione</a> dell&#39;API per <code>node-addon-api</code>.</p><p>La <a href="https://nodejs.github.io/node-addon-examples/" target="_blank" rel="noreferrer">Risorsa Node-API</a> offre un eccellente orientamento e suggerimenti per gli sviluppatori che hanno appena iniziato con Node-API e <code>node-addon-api</code>. Ulteriori risorse multimediali sono disponibili nella pagina <a href="https://github.com/nodejs/abi-stable-node/blob/HEAD/node-api-media.md" target="_blank" rel="noreferrer">Node-API Media</a>.</p><h2 id="implications-of-abi-stability" tabindex="-1">Implicazioni della Stabilità dell&#39;ABI <a class="header-anchor" href="#implications-of-abi-stability" aria-label="Permalink to “Implicazioni della Stabilità dell&#39;ABI”">​</a></h2><p>Sebbene Node-API fornisca una garanzia di stabilità dell&#39;ABI, altre parti di Node.js non lo fanno, e qualsiasi libreria esterna utilizzata dall&#39;addon potrebbe non farlo. In particolare, nessuna delle seguenti API fornisce una garanzia di stabilità dell&#39;ABI tra le versioni principali:</p><ul><li>le API C++ di Node.js disponibili tramite</li><li>le API libuv che sono anche incluse con Node.js e disponibili tramite</li><li>l&#39;API V8 disponibile tramite</li></ul><p>Pertanto, affinché un addon rimanga compatibile con l&#39;ABI tra le versioni principali di Node.js, deve utilizzare esclusivamente Node-API limitandosi a usare</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>e controllando, per tutte le librerie esterne che utilizza, che la libreria esterna fornisca garanzie di stabilità dell&#39;ABI simili a Node-API.</p><h2 id="building" tabindex="-1">Compilazione <a class="header-anchor" href="#building" aria-label="Permalink to “Compilazione”">​</a></h2><p>A differenza dei moduli scritti in JavaScript, lo sviluppo e la distribuzione di addon nativi Node.js utilizzando Node-API richiede un set aggiuntivo di strumenti. Oltre agli strumenti di base necessari per lo sviluppo per Node.js, lo sviluppatore di addon nativi richiede una toolchain in grado di compilare codice C e C++ in un binario. Inoltre, a seconda di come viene distribuito l&#39;addon nativo, l&#39; <em>utente</em> dell&#39;addon nativo dovrà anche avere una toolchain C/C++ installata.</p><p>Per gli sviluppatori Linux, i pacchetti toolchain C/C++ necessari sono facilmente disponibili. <a href="https://gcc.gnu.org/" target="_blank" rel="noreferrer">GCC</a> è ampiamente utilizzato nella comunità Node.js per compilare e testare su una varietà di piattaforme. Per molti sviluppatori, anche l&#39;infrastruttura del compilatore <a href="https://llvm.org/" target="_blank" rel="noreferrer">LLVM</a> è una buona scelta.</p><p>Per gli sviluppatori Mac, <a href="https://developer.apple.com/xcode/" target="_blank" rel="noreferrer">Xcode</a> offre tutti gli strumenti di compilazione necessari. Tuttavia, non è necessario installare l&#39;intero IDE Xcode. Il seguente comando installa la toolchain necessaria:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xcode-select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --install</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Per gli sviluppatori Windows, <a href="https://visualstudio.microsoft.com/" target="_blank" rel="noreferrer">Visual Studio</a> offre tutti gli strumenti di compilazione necessari. Tuttavia, non è necessario installare l&#39;intero IDE di Visual Studio. Il seguente comando installa la toolchain necessaria:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> windows-build-tools</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Le sezioni seguenti descrivono gli strumenti aggiuntivi disponibili per lo sviluppo e la distribuzione di addon nativi Node.js.</p><h3 id="build-tools" tabindex="-1">Strumenti di compilazione <a class="header-anchor" href="#build-tools" aria-label="Permalink to “Strumenti di compilazione”">​</a></h3><p>Entrambi gli strumenti elencati qui richiedono che gli <em>utenti</em> dell&#39;addon nativo abbiano una toolchain C/C++ installata per poter installare correttamente l&#39;addon nativo.</p><h4 id="node-gyp" tabindex="-1">node-gyp <a class="header-anchor" href="#node-gyp" aria-label="Permalink to “node-gyp”">​</a></h4><p><a href="https://github.com/nodejs/node-gyp" target="_blank" rel="noreferrer">node-gyp</a> è un sistema di compilazione basato sul fork <a href="https://github.com/nodejs/gyp-next" target="_blank" rel="noreferrer">gyp-next</a> dello strumento <a href="https://gyp.gsrc.io/" target="_blank" rel="noreferrer">GYP</a> di Google ed è incluso in npm. GYP, e quindi node-gyp, richiede che Python sia installato.</p><p>Storicamente, node-gyp è stato lo strumento preferito per la compilazione di addon nativi. Ha un&#39;ampia adozione e documentazione. Tuttavia, alcuni sviluppatori hanno riscontrato limitazioni in node-gyp.</p><h4 id="cmakejs" tabindex="-1">CMake.js <a class="header-anchor" href="#cmakejs" aria-label="Permalink to “CMake.js”">​</a></h4><p><a href="https://github.com/cmake-js/cmake-js" target="_blank" rel="noreferrer">CMake.js</a> è un sistema di compilazione alternativo basato su <a href="https://cmake.org/" target="_blank" rel="noreferrer">CMake</a>.</p><p>CMake.js è una buona scelta per i progetti che già utilizzano CMake o per gli sviluppatori interessati dalle limitazioni di node-gyp. <a href="https://github.com/nodejs/node-addon-examples/tree/main/src/8-tooling/build_with_cmake" target="_blank" rel="noreferrer"><code>build_with_cmake</code></a> è un esempio di progetto di addon nativo basato su CMake.</p><h3 id="uploading-precompiled-binaries" tabindex="-1">Caricamento di binari precompilati <a class="header-anchor" href="#uploading-precompiled-binaries" aria-label="Permalink to “Caricamento di binari precompilati”">​</a></h3><p>I tre strumenti elencati qui consentono agli sviluppatori e ai manutentori di addon nativi di creare e caricare binari su server pubblici o privati. Questi strumenti sono tipicamente integrati con sistemi di compilazione CI/CD come <a href="https://travis-ci.org/" target="_blank" rel="noreferrer">Travis CI</a> e <a href="https://www.appveyor.com/" target="_blank" rel="noreferrer">AppVeyor</a> per compilare e caricare binari per una varietà di piattaforme e architetture. Questi binari sono quindi disponibili per il download da parte degli utenti che non hanno bisogno di avere una toolchain C/C++ installata.</p><h4 id="node-pre-gyp" tabindex="-1">node-pre-gyp <a class="header-anchor" href="#node-pre-gyp" aria-label="Permalink to “node-pre-gyp”">​</a></h4><p><a href="https://github.com/mapbox/node-pre-gyp" target="_blank" rel="noreferrer">node-pre-gyp</a> è uno strumento basato su node-gyp che aggiunge la possibilità di caricare binari su un server a scelta dello sviluppatore. node-pre-gyp ha un supporto particolarmente buono per il caricamento di binari su Amazon S3.</p><h4 id="prebuild" tabindex="-1">prebuild <a class="header-anchor" href="#prebuild" aria-label="Permalink to “prebuild”">​</a></h4><p><a href="https://github.com/prebuild/prebuild" target="_blank" rel="noreferrer">prebuild</a> è uno strumento che supporta le compilazioni utilizzando sia node-gyp che CMake.js. A differenza di node-pre-gyp che supporta una varietà di server, prebuild carica i binari solo su <a href="https://help.github.com/en/github/administering-a-repository/about-releases" target="_blank" rel="noreferrer">GitHub releases</a>. prebuild è una buona scelta per i progetti GitHub che utilizzano CMake.js.</p><h4 id="prebuildify" tabindex="-1">prebuildify <a class="header-anchor" href="#prebuildify" aria-label="Permalink to “prebuildify”">​</a></h4><p><a href="https://github.com/prebuild/prebuildify" target="_blank" rel="noreferrer">prebuildify</a> è uno strumento basato su node-gyp. Il vantaggio di prebuildify è che i binari compilati sono raggruppati con l&#39;addon nativo quando viene caricato su npm. I binari vengono scaricati da npm e sono immediatamente disponibili per l&#39;utente del modulo quando l&#39;addon nativo viene installato.</p><h2 id="usage" tabindex="-1">Utilizzo <a class="header-anchor" href="#usage" aria-label="Permalink to “Utilizzo”">​</a></h2><p>Per utilizzare le funzioni Node-API, includi il file <a href="https://github.com/nodejs/node/blob/HEAD/src/node_api.h" target="_blank" rel="noreferrer"><code>node_api.h</code></a> che si trova nella directory src nell&#39;albero di sviluppo di node:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Questo opterà per la <code>NAPI_VERSION</code> predefinita per la release specificata di Node.js. Per garantire la compatibilità con versioni specifiche di Node-API, la versione può essere specificata esplicitamente quando si include l&#39;header:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NAPI_VERSION</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Questo limita la superficie di Node-API alla sola funzionalità disponibile nelle versioni specificate (e precedenti).</p><p>Alcune parti della superficie di Node-API sono sperimentali e richiedono un&#39;adesione esplicita:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NAPI_EXPERIMENTAL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>In questo caso, l&#39;intera superficie API, comprese le API sperimentali, sarà disponibile per il codice del modulo.</p><p>Occasionalmente, vengono introdotte funzionalità sperimentali che influiscono su API già rilasciate e stabili. Queste funzionalità possono essere disabilitate tramite un opt-out:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NAPI_EXPERIMENTAL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NODE_API_EXPERIMENTAL_</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FEATURE_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_OPT_OUT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>dove <code>\\&lt;FEATURE_NAME\\&gt;</code> è il nome di una funzionalità sperimentale che influisce sia sulle API sperimentali che su quelle stabili.</p><h2 id="node-api-version-matrix" tabindex="-1">Tabella di compatibilità delle versioni di Node-API <a class="header-anchor" href="#node-api-version-matrix" aria-label="Permalink to “Tabella di compatibilità delle versioni di Node-API”">​</a></h2><p>Fino alla versione 9, le versioni di Node-API erano additive e versionate indipendentemente da Node.js. Ciò significava che ogni versione era un&#39;estensione della versione precedente in quanto aveva tutte le API della versione precedente con alcune aggiunte. Ogni versione di Node.js supportava solo una singola versione di Node-API. Ad esempio, v18.15.0 supporta solo la versione 8 di Node-API. La stabilità ABI è stata raggiunta perché 8 era un sovrainsieme stretto di tutte le versioni precedenti.</p><p>A partire dalla versione 9, sebbene le versioni di Node-API continuino a essere versionate in modo indipendente, un add-on che veniva eseguito con la versione 9 di Node-API potrebbe richiedere aggiornamenti del codice per essere eseguito con la versione 10 di Node-API. La stabilità ABI viene mantenuta, tuttavia, poiché le versioni di Node.js che supportano versioni di Node-API superiori a 8 supporteranno tutte le versioni comprese tra 8 e la versione più alta che supportano e per impostazione predefinita forniranno le API della versione 8 a meno che un add-on non scelga una versione di Node-API superiore. Questo approccio offre la flessibilità di ottimizzare meglio le funzioni Node-API esistenti mantenendo la stabilità ABI. Gli add-on esistenti possono continuare a essere eseguiti senza ricompilazione utilizzando una versione precedente di Node-API. Se un add-on necessita di funzionalità da una versione più recente di Node-API, saranno necessari modifiche al codice esistente e ricompilazione per utilizzare comunque quelle nuove funzioni.</p><p>Nelle versioni di Node.js che supportano la versione 9 e successive di Node-API, la definizione di <code>NAPI_VERSION=X</code> e l&#39;utilizzo delle macro di inizializzazione degli add-on esistenti incorporeranno la versione di Node-API richiesta che verrà utilizzata in fase di esecuzione nell&#39;add-on. Se <code>NAPI_VERSION</code> non è impostato, verrà impostato di default su 8.</p><p>Questa tabella potrebbe non essere aggiornata negli stream precedenti, le informazioni più aggiornate si trovano nella documentazione API più recente in: <a href="/it/nodejs/api/n-api#node-api-version-matrix">Tabella di compatibilità delle versioni di Node-API</a></p><table tabindex="0"><thead><tr><th>Versione Node-API</th><th>Supportata in</th></tr></thead><tbody><tr><td>9</td><td>v18.17.0+, 20.3.0+, 21.0.0 e tutte le versioni successive</td></tr><tr><td>8</td><td>v12.22.0+, v14.17.0+, v15.12.0+, 16.0.0 e tutte le versioni successive</td></tr><tr><td>7</td><td>v10.23.0+, v12.19.0+, v14.12.0+, 15.0.0 e tutte le versioni successive</td></tr><tr><td>6</td><td>v10.20.0+, v12.17.0+, 14.0.0 e tutte le versioni successive</td></tr><tr><td>5</td><td>v10.17.0+, v12.11.0+, 13.0.0 e tutte le versioni successive</td></tr><tr><td>4</td><td>v10.16.0+, v11.8.0+, 12.0.0 e tutte le versioni successive</td></tr><tr><td>3</td><td>v6.14.2*, 8.11.2+, v9.11.0+*, 10.0.0 e tutte le versioni successive</td></tr><tr><td>2</td><td>v8.10.0+<em>, v9.3.0+</em>, 10.0.0 e tutte le versioni successive</td></tr><tr><td>1</td><td>v8.6.0+**, v9.0.0+*, 10.0.0 e tutte le versioni successive</td></tr></tbody></table><ul><li>Node-API era sperimentale.</li></ul><p>** Node.js 8.0.0 includeva Node-API come sperimentale. È stato rilasciato come Node-API versione 1 ma ha continuato a evolversi fino a Node.js 8.6.0. L&#39;API è diversa nelle versioni precedenti a Node.js 8.6.0. Si consiglia Node-API versione 3 o successiva.</p><p>Ogni API documentata per Node-API avrà un header denominato <code>aggiunta in:</code>, e le API che sono stabili avranno l&#39;header aggiuntivo <code>Versione Node-API:</code>. Le API sono direttamente utilizzabili quando si utilizza una versione di Node.js che supporta la versione Node-API mostrata in <code>Versione Node-API:</code> o superiore. Quando si utilizza una versione di Node.js che non supporta la <code>Versione Node-API:</code> elencata o se non è elencata alcuna <code>Versione Node-API:</code>, allora l&#39;API sarà disponibile solo se <code>#define NAPI_EXPERIMENTAL</code> precede l&#39;inclusione di <code>node_api.h</code> o <code>js_native_api.h</code>. Se un&#39;API sembra non essere disponibile su una versione di Node.js successiva a quella mostrata in <code>aggiunta in:</code>, allora questo è molto probabilmente il motivo dell&#39;apparente assenza.</p><p>Le Node-API associate strettamente all&#39;accesso alle funzionalità ECMAScript dal codice nativo si trovano separatamente in <code>js_native_api.h</code> e <code>js_native_api_types.h</code>. Le API definite in questi header sono incluse in <code>node_api.h</code> e <code>node_api_types.h</code>. Gli header sono strutturati in questo modo per consentire implementazioni di Node-API al di fuori di Node.js. Per tali implementazioni, le API specifiche di Node.js potrebbero non essere applicabili.</p><p>Le parti specifiche di Node.js di un addon possono essere separate dal codice che espone la funzionalità effettiva all&#39;ambiente JavaScript in modo che quest&#39;ultimo possa essere utilizzato con più implementazioni di Node-API. Nell&#39;esempio seguente, <code>addon.c</code> e <code>addon.h</code> si riferiscono solo a <code>js_native_api.h</code>. Ciò garantisce che <code>addon.c</code> possa essere riutilizzato per la compilazione con l&#39;implementazione Node.js di Node-API o con qualsiasi implementazione di Node-API al di fuori di Node.js.</p><p><code>addon_node.c</code> è un file separato che contiene il punto di ingresso specifico di Node.js nell&#39;addon e che istanzia l&#39;addon chiamando <code>addon.c</code> quando l&#39;addon viene caricato in un ambiente Node.js.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// addon.h</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifndef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _ADDON_H_</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _ADDON_H_</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;js_native_api.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create_addon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // _ADDON_H_</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// addon.c</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;addon.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NODE_API_CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                                  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {                                                            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (call);                                  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {                                      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_extended_error_info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      napi_get_last_error_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((env), </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">error_info);               </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err_message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error_info-&gt;error_message;        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> is_pending;                                            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      napi_is_exception_pending</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((env), </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_pending);              </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      /* If an exception is already pending, don&#39;t rethrow it */</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_pending) {                                          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (err_message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)               </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;empty error message&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                               \\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            :</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err_message;                                        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        napi_throw_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((env), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, message);                   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }                                                           </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;                                                </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }                                                             </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_value</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DoSomethingUseful</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Do something useful.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create_addon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value result;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  NODE_API_CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value exported_function;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  NODE_API_CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                          &quot;doSomethingUseful&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          NAPI_AUTO_LENGTH,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          DoSomethingUseful,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                          NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                          &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">exported_function));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  NODE_API_CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                             result,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                             &quot;doSomethingUseful&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                             exported_function));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// addon_node.c</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;node_api.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;addon.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAPI_MODULE_INIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* napi_env env, napi_value exports */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // This function body is expected to return a \`napi_value\`.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // The variables \`napi_env env\` and \`napi_value exports\` may be used within</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // the body, as they are provided by the definition of \`NAPI_MODULE_INIT()\`.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> create_addon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="environment-life-cycle-apis" tabindex="-1">API del ciclo di vita dell&#39;ambiente <a class="header-anchor" href="#environment-life-cycle-apis" aria-label="Permalink to “API del ciclo di vita dell&#39;ambiente”">​</a></h2><p>La <a href="https://tc39.es/ecma262/#sec-agents" target="_blank" rel="noreferrer">Sezione 8.7</a> della <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">Specificazione del linguaggio ECMAScript</a> definisce il concetto di &quot;Agent&quot; come un ambiente autonomo in cui viene eseguito il codice JavaScript. Più Agent possono essere avviati e terminati contemporaneamente o in sequenza dal processo.</p><p>Un ambiente Node.js corrisponde a un Agent ECMAScript. Nel processo principale, un ambiente viene creato all&#39;avvio e ambienti aggiuntivi possono essere creati su thread separati per fungere da <a href="https://nodejs.org/api/worker_threads" target="_blank" rel="noreferrer">thread di worker</a>. Quando Node.js è incorporato in un&#39;altra applicazione, il thread principale dell&#39;applicazione può anche costruire e distruggere un ambiente Node.js più volte durante il ciclo di vita del processo dell&#39;applicazione in modo tale che ogni ambiente Node.js creato dall&#39;applicazione possa, a sua volta, durante il suo ciclo di vita creare e distruggere ambienti aggiuntivi come thread di worker.</p><p>Dal punto di vista di un addon nativo, questo significa che i binding che fornisce possono essere chiamati più volte, da più contesti e anche contemporaneamente da più thread.</p><p>Gli addon nativi potrebbero aver bisogno di allocare uno stato globale che utilizzano durante il loro ciclo di vita di un ambiente Node.js in modo che lo stato possa essere univoco per ogni istanza dell&#39;addon.</p><p>A tal fine, Node-API fornisce un modo per associare i dati in modo che il loro ciclo di vita sia legato al ciclo di vita di un ambiente Node.js.</p><h3 id="napi_set_instance_data" tabindex="-1"><code>napi_set_instance_data</code> <a class="header-anchor" href="#napi_set_instance_data" aria-label="Permalink to “napi_set_instance_data”">​</a></h3><p><strong>Aggiunto in: v12.8.0, v10.20.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_set_instance_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente sotto il quale viene invocata la chiamata Node-API.</li><li><code>[in] data</code>: L&#39;elemento di dati da rendere disponibile ai binding di questa istanza.</li><li><code>[in] finalize_cb</code>: La funzione da chiamare quando l&#39;ambiente viene smantellato. La funzione riceve <code>data</code> in modo da poterlo liberare. <a href="/it/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> fornisce maggiori dettagli.</li><li><code>[in] finalize_hint</code>: Suggerimento opzionale da passare alla callback di finalizzazione durante la raccolta.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API associa <code>data</code> all&#39;ambiente Node.js attualmente in esecuzione. <code>data</code> può essere recuperato in seguito utilizzando <code>napi_get_instance_data()</code>. Qualsiasi dato esistente associato all&#39;ambiente Node.js attualmente in esecuzione che è stato impostato tramite una precedente chiamata a <code>napi_set_instance_data()</code> verrà sovrascritto. Se una <code>finalize_cb</code> è stata fornita dalla precedente chiamata, non verrà chiamata.</p><h3 id="napi_get_instance_data" tabindex="-1"><code>napi_get_instance_data</code> <a class="header-anchor" href="#napi_get_instance_data" aria-label="Permalink to “napi_get_instance_data”">​</a></h3><p><strong>Aggiunto in: v12.8.0, v10.20.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_instance_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata la chiamata Node-API.</li><li><code>[out] data</code>: L&#39;elemento dati che è stato precedentemente associato all&#39;ambiente Node.js attualmente in esecuzione tramite una chiamata a <code>napi_set_instance_data()</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API recupera i dati che sono stati precedentemente associati all&#39;ambiente Node.js attualmente in esecuzione tramite <code>napi_set_instance_data()</code>. Se non sono impostati dati, la chiamata avrà successo e <code>data</code> verrà impostato su <code>NULL</code>.</p><h2 id="basic-node-api-data-types" tabindex="-1">Tipi di dati Node-API di base <a class="header-anchor" href="#basic-node-api-data-types" aria-label="Permalink to “Tipi di dati Node-API di base”">​</a></h2><p>Node-API espone i seguenti tipi di dati fondamentali come astrazioni che vengono utilizzate dalle varie API. Queste API devono essere trattate come opache, ispezionabili solo con altre chiamate Node-API.</p><h3 id="napi_status" tabindex="-1"><code>napi_status</code> <a class="header-anchor" href="#napi_status" aria-label="Permalink to “napi_status”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><p>Codice di stato integrale che indica il successo o il fallimento di una chiamata Node-API. Attualmente, sono supportati i seguenti codici di stato.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_ok,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_invalid_arg,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_object_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_string_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_name_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_function_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_number_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_boolean_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_array_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_generic_failure,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_pending_exception,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_cancelled,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_escape_called_twice,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_handle_scope_mismatch,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_callback_scope_mismatch,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_queue_full,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_closing,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_bigint_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_date_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_arraybuffer_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_detachable_arraybuffer_expected,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_would_deadlock,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* unused */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_no_external_buffers_allowed,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_cannot_run_js</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_status;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>Se sono necessarie informazioni aggiuntive quando un&#39;API restituisce uno stato di errore, possono essere ottenute chiamando <code>napi_get_last_error_info</code>.</p><h3 id="napi_extended_error_info" tabindex="-1"><code>napi_extended_error_info</code> <a class="header-anchor" href="#napi_extended_error_info" aria-label="Permalink to “napi_extended_error_info”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error_message;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> engine_reserved;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> engine_error_code;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status error_code;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_extended_error_info;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>error_message</code>: Stringa con codifica UTF8 contenente una descrizione dell&#39;errore neutrale rispetto alla VM.</li><li><code>engine_reserved</code>: Riservato per i dettagli dell&#39;errore specifici della VM. Attualmente non è implementato per nessuna VM.</li><li><code>engine_error_code</code>: Codice di errore specifico della VM. Attualmente non è implementato per nessuna VM.</li><li><code>error_code</code>: Il codice di stato Node-API che ha avuto origine con l&#39;ultimo errore.</li></ul><p>Consulta la sezione <a href="/it/nodejs/api/n-api#error-handling">Gestione degli errori</a> per ulteriori informazioni.</p><h3 id="napi_env" tabindex="-1"><code>napi_env</code> <a class="header-anchor" href="#napi_env" aria-label="Permalink to “napi_env”">​</a></h3><p><code>napi_env</code> viene utilizzato per rappresentare un contesto che l&#39;implementazione Node-API sottostante può utilizzare per persistere lo stato specifico della VM. Questa struttura viene passata alle funzioni native quando vengono invocate e deve essere restituita quando si effettuano chiamate Node-API. In particolare, lo stesso <code>napi_env</code> che è stato passato quando è stata chiamata la funzione nativa iniziale deve essere passato a qualsiasi successiva chiamata Node-API nidificata. Non è consentito memorizzare nella cache <code>napi_env</code> allo scopo di un riutilizzo generale e passare <code>napi_env</code> tra istanze dello stesso addon in esecuzione su diversi thread <a href="/it/nodejs/api/worker_threads#class-worker"><code>Worker</code></a>. <code>napi_env</code> diventa non valido quando un&#39;istanza di un addon nativo viene scaricata. La notifica di questo evento viene fornita tramite i callback forniti a <a href="/it/nodejs/api/n-api#napi-add-env-cleanup-hook"><code>napi_add_env_cleanup_hook</code></a> e <a href="/it/nodejs/api/n-api#napi-set-instance-data"><code>napi_set_instance_data</code></a>.</p><h3 id="node_api_basic_env" tabindex="-1"><code>node_api_basic_env</code> <a class="header-anchor" href="#node_api_basic_env" aria-label="Permalink to “node_api_basic_env”">​</a></h3><div class="warning custom-block"><p class="custom-block-title">[Stabile: 1 - Sperimentale]</p><p><a href="/it/nodejs/api/documentation#stability-index">Stabile: 1</a> <a href="/it/nodejs/api/documentation#stability-index">Stabilità: 1</a> - Sperimentale</p></div><p>Questa variante di <code>napi_env</code> viene passata ai finalizzatori sincroni (<a href="/it/nodejs/api/n-api#node-api-basic-finalize"><code>node_api_basic_finalize</code></a>). Esiste un sottoinsieme di Node-API che accettano un parametro di tipo <code>node_api_basic_env</code> come primo argomento. Queste API non accedono allo stato del motore JavaScript e sono quindi sicure da chiamare dai finalizzatori sincroni. È consentito passare un parametro di tipo <code>napi_env</code> a queste API, tuttavia, non è consentito passare un parametro di tipo <code>node_api_basic_env</code> alle API che accedono allo stato del motore JavaScript. Tentare di farlo senza un cast produrrà un avviso del compilatore o un errore quando gli add-on vengono compilati con flag che li fanno emettere avvisi e/o errori quando tipi di puntatore errati vengono passati in una funzione. Chiamare tali API da un finalizzatore sincrono comporterà alla fine la terminazione dell&#39;applicazione.</p><h3 id="napi_value" tabindex="-1"><code>napi_value</code> <a class="header-anchor" href="#napi_value" aria-label="Permalink to “napi_value”">​</a></h3><p>Questo è un puntatore opaco che viene utilizzato per rappresentare un valore JavaScript.</p><h3 id="napi_threadsafe_function" tabindex="-1"><code>napi_threadsafe_function</code> <a class="header-anchor" href="#napi_threadsafe_function" aria-label="Permalink to “napi_threadsafe_function”">​</a></h3><p><strong>Aggiunto in: v10.6.0</strong></p><p><strong>Versione N-API: 4</strong></p><p>Si tratta di un puntatore opaco che rappresenta una funzione JavaScript che può essere chiamata in modo asincrono da più thread tramite <code>napi_call_threadsafe_function()</code>.</p><h3 id="napi_threadsafe_function_release_mode" tabindex="-1"><code>napi_threadsafe_function_release_mode</code> <a class="header-anchor" href="#napi_threadsafe_function_release_mode" aria-label="Permalink to “napi_threadsafe_function_release_mode”">​</a></h3><p><strong>Aggiunto in: v10.6.0</strong></p><p><strong>Versione N-API: 4</strong></p><p>Un valore da fornire a <code>napi_release_threadsafe_function()</code> per indicare se la funzione thread-safe deve essere chiusa immediatamente (<code>napi_tsfn_abort</code>) o semplicemente rilasciata (<code>napi_tsfn_release</code>) e quindi disponibile per l&#39;uso successivo tramite <code>napi_acquire_threadsafe_function()</code> e <code>napi_call_threadsafe_function()</code>.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_tsfn_release,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_tsfn_abort</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_threadsafe_function_release_mode;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="napi_threadsafe_function_call_mode" tabindex="-1"><code>napi_threadsafe_function_call_mode</code> <a class="header-anchor" href="#napi_threadsafe_function_call_mode" aria-label="Permalink to “napi_threadsafe_function_call_mode”">​</a></h3><p><strong>Aggiunto in: v10.6.0</strong></p><p><strong>Versione N-API: 4</strong></p><p>Un valore da fornire a <code>napi_call_threadsafe_function()</code> per indicare se la chiamata deve bloccarsi ogni volta che la coda associata alla funzione thread-safe è piena.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_tsfn_nonblocking,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_tsfn_blocking</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_threadsafe_function_call_mode;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="node-api-memory-management-types" tabindex="-1">Tipi di gestione della memoria Node-API <a class="header-anchor" href="#node-api-memory-management-types" aria-label="Permalink to “Tipi di gestione della memoria Node-API”">​</a></h3><h4 id="napi_handle_scope" tabindex="-1"><code>napi_handle_scope</code> <a class="header-anchor" href="#napi_handle_scope" aria-label="Permalink to “napi_handle_scope”">​</a></h4><p>Questa è un&#39;astrazione utilizzata per controllare e modificare la durata degli oggetti creati all&#39;interno di un ambito particolare. In generale, i valori Node-API vengono creati nel contesto di un ambito di handle. Quando un metodo nativo viene chiamato da JavaScript, esisterà un ambito di handle predefinito. Se l&#39;utente non crea esplicitamente un nuovo ambito di handle, i valori Node-API verranno creati nell&#39;ambito di handle predefinito. Per qualsiasi invocazione di codice al di fuori dell&#39;esecuzione di un metodo nativo (ad esempio, durante un&#39;invocazione di callback libuv), il modulo è tenuto a creare un ambito prima di invocare qualsiasi funzione che possa comportare la creazione di valori JavaScript.</p><p>Gli ambiti di handle vengono creati utilizzando <a href="/it/nodejs/api/n-api#napi-open-handle-scope"><code>napi_open_handle_scope</code></a> e vengono distrutti utilizzando <a href="/it/nodejs/api/n-api#napi-close-handle-scope"><code>napi_close_handle_scope</code></a>. La chiusura dell&#39;ambito può indicare al GC che tutti i <code>napi_value</code> creati durante la durata dell&#39;ambito di handle non sono più referenziati dal frame dello stack corrente.</p><p>Per maggiori dettagli, rivedi la sezione <a href="/it/nodejs/api/n-api#object-lifetime-management">Gestione della durata degli oggetti</a>.</p><h4 id="napi_escapable_handle_scope" tabindex="-1"><code>napi_escapable_handle_scope</code> <a class="header-anchor" href="#napi_escapable_handle_scope" aria-label="Permalink to “napi_escapable_handle_scope”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><p>Gli ambiti di handle con escape sono un tipo speciale di ambito di handle per restituire valori creati all&#39;interno di un particolare ambito di handle a un ambito padre.</p><h4 id="napi_ref" tabindex="-1"><code>napi_ref</code> <a class="header-anchor" href="#napi_ref" aria-label="Permalink to “napi_ref”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><p>Questa è l&#39;astrazione da utilizzare per fare riferimento a un <code>napi_value</code>. Ciò consente agli utenti di gestire la durata dei valori JavaScript, inclusa la definizione esplicita delle loro durate minime.</p><p>Per maggiori dettagli, rivedere la <a href="/it/nodejs/api/n-api#object-lifetime-management">Gestione della durata degli oggetti</a>.</p><h4 id="napi_type_tag" tabindex="-1"><code>napi_type_tag</code> <a class="header-anchor" href="#napi_type_tag" aria-label="Permalink to “napi_type_tag”">​</a></h4><p><strong>Aggiunto in: v14.8.0, v12.19.0</strong></p><p><strong>Versione N-API: 8</strong></p><p>Un valore a 128 bit memorizzato come due interi senza segno a 64 bit. Funge da UUID con cui gli oggetti JavaScript o gli <a href="/it/nodejs/api/n-api#napi-create-external"><code>externals</code></a> possono essere &quot;taggati&quot; al fine di garantire che siano di un certo tipo. Questo è un controllo più forte di <a href="/it/nodejs/api/n-api#napi-instanceof"><code>napi_instanceof</code></a>, perché quest&#39;ultimo può segnalare un falso positivo se il prototipo dell&#39;oggetto è stato manipolato. Il tagging del tipo è più utile in combinazione con <a href="/it/nodejs/api/n-api#napi-wrap"><code>napi_wrap</code></a> perché garantisce che il puntatore recuperato da un oggetto avvolto possa essere tranquillamente convertito nel tipo nativo corrispondente al tag di tipo che era stato precedentemente applicato all&#39;oggetto JavaScript.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint64_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lower;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint64_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> upper;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_type_tag;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="napi_async_cleanup_hook_handle" tabindex="-1"><code>napi_async_cleanup_hook_handle</code> <a class="header-anchor" href="#napi_async_cleanup_hook_handle" aria-label="Permalink to “napi_async_cleanup_hook_handle”">​</a></h4><p><strong>Aggiunto in: v14.10.0, v12.19.0</strong></p><p>Un valore opaco restituito da <a href="/it/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>. Deve essere passato a <a href="/it/nodejs/api/n-api#napi-remove-async-cleanup-hook"><code>napi_remove_async_cleanup_hook</code></a> quando la catena di eventi di pulizia asincrona è completa.</p><h3 id="node-api-callback-types" tabindex="-1">Tipi di callback Node-API <a class="header-anchor" href="#node-api-callback-types" aria-label="Permalink to “Tipi di callback Node-API”">​</a></h3><h4 id="napi_callback_info" tabindex="-1"><code>napi_callback_info</code> <a class="header-anchor" href="#napi_callback_info" aria-label="Permalink to “napi_callback_info”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><p>Tipo di dati opaco che viene passato a una funzione di callback. Può essere utilizzato per ottenere ulteriori informazioni sul contesto in cui è stata richiamata la callback.</p><h4 id="napi_callback" tabindex="-1"><code>napi_callback</code> <a class="header-anchor" href="#napi_callback" aria-label="Permalink to “napi_callback”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><p>Tipo di puntatore a funzione per le funzioni native fornite dall&#39;utente che devono essere esposte a JavaScript tramite Node-API. Le funzioni di callback devono soddisfare la seguente firma:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">napi_callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)(napi_env, napi_callback_info);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>A meno che per i motivi discussi in <a href="/it/nodejs/api/n-api#object-lifetime-management">Gestione della durata degli oggetti</a>, la creazione di un ambito di handle e/o di callback all&#39;interno di una <code>napi_callback</code> non è necessaria.</p><h4 id="node_api_basic_finalize" tabindex="-1"><code>node_api_basic_finalize</code> <a class="header-anchor" href="#node_api_basic_finalize" aria-label="Permalink to “node_api_basic_finalize”">​</a></h4><p><strong>Aggiunto in: v21.6.0, v20.12.0, v18.20.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[Stabile: 1 - Sperimentale]</p><p><a href="/it/nodejs/api/documentation#stability-index">Stabile: 1</a> <a href="/it/nodejs/api/documentation#stability-index">Stabilità: 1</a> - Sperimentale</p></div><p>Tipo di puntatore a funzione per funzioni fornite da componenti aggiuntivi che consentono all&#39;utente di essere avvisato quando i dati di proprietà esterna sono pronti per essere puliti perché l&#39;oggetto a cui erano associati è stato raccolto come spazzatura. L&#39;utente deve fornire una funzione che soddisfi la seguente firma che verrebbe chiamata al momento della raccolta dell&#39;oggetto. Attualmente, <code>node_api_basic_finalize</code> può essere utilizzato per scoprire quando gli oggetti che hanno dati esterni vengono raccolti.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">node_api_basic_finalize)(node_api_basic_env env,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> finalize_data,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> finalize_hint);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>A meno che per motivi discussi in <a href="/it/nodejs/api/n-api#object-lifetime-management">Gestione della durata dell&#39;oggetto</a>, non è necessario creare un handle e/o un ambito di callback all&#39;interno del corpo della funzione.</p><p>Poiché queste funzioni possono essere chiamate mentre il motore JavaScript è in uno stato in cui non può eseguire codice JavaScript, possono essere chiamate solo le Node-API che accettano un <code>node_api_basic_env</code> come primo parametro. <a href="/it/nodejs/api/n-api#node-api-post-finalizer"><code>node_api_post_finalizer</code></a> può essere utilizzato per pianificare chiamate Node-API che richiedono l&#39;accesso allo stato del motore JavaScript per essere eseguite dopo che il ciclo di garbage collection corrente è stato completato.</p><p>Nel caso di <a href="/it/nodejs/api/n-api#node-api-create-external-string-latin1"><code>node_api_create_external_string_latin1</code></a> e <a href="/it/nodejs/api/n-api#node-api-create-external-string-utf16"><code>node_api_create_external_string_utf16</code></a> il parametro <code>env</code> può essere nullo, perché le stringhe esterne possono essere raccolte durante l&#39;ultima parte dell&#39;arresto dell&#39;ambiente.</p><p>Cronologia delle modifiche:</p><ul><li>sperimentale (<code>NAPI_EXPERIMENTAL</code>): Possono essere chiamate solo le chiamate Node-API che accettano un <code>node_api_basic_env</code> come primo parametro, altrimenti l&#39;applicazione verrà terminata con un messaggio di errore appropriato. Questa funzionalità può essere disattivata definendo <code>NODE_API_EXPERIMENTAL_BASIC_ENV_OPT_OUT</code>.</li></ul><h4 id="napi_finalize" tabindex="-1"><code>napi_finalize</code> <a class="header-anchor" href="#napi_finalize" aria-label="Permalink to “napi_finalize”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><p>Tipo di puntatore a funzione per la funzione fornita dall&#39;add-on che consente all&#39;utente di pianificare un gruppo di chiamate alle Node-API in risposta a un evento di garbage collection, dopo che il ciclo di garbage collection è stato completato. Questi puntatori a funzione possono essere utilizzati con <a href="/it/nodejs/api/n-api#node-api-post-finalizer"><code>node_api_post_finalizer</code></a>.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_finalize)(napi_env env,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> finalize_data,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> finalize_hint);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Cronologia delle modifiche:</p><ul><li>sperimentale (<code>NAPI_EXPERIMENTAL</code> è definito): una funzione di questo tipo potrebbe non essere più utilizzata come finalizzatore, tranne che con <a href="/it/nodejs/api/n-api#node-api-post-finalizer"><code>node_api_post_finalizer</code></a>. Deve essere utilizzato invece <a href="/it/nodejs/api/n-api#node-api-basic-finalize"><code>node_api_basic_finalize</code></a>. Questa funzionalità può essere disattivata definendo <code>NODE_API_EXPERIMENTAL_BASIC_ENV_OPT_OUT</code>.</li></ul><h4 id="napi_async_execute_callback" tabindex="-1"><code>napi_async_execute_callback</code> <a class="header-anchor" href="#napi_async_execute_callback" aria-label="Permalink to “napi_async_execute_callback”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><p>Puntatore a funzione utilizzato con funzioni che supportano operazioni asincrone. Le funzioni di callback devono soddisfare la seguente firma:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_async_execute_callback)(napi_env env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Le implementazioni di questa funzione devono evitare di effettuare chiamate Node-API che eseguono JavaScript o interagiscono con oggetti JavaScript. Le chiamate Node-API dovrebbero essere invece nella <code>napi_async_complete_callback</code>. Non utilizzare il parametro <code>napi_env</code> in quanto probabilmente comporterà l&#39;esecuzione di JavaScript.</p><h4 id="napi_async_complete_callback" tabindex="-1"><code>napi_async_complete_callback</code> <a class="header-anchor" href="#napi_async_complete_callback" aria-label="Permalink to “napi_async_complete_callback”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><p>Puntatore a funzione utilizzato con funzioni che supportano operazioni asincrone. Le funzioni di callback devono soddisfare la seguente firma:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_async_complete_callback)(napi_env env,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                             napi_status status,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                             void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>A meno che per motivi discussi in <a href="/it/nodejs/api/n-api#object-lifetime-management">Gestione del ciclo di vita degli oggetti</a>, non è necessario creare un handle e/o uno scope di callback all&#39;interno del corpo della funzione.</p><h4 id="napi_threadsafe_function_call_js" tabindex="-1"><code>napi_threadsafe_function_call_js</code> <a class="header-anchor" href="#napi_threadsafe_function_call_js" aria-label="Permalink to “napi_threadsafe_function_call_js”">​</a></h4><p><strong>Aggiunto in: v10.6.0</strong></p><p><strong>Versione N-API: 4</strong></p><p>Puntatore a funzione utilizzato con chiamate di funzione asincrone thread-safe. La callback verrà chiamata sul thread principale. Il suo scopo è utilizzare un elemento dati che arriva tramite la coda da uno dei thread secondari per costruire i parametri necessari per una chiamata in JavaScript, solitamente tramite <code>napi_call_function</code>, e quindi effettuare la chiamata in JavaScript.</p><p>I dati che arrivano dal thread secondario tramite la coda sono forniti nel parametro <code>data</code> e la funzione JavaScript da chiamare è fornita nel parametro <code>js_callback</code>.</p><p>Node-API imposta l&#39;ambiente prima di chiamare questa callback, quindi è sufficiente chiamare la funzione JavaScript tramite <code>napi_call_function</code> piuttosto che tramite <code>napi_make_callback</code>.</p><p>Le funzioni di callback devono soddisfare la seguente firma:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_threadsafe_function_call_js)(napi_env env,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_value js_callback,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                 void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                 void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente da utilizzare per le chiamate API, o <code>NULL</code> se la funzione thread-safe viene smantellata e <code>data</code> potrebbe dover essere liberato.</li><li><code>[in] js_callback</code>: La funzione JavaScript da chiamare, o <code>NULL</code> se la funzione thread-safe viene smantellata e <code>data</code> potrebbe dover essere liberato. Può anche essere <code>NULL</code> se la funzione thread-safe è stata creata senza <code>js_callback</code>.</li><li><code>[in] context</code>: I dati opzionali con cui è stata creata la funzione thread-safe.</li><li><code>[in] data</code>: Dati creati dal thread secondario. È responsabilità della callback convertire questi dati nativi in valori JavaScript (con le funzioni Node-API) che possono essere passati come parametri quando viene invocata <code>js_callback</code>. Questo puntatore è gestito interamente dai thread e da questa callback. Pertanto, questa callback dovrebbe liberare i dati.</li></ul><p>A meno che per motivi discussi in <a href="/it/nodejs/api/n-api#object-lifetime-management">Gestione del ciclo di vita degli oggetti</a>, non è necessario creare un handle e/o uno scope di callback all&#39;interno del corpo della funzione.</p><h4 id="napi_cleanup_hook" tabindex="-1"><code>napi_cleanup_hook</code> <a class="header-anchor" href="#napi_cleanup_hook" aria-label="Permalink to “napi_cleanup_hook”">​</a></h4><p><strong>Aggiunta in: v19.2.0, v18.13.0</strong></p><p><strong>Versione N-API: 3</strong></p><p>Puntatore a funzione utilizzato con <a href="/it/nodejs/api/n-api#napi-add-env-cleanup-hook"><code>napi_add_env_cleanup_hook</code></a>. Sarà chiamata quando l&#39;ambiente viene smantellato.</p><p>Le funzioni di callback devono soddisfare la seguente firma:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_cleanup_hook)(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] data</code>: I dati che sono stati passati a <a href="/it/nodejs/api/n-api#napi-add-env-cleanup-hook"><code>napi_add_env_cleanup_hook</code></a>.</li></ul><h4 id="napi_async_cleanup_hook" tabindex="-1"><code>napi_async_cleanup_hook</code> <a class="header-anchor" href="#napi_async_cleanup_hook" aria-label="Permalink to “napi_async_cleanup_hook”">​</a></h4><p><strong>Aggiunta in: v14.10.0, v12.19.0</strong></p><p>Puntatore a funzione utilizzato con <a href="/it/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>. Sarà chiamata quando l&#39;ambiente viene smantellato.</p><p>Le funzioni di callback devono soddisfare la seguente firma:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_async_cleanup_hook)(napi_async_cleanup_hook_handle handle,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] handle</code>: L&#39;handle che deve essere passato a <a href="/it/nodejs/api/n-api#napi-remove-async-cleanup-hook"><code>napi_remove_async_cleanup_hook</code></a> dopo il completamento della pulizia asincrona.</li><li><code>[in] data</code>: I dati che sono stati passati a <a href="/it/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>.</li></ul><p>Il corpo della funzione deve avviare le azioni di pulizia asincrona al termine delle quali <code>handle</code> deve essere passato in una chiamata a <a href="/it/nodejs/api/n-api#napi-remove-async-cleanup-hook"><code>napi_remove_async_cleanup_hook</code></a>.</p><h2 id="error-handling" tabindex="-1">Gestione degli errori <a class="header-anchor" href="#error-handling" aria-label="Permalink to “Gestione degli errori”">​</a></h2><p>Node-API utilizza sia i valori di ritorno che le eccezioni JavaScript per la gestione degli errori. Le seguenti sezioni spiegano l&#39;approccio per ciascun caso.</p><h3 id="return-values" tabindex="-1">Valori di ritorno <a class="header-anchor" href="#return-values" aria-label="Permalink to “Valori di ritorno”">​</a></h3><p>Tutte le funzioni Node-API condividono lo stesso modello di gestione degli errori. Il tipo di ritorno di tutte le funzioni API è <code>napi_status</code>.</p><p>Il valore di ritorno sarà <code>napi_ok</code> se la richiesta ha avuto successo e non è stata generata alcuna eccezione JavaScript non gestita. Se si è verificato un errore E un&#39;eccezione è stata generata, verrà restituito il valore <code>napi_status</code> per l&#39;errore. Se un&#39;eccezione è stata generata e non si è verificato alcun errore, verrà restituito <code>napi_pending_exception</code>.</p><p>Nei casi in cui viene restituito un valore di ritorno diverso da <code>napi_ok</code> o <code>napi_pending_exception</code>, è necessario chiamare <a href="/it/nodejs/api/n-api#napi-is-exception-pending"><code>napi_is_exception_pending</code></a> per verificare se è in sospeso un&#39;eccezione. Vedere la sezione sulle eccezioni per maggiori dettagli.</p><p>L&#39;insieme completo di possibili valori <code>napi_status</code> è definito in <code>napi_api_types.h</code>.</p><p>Il valore di ritorno <code>napi_status</code> fornisce una rappresentazione indipendente dalla VM dell&#39;errore che si è verificato. In alcuni casi, è utile essere in grado di ottenere informazioni più dettagliate, inclusa una stringa che rappresenta l&#39;errore e informazioni specifiche della VM (motore).</p><p>Per recuperare queste informazioni, viene fornito <a href="/it/nodejs/api/n-api#napi-get-last-error-info"><code>napi_get_last_error_info</code></a> che restituisce una struttura <code>napi_extended_error_info</code>. Il formato della struttura <code>napi_extended_error_info</code> è il seguente:</p><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_extended_error_info {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error_message;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> engine_reserved;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> engine_error_code;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status error_code;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>error_message</code>: Rappresentazione testuale dell&#39;errore che si è verificato.</li><li><code>engine_reserved</code>: Handle opaco riservato esclusivamente all&#39;uso del motore.</li><li><code>engine_error_code</code>: Codice di errore specifico della VM.</li><li><code>error_code</code>: Codice di stato Node-API per l&#39;ultimo errore.</li></ul><p><a href="/it/nodejs/api/n-api#napi-get-last-error-info"><code>napi_get_last_error_info</code></a> restituisce le informazioni per l&#39;ultima chiamata Node-API effettuata.</p><p>Non fare affidamento sul contenuto o sul formato di nessuna delle informazioni estese in quanto non sono soggette a SemVer e possono cambiare in qualsiasi momento. Sono destinati solo a scopi di registrazione.</p><h4 id="napi_get_last_error_info" tabindex="-1"><code>napi_get_last_error_info</code> <a class="header-anchor" href="#napi_get_last_error_info" aria-label="Permalink to “napi_get_last_error_info”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_last_error_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                         const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_extended_error_info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] result</code>: La struttura <code>napi_extended_error_info</code> con maggiori informazioni sull&#39;errore.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API recupera una struttura <code>napi_extended_error_info</code> con informazioni sull&#39;ultimo errore che si è verificato.</p><p>Il contenuto di <code>napi_extended_error_info</code> restituito è valido solo fino a quando una funzione Node-API viene chiamata nello stesso <code>env</code>. Questo include una chiamata a <code>napi_is_exception_pending</code>, quindi potrebbe essere spesso necessario fare una copia delle informazioni in modo che possano essere utilizzate in seguito. Il puntatore restituito in <code>error_message</code> punta a una stringa definita staticamente, quindi è sicuro usare quel puntatore se lo si è copiato fuori dal campo <code>error_message</code> (che verrà sovrascritto) prima che venisse chiamata un&#39;altra funzione Node-API.</p><p>Non fare affidamento sul contenuto o sul formato di nessuna delle informazioni estese poiché non sono soggette a SemVer e possono cambiare in qualsiasi momento. È inteso solo per scopi di registrazione.</p><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h3 id="exceptions" tabindex="-1">Eccezioni <a class="header-anchor" href="#exceptions" aria-label="Permalink to “Eccezioni”">​</a></h3><p>Qualsiasi chiamata di funzione Node-API può comportare un&#39;eccezione JavaScript in sospeso. Questo è il caso per qualsiasi funzione API, anche quelle che potrebbero non causare l&#39;esecuzione di JavaScript.</p><p>Se il <code>napi_status</code> restituito da una funzione è <code>napi_ok</code>, allora non ci sono eccezioni in sospeso e non è richiesta alcuna azione aggiuntiva. Se il <code>napi_status</code> restituito è diverso da <code>napi_ok</code> o <code>napi_pending_exception</code>, per provare a ripristinare e continuare invece di restituire semplicemente immediatamente, deve essere chiamato <a href="/it/nodejs/api/n-api#napi-is-exception-pending"><code>napi_is_exception_pending</code></a> per determinare se un&#39;eccezione è in sospeso o meno.</p><p>In molti casi, quando viene chiamata una funzione Node-API e un&#39;eccezione è già in sospeso, la funzione restituirà immediatamente un <code>napi_status</code> di <code>napi_pending_exception</code>. Tuttavia, questo non è il caso per tutte le funzioni. Node-API consente a un sottoinsieme delle funzioni di essere chiamate per consentire una pulizia minima prima di tornare a JavaScript. In tal caso, <code>napi_status</code> rifletterà lo stato della funzione. Non rifletterà le precedenti eccezioni in sospeso. Per evitare confusione, controllare lo stato dell&#39;errore dopo ogni chiamata di funzione.</p><p>Quando un&#39;eccezione è in sospeso, è possibile utilizzare uno dei due approcci.</p><p>Il primo approccio consiste nell&#39;eseguire qualsiasi pulizia appropriata e quindi tornare in modo che l&#39;esecuzione torni a JavaScript. Come parte della transizione di ritorno a JavaScript, l&#39;eccezione verrà lanciata nel punto del codice JavaScript in cui è stato invocato il metodo nativo. Il comportamento della maggior parte delle chiamate Node-API non è specificato mentre un&#39;eccezione è in sospeso e molte restituiranno semplicemente <code>napi_pending_exception</code>, quindi fare il meno possibile e quindi tornare a JavaScript dove l&#39;eccezione può essere gestita.</p><p>Il secondo approccio consiste nel cercare di gestire l&#39;eccezione. Ci saranno casi in cui il codice nativo può intercettare l&#39;eccezione, intraprendere l&#39;azione appropriata e quindi continuare. Questo è consigliato solo in casi specifici in cui è noto che l&#39;eccezione può essere gestita in modo sicuro. In questi casi <a href="/it/nodejs/api/n-api#napi-get-and-clear-last-exception"><code>napi_get_and_clear_last_exception</code></a> può essere utilizzato per ottenere e cancellare l&#39;eccezione. In caso di successo, il risultato conterrà l&#39;handle dell&#39;ultimo <code>Object</code> JavaScript lanciato. Se si determina, dopo aver recuperato l&#39;eccezione, che l&#39;eccezione non può essere gestita, può essere rilanciata con <a href="/it/nodejs/api/n-api#napi-throw"><code>napi_throw</code></a> dove error è il valore JavaScript da lanciare.</p><p>Le seguenti funzioni di utilità sono anche disponibili nel caso in cui il codice nativo debba lanciare un&#39;eccezione o determinare se un <code>napi_value</code> è un&#39;istanza di un oggetto JavaScript <code>Error</code>: <a href="/it/nodejs/api/n-api#napi-throw-error"><code>napi_throw_error</code></a>, <a href="/it/nodejs/api/n-api#napi-throw-type-error"><code>napi_throw_type_error</code></a>, <a href="/it/nodejs/api/n-api#napi-throw-range-error"><code>napi_throw_range_error</code></a>, <a href="/it/nodejs/api/n-api#node-api-throw-syntax-error"><code>node_api_throw_syntax_error</code></a> e <a href="/it/nodejs/api/n-api#napi-is-error"><code>napi_is_error</code></a>.</p><p>Le seguenti funzioni di utilità sono anche disponibili nel caso in cui il codice nativo debba creare un oggetto <code>Error</code>: <a href="/it/nodejs/api/n-api#napi-create-error"><code>napi_create_error</code></a>, <a href="/it/nodejs/api/n-api#napi-create-type-error"><code>napi_create_type_error</code></a>, <a href="/it/nodejs/api/n-api#napi-create-range-error"><code>napi_create_range_error</code></a> e <a href="/it/nodejs/api/n-api#node-api-create-syntax-error"><code>node_api_create_syntax_error</code></a>, dove result è il <code>napi_value</code> che fa riferimento all&#39;oggetto JavaScript <code>Error</code> appena creato.</p><p>Il progetto Node.js sta aggiungendo codici di errore a tutti gli errori generati internamente. L&#39;obiettivo è che le applicazioni utilizzino questi codici di errore per tutti i controlli degli errori. I messaggi di errore associati rimarranno, ma saranno intesi solo per essere utilizzati per la registrazione e la visualizzazione, con l&#39;aspettativa che il messaggio possa cambiare senza che venga applicato SemVer. Al fine di supportare questo modello con Node-API, sia nella funzionalità interna che per la funzionalità specifica del modulo (come è una buona pratica), le funzioni <code>throw_</code> e <code>create_</code> accettano un parametro di codice opzionale che è la stringa per il codice da aggiungere all&#39;oggetto error. Se il parametro opzionale è <code>NULL</code>, nessun codice verrà associato all&#39;errore. Se viene fornito un codice, anche il nome associato all&#39;errore viene aggiornato per essere:</p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>originalName [code]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>dove <code>originalName</code> è il nome originale associato all&#39;errore e <code>code</code> è il codice che è stato fornito. Ad esempio, se il codice è <code>&#39;ERR_ERROR_1&#39;</code> e viene creato un <code>TypeError</code>, il nome sarà:</p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>TypeError [ERR_ERROR_1]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="napi_throw" tabindex="-1"><code>napi_throw</code> <a class="header-anchor" href="#napi_throw" aria-label="Permalink to “napi_throw”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] error</code>: Il valore JavaScript da lanciare.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API lancia il valore JavaScript fornito.</p><h4 id="napi_throw_error" tabindex="-1"><code>napi_throw_error</code> <a class="header-anchor" href="#napi_throw_error" aria-label="Permalink to “napi_throw_error”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_throw_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] code</code>: Codice di errore opzionale da impostare sull&#39;errore.</li><li><code>[in] msg</code>: Stringa C che rappresenta il testo da associare all&#39;errore.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API lancia un <code>Error</code> JavaScript con il testo fornito.</p><h4 id="napi_throw_type_error" tabindex="-1"><code>napi_throw_type_error</code> <a class="header-anchor" href="#napi_throw_type_error" aria-label="Permalink to “napi_throw_type_error”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_throw_type_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                              const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                              const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] code</code>: Codice di errore opzionale da impostare sull&#39;errore.</li><li><code>[in] msg</code>: Stringa C che rappresenta il testo da associare all&#39;errore.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API lancia un <code>TypeError</code> JavaScript con il testo fornito.</p><h4 id="napi_throw_range_error" tabindex="-1"><code>napi_throw_range_error</code> <a class="header-anchor" href="#napi_throw_range_error" aria-label="Permalink to “napi_throw_range_error”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_throw_range_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                               const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                               const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] code</code>: Codice di errore opzionale da impostare sull&#39;errore.</li><li><code>[in] msg</code>: Stringa C che rappresenta il testo da associare all&#39;errore.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API lancia un <code>RangeError</code> JavaScript con il testo fornito.</p><h4 id="node_api_throw_syntax_error" tabindex="-1"><code>node_api_throw_syntax_error</code> <a class="header-anchor" href="#node_api_throw_syntax_error" aria-label="Permalink to “node_api_throw_syntax_error”">​</a></h4><p><strong>Aggiunto in: v17.2.0, v16.14.0</strong></p><p><strong>Versione N-API: 9</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_throw_syntax_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] code</code>: Codice di errore opzionale da impostare sull&#39;errore.</li><li><code>[in] msg</code>: Stringa C che rappresenta il testo da associare all&#39;errore.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API genera un <code>SyntaxError</code> JavaScript con il testo fornito.</p><h4 id="napi_is_error" tabindex="-1"><code>napi_is_error</code> <a class="header-anchor" href="#napi_is_error" aria-label="Permalink to “napi_is_error”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: Il <code>napi_value</code> da controllare.</li><li><code>[out] result</code>: Valore booleano impostato su true se <code>napi_value</code> rappresenta un errore, false altrimenti.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API interroga un <code>napi_value</code> per verificare se rappresenta un oggetto errore.</p><h4 id="napi_create_error" tabindex="-1"><code>napi_create_error</code> <a class="header-anchor" href="#napi_create_error" aria-label="Permalink to “napi_create_error”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] code</code>: <code>napi_value</code> opzionale con la stringa per il codice di errore da associare all&#39;errore.</li><li><code>[in] msg</code>: <code>napi_value</code> che fa riferimento a una <code>string</code> JavaScript da utilizzare come messaggio per l&#39;<code>Error</code>.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;errore creato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce un <code>Error</code> JavaScript con il testo fornito.</p><h4 id="napi_create_type_error" tabindex="-1"><code>napi_create_type_error</code> <a class="header-anchor" href="#napi_create_type_error" aria-label="Permalink to “napi_create_type_error”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_type_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                               napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] code</code>: <code>napi_value</code> opzionale con la stringa per il codice di errore da associare all&#39;errore.</li><li><code>[in] msg</code>: <code>napi_value</code> che fa riferimento a una <code>string</code> JavaScript da utilizzare come messaggio per l&#39;<code>Error</code>.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;errore creato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce un <code>TypeError</code> JavaScript con il testo fornito.</p><h4 id="napi_create_range_error" tabindex="-1"><code>napi_create_range_error</code> <a class="header-anchor" href="#napi_create_range_error" aria-label="Permalink to “napi_create_range_error”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_range_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] code</code>: <code>napi_value</code> opzionale con la stringa per il codice di errore da associare all&#39;errore.</li><li><code>[in] msg</code>: <code>napi_value</code> che fa riferimento a una <code>stringa</code> JavaScript da utilizzare come messaggio per l&#39;<code>Error</code>.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;errore creato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce un <code>RangeError</code> JavaScript con il testo fornito.</p><h4 id="node_api_create_syntax_error" tabindex="-1"><code>node_api_create_syntax_error</code> <a class="header-anchor" href="#node_api_create_syntax_error" aria-label="Permalink to “node_api_create_syntax_error”">​</a></h4><p><strong>Aggiunto in: v17.2.0, v16.14.0</strong></p><p><strong>Versione N-API: 9</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_syntax_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                     napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                     napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                     napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] code</code>: <code>napi_value</code> opzionale con la stringa per il codice di errore da associare all&#39;errore.</li><li><code>[in] msg</code>: <code>napi_value</code> che fa riferimento a una <code>stringa</code> JavaScript da utilizzare come messaggio per l&#39;<code>Error</code>.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;errore creato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce un <code>SyntaxError</code> JavaScript con il testo fornito.</p><h4 id="napi_get_and_clear_last_exception" tabindex="-1"><code>napi_get_and_clear_last_exception</code> <a class="header-anchor" href="#napi_get_and_clear_last_exception" aria-label="Permalink to “napi_get_and_clear_last_exception”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_and_clear_last_exception</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] result</code>: L&#39;eccezione se ne è presente una in sospeso, <code>NULL</code> altrimenti.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h4 id="napi_is_exception_pending" tabindex="-1"><code>napi_is_exception_pending</code> <a class="header-anchor" href="#napi_is_exception_pending" aria-label="Permalink to “napi_is_exception_pending”">​</a></h4><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_exception_pending</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[out] result</code>: Valore booleano impostato su true se è in sospeso un&#39;eccezione.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h4 id="napi_fatal_exception" tabindex="-1"><code>napi_fatal_exception</code> <a class="header-anchor" href="#napi_fatal_exception" aria-label="Permalink to “napi_fatal_exception”">​</a></h4><p><strong>Aggiunta in: v9.10.0</strong></p><p><strong>Versione N-API: 3</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_fatal_exception</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] err</code>: L&#39;errore passato a <code>&#39;uncaughtException&#39;</code>.</li></ul><p>Attiva un&#39;eccezione <code>&#39;uncaughtException&#39;</code> in JavaScript. Utile se un callback asincrono genera un&#39;eccezione senza possibilità di ripristino.</p><h3 id="fatal-errors" tabindex="-1">Errori irreversibili <a class="header-anchor" href="#fatal-errors" aria-label="Permalink to “Errori irreversibili”">​</a></h3><p>In caso di errore irreversibile in un addon nativo, è possibile generare un errore irreversibile per terminare immediatamente il processo.</p><h4 id="napi_fatal_error" tabindex="-1"><code>napi_fatal_error</code> <a class="header-anchor" href="#napi_fatal_error" aria-label="Permalink to “napi_fatal_error”">​</a></h4><p><strong>Aggiunta in: v8.2.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_NO_RETURN </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_fatal_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> location_len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message_len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] location</code>: Posizione facoltativa in cui si è verificato l&#39;errore.</li><li><code>[in] location_len</code>: La lunghezza della posizione in byte oppure <code>NAPI_AUTO_LENGTH</code> se è terminata con null.</li><li><code>[in] message</code>: Il messaggio associato all&#39;errore.</li><li><code>[in] message_len</code>: La lunghezza del messaggio in byte oppure <code>NAPI_AUTO_LENGTH</code> se è terminato con null.</li></ul><p>La chiamata di funzione non ritorna, il processo verrà terminato.</p><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h2 id="object-lifetime-management" tabindex="-1">Gestione della durata degli oggetti <a class="header-anchor" href="#object-lifetime-management" aria-label="Permalink to “Gestione della durata degli oggetti”">​</a></h2><p>Man mano che vengono effettuate chiamate Node-API, gli handle agli oggetti nell&#39;heap per la VM sottostante possono essere restituiti come <code>napi_values</code>. Questi handle devono mantenere gli oggetti &quot;attivi&quot; fino a quando non sono più necessari al codice nativo, altrimenti gli oggetti potrebbero essere raccolti prima che il codice nativo abbia finito di utilizzarli.</p><p>Man mano che gli handle degli oggetti vengono restituiti, sono associati a un &quot;ambito&quot;. La durata dell&#39;ambito predefinito è legata alla durata della chiamata al metodo nativo. Il risultato è che, per impostazione predefinita, gli handle rimangono validi e gli oggetti associati a questi handle verranno mantenuti attivi per la durata della chiamata al metodo nativo.</p><p>In molti casi, tuttavia, è necessario che gli handle rimangano validi per una durata inferiore o superiore a quella del metodo nativo. Le sezioni che seguono descrivono le funzioni Node-API che possono essere utilizzate per modificare la durata dell&#39;handle rispetto a quella predefinita.</p><h3 id="making-handle-lifespan-shorter-than-that-of-the-native-method" tabindex="-1">Ridurre la durata dell&#39;handle rispetto a quella del metodo nativo <a class="header-anchor" href="#making-handle-lifespan-shorter-than-that-of-the-native-method" aria-label="Permalink to “Ridurre la durata dell&#39;handle rispetto a quella del metodo nativo”">​</a></h3><p>Spesso è necessario ridurre la durata degli handle rispetto alla durata di un metodo nativo. Ad esempio, si consideri un metodo nativo che ha un ciclo che scorre gli elementi di un grande array:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, object, i, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // do something with element</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Ciò comporterebbe la creazione di un gran numero di handle, consumando risorse considerevoli. Inoltre, anche se il codice nativo potesse utilizzare solo l&#39;handle più recente, tutti gli oggetti associati verrebbero mantenuti in vita poiché condividono tutti lo stesso scope.</p><p>Per gestire questo caso, Node-API offre la possibilità di stabilire un nuovo &#39;scope&#39; a cui saranno associati gli handle appena creati. Una volta che tali handle non sono più necessari, lo scope può essere &#39;chiuso&#39; e tutti gli handle associati allo scope vengono invalidati. I metodi disponibili per aprire/chiudere gli scope sono <a href="/it/nodejs/api/n-api#napi-open-handle-scope"><code>napi_open_handle_scope</code></a> e <a href="/it/nodejs/api/n-api#napi-close-handle-scope"><code>napi_close_handle_scope</code></a>.</p><p>Node-API supporta solo una singola gerarchia nidificata di scope. C&#39;è solo uno scope attivo in qualsiasi momento e tutti i nuovi handle saranno associati a tale scope mentre è attivo. Gli scope devono essere chiusi nell&#39;ordine inverso rispetto a quello in cui sono stati aperti. Inoltre, tutti gli scope creati all&#39;interno di un metodo nativo devono essere chiusi prima di ritornare da quel metodo.</p><p>Riprendendo l&#39;esempio precedente, l&#39;aggiunta di chiamate a <a href="/it/nodejs/api/n-api#napi-open-handle-scope"><code>napi_open_handle_scope</code></a> e <a href="/it/nodejs/api/n-api#napi-close-handle-scope"><code>napi_close_handle_scope</code></a> garantirebbe che al massimo un singolo handle sia valido durante l&#39;esecuzione del ciclo:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_handle_scope scope;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_open_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scope);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, object, i, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // do something with element</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_close_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, scope);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>Quando si annidano gli scope, ci sono casi in cui un handle di uno scope interno deve sopravvivere alla durata di tale scope. Node-API supporta uno &#39;scope escapabile&#39; per supportare questo caso. Uno scope escapabile consente a un handle di essere &#39;promosso&#39; in modo che &#39;sfugga&#39; allo scope corrente e la durata dell&#39;handle cambi dallo scope corrente a quello dello scope esterno.</p><p>I metodi disponibili per aprire/chiudere gli scope escapabili sono <a href="/it/nodejs/api/n-api#napi-open-escapable-handle-scope"><code>napi_open_escapable_handle_scope</code></a> e <a href="/it/nodejs/api/n-api#napi-close-escapable-handle-scope"><code>napi_close_escapable_handle_scope</code></a>.</p><p>La richiesta di promuovere un handle viene effettuata tramite <a href="/it/nodejs/api/n-api#napi-escape-handle"><code>napi_escape_handle</code></a> che può essere chiamato una sola volta.</p><h4 id="napi_open_handle_scope" tabindex="-1"><code>napi_open_handle_scope</code> <a class="header-anchor" href="#napi_open_handle_scope" aria-label="Permalink to “napi_open_handle_scope”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_open_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                               napi_handle_scope</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta il nuovo scope.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API apre un nuovo scope.</p><h4 id="napi_close_handle_scope" tabindex="-1"><code>napi_close_handle_scope</code> <a class="header-anchor" href="#napi_close_handle_scope" aria-label="Permalink to “napi_close_handle_scope”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_close_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                napi_handle_scope </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] scope</code>: <code>napi_value</code> che rappresenta lo scope da chiudere.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API chiude lo scope passato. Gli scope devono essere chiusi nell&#39;ordine inverso rispetto a quello in cui sono stati creati.</p><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h4 id="napi_open_escapable_handle_scope" tabindex="-1"><code>napi_open_escapable_handle_scope</code> <a class="header-anchor" href="#napi_open_escapable_handle_scope" aria-label="Permalink to “napi_open_escapable_handle_scope”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    napi_open_escapable_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_handle_scope</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta il nuovo scope.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API apre un nuovo scope da cui un oggetto può essere promosso allo scope esterno.</p><h4 id="napi_close_escapable_handle_scope" tabindex="-1"><code>napi_close_escapable_handle_scope</code> <a class="header-anchor" href="#napi_close_escapable_handle_scope" aria-label="Permalink to “napi_close_escapable_handle_scope”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    napi_close_escapable_handle_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_handle_scope </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] scope</code>: <code>napi_value</code> che rappresenta lo scope da chiudere.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API chiude lo scope passato. Gli scope devono essere chiusi nell&#39;ordine inverso rispetto a quello in cui sono stati creati.</p><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h4 id="napi_escape_handle" tabindex="-1"><code>napi_escape_handle</code> <a class="header-anchor" href="#napi_escape_handle" aria-label="Permalink to “napi_escape_handle”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_escape_handle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_escapable_handle_scope </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">escapee</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] scope</code>: <code>napi_value</code> che rappresenta l&#39;ambito corrente.</li><li><code>[in] escapee</code>: <code>napi_value</code> che rappresenta l&#39;<code>Object</code> JavaScript da rilasciare.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;handle per l&#39;<code>Object</code> rilasciato nell&#39;ambito esterno.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API promuove l&#39;handle all&#39;oggetto JavaScript in modo che sia valido per tutta la durata dell&#39;ambito esterno. Può essere chiamato solo una volta per ambito. Se viene chiamato più di una volta, verrà restituito un errore.</p><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h3 id="references-to-values-with-a-lifespan-longer-than-that-of-the-native-method" tabindex="-1">Riferimenti a valori con una durata maggiore di quella del metodo nativo <a class="header-anchor" href="#references-to-values-with-a-lifespan-longer-than-that-of-the-native-method" aria-label="Permalink to “Riferimenti a valori con una durata maggiore di quella del metodo nativo”">​</a></h3><p>In alcuni casi, un addon dovrà essere in grado di creare e fare riferimento a valori con una durata maggiore di quella di una singola invocazione di metodo nativo. Ad esempio, per creare un costruttore e successivamente utilizzare tale costruttore in una richiesta per creare istanze, deve essere possibile fare riferimento all&#39;oggetto costruttore attraverso molte richieste di creazione di istanze diverse. Ciò non sarebbe possibile con un normale handle restituito come <code>napi_value</code> come descritto nella sezione precedente. La durata di un normale handle è gestita dagli ambiti e tutti gli ambiti devono essere chiusi prima della fine di un metodo nativo.</p><p>Node-API fornisce metodi per la creazione di riferimenti permanenti ai valori. Attualmente Node-API consente la creazione di riferimenti solo per un insieme limitato di tipi di valore, tra cui object, external, function e symbol.</p><p>Ogni riferimento ha un conteggio associato con un valore pari o superiore a 0, che determina se il riferimento manterrà attivo il valore corrispondente. I riferimenti con un conteggio pari a 0 non impediscono la raccolta dei valori. I valori di tipo object (object, function, external) e symbol stanno diventando riferimenti &quot;deboli&quot; e sono ancora accessibili finché non vengono raccolti. Qualsiasi conteggio maggiore di 0 impedirà la raccolta dei valori.</p><p>I valori Symbol hanno diversi tipi. Il vero comportamento di riferimento debole è supportato solo dai simboli locali creati con la funzione <code>napi_create_symbol</code> o le chiamate al costruttore JavaScript <code>Symbol()</code>. I simboli registrati globalmente creati con la funzione <code>node_api_symbol_for</code> o le chiamate alla funzione JavaScript <code>Symbol.for()</code> rimangono sempre riferimenti forti perché il garbage collector non li raccoglie. Lo stesso vale per i simboli noti come <code>Symbol.iterator</code>. Inoltre, non vengono mai raccolti dal garbage collector.</p><p>È possibile creare riferimenti con un conteggio iniziale di riferimenti. Il conteggio può quindi essere modificato tramite <a href="/it/nodejs/api/n-api#napi-reference-ref"><code>napi_reference_ref</code></a> e <a href="/it/nodejs/api/n-api#napi-reference-unref"><code>napi_reference_unref</code></a>. Se un oggetto viene raccolto mentre il conteggio per un riferimento è 0, tutte le chiamate successive per ottenere l&#39;oggetto associato al riferimento <a href="/it/nodejs/api/n-api#napi-get-reference-value"><code>napi_get_reference_value</code></a> restituiranno <code>NULL</code> per il <code>napi_value</code> restituito. Un tentativo di chiamare <a href="/it/nodejs/api/n-api#napi-reference-ref"><code>napi_reference_ref</code></a> per un riferimento il cui oggetto è stato raccolto provoca un errore.</p><p>I riferimenti devono essere eliminati una volta che non sono più necessari per l&#39;addon. Quando un riferimento viene eliminato, non impedirà più la raccolta dell&#39;oggetto corrispondente. La mancata eliminazione di un riferimento persistente si traduce in una &quot;perdita di memoria&quot; con sia la memoria nativa per il riferimento persistente sia l&#39;oggetto corrispondente sull&#39;heap che vengono conservati per sempre.</p><p>È possibile creare più riferimenti persistenti che fanno riferimento allo stesso oggetto, ognuno dei quali manterrà attivo l&#39;oggetto o meno in base al suo conteggio individuale. Più riferimenti persistenti allo stesso oggetto possono comportare la conservazione inaspettata della memoria nativa. Le strutture native per un riferimento persistente devono essere mantenute attive fino a quando non vengono eseguiti i finalizzatori per l&#39;oggetto a cui si fa riferimento. Se viene creato un nuovo riferimento persistente per lo stesso oggetto, i finalizzatori per tale oggetto non verranno eseguiti e la memoria nativa puntata dal precedente riferimento persistente non verrà liberata. Ciò può essere evitato chiamando <code>napi_delete_reference</code> in aggiunta a <code>napi_reference_unref</code> quando possibile.</p><p><strong>Cronologia delle modifiche:</strong></p><ul><li>Sperimentale (<code>NAPI_EXPERIMENTAL</code> è definito): è possibile creare riferimenti per tutti i tipi di valore. I nuovi tipi di valore supportati non supportano la semantica di riferimento debole e i valori di questi tipi vengono rilasciati quando il conteggio dei riferimenti diventa 0 e non è più possibile accedervi dal riferimento.</li></ul><h4 id="napi_create_reference" tabindex="-1"><code>napi_create_reference</code> <a class="header-anchor" href="#napi_create_reference" aria-label="Permalink to “napi_create_reference”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_reference</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                              uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> initial_refcount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                              napi_ref</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: Il <code>napi_value</code> per cui viene creato un riferimento.</li><li><code>[in] initial_refcount</code>: Conteggio iniziale dei riferimenti per il nuovo riferimento.</li><li><code>[out] result</code>: <code>napi_ref</code> che punta al nuovo riferimento.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un nuovo riferimento con il conteggio dei riferimenti specificato al valore passato.</p><h4 id="napi_delete_reference" tabindex="-1"><code>napi_delete_reference</code> <a class="header-anchor" href="#napi_delete_reference" aria-label="Permalink to “napi_delete_reference”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_delete_reference</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_ref </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] ref</code>: <code>napi_ref</code> da eliminare.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API elimina il riferimento passato.</p><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h4 id="napi_reference_ref" tabindex="-1"><code>napi_reference_ref</code> <a class="header-anchor" href="#napi_reference_ref" aria-label="Permalink to “napi_reference_ref”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_reference_ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_ref </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                           uint32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] ref</code>: <code>napi_ref</code> per cui verrà incrementato il conteggio dei riferimenti.</li><li><code>[out] result</code>: Il nuovo conteggio dei riferimenti.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API incrementa il conteggio dei riferimenti per il riferimento passato e restituisce il conteggio dei riferimenti risultante.</p><h4 id="napi_reference_unref" tabindex="-1"><code>napi_reference_unref</code> <a class="header-anchor" href="#napi_reference_unref" aria-label="Permalink to “napi_reference_unref”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_reference_unref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                             napi_ref </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                             uint32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] ref</code>: <code>napi_ref</code> per cui verrà decrementato il conteggio dei riferimenti.</li><li><code>[out] result</code>: Il nuovo conteggio dei riferimenti.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API decrementa il conteggio dei riferimenti per il riferimento passato e restituisce il conteggio dei riferimenti risultante.</p><h4 id="napi_get_reference_value" tabindex="-1"><code>napi_get_reference_value</code> <a class="header-anchor" href="#napi_get_reference_value" aria-label="Permalink to “napi_get_reference_value”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_reference_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_ref </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] ref</code>: Il <code>napi_ref</code> per il quale viene richiesto il valore corrispondente.</li><li><code>[out] result</code>: Il <code>napi_value</code> a cui fa riferimento <code>napi_ref</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Se ancora valido, questa API restituisce il <code>napi_value</code> che rappresenta il valore JavaScript associato al <code>napi_ref</code>. Altrimenti, il risultato sarà <code>NULL</code>.</p><h3 id="cleanup-on-exit-of-the-current-nodejs-environment" tabindex="-1">Pulizia all&#39;uscita dell&#39;ambiente Node.js corrente <a class="header-anchor" href="#cleanup-on-exit-of-the-current-nodejs-environment" aria-label="Permalink to “Pulizia all&#39;uscita dell&#39;ambiente Node.js corrente”">​</a></h3><p>Mentre un processo Node.js rilascia tipicamente tutte le sue risorse all&#39;uscita, gli incorporatori di Node.js, o il futuro supporto di Worker, potrebbero richiedere agli addon di registrare hook di pulizia che verranno eseguiti una volta che l&#39;ambiente Node.js corrente esce.</p><p>Node-API fornisce funzioni per registrare e annullare la registrazione di tali callback. Quando vengono eseguiti questi callback, tutte le risorse che vengono trattenute dall&#39;addon devono essere liberate.</p><h4 id="napi_add_env_cleanup_hook" tabindex="-1"><code>napi_add_env_cleanup_hook</code> <a class="header-anchor" href="#napi_add_env_cleanup_hook" aria-label="Permalink to “napi_add_env_cleanup_hook”">​</a></h4><p><strong>Aggiunto in: v10.2.0</strong></p><p><strong>Versione N-API: 3</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NODE_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_add_env_cleanup_hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                  napi_cleanup_hook </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fun</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                  void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Registra <code>fun</code> come funzione da eseguire con il parametro <code>arg</code> una volta che l&#39;ambiente Node.js corrente esce.</p><p>Una funzione può essere specificata in modo sicuro più volte con valori <code>arg</code> diversi. In tal caso, verrà chiamata anche più volte. Fornire gli stessi valori <code>fun</code> e <code>arg</code> più volte non è consentito e porterà all&#39;interruzione del processo.</p><p>Gli hook verranno chiamati in ordine inverso, ovvero quello aggiunto più di recente verrà chiamato per primo.</p><p>La rimozione di questo hook può essere eseguita utilizzando <a href="/it/nodejs/api/n-api#napi-remove-env-cleanup-hook"><code>napi_remove_env_cleanup_hook</code></a>. In genere, ciò accade quando la risorsa per la quale è stato aggiunto questo hook viene comunque smantellata.</p><p>Per la pulizia asincrona, è disponibile <a href="/it/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>.</p><h4 id="napi_remove_env_cleanup_hook" tabindex="-1"><code>napi_remove_env_cleanup_hook</code> <a class="header-anchor" href="#napi_remove_env_cleanup_hook" aria-label="Permalink to “napi_remove_env_cleanup_hook”">​</a></h4><p><strong>Aggiunto in: v10.2.0</strong></p><p><strong>Versione N-API: 3</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_remove_env_cleanup_hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                     void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fun)(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arg),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                     void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Annulla la registrazione di <code>fun</code> come funzione da eseguire con il parametro <code>arg</code> una volta che l&#39;ambiente Node.js corrente si chiude. Sia l&#39;argomento che il valore della funzione devono corrispondere esattamente.</p><p>La funzione deve essere stata originariamente registrata con <code>napi_add_env_cleanup_hook</code>, altrimenti il processo verrà interrotto.</p><h4 id="napi_add_async_cleanup_hook" tabindex="-1"><code>napi_add_async_cleanup_hook</code> <a class="header-anchor" href="#napi_add_async_cleanup_hook" aria-label="Permalink to “napi_add_async_cleanup_hook”">​</a></h4><div class="info custom-block"><p class="custom-block-title">[Cronologia]</p><table tabindex="0"><thead><tr><th>Versione</th><th>Modifiche</th></tr></thead><tbody><tr><td>v14.10.0, v12.19.0</td><td>Firma modificata del callback <code>hook</code>.</td></tr><tr><td>v14.8.0, v12.19.0</td><td>Aggiunto in: v14.8.0, v12.19.0</td></tr></tbody></table></div><p><strong>Versione N-API: 8</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_add_async_cleanup_hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    napi_async_cleanup_hook </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    napi_async_cleanup_hook_handle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> remove_handle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] hook</code>: Il puntatore di funzione da chiamare alla chiusura dell&#39;ambiente.</li><li><code>[in] arg</code>: Il puntatore da passare a <code>hook</code> quando viene chiamato.</li><li><code>[out] remove_handle</code>: Handle facoltativo che fa riferimento all&#39;hook di pulizia asincrono.</li></ul><p>Registra <code>hook</code>, che è una funzione di tipo <a href="/it/nodejs/api/n-api#napi-async-cleanup-hook"><code>napi_async_cleanup_hook</code></a>, come funzione da eseguire con i parametri <code>remove_handle</code> e <code>arg</code> una volta che l&#39;ambiente Node.js corrente si chiude.</p><p>A differenza di <a href="/it/nodejs/api/n-api#napi-add-env-cleanup-hook"><code>napi_add_env_cleanup_hook</code></a>, l&#39;hook può essere asincrono.</p><p>Altrimenti, il comportamento corrisponde generalmente a quello di <a href="/it/nodejs/api/n-api#napi-add-env-cleanup-hook"><code>napi_add_env_cleanup_hook</code></a>.</p><p>Se <code>remove_handle</code> non è <code>NULL</code>, in esso verrà memorizzato un valore opaco che dovrà essere successivamente passato a <a href="/it/nodejs/api/n-api#napi-remove-async-cleanup-hook"><code>napi_remove_async_cleanup_hook</code></a>, indipendentemente dal fatto che l&#39;hook sia già stato richiamato o meno. In genere, ciò accade quando la risorsa per la quale è stato aggiunto questo hook viene comunque smantellata.</p><h4 id="napi_remove_async_cleanup_hook" tabindex="-1"><code>napi_remove_async_cleanup_hook</code> <a class="header-anchor" href="#napi_remove_async_cleanup_hook" aria-label="Permalink to “napi_remove_async_cleanup_hook”">​</a></h4><div class="info custom-block"><p class="custom-block-title">[Cronologia]</p><table tabindex="0"><thead><tr><th>Versione</th><th>Modifiche</th></tr></thead><tbody><tr><td>v14.10.0, v12.19.0</td><td>Parametro <code>env</code> rimosso.</td></tr><tr><td>v14.8.0, v12.19.0</td><td>Aggiunto in: v14.8.0, v12.19.0</td></tr></tbody></table></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_remove_async_cleanup_hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    napi_async_cleanup_hook_handle </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">remove_handle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] remove_handle</code>: L&#39;handle di un hook di pulizia asincrono creato con <a href="/it/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>.</li></ul><p>Annulla la registrazione dell&#39;hook di pulizia corrispondente a <code>remove_handle</code>. Ciò impedirà l&#39;esecuzione dell&#39;hook, a meno che non abbia già iniziato l&#39;esecuzione. Questo deve essere chiamato su qualsiasi valore <code>napi_async_cleanup_hook_handle</code> ottenuto da <a href="/it/nodejs/api/n-api#napi-add-async-cleanup-hook"><code>napi_add_async_cleanup_hook</code></a>.</p><h3 id="finalization-on-the-exit-of-the-nodejs-environment" tabindex="-1">Finalizzazione all&#39;uscita dell&#39;ambiente Node.js <a class="header-anchor" href="#finalization-on-the-exit-of-the-nodejs-environment" aria-label="Permalink to “Finalizzazione all&#39;uscita dell&#39;ambiente Node.js”">​</a></h3><p>L&#39;ambiente Node.js può essere smantellato in un momento arbitrario il prima possibile con l&#39;esecuzione di JavaScript non consentita, come su richiesta di <a href="/it/nodejs/api/worker_threads#workerterminate"><code>worker.terminate()</code></a>. Quando l&#39;ambiente viene smantellato, i callback <code>napi_finalize</code> registrati degli oggetti JavaScript, delle funzioni thread-safe e dei dati dell&#39;istanza dell&#39;ambiente vengono invocati immediatamente e indipendentemente.</p><p>L&#39;invocazione dei callback <code>napi_finalize</code> è programmata dopo gli hook di pulizia registrati manualmente. Al fine di garantire un ordine corretto di finalizzazione dell&#39;addon durante l&#39;arresto dell&#39;ambiente per evitare l&#39;uso dopo la liberazione nel callback <code>napi_finalize</code>, gli addon dovrebbero registrare un hook di pulizia con <code>napi_add_env_cleanup_hook</code> e <code>napi_add_async_cleanup_hook</code> per rilasciare manualmente la risorsa allocata in un ordine corretto.</p><h2 id="module-registration" tabindex="-1">Registrazione del modulo <a class="header-anchor" href="#module-registration" aria-label="Permalink to “Registrazione del modulo”">​</a></h2><p>I moduli Node-API sono registrati in modo simile ad altri moduli, tranne per il fatto che invece di usare la macro <code>NODE_MODULE</code> viene usato quanto segue:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAPI_MODULE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NODE_GYP_MODULE_NAME, Init)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>La successiva differenza è la firma per il metodo <code>Init</code>. Per un modulo Node-API è la seguente:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Il valore di ritorno da <code>Init</code> è trattato come l&#39;oggetto <code>exports</code> per il modulo. Il metodo <code>Init</code> viene passato un oggetto vuoto tramite il parametro <code>exports</code> come comodità. Se <code>Init</code> restituisce <code>NULL</code>, il parametro passato come <code>exports</code> viene esportato dal modulo. I moduli Node-API non possono modificare l&#39;oggetto <code>module</code> ma possono specificare qualsiasi cosa come proprietà <code>exports</code> del modulo.</p><p>Per aggiungere il metodo <code>hello</code> come funzione in modo che possa essere chiamato come un metodo fornito dall&#39;addon:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_property_descriptor desc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Method,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_enumerable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_configurable,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    NULL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_define_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, exports, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">desc);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> exports;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>Per impostare una funzione da restituire tramite il <code>require()</code> per l&#39;addon:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value method;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;exports&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, NAPI_AUTO_LENGTH, Method, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">method);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> method;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Per definire una classe in modo che possano essere create nuove istanze (spesso usata con <a href="/it/nodejs/api/n-api#object-wrap">Object wrap</a>):</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// NOTA: esempio parziale, non tutto il codice a cui si fa riferimento è incluso</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_property_descriptor properties</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, GetValue, SetValue, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_configurable, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    DECLARE_NAPI_METHOD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;plusOne&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, PlusOne),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    DECLARE_NAPI_METHOD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;multiply&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Multiply),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value cons;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      napi_define_class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyObject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, New, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, properties, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cons);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_reference</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, cons, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">constructor);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, exports, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyObject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, cons);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> exports;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>È anche possibile usare la macro <code>NAPI_MODULE_INIT</code>, che funge da abbreviazione per <code>NAPI_MODULE</code> e definisce una funzione <code>Init</code>:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAPI_MODULE_INIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* napi_env env, napi_value exports */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value answer;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status result;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">answer);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, exports, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, answer);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> exports;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>I parametri <code>env</code> e <code>exports</code> sono forniti al corpo della macro <code>NAPI_MODULE_INIT</code>.</p><p>Tutti gli addon Node-API sono context-aware, il che significa che possono essere caricati più volte. Ci sono alcune considerazioni di progettazione quando si dichiara un tale modulo. La documentazione sugli <a href="/it/nodejs/api/addons#context-aware-addons">addon context-aware</a> fornisce maggiori dettagli.</p><p>Le variabili <code>env</code> e <code>exports</code> saranno disponibili all&#39;interno del corpo della funzione dopo l&#39;invocazione della macro.</p><p>Per maggiori dettagli sull&#39;impostazione delle proprietà sugli oggetti, consultare la sezione su <a href="/it/nodejs/api/n-api#working-with-javascript-properties">Lavorare con le proprietà JavaScript</a>.</p><p>Per maggiori dettagli sulla creazione di moduli addon in generale, fare riferimento all&#39;API esistente.</p><h2 id="working-with-javascript-values" tabindex="-1">Lavorare con valori JavaScript <a class="header-anchor" href="#working-with-javascript-values" aria-label="Permalink to “Lavorare con valori JavaScript”">​</a></h2><p>Node-API espone un insieme di API per creare tutti i tipi di valori JavaScript. Alcuni di questi tipi sono documentati nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values" target="_blank" rel="noreferrer">Sezione 6</a> della <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">Specifica del linguaggio ECMAScript</a>.</p><p>Fondamentalmente, queste API vengono utilizzate per fare una delle seguenti cose:</p><p>I valori Node-API sono rappresentati dal tipo <code>napi_value</code>. Qualsiasi chiamata Node-API che richiede un valore JavaScript accetta un <code>napi_value</code>. In alcuni casi, l&#39;API verifica in anticipo il tipo di <code>napi_value</code>. Tuttavia, per ottenere prestazioni migliori, è meglio che il chiamante si assicuri che il <code>napi_value</code> in questione sia del tipo JavaScript previsto dall&#39;API.</p><h3 id="enum-types" tabindex="-1">Tipi Enum <a class="header-anchor" href="#enum-types" aria-label="Permalink to “Tipi Enum”">​</a></h3><h4 id="napi_key_collection_mode" tabindex="-1"><code>napi_key_collection_mode</code> <a class="header-anchor" href="#napi_key_collection_mode" aria-label="Permalink to “napi_key_collection_mode”">​</a></h4><p><strong>Aggiunto in: v13.7.0, v12.17.0, v10.20.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_include_prototypes,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_own_only</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_key_collection_mode;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Descrive gli enum del filtro <code>Chiavi/Proprietà</code>:</p><p><code>napi_key_collection_mode</code> limita l&#39;intervallo di proprietà raccolte.</p><p><code>napi_key_own_only</code> limita le proprietà raccolte solo all&#39;oggetto specificato. <code>napi_key_include_prototypes</code> includerà anche tutte le chiavi della catena di prototipi dell&#39;oggetto.</p><h4 id="napi_key_filter" tabindex="-1"><code>napi_key_filter</code> <a class="header-anchor" href="#napi_key_filter" aria-label="Permalink to “napi_key_filter”">​</a></h4><p><strong>Aggiunto in: v13.7.0, v12.17.0, v10.20.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_all_properties </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_enumerable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_configurable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_skip_strings </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_skip_symbols </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_key_filter;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Bit di filtro proprietà. Possono essere combinati con OR per creare un filtro composito.</p><h4 id="napi_key_conversion" tabindex="-1"><code>napi_key_conversion</code> <a class="header-anchor" href="#napi_key_conversion" aria-label="Permalink to “napi_key_conversion”">​</a></h4><p><strong>Aggiunto in: v13.7.0, v12.17.0, v10.20.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_keep_numbers,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_key_numbers_to_strings</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_key_conversion;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>napi_key_numbers_to_strings</code> convertirà gli indici interi in stringhe. <code>napi_key_keep_numbers</code> restituirà numeri per gli indici interi.</p><h4 id="napi_valuetype" tabindex="-1"><code>napi_valuetype</code> <a class="header-anchor" href="#napi_valuetype" aria-label="Permalink to “napi_valuetype”">​</a></h4><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Tipi ES6 (corrisponde a typeof)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_undefined,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_null,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_boolean,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_number,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_string,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_symbol,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_object,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_function,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_external,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_bigint,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_valuetype;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Descrive il tipo di un <code>napi_value</code>. Ciò corrisponde generalmente ai tipi descritti nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types" target="_blank" rel="noreferrer">Sezione 6.1</a> della Specifica del linguaggio ECMAScript. Oltre ai tipi in quella sezione, <code>napi_valuetype</code> può anche rappresentare <code>Funzioni</code> e <code>Oggetti</code> con dati esterni.</p><p>Un valore JavaScript di tipo <code>napi_external</code> appare in JavaScript come un oggetto semplice su cui non è possibile impostare proprietà e nessun prototipo.</p><h4 id="napi_typedarray_type" tabindex="-1"><code>napi_typedarray_type</code> <a class="header-anchor" href="#napi_typedarray_type" aria-label="Permalink to “napi_typedarray_type”">​</a></h4><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_int8_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_uint8_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_uint8_clamped_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_int16_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_uint16_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_int32_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_uint32_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_float32_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_float64_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_bigint64_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_biguint64_array,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_typedarray_type;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Questo rappresenta il tipo di dati scalare binario sottostante del <code>TypedArray</code>. Gli elementi di questo enum corrispondono alla <a href="https://tc39.github.io/ecma262/#sec-typedarray-objects" target="_blank" rel="noreferrer">Sezione 22.2</a> della <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">Specificazione del Linguaggio ECMAScript</a>.</p><h3 id="object-creation-functions" tabindex="-1">Funzioni di creazione degli oggetti <a class="header-anchor" href="#object-creation-functions" aria-label="Permalink to “Funzioni di creazione degli oggetti”">​</a></h3><h4 id="napi_create_array" tabindex="-1"><code>napi_create_array</code> <a class="header-anchor" href="#napi_create_array" aria-label="Permalink to “napi_create_array”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata la chiamata Node-API.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>Array</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce un valore Node-API corrispondente a un tipo <code>Array</code> JavaScript. Gli array JavaScript sono descritti nella <a href="https://tc39.github.io/ecma262/#sec-array-objects" target="_blank" rel="noreferrer">Sezione 22.1</a> della Specificazione del Linguaggio ECMAScript.</p><h4 id="napi_create_array_with_length" tabindex="-1"><code>napi_create_array_with_length</code> <a class="header-anchor" href="#napi_create_array_with_length" aria-label="Permalink to “napi_create_array_with_length”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_array_with_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                          size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                          napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] length</code>: La lunghezza iniziale dell&#39;<code>Array</code>.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>Array</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce un valore Node-API corrispondente a un tipo <code>Array</code> JavaScript. La proprietà length dell&#39;<code>Array</code> è impostata sul parametro length passato. Tuttavia, non è garantito che il buffer sottostante venga pre-allocato dalla VM quando viene creato l&#39;array. Tale comportamento è lasciato all&#39;implementazione della VM sottostante. Se il buffer deve essere un blocco di memoria contiguo che può essere letto e/o scritto direttamente tramite C, si consideri l&#39;utilizzo di <a href="/it/nodejs/api/n-api#napi-create-external-arraybuffer"><code>napi_create_external_arraybuffer</code></a>.</p><p>Gli array JavaScript sono descritti nella <a href="https://tc39.github.io/ecma262/#sec-array-objects" target="_blank" rel="noreferrer">Sezione 22.1</a> della Specificazione del Linguaggio ECMAScript.</p><h4 id="napi_create_arraybuffer" tabindex="-1"><code>napi_create_arraybuffer</code> <a class="header-anchor" href="#napi_create_arraybuffer" aria-label="Permalink to “napi_create_arraybuffer”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui l&#39;API viene invocata.</li><li><code>[in] length</code>: La lunghezza in byte del buffer array da creare.</li><li><code>[out] data</code>: Puntatore al buffer di byte sottostante dell&#39;<code>ArrayBuffer</code>. <code>data</code> può essere facoltativamente ignorato passando <code>NULL</code>.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>ArrayBuffer</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce un valore Node-API corrispondente a un <code>ArrayBuffer</code> JavaScript. Gli <code>ArrayBuffer</code> vengono utilizzati per rappresentare buffer di dati binari a lunghezza fissa. Vengono normalmente utilizzati come buffer di supporto per gli oggetti <code>TypedArray</code>. L&#39;<code>ArrayBuffer</code> allocato avrà un buffer di byte sottostante la cui dimensione è determinata dal parametro <code>length</code> passato. Il buffer sottostante viene facoltativamente restituito al chiamante nel caso in cui il chiamante voglia manipolare direttamente il buffer. Questo buffer può essere scritto direttamente solo dal codice nativo. Per scrivere in questo buffer da JavaScript, sarebbe necessario creare un array tipizzato o un oggetto <code>DataView</code>.</p><p>Gli oggetti <code>ArrayBuffer</code> JavaScript sono descritti nella <a href="https://tc39.github.io/ecma262/#sec-arraybuffer-objects" target="_blank" rel="noreferrer">Sezione 24.1</a> della specifica del linguaggio ECMAScript.</p><h4 id="napi_create_buffer" tabindex="-1"><code>napi_create_buffer</code> <a class="header-anchor" href="#napi_create_buffer" aria-label="Permalink to “napi_create_buffer”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                               size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                               void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui l&#39;API viene invocata.</li><li><code>[in] size</code>: Dimensione in byte del buffer sottostante.</li><li><code>[out] data</code>: Puntatore raw al buffer sottostante. <code>data</code> può essere facoltativamente ignorato passando <code>NULL</code>.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>node::Buffer</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API alloca un oggetto <code>node::Buffer</code>. Sebbene questa sia ancora una struttura dati completamente supportata, nella maggior parte dei casi l&#39;utilizzo di un <code>TypedArray</code> sarà sufficiente.</p><h4 id="napi_create_buffer_copy" tabindex="-1"><code>napi_create_buffer_copy</code> <a class="header-anchor" href="#napi_create_buffer_copy" aria-label="Permalink to “napi_create_buffer_copy”">​</a></h4><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_buffer_copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] size</code>: Dimensione in byte del buffer di input (deve essere uguale alla dimensione del nuovo buffer).</li><li><code>[in] data</code>: Puntatore raw al buffer sottostante da cui copiare.</li><li><code>[out] result_data</code>: Puntatore al buffer di dati sottostante del nuovo <code>Buffer</code>. <code>result_data</code> può essere opzionalmente ignorato passando <code>NULL</code>.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>node::Buffer</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API alloca un oggetto <code>node::Buffer</code> e lo inizializza con i dati copiati dal buffer passato. Sebbene questa sia ancora una struttura dati pienamente supportata, nella maggior parte dei casi l&#39;utilizzo di un <code>TypedArray</code> sarà sufficiente.</p><h4 id="napi_create_date" tabindex="-1"><code>napi_create_date</code> <a class="header-anchor" href="#napi_create_date" aria-label="Permalink to “napi_create_date”">​</a></h4><p><strong>Aggiunta in: v11.11.0, v10.17.0</strong></p><p><strong>Versione N-API: 5</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             double</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] time</code>: Valore di tempo ECMAScript in millisecondi dal 01 gennaio 1970 UTC.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>Date</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API non considera i secondi intercalari; vengono ignorati, poiché ECMAScript si allinea alla specifica temporale POSIX.</p><p>Questa API alloca un oggetto <code>Date</code> JavaScript.</p><p>Gli oggetti <code>Date</code> JavaScript sono descritti nella <a href="https://tc39.github.io/ecma262/#sec-date-objects" target="_blank" rel="noreferrer">Sezione 20.3</a> della Specification del linguaggio ECMAScript.</p><h4 id="napi_create_external" tabindex="-1"><code>napi_create_external</code> <a class="header-anchor" href="#napi_create_external" aria-label="Permalink to “napi_create_external”">​</a></h4><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_external</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] data</code>: Puntatore raw ai dati esterni.</li><li><code>[in] finalize_cb</code>: Callback opzionale da chiamare quando il valore esterno viene raccolto. <a href="/it/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> fornisce maggiori dettagli.</li><li><code>[in] finalize_hint</code>: Suggerimento opzionale da passare alla callback di finalizzazione durante la raccolta.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un valore esterno.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API alloca un valore JavaScript con dati esterni allegati. Questo viene utilizzato per passare dati esterni attraverso il codice JavaScript, in modo che possa essere recuperato in seguito dal codice nativo usando <a href="/it/nodejs/api/n-api#napi-get-value-external"><code>napi_get_value_external</code></a>.</p><p>L&#39;API aggiunge una callback <code>napi_finalize</code> che verrà chiamata quando l&#39;oggetto JavaScript appena creato è stato sottoposto a garbage collection.</p><p>Il valore creato non è un oggetto e quindi non supporta proprietà aggiuntive. È considerato un tipo di valore distinto: chiamare <code>napi_typeof()</code> con un valore esterno produce <code>napi_external</code>.</p><h4 id="napi_create_external_arraybuffer" tabindex="-1"><code>napi_create_external_arraybuffer</code> <a class="header-anchor" href="#napi_create_external_arraybuffer" aria-label="Permalink to “napi_create_external_arraybuffer”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_external_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> external_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] external_data</code>: Puntatore al buffer di byte sottostante dell&#39;<code>ArrayBuffer</code>.</li><li><code>[in] byte_length</code>: La lunghezza in byte del buffer sottostante.</li><li><code>[in] finalize_cb</code>: Callback opzionale da chiamare quando l&#39;<code>ArrayBuffer</code> viene raccolto. <a href="/it/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> fornisce maggiori dettagli.</li><li><code>[in] finalize_hint</code>: Suggerimento opzionale da passare alla callback di finalizzazione durante la raccolta.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>ArrayBuffer</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p><strong>Alcuni runtime diversi da Node.js hanno abbandonato il supporto per i buffer esterni</strong>. Su runtime diversi da Node.js questo metodo può restituire <code>napi_no_external_buffers_allowed</code> per indicare che i buffer esterni non sono supportati. Un runtime di questo tipo è Electron come descritto in questo problema <a href="https://github.com/electron/electron/issues/35801" target="_blank" rel="noreferrer">electron/issues/35801</a>.</p><p>Per mantenere la più ampia compatibilità con tutti i runtime, è possibile definire <code>NODE_API_NO_EXTERNAL_BUFFERS_ALLOWED</code> nel proprio componente aggiuntivo prima degli include per le intestazioni node-api. In questo modo si nasconderanno le 2 funzioni che creano buffer esterni. Ciò garantirà che si verifichi un errore di compilazione se si utilizza accidentalmente uno di questi metodi.</p><p>Questa API restituisce un valore Node-API corrispondente a un <code>ArrayBuffer</code> JavaScript. Il buffer di byte sottostante dell&#39;<code>ArrayBuffer</code> è allocato e gestito esternamente. Il chiamante deve garantire che il buffer di byte rimanga valido fino a quando non viene chiamata la callback di finalizzazione.</p><p>L&#39;API aggiunge una callback <code>napi_finalize</code> che verrà chiamata quando l&#39;oggetto JavaScript appena creato è stato sottoposto a garbage collection.</p><p>Gli <code>ArrayBuffer</code> JavaScript sono descritti nella <a href="https://tc39.github.io/ecma262/#sec-arraybuffer-objects" target="_blank" rel="noreferrer">Sezione 24.1</a> della Specifica del linguaggio ECMAScript.</p><h4 id="napi_create_external_buffer" tabindex="-1"><code>napi_create_external_buffer</code> <a class="header-anchor" href="#napi_create_external_buffer" aria-label="Permalink to “napi_create_external_buffer”">​</a></h4><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_external_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] length</code>: Dimensione in byte del buffer di input (deve essere uguale alla dimensione del nuovo buffer).</li><li><code>[in] data</code>: Puntatore raw al buffer sottostante da esporre a JavaScript.</li><li><code>[in] finalize_cb</code>: Callback opzionale da chiamare quando l&#39;<code>ArrayBuffer</code> viene raccolto. <a href="/it/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> fornisce maggiori dettagli.</li><li><code>[in] finalize_hint</code>: Suggerimento opzionale da passare alla callback di finalizzazione durante la raccolta.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>node::Buffer</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p><strong>Alcuni runtime diversi da Node.js hanno abbandonato il supporto per i buffer esterni</strong>. Su runtime diversi da Node.js, questo metodo può restituire <code>napi_no_external_buffers_allowed</code> per indicare che i buffer esterni non sono supportati. Un runtime di questo tipo è Electron, come descritto in questo problema <a href="https://github.com/electron/electron/issues/35801" target="_blank" rel="noreferrer">electron/issues/35801</a>.</p><p>Per mantenere la più ampia compatibilità con tutti i runtime, è possibile definire <code>NODE_API_NO_EXTERNAL_BUFFERS_ALLOWED</code> nel proprio addon prima degli include per gli header node-api. In questo modo si nasconderanno le 2 funzioni che creano buffer esterni. Ciò garantirà che si verifichi un errore di compilazione se si utilizza accidentalmente uno di questi metodi.</p><p>Questa API alloca un oggetto <code>node::Buffer</code> e lo inizializza con dati supportati dal buffer passato. Sebbene questa sia ancora una struttura dati completamente supportata, nella maggior parte dei casi l&#39;utilizzo di un <code>TypedArray</code> sarà sufficiente.</p><p>L&#39;API aggiunge una callback <code>napi_finalize</code> che verrà chiamata quando l&#39;oggetto JavaScript appena creato è stato sottoposto a garbage collection.</p><p>Per Node.js &gt;=4 i <code>Buffer</code> sono <code>Uint8Array</code>.</p><h4 id="napi_create_object" tabindex="-1"><code>napi_create_object</code> <a class="header-anchor" href="#napi_create_object" aria-label="Permalink to “napi_create_object”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>Object</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API alloca un <code>Object</code> JavaScript predefinito. È l&#39;equivalente di fare <code>new Object()</code> in JavaScript.</p><p>Il tipo <code>Object</code> JavaScript è descritto nella <a href="https://tc39.github.io/ecma262/#sec-object-type" target="_blank" rel="noreferrer">Sezione 6.1.7</a> della specifica del linguaggio ECMAScript.</p><h4 id="napi_create_symbol" tabindex="-1"><code>napi_create_symbol</code> <a class="header-anchor" href="#napi_create_symbol" aria-label="Permalink to “napi_create_symbol”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_symbol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] description</code>: <code>napi_value</code> opzionale che fa riferimento a una <code>string</code> JavaScript da impostare come descrizione per il simbolo.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>symbol</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un valore <code>symbol</code> JavaScript da una stringa C con codifica UTF8.</p><p>Il tipo <code>symbol</code> JavaScript è descritto nella <a href="https://tc39.github.io/ecma262/#sec-symbol-objects" target="_blank" rel="noreferrer">Sezione 19.4</a> della specifica del linguaggio ECMAScript.</p><h4 id="node_api_symbol_for" tabindex="-1"><code>node_api_symbol_for</code> <a class="header-anchor" href="#node_api_symbol_for" aria-label="Permalink to “node_api_symbol_for”">​</a></h4><p><strong>Aggiunto in: v17.5.0, v16.15.0</strong></p><p><strong>Versione N-API: 9</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_symbol_for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] utf8description</code>: Stringa C UTF-8 che rappresenta il testo da utilizzare come descrizione per il simbolo.</li><li><code>[in] length</code>: La lunghezza della stringa di descrizione in byte, o <code>NAPI_AUTO_LENGTH</code> se è terminata con null.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>symbol</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API cerca nel registro globale un simbolo esistente con la descrizione specificata. Se il simbolo esiste già, verrà restituito, altrimenti verrà creato un nuovo simbolo nel registro.</p><p>Il tipo <code>symbol</code> JavaScript è descritto nella <a href="https://tc39.github.io/ecma262/#sec-symbol-objects" target="_blank" rel="noreferrer">Sezione 19.4</a> della specifica del linguaggio ECMAScript.</p><h4 id="napi_create_typedarray" tabindex="-1"><code>napi_create_typedarray</code> <a class="header-anchor" href="#napi_create_typedarray" aria-label="Permalink to “napi_create_typedarray”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_typedarray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_typedarray_type </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_offset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] type</code>: Tipo di dati scalare degli elementi all&#39;interno del <code>TypedArray</code>.</li><li><code>[in] length</code>: Numero di elementi nel <code>TypedArray</code>.</li><li><code>[in] arraybuffer</code>: <code>ArrayBuffer</code> sottostante al typed array.</li><li><code>[in] byte_offset</code>: L&#39;offset in byte all&#39;interno dell&#39;<code>ArrayBuffer</code> da cui iniziare a proiettare il <code>TypedArray</code>.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>TypedArray</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un oggetto <code>TypedArray</code> JavaScript su un <code>ArrayBuffer</code> esistente. Gli oggetti <code>TypedArray</code> forniscono una vista simile a un array su un buffer di dati sottostante in cui ogni elemento ha lo stesso tipo di dati scalare binario sottostante.</p><p>È necessario che <code>(length * size_of_element) + byte_offset</code> sia &lt;= della dimensione in byte dell&#39;array passato. In caso contrario, viene sollevata un&#39;eccezione <code>RangeError</code>.</p><p>Gli oggetti <code>TypedArray</code> JavaScript sono descritti nella <a href="https://tc39.github.io/ecma262/#sec-typedarray-objects" target="_blank" rel="noreferrer">Sezione 22.2</a> della specifica del linguaggio ECMAScript.</p><h4 id="node_api_create_buffer_from_arraybuffer" tabindex="-1"><code>node_api_create_buffer_from_arraybuffer</code> <a class="header-anchor" href="#node_api_create_buffer_from_arraybuffer" aria-label="Permalink to “node_api_create_buffer_from_arraybuffer”">​</a></h4><p><strong>Aggiunto in: v23.0.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[Stabile: 1 - Sperimentale]</p><p><a href="/it/nodejs/api/documentation#stability-index">Stabile: 1</a> <a href="/it/nodejs/api/documentation#stability-index">Stabilità: 1</a> - Sperimentale</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status NAPI_CDECL </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_buffer_from_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                              size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_offset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                              size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><strong><code>[in] env</code></strong>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><strong><code>[in] arraybuffer</code></strong>: L&#39;<code>ArrayBuffer</code> da cui verrà creato il buffer.</li><li><strong><code>[in] byte_offset</code></strong>: L&#39;offset in byte all&#39;interno dell&#39;<code>ArrayBuffer</code> da cui iniziare a creare il buffer.</li><li><strong><code>[in] byte_length</code></strong>: La lunghezza in byte del buffer da creare dall&#39;<code>ArrayBuffer</code>.</li><li><strong><code>[out] result</code></strong>: Un <code>napi_value</code> che rappresenta l&#39;oggetto <code>Buffer</code> JavaScript creato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un oggetto <code>Buffer</code> JavaScript da un <code>ArrayBuffer</code> esistente. L&#39;oggetto <code>Buffer</code> è una classe specifica di Node.js che fornisce un modo per lavorare direttamente con dati binari in JavaScript.</p><p>L&#39;intervallo di byte <code>[byte_offset, byte_offset + byte_length)</code> deve rientrare nei limiti dell&#39;<code>ArrayBuffer</code>. Se <code>byte_offset + byte_length</code> supera la dimensione dell&#39;<code>ArrayBuffer</code>, viene generata un&#39;eccezione <code>RangeError</code>.</p><h4 id="napi_create_dataview" tabindex="-1"><code>napi_create_dataview</code> <a class="header-anchor" href="#napi_create_dataview" aria-label="Permalink to “napi_create_dataview”">​</a></h4><p><strong>Aggiunto in: v8.3.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_dataview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_offset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] length</code>: Numero di elementi nel <code>DataView</code>.</li><li><code>[in] arraybuffer</code>: <code>ArrayBuffer</code> sottostante al <code>DataView</code>.</li><li><code>[in] byte_offset</code>: L&#39;offset in byte all&#39;interno dell&#39;<code>ArrayBuffer</code> da cui iniziare a proiettare il <code>DataView</code>.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>DataView</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un oggetto <code>DataView</code> JavaScript su un <code>ArrayBuffer</code> esistente. Gli oggetti <code>DataView</code> forniscono una vista simile a un array su un buffer di dati sottostante, ma che consente elementi di dimensioni e tipi diversi nell&#39;<code>ArrayBuffer</code>.</p><p>È necessario che <code>byte_length + byte_offset</code> sia minore o uguale alla dimensione in byte dell&#39;array passato. In caso contrario, viene generata un&#39;eccezione <code>RangeError</code>.</p><p>Gli oggetti <code>DataView</code> JavaScript sono descritti nella <a href="https://tc39.github.io/ecma262/#sec-dataview-objects" target="_blank" rel="noreferrer">Sezione 24.3</a> della specifica del linguaggio ECMAScript.</p><h3 id="functions-to-convert-from-c-types-to-node-api" tabindex="-1">Funzioni per convertire dai tipi C a Node-API <a class="header-anchor" href="#functions-to-convert-from-c-types-to-node-api" aria-label="Permalink to “Funzioni per convertire dai tipi C a Node-API”">​</a></h3><h4 id="napi_create_int32" tabindex="-1"><code>napi_create_int32</code> <a class="header-anchor" href="#napi_create_int32" aria-label="Permalink to “napi_create_int32”">​</a></h4><p><strong>Aggiunto in: v8.4.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: Valore intero da rappresentare in JavaScript.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>number</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API viene utilizzata per convertire dal tipo C <code>int32_t</code> al tipo JavaScript <code>number</code>.</p><p>Il tipo JavaScript <code>number</code> è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-number-type" target="_blank" rel="noreferrer">Sezione 6.1.6</a> della specifica del linguaggio ECMAScript.</p><h4 id="napi_create_uint32" tabindex="-1"><code>napi_create_uint32</code> <a class="header-anchor" href="#napi_create_uint32" aria-label="Permalink to “napi_create_uint32”">​</a></h4><p><strong>Aggiunto in: v8.4.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_uint32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: Valore intero senza segno da rappresentare in JavaScript.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>number</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API viene utilizzata per convertire dal tipo C <code>uint32_t</code> al tipo JavaScript <code>number</code>.</p><p>Il tipo JavaScript <code>number</code> è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-number-type" target="_blank" rel="noreferrer">Sezione 6.1.6</a> della specifica del linguaggio ECMAScript.</p><h4 id="napi_create_int64" tabindex="-1"><code>napi_create_int64</code> <a class="header-anchor" href="#napi_create_int64" aria-label="Permalink to “napi_create_int64”">​</a></h4><p><strong>Aggiunto in: v8.4.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int64_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: Valore intero da rappresentare in JavaScript.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>number</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API viene utilizzata per convertire dal tipo C <code>int64_t</code> al tipo JavaScript <code>number</code>.</p><p>Il tipo JavaScript <code>number</code> è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-number-type" target="_blank" rel="noreferrer">Sezione 6.1.6</a> della specifica del linguaggio ECMAScript. Si noti che l&#39;intervallo completo di <code>int64_t</code> non può essere rappresentato con precisione completa in JavaScript. I valori interi al di fuori dell&#39;intervallo di <a href="https://tc39.github.io/ecma262/#sec-number.min_safe_integer" target="_blank" rel="noreferrer"><code>Number.MIN_SAFE_INTEGER</code></a> <code>-(2**53 - 1)</code> - <a href="https://tc39.github.io/ecma262/#sec-number.max_safe_integer" target="_blank" rel="noreferrer"><code>Number.MAX_SAFE_INTEGER</code></a> <code>(2**53 - 1)</code> perderanno precisione.</p><h4 id="napi_create_double" tabindex="-1"><code>napi_create_double</code> <a class="header-anchor" href="#napi_create_double" aria-label="Permalink to “napi_create_double”">​</a></h4><p><strong>Aggiunto in: v8.4.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">double</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: Valore a doppia precisione da rappresentare in JavaScript.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>number</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API viene utilizzata per convertire dal tipo C <code>double</code> al tipo JavaScript <code>number</code>.</p><p>Il tipo JavaScript <code>number</code> è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-number-type" target="_blank" rel="noreferrer">Sezione 6.1.6</a> della specifica del linguaggio ECMAScript.</p><h4 id="napi_create_bigint_int64" tabindex="-1"><code>napi_create_bigint_int64</code> <a class="header-anchor" href="#napi_create_bigint_int64" aria-label="Permalink to “napi_create_bigint_int64”">​</a></h4><p><strong>Aggiunto in: v10.7.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_bigint_int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     int64_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: Valore intero da rappresentare in JavaScript.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>BigInt</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API converte il tipo C <code>int64_t</code> nel tipo JavaScript <code>BigInt</code>.</p><h4 id="napi_create_bigint_uint64" tabindex="-1"><code>napi_create_bigint_uint64</code> <a class="header-anchor" href="#napi_create_bigint_uint64" aria-label="Permalink to “napi_create_bigint_uint64”">​</a></h4><p><strong>Aggiunto in: v10.7.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_bigint_uint64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      uint64_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: Valore intero senza segno da rappresentare in JavaScript.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>BigInt</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API converte il tipo C <code>uint64_t</code> nel tipo JavaScript <code>BigInt</code>.</p><h4 id="napi_create_bigint_words" tabindex="-1"><code>napi_create_bigint_words</code> <a class="header-anchor" href="#napi_create_bigint_words" aria-label="Permalink to “napi_create_bigint_words”">​</a></h4><p><strong>Aggiunto in: v10.7.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_bigint_words</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> sign_bit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> word_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> uint64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> words</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] sign_bit</code>: Determina se il <code>BigInt</code> risultante sarà positivo o negativo.</li><li><code>[in] word_count</code>: La lunghezza dell&#39;array <code>words</code>.</li><li><code>[in] words</code>: Un array di parole little-endian a 64 bit <code>uint64_t</code>.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un <code>BigInt</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API converte un array di parole a 64 bit senza segno in un singolo valore <code>BigInt</code>.</p><p>Il <code>BigInt</code> risultante viene calcolato come: (–1) (<code>words[0]</code> × (2) + <code>words[1]</code> × (2) + …)</p><h4 id="napi_create_string_latin1" tabindex="-1"><code>napi_create_string_latin1</code> <a class="header-anchor" href="#napi_create_string_latin1" aria-label="Permalink to “napi_create_string_latin1”">​</a></h4><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_string_latin1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] str</code>: Buffer di caratteri che rappresenta una stringa codificata ISO-8859-1.</li><li><code>[in] length</code>: La lunghezza della stringa in byte, o <code>NAPI_AUTO_LENGTH</code> se è terminata con null.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta una <code>string</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un valore <code>string</code> JavaScript da una stringa C con codifica ISO-8859-1. La stringa nativa viene copiata.</p><p>Il tipo <code>string</code> JavaScript è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">Sezione 6.1.4</a> della Specifica del Linguaggio ECMAScript.</p><h4 id="node_api_create_external_string_latin1" tabindex="-1"><code>node_api_create_external_string_latin1</code> <a class="header-anchor" href="#node_api_create_external_string_latin1" aria-label="Permalink to “node_api_create_external_string_latin1”">​</a></h4><p><strong>Aggiunta in: v20.4.0, v18.18.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[Stabile: 1 - Sperimentale]</p><p><a href="/it/nodejs/api/documentation#stability-index">Stabile: 1</a> <a href="/it/nodejs/api/documentation#stability-index">Stabilità: 1</a> - Sperimentale</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_external_string_latin1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                       napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                       napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> copied</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><p><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</p></li><li><p><code>[in] str</code>: Buffer di caratteri che rappresenta una stringa codificata ISO-8859-1.</p></li><li><p><code>[in] length</code>: La lunghezza della stringa in byte, o <code>NAPI_AUTO_LENGTH</code> se è terminata con null.</p></li><li><p><code>[in] finalize_callback</code>: La funzione da chiamare quando la stringa viene raccolta. La funzione verrà chiamata con i seguenti parametri:</p><ul><li><code>[in] env</code>: L&#39;ambiente in cui è in esecuzione l&#39;addon. Questo valore può essere null se la stringa viene raccolta come parte della terminazione del worker o dell&#39;istanza principale di Node.js.</li><li><code>[in] data</code>: Questo è il valore <code>str</code> come puntatore <code>void*</code>.</li><li><code>[in] finalize_hint</code>: Questo è il valore <code>finalize_hint</code> che è stato fornito all&#39;API. <a href="/it/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> fornisce maggiori dettagli. Questo parametro è opzionale. Passare un valore null significa che l&#39;addon non deve essere notificato quando la stringa JavaScript corrispondente viene raccolta.</li></ul></li><li><p><code>[in] finalize_hint</code>: Suggerimento opzionale da passare alla callback di finalizzazione durante la raccolta.</p></li><li><p><code>[out] result</code>: Un <code>napi_value</code> che rappresenta una <code>string</code> JavaScript.</p></li><li><p><code>[out] copied</code>: Indica se la stringa è stata copiata. Se lo è stata, il finalizzatore sarà già stato invocato per distruggere <code>str</code>.</p></li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un valore <code>string</code> JavaScript da una stringa C con codifica ISO-8859-1. La stringa nativa potrebbe non essere copiata e deve quindi esistere per l&#39;intero ciclo di vita del valore JavaScript.</p><p>Il tipo <code>string</code> JavaScript è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">Sezione 6.1.4</a> della Specifica del Linguaggio ECMAScript.</p><h4 id="napi_create_string_utf16" tabindex="-1"><code>napi_create_string_utf16</code> <a class="header-anchor" href="#napi_create_string_utf16" aria-label="Permalink to “napi_create_string_utf16”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_string_utf16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> char16_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] str</code>: Buffer di caratteri che rappresenta una stringa codificata in UTF16-LE.</li><li><code>[in] length</code>: La lunghezza della stringa in unità di codice a due byte, o <code>NAPI_AUTO_LENGTH</code> se è terminata da null.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta una <code>string</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un valore <code>string</code> JavaScript da una stringa C codificata in UTF16-LE. La stringa nativa viene copiata.</p><p>Il tipo <code>string</code> di JavaScript è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">Sezione 6.1.4</a> della specifica del linguaggio ECMAScript.</p><h4 id="node_api_create_external_string_utf16" tabindex="-1"><code>node_api_create_external_string_utf16</code> <a class="header-anchor" href="#node_api_create_external_string_utf16" aria-label="Permalink to “node_api_create_external_string_utf16”">​</a></h4><p><strong>Aggiunto in: v20.4.0, v18.18.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[Stabile: 1 - Sperimentale]</p><p><a href="/it/nodejs/api/documentation#stability-index">Stabile: 1</a> <a href="/it/nodejs/api/documentation#stability-index">Stabilità: 1</a> - Sperimentale</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_external_string_utf16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                      char16_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> copied</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><p><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</p></li><li><p><code>[in] str</code>: Buffer di caratteri che rappresenta una stringa codificata in UTF16-LE.</p></li><li><p><code>[in] length</code>: La lunghezza della stringa in unità di codice a due byte, o <code>NAPI_AUTO_LENGTH</code> se è terminata da null.</p></li><li><p><code>[in] finalize_callback</code>: La funzione da chiamare quando la stringa viene raccolta. La funzione verrà chiamata con i seguenti parametri:</p><ul><li><code>[in] env</code>: L&#39;ambiente in cui è in esecuzione l&#39;addon. Questo valore può essere null se la stringa viene raccolta come parte della terminazione del worker o dell&#39;istanza principale di Node.js.</li><li><code>[in] data</code>: Questo è il valore <code>str</code> come puntatore <code>void*</code>.</li><li><code>[in] finalize_hint</code>: Questo è il valore <code>finalize_hint</code> che è stato fornito all&#39;API. <a href="/it/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> fornisce maggiori dettagli. Questo parametro è opzionale. Passare un valore null significa che l&#39;addon non ha bisogno di essere avvisato quando la stringa JavaScript corrispondente viene raccolta.</li></ul></li><li><p><code>[in] finalize_hint</code>: Suggerimento opzionale da passare alla callback di finalizzazione durante la raccolta.</p></li><li><p><code>[out] result</code>: Un <code>napi_value</code> che rappresenta una <code>string</code> JavaScript.</p></li><li><p><code>[out] copied</code>: Indica se la stringa è stata copiata. In tal caso, il finalizzatore sarà già stato invocato per distruggere <code>str</code>.</p></li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un valore <code>string</code> JavaScript da una stringa C codificata in UTF16-LE. La stringa nativa potrebbe non essere copiata e deve quindi esistere per l&#39;intero ciclo di vita del valore JavaScript.</p><p>Il tipo <code>string</code> di JavaScript è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">Sezione 6.1.4</a> della specifica del linguaggio ECMAScript.</p><h4 id="napi_create_string_utf8" tabindex="-1"><code>napi_create_string_utf8</code> <a class="header-anchor" href="#napi_create_string_utf8" aria-label="Permalink to “napi_create_string_utf8”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_string_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] str</code>: Buffer di caratteri che rappresenta una stringa con codifica UTF8.</li><li><code>[in] length</code>: La lunghezza della stringa in byte, o <code>NAPI_AUTO_LENGTH</code> se è terminata con null.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta una <code>string</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un valore <code>string</code> JavaScript da una stringa C con codifica UTF8. La stringa nativa viene copiata.</p><p>Il tipo <code>string</code> JavaScript è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">Sezione 6.1.4</a> della Specifica del Linguaggio ECMAScript.</p><h3 id="functions-to-create-optimized-property-keys" tabindex="-1">Funzioni per creare chiavi di proprietà ottimizzate <a class="header-anchor" href="#functions-to-create-optimized-property-keys" aria-label="Permalink to “Funzioni per creare chiavi di proprietà ottimizzate”">​</a></h3><p>Molti motori JavaScript, incluso V8, utilizzano stringhe internalizzate come chiavi per impostare e ottenere valori di proprietà. In genere utilizzano una tabella hash per creare e cercare tali stringhe. Anche se aggiunge un certo costo per la creazione di ogni chiave, migliora le prestazioni in seguito consentendo il confronto dei puntatori di stringa anziché l&#39;intera stringa.</p><p>Se una nuova stringa JavaScript deve essere utilizzata come chiave di proprietà, allora per alcuni motori JavaScript sarà più efficiente utilizzare le funzioni in questa sezione. Altrimenti, utilizzare le funzioni della serie <code>napi_create_string_utf8</code> o <code>node_api_create_external_string_utf8</code> poiché potrebbero esserci ulteriori overhead nella creazione/memorizzazione di stringhe con i metodi di creazione di chiavi di proprietà.</p><h4 id="node_api_create_property_key_latin1" tabindex="-1"><code>node_api_create_property_key_latin1</code> <a class="header-anchor" href="#node_api_create_property_key_latin1" aria-label="Permalink to “node_api_create_property_key_latin1”">​</a></h4><p><strong>Aggiunto in: v22.9.0, v20.18.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[Stabile: 1 - Sperimentale]</p><p><a href="/it/nodejs/api/documentation#stability-index">Stabile: 1</a> <a href="/it/nodejs/api/documentation#stability-index">Stabilità: 1</a> - Sperimentale</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status NAPI_CDECL </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_property_key_latin1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                           const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                           size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                           napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] str</code>: Buffer di caratteri che rappresenta una stringa con codifica ISO-8859-1.</li><li><code>[in] length</code>: La lunghezza della stringa in byte, o <code>NAPI_AUTO_LENGTH</code> se è terminata con null.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta una <code>string</code> JavaScript ottimizzata da utilizzare come chiave di proprietà per gli oggetti.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un valore <code>string</code> JavaScript ottimizzato da una stringa C con codifica ISO-8859-1 da utilizzare come chiave di proprietà per gli oggetti. La stringa nativa viene copiata. A differenza di <code>napi_create_string_latin1</code>, le chiamate successive a questa funzione con lo stesso puntatore <code>str</code> potrebbero beneficiare di un&#39;accelerazione nella creazione del <code>napi_value</code> richiesto, a seconda del motore.</p><p>Il tipo <code>string</code> JavaScript è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">Sezione 6.1.4</a> della Specifica del Linguaggio ECMAScript.</p><h4 id="node_api_create_property_key_utf16" tabindex="-1"><code>node_api_create_property_key_utf16</code> <a class="header-anchor" href="#node_api_create_property_key_utf16" aria-label="Permalink to “node_api_create_property_key_utf16”">​</a></h4><p><strong>Aggiunto in: v21.7.0, v20.12.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[Stable: 1 - Experimental]</p><p><a href="/it/nodejs/api/documentation#stability-index">Stable: 1</a> <a href="/it/nodejs/api/documentation#stability-index">Stabilità: 1</a> - Sperimentale</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status NAPI_CDECL </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_property_key_utf16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                          const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> char16_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                          size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                          napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente sotto il quale viene invocata l&#39;API.</li><li><code>[in] str</code>: Buffer di caratteri che rappresenta una stringa con codifica UTF16-LE.</li><li><code>[in] length</code>: La lunghezza della stringa in unità di codice a due byte, o <code>NAPI_AUTO_LENGTH</code> se è terminata con null.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta una <code>stringa</code> JavaScript ottimizzata da utilizzare come chiave di proprietà per gli oggetti.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un valore <code>stringa</code> JavaScript ottimizzato da una stringa C con codifica UTF16-LE da utilizzare come chiave di proprietà per gli oggetti. La stringa nativa viene copiata.</p><p>Il tipo <code>stringa</code> JavaScript è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">Sezione 6.1.4</a> della Specifica del Linguaggio ECMAScript.</p><h4 id="node_api_create_property_key_utf8" tabindex="-1"><code>node_api_create_property_key_utf8</code> <a class="header-anchor" href="#node_api_create_property_key_utf8" aria-label="Permalink to “node_api_create_property_key_utf8”">​</a></h4><p><strong>Aggiunto in: v22.9.0, v20.18.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[Stable: 1 - Experimental]</p><p><a href="/it/nodejs/api/documentation#stability-index">Stable: 1</a> <a href="/it/nodejs/api/documentation#stability-index">Stabilità: 1</a> - Sperimentale</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status NAPI_CDECL </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_create_property_key_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                         const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                         size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                         napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente sotto il quale viene invocata l&#39;API.</li><li><code>[in] str</code>: Buffer di caratteri che rappresenta una stringa con codifica UTF8.</li><li><code>[in] length</code>: La lunghezza della stringa in unità di codice a due byte, o <code>NAPI_AUTO_LENGTH</code> se è terminata con null.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta una <code>stringa</code> JavaScript ottimizzata da utilizzare come chiave di proprietà per gli oggetti.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un valore <code>stringa</code> JavaScript ottimizzato da una stringa C con codifica UTF8 da utilizzare come chiave di proprietà per gli oggetti. La stringa nativa viene copiata.</p><p>Il tipo <code>stringa</code> JavaScript è descritto nella <a href="https://tc39.github.io/ecma262/#sec-ecmascript-language-types-string-type" target="_blank" rel="noreferrer">Sezione 6.1.4</a> della Specifica del Linguaggio ECMAScript.</p><h3 id="functions-to-convert-from-node-api-to-c-types" tabindex="-1">Funzioni per la conversione da Node-API a tipi C <a class="header-anchor" href="#functions-to-convert-from-node-api-to-c-types" aria-label="Permalink to “Funzioni per la conversione da Node-API a tipi C”">​</a></h3><h4 id="napi_get_array_length" tabindex="-1"><code>napi_get_array_length</code> <a class="header-anchor" href="#napi_get_array_length" aria-label="Permalink to “napi_get_array_length”">​</a></h4><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_array_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                  uint32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta l&#39;<code>Array</code> JavaScript di cui si sta interrogando la lunghezza.</li><li><code>[out] result</code>: <code>uint32</code> che rappresenta la lunghezza dell&#39;array.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce la lunghezza di un array.</p><p>La lunghezza dell&#39;<code>Array</code> è descritta nella <a href="https://tc39.github.io/ecma262/#sec-properties-of-array-instances-length" target="_blank" rel="noreferrer">Sezione 22.1.4.1</a> della specifica del linguaggio ECMAScript.</p><h4 id="napi_get_arraybuffer_info" tabindex="-1"><code>napi_get_arraybuffer_info</code> <a class="header-anchor" href="#napi_get_arraybuffer_info" aria-label="Permalink to “napi_get_arraybuffer_info”">​</a></h4><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_arraybuffer_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                      napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] arraybuffer</code>: <code>napi_value</code> che rappresenta l&#39;<code>ArrayBuffer</code> di cui si sta interrogando.</li><li><code>[out] data</code>: Il buffer di dati sottostante dell&#39;<code>ArrayBuffer</code>. Se byte_length è <code>0</code>, questo può essere <code>NULL</code> o qualsiasi altro valore puntatore.</li><li><code>[out] byte_length</code>: Lunghezza in byte del buffer di dati sottostante.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API viene utilizzata per recuperare il buffer di dati sottostante di un <code>ArrayBuffer</code> e la sua lunghezza.</p><p><em>ATTENZIONE</em>: Prestare attenzione quando si utilizza questa API. La durata del buffer di dati sottostante è gestita dall&#39;<code>ArrayBuffer</code> anche dopo che è stato restituito. Un modo sicuro per utilizzare questa API è in combinazione con <a href="/it/nodejs/api/n-api#napi-create-reference"><code>napi_create_reference</code></a>, che può essere utilizzato per garantire il controllo sulla durata dell&#39;<code>ArrayBuffer</code>. È inoltre sicuro utilizzare il buffer di dati restituito all&#39;interno della stessa callback purché non vi siano chiamate ad altre API che potrebbero attivare una GC.</p><h4 id="napi_get_buffer_info" tabindex="-1"><code>napi_get_buffer_info</code> <a class="header-anchor" href="#napi_get_buffer_info" aria-label="Permalink to “napi_get_buffer_info”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_buffer_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta il <code>node::Buffer</code> o <code>Uint8Array</code> su cui si sta effettuando la query.</li><li><code>[out] data</code>: Il buffer di dati sottostante del <code>node::Buffer</code> o <code>Uint8Array</code>. Se la lunghezza è <code>0</code>, questo può essere <code>NULL</code> o qualsiasi altro valore di puntatore.</li><li><code>[out] length</code>: Lunghezza in byte del buffer di dati sottostante.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questo metodo restituisce gli stessi <code>data</code> e <code>byte_length</code> di <a href="/it/nodejs/api/n-api#napi-get-typedarray-info"><code>napi_get_typedarray_info</code></a>. Inoltre, <code>napi_get_typedarray_info</code> accetta anche un <code>node::Buffer</code> (un Uint8Array) come valore.</p><p>Questa API viene utilizzata per recuperare il buffer di dati sottostante di un <code>node::Buffer</code> e la sua lunghezza.</p><p><em>Avviso</em>: Prestare attenzione quando si utilizza questa API poiché la durata del buffer di dati sottostante non è garantita se è gestita dalla VM.</p><h4 id="napi_get_prototype" tabindex="-1"><code>napi_get_prototype</code> <a class="header-anchor" href="#napi_get_prototype" aria-label="Permalink to “napi_get_prototype”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_prototype</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] object</code>: <code>napi_value</code> che rappresenta l&#39;<code>Object</code> JavaScript di cui restituire il prototipo. Questo restituisce l&#39;equivalente di <code>Object.getPrototypeOf</code> (che non è lo stesso della proprietà <code>prototype</code> della funzione).</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta il prototipo dell&#39;oggetto specificato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><h4 id="napi_get_typedarray_info" tabindex="-1"><code>napi_get_typedarray_info</code> <a class="header-anchor" href="#napi_get_typedarray_info" aria-label="Permalink to “napi_get_typedarray_info”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_typedarray_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">typedarray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_typedarray_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                     napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_offset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] typedarray</code>: <code>napi_value</code> che rappresenta il <code>TypedArray</code> di cui interrogare le proprietà.</li><li><code>[out] type</code>: Tipo di dati scalare degli elementi all&#39;interno di <code>TypedArray</code>.</li><li><code>[out] length</code>: Il numero di elementi in <code>TypedArray</code>.</li><li><code>[out] data</code>: Il buffer di dati sottostante <code>TypedArray</code> regolato dal valore <code>byte_offset</code> in modo che punti al primo elemento in <code>TypedArray</code>. Se la lunghezza dell&#39;array è <code>0</code>, questo può essere <code>NULL</code> o qualsiasi altro valore di puntatore.</li><li><code>[out] arraybuffer</code>: L&#39;<code>ArrayBuffer</code> sottostante <code>TypedArray</code>.</li><li><code>[out] byte_offset</code>: L&#39;offset di byte all&#39;interno dell&#39;array nativo sottostante in cui si trova il primo elemento degli array. Il valore per il parametro data è già stato regolato in modo che data punti al primo elemento nell&#39;array. Pertanto, il primo byte dell&#39;array nativo sarebbe in <code>data - byte_offset</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce varie proprietà di un array tipizzato.</p><p>Qualsiasi dei parametri out può essere <code>NULL</code> se quella proprietà non è necessaria.</p><p><em>Avviso</em>: Prestare attenzione quando si utilizza questa API poiché il buffer di dati sottostante è gestito dalla VM.</p><h4 id="napi_get_dataview_info" tabindex="-1"><code>napi_get_dataview_info</code> <a class="header-anchor" href="#napi_get_dataview_info" aria-label="Permalink to “napi_get_dataview_info”">​</a></h4><p><strong>Aggiunto in: v8.3.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_dataview_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dataview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> byte_offset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] dataview</code>: <code>napi_value</code> che rappresenta la <code>DataView</code> di cui interrogare le proprietà.</li><li><code>[out] byte_length</code>: Numero di byte nella <code>DataView</code>.</li><li><code>[out] data</code>: Il buffer di dati sottostante la <code>DataView</code>. Se byte_length è <code>0</code>, questo può essere <code>NULL</code> o qualsiasi altro valore di puntatore.</li><li><code>[out] arraybuffer</code>: <code>ArrayBuffer</code> sottostante la <code>DataView</code>.</li><li><code>[out] byte_offset</code>: L&#39;offset di byte all&#39;interno del buffer di dati da cui iniziare a proiettare la <code>DataView</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Qualsiasi parametro out può essere <code>NULL</code> se tale proprietà non è necessaria.</p><p>Questa API restituisce varie proprietà di una <code>DataView</code>.</p><h4 id="napi_get_date_value" tabindex="-1"><code>napi_get_date_value</code> <a class="header-anchor" href="#napi_get_date_value" aria-label="Permalink to “napi_get_date_value”">​</a></h4><p><strong>Aggiunto in: v11.11.0, v10.17.0</strong></p><p><strong>Versione N-API: 5</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_date_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                double*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta una <code>Date</code> JavaScript.</li><li><code>[out] result</code>: Valore temporale come <code>double</code> rappresentato come millisecondi dalla mezzanotte all&#39;inizio del 1° gennaio 1970 UTC.</li></ul><p>Questa API non osserva i secondi intercalari; vengono ignorati, poiché ECMAScript si allinea alla specifica temporale POSIX.</p><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un <code>napi_value</code> non di tipo data, restituisce <code>napi_date_expected</code>.</p><p>Questa API restituisce il tipo primitivo C double del valore temporale per la <code>Date</code> JavaScript fornita.</p><h4 id="napi_get_value_bool" tabindex="-1"><code>napi_get_value_bool</code> <a class="header-anchor" href="#napi_get_value_bool" aria-label="Permalink to “napi_get_value_bool”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta un <code>Boolean</code> JavaScript.</li><li><code>[out] result</code>: Primitiva booleana C equivalente al <code>Boolean</code> JavaScript fornito.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un <code>napi_value</code> non booleano, restituisce <code>napi_boolean_expected</code>.</p><p>Questa API restituisce la primitiva booleana C equivalente al <code>Boolean</code> JavaScript fornito.</p><h4 id="napi_get_value_double" tabindex="-1"><code>napi_get_value_double</code> <a class="header-anchor" href="#napi_get_value_double" aria-label="Permalink to “napi_get_value_double”">​</a></h4><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                  double*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta un <code>number</code> JavaScript.</li><li><code>[out] result</code>: Primitiva C double equivalente al <code>number</code> JavaScript fornito.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un <code>napi_value</code> non numerico, restituisce <code>napi_number_expected</code>.</p><p>Questa API restituisce la primitiva C double equivalente al <code>number</code> JavaScript fornito.</p><h4 id="napi_get_value_bigint_int64" tabindex="-1"><code>napi_get_value_bigint_int64</code> <a class="header-anchor" href="#napi_get_value_bigint_int64" aria-label="Permalink to “napi_get_value_bigint_int64”">​</a></h4><p><strong>Aggiunta in: v10.7.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_bigint_int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        int64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> lossless</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta un <code>BigInt</code> JavaScript.</li><li><code>[out] result</code>: Primitiva C <code>int64_t</code> equivalente al <code>BigInt</code> JavaScript fornito.</li><li><code>[out] lossless</code>: Indica se il valore <code>BigInt</code> è stato convertito senza perdita di dati.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un valore diverso da <code>BigInt</code>, restituisce <code>napi_bigint_expected</code>.</p><p>Questa API restituisce la primitiva C <code>int64_t</code> equivalente al <code>BigInt</code> JavaScript fornito. Se necessario, troncherà il valore, impostando <code>lossless</code> su <code>false</code>.</p><h4 id="napi_get_value_bigint_uint64" tabindex="-1"><code>napi_get_value_bigint_uint64</code> <a class="header-anchor" href="#napi_get_value_bigint_uint64" aria-label="Permalink to “napi_get_value_bigint_uint64”">​</a></h4><p><strong>Aggiunta in: v10.7.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_bigint_uint64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        uint64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> lossless</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta un <code>BigInt</code> JavaScript.</li><li><code>[out] result</code>: Primitiva C <code>uint64_t</code> equivalente al <code>BigInt</code> JavaScript fornito.</li><li><code>[out] lossless</code>: Indica se il valore <code>BigInt</code> è stato convertito senza perdita di dati.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un valore diverso da <code>BigInt</code>, restituisce <code>napi_bigint_expected</code>.</p><p>Questa API restituisce la primitiva C <code>uint64_t</code> equivalente al <code>BigInt</code> JavaScript fornito. Se necessario, troncherà il valore, impostando <code>lossless</code> su <code>false</code>.</p><h4 id="napi_get_value_bigint_words" tabindex="-1"><code>napi_get_value_bigint_words</code> <a class="header-anchor" href="#napi_get_value_bigint_words" aria-label="Permalink to “napi_get_value_bigint_words”">​</a></h4><p><strong>Aggiunto in: v10.7.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_bigint_words</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        int*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> sign_bit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> word_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        uint64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> words</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta JavaScript <code>BigInt</code>.</li><li><code>[out] sign_bit</code>: Intero che rappresenta se il <code>BigInt</code> JavaScript è positivo o negativo.</li><li><code>[in/out] word_count</code>: Deve essere inizializzato alla lunghezza dell&#39;array <code>words</code>. Al ritorno, verrà impostato sul numero effettivo di parole necessarie per archiviare questo <code>BigInt</code>.</li><li><code>[out] words</code>: Puntatore a un array di parole a 64 bit pre-allocato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API converte un singolo valore <code>BigInt</code> in un bit di segno, un array little-endian a 64 bit e il numero di elementi nell&#39;array. <code>sign_bit</code> e <code>words</code> possono essere entrambi impostati su <code>NULL</code>, al fine di ottenere solo <code>word_count</code>.</p><h4 id="napi_get_value_external" tabindex="-1"><code>napi_get_value_external</code> <a class="header-anchor" href="#napi_get_value_external" aria-label="Permalink to “napi_get_value_external”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_external</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta un valore esterno JavaScript.</li><li><code>[out] result</code>: Puntatore ai dati incapsulati dal valore esterno JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un <code>napi_value</code> non esterno, restituisce <code>napi_invalid_arg</code>.</p><p>Questa API recupera il puntatore ai dati esterni che è stato precedentemente passato a <code>napi_create_external()</code>.</p><h4 id="napi_get_value_int32" tabindex="-1"><code>napi_get_value_int32</code> <a class="header-anchor" href="#napi_get_value_int32" aria-label="Permalink to “napi_get_value_int32”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 int32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta un <code>number</code> JavaScript.</li><li><code>[out] result</code>: Primitiva C <code>int32</code> equivalente al dato <code>number</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un <code>napi_value</code> non numerico, restituisce <code>napi_number_expected</code>.</p><p>Questa API restituisce la primitiva C <code>int32</code> equivalente al dato <code>number</code> JavaScript.</p><p>Se il numero supera l&#39;intervallo dell&#39;intero a 32 bit, il risultato viene troncato all&#39;equivalente dei 32 bit inferiori. Ciò può comportare che un grande numero positivo diventi un numero negativo se il valore è &gt; 2^31 - 1.</p><p>Valori numerici non finiti (<code>NaN</code>, <code>+Infinity</code> o <code>-Infinity</code>) impostano il risultato su zero.</p><h4 id="napi_get_value_int64" tabindex="-1"><code>napi_get_value_int64</code> <a class="header-anchor" href="#napi_get_value_int64" aria-label="Permalink to “napi_get_value_int64”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 int64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente sotto il quale viene invocata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta un <code>number</code> JavaScript.</li><li><code>[out] result</code>: Primitiva C <code>int64</code> equivalente al <code>number</code> JavaScript fornito.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un <code>napi_value</code> non-number, restituisce <code>napi_number_expected</code>.</p><p>Questa API restituisce la primitiva C <code>int64</code> equivalente al <code>number</code> JavaScript fornito.</p><p>I valori <code>number</code> al di fuori dell&#39;intervallo di <a href="https://tc39.github.io/ecma262/#sec-number.min_safe_integer" target="_blank" rel="noreferrer"><code>Number.MIN_SAFE_INTEGER</code></a> <code>-(2**53 - 1)</code> - <a href="https://tc39.github.io/ecma262/#sec-number.max_safe_integer" target="_blank" rel="noreferrer"><code>Number.MAX_SAFE_INTEGER</code></a> <code>(2**53 - 1)</code> perderanno precisione.</p><p>I valori numerici non finiti (<code>NaN</code>, <code>+Infinity</code> o <code>-Infinity</code>) impostano il risultato a zero.</p><h4 id="napi_get_value_string_latin1" tabindex="-1"><code>napi_get_value_string_latin1</code> <a class="header-anchor" href="#napi_get_value_string_latin1" aria-label="Permalink to “napi_get_value_string_latin1”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_string_latin1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                         napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> bufsize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente sotto il quale viene invocata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta una stringa JavaScript.</li><li><code>[in] buf</code>: Buffer in cui scrivere la stringa codificata in ISO-8859-1. Se viene passato <code>NULL</code>, la lunghezza della stringa in byte, escluso il terminatore nullo, viene restituita in <code>result</code>.</li><li><code>[in] bufsize</code>: Dimensione del buffer di destinazione. Quando questo valore è insufficiente, la stringa restituita viene troncata e terminata con null.</li><li><code>[out] result</code>: Numero di byte copiati nel buffer, escluso il terminatore nullo.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un <code>napi_value</code> non-<code>string</code>, restituisce <code>napi_string_expected</code>.</p><p>Questa API restituisce la stringa codificata in ISO-8859-1 corrispondente al valore passato.</p><h4 id="napi_get_value_string_utf8" tabindex="-1"><code>napi_get_value_string_utf8</code> <a class="header-anchor" href="#napi_get_value_string_utf8" aria-label="Permalink to “napi_get_value_string_utf8”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_string_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                       napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> bufsize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta la stringa JavaScript.</li><li><code>[in] buf</code>: Buffer in cui scrivere la stringa con codifica UTF8. Se viene passato <code>NULL</code>, la lunghezza della stringa in byte, escluso il terminatore nullo, viene restituita in <code>result</code>.</li><li><code>[in] bufsize</code>: Dimensione del buffer di destinazione. Quando questo valore è insufficiente, la stringa restituita viene troncata e terminata con null.</li><li><code>[out] result</code>: Numero di byte copiati nel buffer, escluso il terminatore nullo.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un <code>napi_value</code> non <code>string</code>, restituisce <code>napi_string_expected</code>.</p><p>Questa API restituisce la stringa con codifica UTF8 corrispondente al valore passato.</p><h4 id="napi_get_value_string_utf16" tabindex="-1"><code>napi_get_value_string_utf16</code> <a class="header-anchor" href="#napi_get_value_string_utf16" aria-label="Permalink to “napi_get_value_string_utf16”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_string_utf16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                        char16_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> bufsize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                        size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta la stringa JavaScript.</li><li><code>[in] buf</code>: Buffer in cui scrivere la stringa con codifica UTF16-LE. Se viene passato <code>NULL</code>, viene restituita la lunghezza della stringa in unità di codice a 2 byte, escluso il terminatore nullo.</li><li><code>[in] bufsize</code>: Dimensione del buffer di destinazione. Quando questo valore è insufficiente, la stringa restituita viene troncata e terminata con null.</li><li><code>[out] result</code>: Numero di unità di codice a 2 byte copiate nel buffer, escluso il terminatore nullo.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un <code>napi_value</code> non <code>string</code>, restituisce <code>napi_string_expected</code>.</p><p>Questa API restituisce la stringa con codifica UTF16 corrispondente al valore passato.</p><h4 id="napi_get_value_uint32" tabindex="-1"><code>napi_get_value_uint32</code> <a class="header-anchor" href="#napi_get_value_uint32" aria-label="Permalink to “napi_get_value_uint32”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_value_uint32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                  uint32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: <code>napi_value</code> che rappresenta un <code>number</code> JavaScript.</li><li><code>[out] result</code>: Primitiva C equivalente del <code>napi_value</code> fornito come <code>uint32_t</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un <code>napi_value</code> non numerico, restituisce <code>napi_number_expected</code>.</p><p>Questa API restituisce la primitiva C equivalente del <code>napi_value</code> fornito come <code>uint32_t</code>.</p><h3 id="functions-to-get-global-instances" tabindex="-1">Funzioni per ottenere istanze globali <a class="header-anchor" href="#functions-to-get-global-instances" aria-label="Permalink to “Funzioni per ottenere istanze globali”">​</a></h3><h4 id="napi_get_boolean" tabindex="-1"><code>napi_get_boolean</code> <a class="header-anchor" href="#napi_get_boolean" aria-label="Permalink to “napi_get_boolean”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: Il valore del booleano da recuperare.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta il singleton <code>Boolean</code> JavaScript da recuperare.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API viene utilizzata per restituire l&#39;oggetto singleton JavaScript utilizzato per rappresentare il valore booleano fornito.</p><h4 id="napi_get_global" tabindex="-1"><code>napi_get_global</code> <a class="header-anchor" href="#napi_get_global" aria-label="Permalink to “napi_get_global”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;oggetto <code>global</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce l&#39;oggetto <code>global</code>.</p><h4 id="napi_get_null" tabindex="-1"><code>napi_get_null</code> <a class="header-anchor" href="#napi_get_null" aria-label="Permalink to “napi_get_null”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;oggetto <code>null</code> JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce l&#39;oggetto <code>null</code>.</p><h4 id="napi_get_undefined" tabindex="-1"><code>napi_get_undefined</code> <a class="header-anchor" href="#napi_get_undefined" aria-label="Permalink to “napi_get_undefined”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta il valore Undefined di JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce l&#39;oggetto Undefined.</p><h2 id="working-with-javascript-values-and-abstract-operations" tabindex="-1">Lavorare con valori JavaScript e operazioni astratte <a class="header-anchor" href="#working-with-javascript-values-and-abstract-operations" aria-label="Permalink to “Lavorare con valori JavaScript e operazioni astratte”">​</a></h2><p>Node-API espone una serie di API per eseguire alcune operazioni astratte sui valori JavaScript. Alcune di queste operazioni sono documentate nella <a href="https://tc39.github.io/ecma262/#sec-abstract-operations" target="_blank" rel="noreferrer">Sezione 7</a> della <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">Specificazione del linguaggio ECMAScript</a>.</p><p>Queste API supportano l&#39;esecuzione di una delle seguenti azioni:</p><h3 id="napi_coerce_to_bool" tabindex="-1"><code>napi_coerce_to_bool</code> <a class="header-anchor" href="#napi_coerce_to_bool" aria-label="Permalink to “napi_coerce_to_bool”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_coerce_to_bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript da forzare.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta il <code>Boolean</code> JavaScript forzato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API implementa l&#39;operazione astratta <code>ToBoolean()</code> come definita nella <a href="https://tc39.github.io/ecma262/#sec-toboolean" target="_blank" rel="noreferrer">Sezione 7.1.2</a> della Specificazione del linguaggio ECMAScript.</p><h3 id="napi_coerce_to_number" tabindex="-1"><code>napi_coerce_to_number</code> <a class="header-anchor" href="#napi_coerce_to_number" aria-label="Permalink to “napi_coerce_to_number”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_coerce_to_number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript da forzare.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta il <code>number</code> JavaScript forzato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API implementa l&#39;operazione astratta <code>ToNumber()</code> come definita nella <a href="https://tc39.github.io/ecma262/#sec-tonumber" target="_blank" rel="noreferrer">Sezione 7.1.3</a> della Specificazione del linguaggio ECMAScript. Questa funzione potenzialmente esegue codice JS se il valore passato è un oggetto.</p><h3 id="napi_coerce_to_object" tabindex="-1"><code>napi_coerce_to_object</code> <a class="header-anchor" href="#napi_coerce_to_object" aria-label="Permalink to “napi_coerce_to_object”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_coerce_to_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript da forzare.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;<code>Object</code> JavaScript forzato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API implementa l&#39;operazione astratta <code>ToObject()</code> come definita nella <a href="https://tc39.github.io/ecma262/#sec-toobject" target="_blank" rel="noreferrer">Sezione 7.1.13</a> della Specificazione del linguaggio ECMAScript.</p><h3 id="napi_coerce_to_string" tabindex="-1"><code>napi_coerce_to_string</code> <a class="header-anchor" href="#napi_coerce_to_string" aria-label="Permalink to “napi_coerce_to_string”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_coerce_to_string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript da forzare.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta la <code>stringa</code> JavaScript forzata.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API implementa l&#39;operazione astratta <code>ToString()</code> come definito nella <a href="https://tc39.github.io/ecma262/#sec-toobject" target="_blank" rel="noreferrer">Sezione 7.1.13</a> della Specifica del Linguaggio ECMAScript. Questa funzione potenzialmente esegue codice JS se il valore passato è un oggetto.</p><h3 id="napi_typeof" tabindex="-1"><code>napi_typeof</code> <a class="header-anchor" href="#napi_typeof" aria-label="Permalink to “napi_typeof”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_valuetype</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript di cui interrogare il tipo.</li><li><code>[out] result</code>: Il tipo del valore JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><ul><li><code>napi_invalid_arg</code> se il tipo di <code>value</code> non è un tipo ECMAScript noto e <code>value</code> non è un valore Esterno.</li></ul><p>Questa API rappresenta un comportamento simile all&#39;invocazione dell&#39;operatore <code>typeof</code> sull&#39;oggetto come definito nella <a href="https://tc39.github.io/ecma262/#sec-typeof-operator" target="_blank" rel="noreferrer">Sezione 12.5.5</a> della Specifica del Linguaggio ECMAScript. Tuttavia, ci sono alcune differenze:</p><p>Se <code>value</code> ha un tipo non valido, viene restituito un errore.</p><h3 id="napi_instanceof" tabindex="-1"><code>napi_instanceof</code> <a class="header-anchor" href="#napi_instanceof" aria-label="Permalink to “napi_instanceof”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_instanceof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                            bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] object</code>: Il valore JavaScript da controllare.</li><li><code>[in] constructor</code>: L&#39;oggetto funzione JavaScript della funzione costruttore da verificare.</li><li><code>[out] result</code>: Booleano impostato su true se <code>object instanceof constructor</code> è true.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API rappresenta l&#39;invocazione dell&#39;operatore <code>instanceof</code> sull&#39;oggetto come definito nella <a href="https://tc39.github.io/ecma262/#sec-instanceofoperator" target="_blank" rel="noreferrer">Sezione 12.10.4</a> della Specifica del Linguaggio ECMAScript.</p><h3 id="napi_is_array" tabindex="-1"><code>napi_is_array</code> <a class="header-anchor" href="#napi_is_array" aria-label="Permalink to “napi_is_array”">​</a></h3><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente sotto il quale viene richiamata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript da controllare.</li><li><code>[out] result</code>: Indica se l&#39;oggetto specificato è un array.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API rappresenta l&#39;invocazione dell&#39;operazione <code>IsArray</code> sull&#39;oggetto come definito nella <a href="https://tc39.github.io/ecma262/#sec-isarray" target="_blank" rel="noreferrer">Sezione 7.2.2</a> della specifica del linguaggio ECMAScript.</p><h3 id="napi_is_arraybuffer" tabindex="-1"><code>napi_is_arraybuffer</code> <a class="header-anchor" href="#napi_is_arraybuffer" aria-label="Permalink to “napi_is_arraybuffer”">​</a></h3><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente sotto il quale viene richiamata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript da controllare.</li><li><code>[out] result</code>: Indica se l&#39;oggetto specificato è un <code>ArrayBuffer</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API verifica se l&#39;<code>Object</code> passato è un array buffer.</p><h3 id="napi_is_buffer" tabindex="-1"><code>napi_is_buffer</code> <a class="header-anchor" href="#napi_is_buffer" aria-label="Permalink to “napi_is_buffer”">​</a></h3><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente sotto il quale viene richiamata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript da controllare.</li><li><code>[out] result</code>: Indica se il <code>napi_value</code> specificato rappresenta un oggetto <code>node::Buffer</code> o <code>Uint8Array</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API verifica se l&#39;<code>Object</code> passato è un buffer o Uint8Array. <a href="/it/nodejs/api/n-api#napi-is-typedarray"><code>napi_is_typedarray</code></a> dovrebbe essere preferito se il chiamante deve verificare se il valore è un Uint8Array.</p><h3 id="napi_is_date" tabindex="-1"><code>napi_is_date</code> <a class="header-anchor" href="#napi_is_date" aria-label="Permalink to “napi_is_date”">​</a></h3><p><strong>Aggiunta in: v11.11.0, v10.17.0</strong></p><p><strong>Versione N-API: 5</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente sotto il quale viene richiamata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript da controllare.</li><li><code>[out] result</code>: Indica se il <code>napi_value</code> specificato rappresenta un oggetto JavaScript <code>Date</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API verifica se l&#39;<code>Object</code> passato è una data.</p><h3 id="napi_is_error_1" tabindex="-1"><code>napi_is_error</code> <a class="header-anchor" href="#napi_is_error_1" aria-label="Permalink to “napi_is_error”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript da controllare.</li><li><code>[out] result</code>: Indica se il <code>napi_value</code> fornito rappresenta un oggetto <code>Error</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API verifica se l&#39;<code>Object</code> passato è un <code>Error</code>.</p><h3 id="napi_is_typedarray" tabindex="-1"><code>napi_is_typedarray</code> <a class="header-anchor" href="#napi_is_typedarray" aria-label="Permalink to “napi_is_typedarray”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_typedarray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript da controllare.</li><li><code>[out] result</code>: Indica se il <code>napi_value</code> fornito rappresenta un <code>TypedArray</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API verifica se l&#39;<code>Object</code> passato è un typed array.</p><h3 id="napi_is_dataview" tabindex="-1"><code>napi_is_dataview</code> <a class="header-anchor" href="#napi_is_dataview" aria-label="Permalink to “napi_is_dataview”">​</a></h3><p><strong>Aggiunto in: v8.3.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_dataview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] value</code>: Il valore JavaScript da controllare.</li><li><code>[out] result</code>: Indica se il <code>napi_value</code> fornito rappresenta un <code>DataView</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API verifica se l&#39;<code>Object</code> passato è un <code>DataView</code>.</p><h3 id="napi_strict_equals" tabindex="-1"><code>napi_strict_equals</code> <a class="header-anchor" href="#napi_strict_equals" aria-label="Permalink to “napi_strict_equals”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_strict_equals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">lhs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">rhs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                               bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] lhs</code>: Il valore JavaScript da controllare.</li><li><code>[in] rhs</code>: Il valore JavaScript da confrontare.</li><li><code>[out] result</code>: Indica se i due oggetti <code>napi_value</code> sono uguali.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API rappresenta l&#39;invocazione dell&#39;algoritmo di Strict Equality come definito nella <a href="https://tc39.github.io/ecma262/#sec-strict-equality-comparison" target="_blank" rel="noreferrer">Sezione 7.2.14</a> della specifica del linguaggio ECMAScript.</p><h3 id="napi_detach_arraybuffer" tabindex="-1"><code>napi_detach_arraybuffer</code> <a class="header-anchor" href="#napi_detach_arraybuffer" aria-label="Permalink to “napi_detach_arraybuffer”">​</a></h3><p><strong>Aggiunto in: v13.0.0, v12.16.0, v10.22.0</strong></p><p><strong>Versione N-API: 7</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_detach_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] arraybuffer</code>: L&#39;<code>ArrayBuffer</code> JavaScript da scollegare.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo. Se viene passato un <code>ArrayBuffer</code> non scollegabile, restituisce <code>napi_detachable_arraybuffer_expected</code>.</p><p>Generalmente, un <code>ArrayBuffer</code> non è scollegabile se è stato scollegato in precedenza. Il motore può imporre condizioni aggiuntive sulla possibilità di scollegare un <code>ArrayBuffer</code>. Ad esempio, V8 richiede che l&#39;<code>ArrayBuffer</code> sia esterno, ovvero creato con <a href="/it/nodejs/api/n-api#napi-create-external-arraybuffer"><code>napi_create_external_arraybuffer</code></a>.</p><p>Questa API rappresenta l&#39;invocazione dell&#39;operazione di scollegamento di <code>ArrayBuffer</code> come definita nella <a href="https://tc39.es/ecma262/#sec-detacharraybuffer" target="_blank" rel="noreferrer">Sezione 24.1.1.3</a> della Specifica del linguaggio ECMAScript.</p><h3 id="napi_is_detached_arraybuffer" tabindex="-1"><code>napi_is_detached_arraybuffer</code> <a class="header-anchor" href="#napi_is_detached_arraybuffer" aria-label="Permalink to “napi_is_detached_arraybuffer”">​</a></h3><p><strong>Aggiunto in: v13.3.0, v12.16.0, v10.22.0</strong></p><p><strong>Versione N-API: 7</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_detached_arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                         napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arraybuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                         bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] arraybuffer</code>: L&#39;<code>ArrayBuffer</code> JavaScript da controllare.</li><li><code>[out] result</code>: Indica se l&#39;<code>arraybuffer</code> è scollegato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>L&#39;<code>ArrayBuffer</code> è considerato scollegato se i suoi dati interni sono <code>null</code>.</p><p>Questa API rappresenta l&#39;invocazione dell&#39;operazione <code>IsDetachedBuffer</code> di <code>ArrayBuffer</code> come definita nella <a href="https://tc39.es/ecma262/#sec-isdetachedbuffer" target="_blank" rel="noreferrer">Sezione 24.1.1.2</a> della Specifica del linguaggio ECMAScript.</p><h2 id="working-with-javascript-properties" tabindex="-1">Lavorare con le proprietà JavaScript <a class="header-anchor" href="#working-with-javascript-properties" aria-label="Permalink to “Lavorare con le proprietà JavaScript”">​</a></h2><p>Node-API espone una serie di API per ottenere e impostare le proprietà sugli oggetti JavaScript. Alcuni di questi tipi sono documentati nella <a href="https://tc39.github.io/ecma262/#sec-abstract-operations" target="_blank" rel="noreferrer">Sezione 7</a> della <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">Specifica del linguaggio ECMAScript</a>.</p><p>Le proprietà in JavaScript sono rappresentate come una tupla di una chiave e un valore. Fondamentalmente, tutte le chiavi delle proprietà in Node-API possono essere rappresentate in una delle seguenti forme:</p><ul><li>Denominata: una semplice stringa con codifica UTF8</li><li>Indicizzata per intero: un valore di indice rappresentato da <code>uint32_t</code></li><li>Valore JavaScript: questi sono rappresentati in Node-API da <code>napi_value</code>. Questo può essere un <code>napi_value</code> che rappresenta una <code>string</code>, <code>number</code> o <code>symbol</code>.</li></ul><p>I valori Node-API sono rappresentati dal tipo <code>napi_value</code>. Qualsiasi chiamata Node-API che richiede un valore JavaScript accetta un <code>napi_value</code>. Tuttavia, è responsabilità del chiamante assicurarsi che il <code>napi_value</code> in questione sia del tipo JavaScript previsto dall&#39;API.</p><p>Le API documentate in questa sezione forniscono una semplice interfaccia per ottenere e impostare proprietà su oggetti JavaScript arbitrari rappresentati da <code>napi_value</code>.</p><p>Ad esempio, considera il seguente frammento di codice JavaScript:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj.myProp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>L&#39;equivalente può essere fatto usando valori Node-API con il seguente frammento:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_generic_failure;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const obj = {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value obj, value;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">obj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Crea un napi_value per 123</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// obj.myProp = 123</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, obj, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;myProp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, value);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Le proprietà indicizzate possono essere impostate in modo simile. Considera il seguente frammento di codice JavaScript:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> arr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">arr[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>L&#39;equivalente può essere fatto usando valori Node-API con il seguente frammento:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_generic_failure;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const arr = [];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value arr, value;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Crea un napi_value per &#39;hello&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_string_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, NAPI_AUTO_LENGTH, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// arr[123] = &#39;hello&#39;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, arr, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, value);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Le proprietà possono essere recuperate utilizzando le API descritte in questa sezione. Considera il seguente frammento di codice JavaScript:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> arr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Il seguente è l&#39;equivalente approssimativo della controparte Node-API:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_generic_failure;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const arr = []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value arr, value;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const value = arr[123]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, arr, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Infine, è anche possibile definire più proprietà su un oggetto per motivi di prestazioni. Considera il seguente JavaScript:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> obj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Object.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">defineProperties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obj, {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;foo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { value: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, writable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, configurable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, enumerable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;bar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { value: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, writable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, configurable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, enumerable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Il seguente è l&#39;equivalente approssimativo della controparte Node-API:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_status_generic_failure;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const obj = {};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value obj;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">obj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Crea napi_values per 123 e 456</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value fooValue, barValue;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fooValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">barValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Imposta le proprietà</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_property_descriptor descriptors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fooValue, napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_configurable, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, barValue, napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_configurable, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_define_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                obj,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(descriptors) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">descriptors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                descriptors);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="structures" tabindex="-1">Strutture <a class="header-anchor" href="#structures" aria-label="Permalink to “Strutture”">​</a></h3><h4 id="napi_property_attributes" tabindex="-1"><code>napi_property_attributes</code> <a class="header-anchor" href="#napi_property_attributes" aria-label="Permalink to “napi_property_attributes”">​</a></h4><div class="info custom-block"><p class="custom-block-title">[Cronologia]</p><table tabindex="0"><thead><tr><th>Versione</th><th>Modifiche</th></tr></thead><tbody><tr><td>v14.12.0</td><td>aggiunti <code>napi_default_method</code> e <code>napi_default_property</code>.</td></tr></tbody></table></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_default </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_enumerable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_configurable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Utilizzato con napi_define_class per distinguere le proprietà statiche</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // dalle proprietà dell&#39;istanza. Ignorato da napi_define_properties.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_static </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Predefinito per i metodi di classe.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_default_method </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_configurable,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Predefinito per le proprietà dell&#39;oggetto, come in JS obj[prop].</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_default_jsproperty </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_writable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                          napi_enumerable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                          napi_configurable,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_property_attributes;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><code>napi_property_attributes</code> sono flag utilizzati per controllare il comportamento delle proprietà impostate su un oggetto JavaScript. A parte <code>napi_static</code>, corrispondono agli attributi elencati nella <a href="https://tc39.github.io/ecma262/#table-2" target="_blank" rel="noreferrer">Sezione 6.1.7.1</a> della <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">Specificazione del linguaggio ECMAScript</a>. Possono essere uno o più dei seguenti bitflag:</p><ul><li><code>napi_default</code>: Nessun attributo esplicito è impostato sulla proprietà. Per impostazione predefinita, una proprietà è di sola lettura, non enumerabile e non configurabile.</li><li><code>napi_writable</code>: La proprietà è scrivibile.</li><li><code>napi_enumerable</code>: La proprietà è enumerabile.</li><li><code>napi_configurable</code>: La proprietà è configurabile come definito nella <a href="https://tc39.github.io/ecma262/#table-2" target="_blank" rel="noreferrer">Sezione 6.1.7.1</a> della <a href="https://tc39.github.io/ecma262/" target="_blank" rel="noreferrer">Specificazione del linguaggio ECMAScript</a>.</li><li><code>napi_static</code>: La proprietà sarà definita come una proprietà statica su una classe, in contrapposizione a una proprietà di istanza, che è l&#39;impostazione predefinita. Questo viene utilizzato solo da <a href="/it/nodejs/api/n-api#napi-define-class"><code>napi_define_class</code></a>. Viene ignorato da <code>napi_define_properties</code>.</li><li><code>napi_default_method</code>: Come un metodo in una classe JS, la proprietà è configurabile e scrivibile, ma non enumerabile.</li><li><code>napi_default_jsproperty</code>: Come una proprietà impostata tramite assegnazione in JavaScript, la proprietà è scrivibile, enumerabile e configurabile.</li></ul><h4 id="napi_property_descriptor" tabindex="-1"><code>napi_property_descriptor</code> <a class="header-anchor" href="#napi_property_descriptor" aria-label="Permalink to “napi_property_descriptor”">​</a></h4><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Uno tra utf8name e name deve essere NULL.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> utf8name;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value name;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_callback method;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_callback getter;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_callback setter;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value value;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_property_attributes attributes;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_property_descriptor;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li><code>utf8name</code>: Stringa opzionale che descrive la chiave per la proprietà, codificata come UTF8. Uno tra <code>utf8name</code> e <code>name</code> deve essere fornito per la proprietà.</li><li><code>name</code>: <code>napi_value</code> opzionale che punta a una stringa JavaScript o a un simbolo da utilizzare come chiave per la proprietà. Uno tra <code>utf8name</code> e <code>name</code> deve essere fornito per la proprietà.</li><li><code>value</code>: Il valore recuperato da un accesso get della proprietà se la proprietà è una data property. Se questo viene passato, imposta <code>getter</code>, <code>setter</code>, <code>method</code> e <code>data</code> su <code>NULL</code> (poiché questi membri non verranno utilizzati).</li><li><code>getter</code>: Una funzione da chiamare quando viene eseguito un accesso get della proprietà. Se questo viene passato, imposta <code>value</code> e <code>method</code> su <code>NULL</code> (poiché questi membri non verranno utilizzati). La funzione fornita viene chiamata implicitamente dal runtime quando si accede alla proprietà dal codice JavaScript (o se viene eseguito un get sulla proprietà utilizzando una chiamata Node-API). <a href="/it/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a> fornisce maggiori dettagli.</li><li><code>setter</code>: Una funzione da chiamare quando viene eseguito un accesso set della proprietà. Se questo viene passato, imposta <code>value</code> e <code>method</code> su <code>NULL</code> (poiché questi membri non verranno utilizzati). La funzione fornita viene chiamata implicitamente dal runtime quando la proprietà viene impostata dal codice JavaScript (o se viene eseguito un set sulla proprietà utilizzando una chiamata Node-API). <a href="/it/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a> fornisce maggiori dettagli.</li><li><code>method</code>: Impostalo per fare in modo che la proprietà <code>value</code> dell&#39;oggetto descrittore di proprietà sia una funzione JavaScript rappresentata da <code>method</code>. Se questo viene passato, imposta <code>value</code>, <code>getter</code> e <code>setter</code> su <code>NULL</code> (poiché questi membri non verranno utilizzati). <a href="/it/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a> fornisce maggiori dettagli.</li><li><code>attributes</code>: Gli attributi associati alla particolare proprietà. Vedi <a href="/it/nodejs/api/n-api#napi-property-attributes"><code>napi_property_attributes</code></a>.</li><li><code>data</code>: I dati di callback passati a <code>method</code>, <code>getter</code> e <code>setter</code> se questa funzione viene invocata.</li></ul><h3 id="functions" tabindex="-1">Funzioni <a class="header-anchor" href="#functions" aria-label="Permalink to “Funzioni”">​</a></h3><h4 id="napi_get_property_names" tabindex="-1"><code>napi_get_property_names</code> <a class="header-anchor" href="#napi_get_property_names" aria-label="Permalink to “napi_get_property_names”">​</a></h4><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_property_names</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da cui recuperare le proprietà.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un array di valori JavaScript che rappresentano i nomi delle proprietà dell&#39;oggetto. L&#39;API può essere utilizzata per iterare su <code>result</code> usando <a href="/it/nodejs/api/n-api#napi-get-array-length"><code>napi_get_array_length</code></a> e <a href="/it/nodejs/api/n-api#napi-get-element"><code>napi_get_element</code></a>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce i nomi delle proprietà enumerabili di <code>object</code> come un array di stringhe. Le proprietà di <code>object</code> la cui chiave è un simbolo non saranno incluse.</p><h4 id="napi_get_all_property_names" tabindex="-1"><code>napi_get_all_property_names</code> <a class="header-anchor" href="#napi_get_all_property_names" aria-label="Permalink to “napi_get_all_property_names”">​</a></h4><p><strong>Aggiunta in: v13.7.0, v12.17.0, v10.20.0</strong></p><p><strong>Versione N-API: 6</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_all_property_names</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_key_collection_mode </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key_mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_key_filter </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key_filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_key_conversion </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key_conversion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da cui recuperare le proprietà.</li><li><code>[in] key_mode</code>: Indica se recuperare anche le proprietà del prototipo.</li><li><code>[in] key_filter</code>: Quali proprietà recuperare (enumerabile/leggibile/scrivibile).</li><li><code>[in] key_conversion</code>: Indica se convertire le chiavi di proprietà numerate in stringhe.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta un array di valori JavaScript che rappresentano i nomi delle proprietà dell&#39;oggetto. <a href="/it/nodejs/api/n-api#napi-get-array-length"><code>napi_get_array_length</code></a> e <a href="/it/nodejs/api/n-api#napi-get-element"><code>napi_get_element</code></a> possono essere utilizzate per iterare su <code>result</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce un array contenente i nomi delle proprietà disponibili di questo oggetto.</p><h4 id="napi_set_property" tabindex="-1"><code>napi_set_property</code> <a class="header-anchor" href="#napi_set_property" aria-label="Permalink to “napi_set_property”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_set_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto su cui impostare la proprietà.</li><li><code>[in] key</code>: Il nome della proprietà da impostare.</li><li><code>[in] value</code>: Il valore della proprietà.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API imposta una proprietà sull&#39;<code>Object</code> passato.</p><h4 id="napi_get_property" tabindex="-1"><code>napi_get_property</code> <a class="header-anchor" href="#napi_get_property" aria-label="Permalink to “napi_get_property”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da cui recuperare la proprietà.</li><li><code>[in] key</code>: Il nome della proprietà da recuperare.</li><li><code>[out] result</code>: Il valore della proprietà.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API ottiene la proprietà richiesta dall&#39;<code>Object</code> passato.</p><h4 id="napi_has_property" tabindex="-1"><code>napi_has_property</code> <a class="header-anchor" href="#napi_has_property" aria-label="Permalink to “napi_has_property”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_has_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da interrogare.</li><li><code>[in] key</code>: Il nome della proprietà di cui verificare l&#39;esistenza.</li><li><code>[out] result</code>: Indica se la proprietà esiste o meno sull&#39;oggetto.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API verifica se l&#39;<code>Object</code> passato ha la proprietà denominata.</p><h4 id="napi_delete_property" tabindex="-1"><code>napi_delete_property</code> <a class="header-anchor" href="#napi_delete_property" aria-label="Permalink to “napi_delete_property”">​</a></h4><p><strong>Aggiunto in: v8.2.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_delete_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da interrogare.</li><li><code>[in] key</code>: Il nome della proprietà da eliminare.</li><li><code>[out] result</code>: Indica se l&#39;eliminazione della proprietà ha avuto successo o meno. <code>result</code> può essere facoltativamente ignorato passando <code>NULL</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API tenta di eliminare la proprietà propria <code>key</code> da <code>object</code>.</p><h4 id="napi_has_own_property" tabindex="-1"><code>napi_has_own_property</code> <a class="header-anchor" href="#napi_has_own_property" aria-label="Permalink to “napi_has_own_property”">​</a></h4><p><strong>Aggiunto in: v8.2.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_has_own_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                  bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da interrogare.</li><li><code>[in] key</code>: Il nome della proprietà &quot;own&quot; di cui verificare l&#39;esistenza.</li><li><code>[out] result</code>: Indica se la proprietà &quot;own&quot; esiste sull&#39;oggetto o meno.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API verifica se l&#39;<code>Object</code> passato ha la proprietà &quot;own&quot; specificata. <code>key</code> deve essere una <code>string</code> o un <code>symbol</code>, altrimenti verrà generato un errore. Node-API non eseguirà alcuna conversione tra i tipi di dati.</p><h4 id="napi_set_named_property" tabindex="-1"><code>napi_set_named_property</code> <a class="header-anchor" href="#napi_set_named_property" aria-label="Permalink to “napi_set_named_property”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto su cui impostare la proprietà.</li><li><code>[in] utf8Name</code>: Il nome della proprietà da impostare.</li><li><code>[in] value</code>: Il valore della proprietà.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questo metodo è equivalente a chiamare <a href="/it/nodejs/api/n-api#napi-set-property"><code>napi_set_property</code></a> con un <code>napi_value</code> creato dalla stringa passata come <code>utf8Name</code>.</p><h4 id="napi_get_named_property" tabindex="-1"><code>napi_get_named_property</code> <a class="header-anchor" href="#napi_get_named_property" aria-label="Permalink to “napi_get_named_property”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da cui recuperare la proprietà.</li><li><code>[in] utf8Name</code>: Il nome della proprietà da ottenere.</li><li><code>[out] result</code>: Il valore della proprietà.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questo metodo è equivalente a chiamare <a href="/it/nodejs/api/n-api#napi-get-property"><code>napi_get_property</code></a> con un <code>napi_value</code> creato dalla stringa passata come <code>utf8Name</code>.</p><h4 id="napi_has_named_property" tabindex="-1"><code>napi_has_named_property</code> <a class="header-anchor" href="#napi_has_named_property" aria-label="Permalink to “napi_has_named_property”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_has_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da interrogare.</li><li><code>[in] utf8Name</code>: Il nome della proprietà di cui verificare l&#39;esistenza.</li><li><code>[out] result</code>: Indica se la proprietà esiste sull&#39;oggetto o meno.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questo metodo è equivalente a chiamare <a href="/it/nodejs/api/n-api#napi-has-property"><code>napi_has_property</code></a> con un <code>napi_value</code> creato dalla stringa passata come <code>utf8Name</code>.</p><h4 id="napi_set_element" tabindex="-1"><code>napi_set_element</code> <a class="header-anchor" href="#napi_set_element" aria-label="Permalink to “napi_set_element”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_set_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da cui impostare le proprietà.</li><li><code>[in] index</code>: L&#39;indice della proprietà da impostare.</li><li><code>[in] value</code>: Il valore della proprietà.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API imposta un elemento sull&#39;<code>Object</code> passato.</p><h4 id="napi_get_element" tabindex="-1"><code>napi_get_element</code> <a class="header-anchor" href="#napi_get_element" aria-label="Permalink to “napi_get_element”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da cui recuperare la proprietà.</li><li><code>[in] index</code>: L&#39;indice della proprietà da ottenere.</li><li><code>[out] result</code>: Il valore della proprietà.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API ottiene l&#39;elemento all&#39;indice richiesto.</p><h4 id="napi_has_element" tabindex="-1"><code>napi_has_element</code> <a class="header-anchor" href="#napi_has_element" aria-label="Permalink to “napi_has_element”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_has_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da interrogare.</li><li><code>[in] index</code>: L&#39;indice della proprietà di cui verificare l&#39;esistenza.</li><li><code>[out] result</code>: Indica se la proprietà esiste sull&#39;oggetto o meno.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce se l&#39;<code>Object</code> passato ha un elemento all&#39;indice richiesto.</p><h4 id="napi_delete_element" tabindex="-1"><code>napi_delete_element</code> <a class="header-anchor" href="#napi_delete_element" aria-label="Permalink to “napi_delete_element”">​</a></h4><p><strong>Aggiunto in: v8.2.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_delete_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                uint32_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da interrogare.</li><li><code>[in] index</code>: L&#39;indice della proprietà da eliminare.</li><li><code>[out] result</code>: Indica se l&#39;eliminazione dell&#39;elemento è avvenuta con successo o meno. <code>result</code> può essere facoltativamente ignorato passando <code>NULL</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API tenta di eliminare l&#39;<code>index</code> specificato da <code>object</code>.</p><h4 id="napi_define_properties" tabindex="-1"><code>napi_define_properties</code> <a class="header-anchor" href="#napi_define_properties" aria-label="Permalink to “napi_define_properties”">​</a></h4><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_define_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> property_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_property_descriptor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da cui recuperare le proprietà.</li><li><code>[in] property_count</code>: Il numero di elementi nell&#39;array <code>properties</code>.</li><li><code>[in] properties</code>: L&#39;array di descrittori di proprietà.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questo metodo consente la definizione efficiente di più proprietà su un dato oggetto. Le proprietà sono definite utilizzando i descrittori di proprietà (vedere <a href="/it/nodejs/api/n-api#napi-property-descriptor"><code>napi_property_descriptor</code></a>). Dato un array di tali descrittori di proprietà, questa API imposterà le proprietà sull&#39;oggetto una alla volta, come definito da <code>DefineOwnProperty()</code> (descritto nella <a href="https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots-defineownproperty-p-desc" target="_blank" rel="noreferrer">Sezione 9.1.6</a> della specifica ECMA-262).</p><h4 id="napi_object_freeze" tabindex="-1"><code>napi_object_freeze</code> <a class="header-anchor" href="#napi_object_freeze" aria-label="Permalink to “napi_object_freeze”">​</a></h4><p><strong>Aggiunto in: v14.14.0, v12.20.0</strong></p><p><strong>Versione N-API: 8</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_object_freeze</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da congelare.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questo metodo congela un determinato oggetto. Ciò impedisce l&#39;aggiunta di nuove proprietà, la rimozione di proprietà esistenti, impedisce la modifica dell&#39;enumerabilità, della configurabilità o della scrivibilità delle proprietà esistenti e impedisce la modifica dei valori delle proprietà esistenti. Impedisce anche la modifica del prototipo dell&#39;oggetto. Questo è descritto nella <a href="https://tc39.es/ecma262/#sec-object.freeze" target="_blank" rel="noreferrer">Sezione 19.1.2.6</a> della specifica ECMA-262.</p><h4 id="napi_object_seal" tabindex="-1"><code>napi_object_seal</code> <a class="header-anchor" href="#napi_object_seal" aria-label="Permalink to “napi_object_seal”">​</a></h4><p><strong>Aggiunto in: v14.14.0, v12.20.0</strong></p><p><strong>Versione N-API: 8</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_object_seal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata la chiamata Node-API.</li><li><code>[in] object</code>: L&#39;oggetto da sigillare.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questo metodo sigilla un dato oggetto. Questo impedisce l&#39;aggiunta di nuove proprietà ad esso, oltre a contrassegnare tutte le proprietà esistenti come non configurabili. Questo è descritto nella <a href="https://tc39.es/ecma262/#sec-object.seal" target="_blank" rel="noreferrer">Sezione 19.1.2.20</a> della specifica ECMA-262.</p><h2 id="working-with-javascript-functions" tabindex="-1">Lavorare con le funzioni JavaScript <a class="header-anchor" href="#working-with-javascript-functions" aria-label="Permalink to “Lavorare con le funzioni JavaScript”">​</a></h2><p>Node-API fornisce una serie di API che consentono al codice JavaScript di richiamare il codice nativo. Le Node-API che supportano la richiamata nel codice nativo accettano funzioni di callback rappresentate dal tipo <code>napi_callback</code>. Quando la VM JavaScript richiama il codice nativo, viene invocata la funzione <code>napi_callback</code> fornita. Le API documentate in questa sezione consentono alla funzione di callback di fare quanto segue:</p><ul><li>Ottenere informazioni sul contesto in cui è stata invocata la callback.</li><li>Ottenere gli argomenti passati alla callback.</li><li>Restituire un <code>napi_value</code> dalla callback.</li></ul><p>Inoltre, Node-API fornisce una serie di funzioni che consentono di chiamare funzioni JavaScript dal codice nativo. Si può chiamare una funzione come una normale chiamata di funzione JavaScript, oppure come una funzione costruttore.</p><p>Qualsiasi dato non <code>NULL</code> che viene passato a questa API tramite il campo <code>data</code> degli elementi <code>napi_property_descriptor</code> può essere associato a <code>object</code> e liberato ogni volta che <code>object</code> viene raccolto come spazzatura passando sia <code>object</code> che i dati a <a href="/it/nodejs/api/n-api#napi-add-finalizer"><code>napi_add_finalizer</code></a>.</p><h3 id="napi_call_function" tabindex="-1"><code>napi_call_function</code> <a class="header-anchor" href="#napi_call_function" aria-label="Permalink to “napi_call_function”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_call_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">recv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                           size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                           const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] recv</code>: Il valore <code>this</code> passato alla funzione chiamata.</li><li><code>[in] func</code>: <code>napi_value</code> che rappresenta la funzione JavaScript da invocare.</li><li><code>[in] argc</code>: Il conteggio degli elementi nell&#39;array <code>argv</code>.</li><li><code>[in] argv</code>: Array di <code>napi_value</code> che rappresentano i valori JavaScript passati come argomenti alla funzione.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;oggetto JavaScript restituito.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questo metodo consente di chiamare un oggetto funzione JavaScript da un add-on nativo. Questo è il meccanismo principale per richiamare <em>dal</em> codice nativo dell&#39;add-on <em>in</em> JavaScript. Per il caso speciale della richiamata in JavaScript dopo un&#39;operazione asincrona, vedere <a href="/it/nodejs/api/n-api#napi-make-callback"><code>napi_make_callback</code></a>.</p><p>Un caso d&#39;uso di esempio potrebbe essere il seguente. Considera il seguente snippet JavaScript:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AddTwo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">num</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> num </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">global.AddTwo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AddTwo;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Quindi, la funzione di cui sopra può essere invocata da un add-on nativo usando il seguente codice:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Ottieni la funzione denominata &quot;AddTwo&quot; sull&#39;oggetto globale</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value global, add_two, arg;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, global, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AddTwo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">add_two</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const arg = 1337</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1337</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">arg;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// AddTwo(arg);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value return_val;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_call_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, global, add_two, argc, argv, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">return_val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Converti il risultato di nuovo in un tipo nativo</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_value_int32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, return_val, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="napi_create_function" tabindex="-1"><code>napi_create_function</code> <a class="header-anchor" href="#napi_create_function" aria-label="Permalink to “napi_create_function”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_callback </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente sotto il quale viene richiamata l&#39;API.</li><li><code>[in] utf8Name</code>: Nome facoltativo della funzione codificato come UTF8. Questo è visibile all&#39;interno di JavaScript come la proprietà <code>name</code> del nuovo oggetto funzione.</li><li><code>[in] length</code>: La lunghezza di <code>utf8name</code> in byte, o <code>NAPI_AUTO_LENGTH</code> se è terminata con null.</li><li><code>[in] cb</code>: La funzione nativa che deve essere chiamata quando viene invocato questo oggetto funzione. <a href="/it/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a> fornisce maggiori dettagli.</li><li><code>[in] data</code>: Contesto dati fornito dall&#39;utente. Questo verrà ripassato alla funzione quando verrà invocata in seguito.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;oggetto funzione JavaScript per la funzione appena creata.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API consente a un autore di componenti aggiuntivi di creare un oggetto funzione nel codice nativo. Questo è il meccanismo principale per consentire la chiamata <em>nel</em> codice nativo del componente aggiuntivo <em>da</em> JavaScript.</p><p>La funzione appena creata non è automaticamente visibile dallo script dopo questa chiamata. Invece, una proprietà deve essere esplicitamente impostata su qualsiasi oggetto visibile a JavaScript, affinché la funzione sia accessibile dallo script.</p><p>Per esporre una funzione come parte delle esportazioni del modulo del componente aggiuntivo, impostare la funzione appena creata sull&#39;oggetto exports. Un modulo di esempio potrebbe avere il seguente aspetto:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SayHello</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Ciao</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value fn;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, SayHello, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fn);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_set_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, exports, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sayHello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fn);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> exports;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAPI_MODULE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NODE_GYP_MODULE_NAME, Init)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>Dato il codice sopra, il componente aggiuntivo può essere utilizzato da JavaScript come segue:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> myaddon</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./addon&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">myaddon.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sayHello</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>La stringa passata a <code>require()</code> è il nome del target in <code>binding.gyp</code> responsabile della creazione del file <code>.node</code>.</p><p>Qualsiasi dato non <code>NULL</code> che viene passato a questa API tramite il parametro <code>data</code> può essere associato alla funzione JavaScript risultante (che viene restituita nel parametro <code>result</code>) e liberato ogni volta che la funzione viene sottoposta a garbage collection passando sia la funzione JavaScript che i dati a <a href="/it/nodejs/api/n-api#napi-add-finalizer"><code>napi_add_finalizer</code></a>.</p><p>Le <code>Function</code> JavaScript sono descritte nella <a href="https://tc39.github.io/ecma262/#sec-function-objects" target="_blank" rel="noreferrer">Sezione 19.2</a> della specifica del linguaggio ECMAScript.</p><h3 id="napi_get_cb_info" tabindex="-1"><code>napi_get_cb_info</code> <a class="header-anchor" href="#napi_get_cb_info" aria-label="Permalink to “napi_get_cb_info”">​</a></h3><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_cb_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cbinfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             size_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> thisArg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] cbinfo</code>: Le informazioni di callback passate alla funzione di callback.</li><li><code>[in-out] argc</code>: Specifica la lunghezza dell&#39;array <code>argv</code> fornito e riceve il conteggio effettivo degli argomenti. <code>argc</code> può facoltativamente essere ignorato passando <code>NULL</code>.</li><li><code>[out] argv</code>: Array C di <code>napi_value</code> in cui verranno copiati gli argomenti. Se ci sono più argomenti del conteggio fornito, viene copiato solo il numero richiesto di argomenti. Se vengono forniti meno argomenti di quelli dichiarati, il resto di <code>argv</code> viene riempito con valori <code>napi_value</code> che rappresentano <code>undefined</code>. <code>argv</code> può facoltativamente essere ignorato passando <code>NULL</code>.</li><li><code>[out] thisArg</code>: Riceve l&#39;argomento JavaScript <code>this</code> per la chiamata. <code>thisArg</code> può facoltativamente essere ignorato passando <code>NULL</code>.</li><li><code>[out] data</code>: Riceve il puntatore ai dati per il callback. <code>data</code> può facoltativamente essere ignorato passando <code>NULL</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questo metodo viene utilizzato all&#39;interno di una funzione di callback per recuperare i dettagli sulla chiamata come gli argomenti e il puntatore <code>this</code> da una data informazione di callback.</p><h3 id="napi_get_new_target" tabindex="-1"><code>napi_get_new_target</code> <a class="header-anchor" href="#napi_get_new_target" aria-label="Permalink to “napi_get_new_target”">​</a></h3><p><strong>Aggiunta in: v8.6.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_new_target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cbinfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] cbinfo</code>: Le informazioni di callback passate alla funzione di callback.</li><li><code>[out] result</code>: Il <code>new.target</code> della chiamata al costruttore.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce il <code>new.target</code> della chiamata al costruttore. Se il callback corrente non è una chiamata al costruttore, il risultato è <code>NULL</code>.</p><h3 id="napi_new_instance" tabindex="-1"><code>napi_new_instance</code> <a class="header-anchor" href="#napi_new_instance" aria-label="Permalink to “napi_new_instance”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_new_instance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cons</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] cons</code>: <code>napi_value</code> che rappresenta la funzione JavaScript da invocare come costruttore.</li><li><code>[in] argc</code>: Il numero di elementi nell&#39;array <code>argv</code>.</li><li><code>[in] argv</code>: Array di valori JavaScript come <code>napi_value</code> che rappresenta gli argomenti del costruttore. Se <code>argc</code> è zero, questo parametro può essere omesso passando <code>NULL</code>.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;oggetto JavaScript restituito, che in questo caso è l&#39;oggetto costruito.</li></ul><p>Questo metodo viene utilizzato per istanziare un nuovo valore JavaScript utilizzando un dato <code>napi_value</code> che rappresenta il costruttore per l&#39;oggetto. Ad esempio, considera il seguente snippet:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.param </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> param;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> arg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arg);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Quanto segue può essere approssimato in Node-API utilizzando il seguente snippet:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Ottieni la funzione costruttore MyObject</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value global, constructor, arg, value;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_named_property</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, global, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyObject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const arg = &quot;hello&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_string_utf8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, NAPI_AUTO_LENGTH, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">arg;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const value = new MyObject(arg)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_new_instance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, constructor, argc, argv, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><h2 id="object-wrap" tabindex="-1">Object wrap <a class="header-anchor" href="#object-wrap" aria-label="Permalink to “Object wrap”">​</a></h2><p>Node-API offre un modo per &quot;wrappare&quot; classi e istanze C++ in modo che il costruttore e i metodi della classe possano essere chiamati da JavaScript.</p><p>Per gli oggetti wrappati, può essere difficile distinguere tra una funzione chiamata su un prototipo di classe e una funzione chiamata su un&#39;istanza di una classe. Un modello comune utilizzato per affrontare questo problema è salvare un riferimento persistente al costruttore della classe per i successivi controlli <code>instanceof</code>.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value MyClass_constructor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_reference_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, MyClass::es_constructor, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">MyClass_constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_ok </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> is_instance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_instanceof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, es_this, MyClass_constructor, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">is_instance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_ok </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (is_instance) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // napi_unwrap() ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // altrimenti...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Il riferimento deve essere liberato quando non è più necessario.</p><p>Ci sono occasioni in cui <code>napi_instanceof()</code> è insufficiente per garantire che un oggetto JavaScript sia un wrapper per un determinato tipo nativo. Questo è il caso soprattutto quando gli oggetti JavaScript wrappati vengono ripassati all&#39;addon tramite metodi statici anziché come valore <code>this</code> dei metodi prototype. In tali casi, c&#39;è la possibilità che possano essere unwrappati in modo errato.</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> myAddon</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./build/Release/my_addon.node&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// \`openDatabase()\` restituisce un oggetto JavaScript che wrappa un database nativo</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// handle.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> dbHandle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myAddon.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// \`query()\` restituisce un oggetto JavaScript che wrappa un query handle nativo.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> queryHandle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myAddon.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dbHandle, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Gimme ALL the things!&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// C&#39;è un errore accidentale nella riga sottostante. Il primo parametro di</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// \`myAddon.queryHasRecords()\` dovrebbe essere l&#39;handle del database (\`dbHandle\`), non</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// il query handle (\`query\`), quindi la condizione corretta per il ciclo while</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// dovrebbe essere</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// myAddon.queryHasRecords(dbHandle, queryHandle)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (myAddon.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">queryHasRecords</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(queryHandle, dbHandle)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // recupera i record</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>Nell&#39;esempio sopra, <code>myAddon.queryHasRecords()</code> è un metodo che accetta due argomenti. Il primo è un handle del database e il secondo è un query handle. Internamente, unwrappa il primo argomento e fa il cast del puntatore risultante a un handle di database nativo. Quindi unwrappa il secondo argomento e fa il cast del puntatore risultante a un query handle. Se gli argomenti vengono passati nell&#39;ordine sbagliato, i cast funzioneranno, tuttavia, ci sono buone probabilità che l&#39;operazione di database sottostante fallirà, o causerà persino un accesso non valido alla memoria.</p><p>Per garantire che il puntatore recuperato dal primo argomento sia effettivamente un puntatore a un handle del database e, allo stesso modo, che il puntatore recuperato dal secondo argomento sia effettivamente un puntatore a un query handle, l&#39;implementazione di <code>queryHasRecords()</code> deve eseguire una validazione del tipo. Conservare il costruttore della classe JavaScript da cui è stato istanziato l&#39;handle del database e il costruttore da cui è stato istanziato il query handle in <code>napi_ref</code> può essere d&#39;aiuto, perché <code>napi_instanceof()</code> può quindi essere utilizzato per garantire che le istanze passate a <code>queryHashRecords()</code> siano effettivamente del tipo corretto.</p><p>Sfortunatamente, <code>napi_instanceof()</code> non protegge dalla manipolazione del prototipo. Ad esempio, il prototipo dell&#39;istanza dell&#39;handle del database può essere impostato sul prototipo del costruttore per le istanze del query handle. In questo caso, l&#39;istanza dell&#39;handle del database può apparire come un&#39;istanza del query handle e supererà il test <code>napi_instanceof()</code> per un&#39;istanza del query handle, pur contenendo un puntatore a un handle del database.</p><p>A tal fine, Node-API fornisce funzionalità di type-tagging.</p><p>Un type tag è un numero intero a 128 bit univoco per l&#39;addon. Node-API fornisce la struttura <code>napi_type_tag</code> per memorizzare un type tag. Quando tale valore viene passato insieme a un oggetto JavaScript o <a href="/it/nodejs/api/n-api#napi-create-external">esterno</a> memorizzato in un <code>napi_value</code> a <code>napi_type_tag_object()</code>, l&#39;oggetto JavaScript verrà &quot;contrassegnato&quot; con il type tag. Il &quot;contrassegno&quot; è invisibile sul lato JavaScript. Quando un oggetto JavaScript arriva in un binding nativo, <code>napi_check_object_type_tag()</code> può essere utilizzato insieme al type tag originale per determinare se l&#39;oggetto JavaScript è stato precedentemente &quot;contrassegnato&quot; con il type tag. Questo crea una capacità di type-checking di una fedeltà superiore a quella che <code>napi_instanceof()</code> può fornire, perché tale type-tagging sopravvive alla manipolazione del prototipo e allo scaricamento/ricaricamento dell&#39;addon.</p><p>Continuando l&#39;esempio sopra, la seguente implementazione scheletrica dell&#39;addon illustra l&#39;uso di <code>napi_type_tag_object()</code> e <code>napi_check_object_type_tag()</code>.</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Questo valore è il type tag per un handle del database. Il comando</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//   uuidgen | sed -r -e &#39;s/-//g&#39; -e &#39;s/(.{16})(.*)/0x\\1, 0x\\2/&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// può essere utilizzato per ottenere i due valori con cui inizializzare la struttura.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_type_tag DatabaseHandleTypeTag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1edf75a38336451d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">a5ed9ce2e4c00c38</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Questo valore è il type tag per un query handle.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_type_tag QueryHandleTypeTag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9c73317f9fad44a3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">93c3920bf3b0ad6a</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_value</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value result;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Esegui l&#39;azione sottostante che si traduce in un handle del database.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  DatabaseHandle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dbHandle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> open_database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Crea un nuovo oggetto JS vuoto.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Tagga l&#39;oggetto per indicare che contiene un puntatore a un \`DatabaseHandle\`.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_type_tag_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, result, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DatabaseHandleTypeTag);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Memorizza il puntatore alla struttura \`DatabaseHandle\` all&#39;interno dell&#39;oggetto JS.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_wrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, result, dbHandle, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Successivamente, quando riceviamo un oggetto JavaScript che pretende di essere un handle del database</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// possiamo utilizzare \`napi_check_object_type_tag()\` per garantire che sia effettivamente tale</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// handle.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_value</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_callback_info </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_status status;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  size_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> is_db_handle;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_cb_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, info, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">argc, argv, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Controlla che l&#39;oggetto passato come primo parametro abbia il tag applicato in precedenza.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_check_object_type_tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">                                      argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DatabaseHandleTypeTag,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                      &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_db_handle);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Lancia un \`TypeError\` se non lo è.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_db_handle) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Lancia un TypeError.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><h3 id="napi_define_class" tabindex="-1"><code>napi_define_class</code> <a class="header-anchor" href="#napi_define_class" aria-label="Permalink to “napi_define_class”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_define_class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> utf8name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_callback </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> property_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_property_descriptor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] utf8name</code>: Nome della funzione costruttore JavaScript. Per chiarezza, si consiglia di utilizzare il nome della classe C++ quando si esegue il wrapping di una classe C++.</li><li><code>[in] length</code>: La lunghezza di <code>utf8name</code> in byte, o <code>NAPI_AUTO_LENGTH</code> se è terminata con null.</li><li><code>[in] constructor</code>: Funzione di callback che gestisce la costruzione di istanze della classe. Quando si esegue il wrapping di una classe C++, questo metodo deve essere un membro statico con la firma <a href="/it/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a>. Un costruttore di classe C++ non può essere utilizzato. <a href="/it/nodejs/api/n-api#napi-callback"><code>napi_callback</code></a> fornisce maggiori dettagli.</li><li><code>[in] data</code>: Dati opzionali da passare alla callback del costruttore come proprietà <code>data</code> delle informazioni di callback.</li><li><code>[in] property_count</code>: Numero di elementi nell&#39;argomento array <code>properties</code>.</li><li><code>[in] properties</code>: Array di descrittori di proprietà che descrivono proprietà di dati statici e di istanza, funzioni di accesso e metodi sulla classe. Vedere <code>napi_property_descriptor</code>.</li><li><code>[out] result</code>: Un <code>napi_value</code> che rappresenta la funzione costruttore per la classe.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Definisce una classe JavaScript, inclusi:</p><ul><li>Una funzione costruttore JavaScript che ha il nome della classe. Quando si esegue il wrapping di una classe C++ corrispondente, la callback passata tramite <code>constructor</code> può essere utilizzata per istanziare una nuova istanza di classe C++, che può quindi essere posizionata all&#39;interno dell&#39;istanza dell&#39;oggetto JavaScript in fase di costruzione utilizzando <a href="/it/nodejs/api/n-api#napi-wrap"><code>napi_wrap</code></a>.</li><li>Proprietà sulla funzione costruttore la cui implementazione può chiamare le corrispondenti proprietà di dati <em>statici</em>, funzioni di accesso e metodi della classe C++ (definiti dai descrittori di proprietà con l&#39;attributo <code>napi_static</code>).</li><li>Proprietà sull&#39;oggetto <code>prototype</code> della funzione costruttore. Quando si esegue il wrapping di una classe C++, le proprietà di dati, le funzioni di accesso e i metodi <em>non statici</em> della classe C++ possono essere chiamati dalle funzioni statiche fornite nei descrittori di proprietà senza l&#39;attributo <code>napi_static</code> dopo aver recuperato l&#39;istanza della classe C++ posizionata all&#39;interno dell&#39;istanza dell&#39;oggetto JavaScript utilizzando <a href="/it/nodejs/api/n-api#napi-unwrap"><code>napi_unwrap</code></a>.</li></ul><p>Quando si esegue il wrapping di una classe C++, la callback del costruttore C++ passata tramite <code>constructor</code> dovrebbe essere un metodo statico sulla classe che chiama l&#39;effettivo costruttore della classe, quindi esegue il wrapping della nuova istanza C++ in un oggetto JavaScript e restituisce l&#39;oggetto wrapper. Vedere <a href="/it/nodejs/api/n-api#napi-wrap"><code>napi_wrap</code></a> per i dettagli.</p><p>La funzione costruttore JavaScript restituita da <a href="/it/nodejs/api/n-api#napi-define-class"><code>napi_define_class</code></a> viene spesso salvata e utilizzata in seguito per costruire nuove istanze della classe dal codice nativo e/o per verificare se i valori forniti sono istanze della classe. In tal caso, per impedire che il valore della funzione venga raccolto dalla garbage collection, è possibile creare un riferimento persistente forte ad essa utilizzando <a href="/it/nodejs/api/n-api#napi-create-reference"><code>napi_create_reference</code></a>, garantendo che il conteggio dei riferimenti sia mantenuto &gt;= 1.</p><p>Qualsiasi dato non <code>NULL</code> che viene passato a questa API tramite il parametro <code>data</code> o tramite il campo <code>data</code> degli elementi dell&#39;array <code>napi_property_descriptor</code> può essere associato al costruttore JavaScript risultante (che viene restituito nel parametro <code>result</code>) e liberato ogni volta che la classe viene raccolta dalla garbage collection passando sia la funzione JavaScript che i dati a <a href="/it/nodejs/api/n-api#napi-add-finalizer"><code>napi_add_finalizer</code></a>.</p><h3 id="napi_wrap" tabindex="-1"><code>napi_wrap</code> <a class="header-anchor" href="#napi_wrap" aria-label="Permalink to “napi_wrap”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_wrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                      napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                      void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> native_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                      napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                      void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                      napi_ref</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] js_object</code>: L&#39;oggetto JavaScript che sarà il wrapper per l&#39;oggetto nativo.</li><li><code>[in] native_object</code>: L&#39;istanza nativa che sarà avvolta nell&#39;oggetto JavaScript.</li><li><code>[in] finalize_cb</code>: Callback nativa facoltativa che può essere utilizzata per liberare l&#39;istanza nativa quando l&#39;oggetto JavaScript è stato sottoposto a garbage collection. <a href="/it/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> fornisce maggiori dettagli.</li><li><code>[in] finalize_hint</code>: Suggerimento contestuale facoltativo che viene passato alla callback di finalizzazione.</li><li><code>[out] result</code>: Riferimento facoltativo all&#39;oggetto avvolto.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Avvolge un&#39;istanza nativa in un oggetto JavaScript. L&#39;istanza nativa può essere recuperata successivamente utilizzando <code>napi_unwrap()</code>.</p><p>Quando il codice JavaScript richiama un costruttore per una classe definita utilizzando <code>napi_define_class()</code>, viene richiamata la <code>napi_callback</code> per il costruttore. Dopo aver costruito un&#39;istanza della classe nativa, la callback deve quindi chiamare <code>napi_wrap()</code> per avvolgere l&#39;istanza appena costruita nell&#39;oggetto JavaScript già creato che è l&#39;argomento <code>this</code> alla callback del costruttore. (Quell&#39;oggetto <code>this</code> è stato creato dal <code>prototype</code> della funzione costruttore, quindi ha già le definizioni di tutte le proprietà e i metodi dell&#39;istanza.)</p><p>In genere, quando si avvolge un&#39;istanza di classe, è necessario fornire una callback di finalizzazione che elimini semplicemente l&#39;istanza nativa che viene ricevuta come argomento <code>data</code> alla callback di finalizzazione.</p><p>Il riferimento restituito facoltativo è inizialmente un riferimento debole, il che significa che ha un conteggio di riferimento pari a 0. In genere, questo conteggio di riferimento verrebbe incrementato temporaneamente durante le operazioni asincrone che richiedono che l&#39;istanza rimanga valida.</p><p><em>Attenzione</em>: Il riferimento restituito facoltativo (se ottenuto) deve essere eliminato tramite <a href="/it/nodejs/api/n-api#napi-delete-reference"><code>napi_delete_reference</code></a> SOLO in risposta alla chiamata della callback di finalizzazione. Se viene eliminato prima, la callback di finalizzazione potrebbe non essere mai richiamata. Pertanto, quando si ottiene un riferimento, è necessaria anche una callback di finalizzazione per consentire la corretta eliminazione del riferimento.</p><p>Le callback del finalizzatore possono essere differite, lasciando una finestra in cui l&#39;oggetto è stato sottoposto a garbage collection (e il riferimento debole non è valido) ma il finalizzatore non è stato ancora chiamato. Quando si utilizza <code>napi_get_reference_value()</code> su riferimenti deboli restituiti da <code>napi_wrap()</code>, è comunque necessario gestire un risultato vuoto.</p><p>Chiamare <code>napi_wrap()</code> una seconda volta su un oggetto restituirà un errore. Per associare un&#39;altra istanza nativa all&#39;oggetto, utilizzare prima <code>napi_remove_wrap()</code>.</p><h3 id="napi_unwrap" tabindex="-1"><code>napi_unwrap</code> <a class="header-anchor" href="#napi_unwrap" aria-label="Permalink to “napi_unwrap”">​</a></h3><p><strong>Aggiunta in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_unwrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                        void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] js_object</code>: L&#39;oggetto associato all&#39;istanza nativa.</li><li><code>[out] result</code>: Puntatore all&#39;istanza nativa wrappata.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Recupera un&#39;istanza nativa che è stata precedentemente wrappata in un oggetto JavaScript utilizzando <code>napi_wrap()</code>.</p><p>Quando il codice JavaScript richiama un metodo o un accessor di proprietà sulla classe, viene richiamato il corrispondente <code>napi_callback</code>. Se il callback è per un metodo o un accessor di istanza, allora l&#39;argomento <code>this</code> del callback è l&#39;oggetto wrapper; l&#39;istanza C++ wrappata che è l&#39;obiettivo della chiamata può essere ottenuta chiamando <code>napi_unwrap()</code> sull&#39;oggetto wrapper.</p><h3 id="napi_remove_wrap" tabindex="-1"><code>napi_remove_wrap</code> <a class="header-anchor" href="#napi_remove_wrap" aria-label="Permalink to “napi_remove_wrap”">​</a></h3><p><strong>Aggiunta in: v8.5.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_remove_wrap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] js_object</code>: L&#39;oggetto associato all&#39;istanza nativa.</li><li><code>[out] result</code>: Puntatore all&#39;istanza nativa wrappata.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Recupera un&#39;istanza nativa che è stata precedentemente wrappata nell&#39;oggetto JavaScript <code>js_object</code> utilizzando <code>napi_wrap()</code> e rimuove il wrapping. Se un callback di finalizzazione era associato al wrapping, non verrà più chiamato quando l&#39;oggetto JavaScript viene sottoposto a garbage collection.</p><h3 id="napi_type_tag_object" tabindex="-1"><code>napi_type_tag_object</code> <a class="header-anchor" href="#napi_type_tag_object" aria-label="Permalink to “napi_type_tag_object”">​</a></h3><p><strong>Aggiunta in: v14.8.0, v12.19.0</strong></p><p><strong>Versione N-API: 8</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_type_tag_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                 const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_type_tag</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> type_tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] js_object</code>: L&#39;oggetto JavaScript o <a href="/it/nodejs/api/n-api#napi-create-external">external</a> da marcare.</li><li><code>[in] type_tag</code>: Il tag con cui l&#39;oggetto deve essere marcato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Associa il valore del puntatore <code>type_tag</code> all&#39;oggetto JavaScript o <a href="/it/nodejs/api/n-api#napi-create-external">external</a>. <code>napi_check_object_type_tag()</code> può quindi essere utilizzato per confrontare il tag che è stato allegato all&#39;oggetto con uno di proprietà dell&#39;addon per garantire che l&#39;oggetto abbia il tipo corretto.</p><p>Se l&#39;oggetto ha già un tag di tipo associato, questa API restituirà <code>napi_invalid_arg</code>.</p><h3 id="napi_check_object_type_tag" tabindex="-1"><code>napi_check_object_type_tag</code> <a class="header-anchor" href="#napi_check_object_type_tag" aria-label="Permalink to “napi_check_object_type_tag”">​</a></h3><p><strong>Aggiunto in: v14.8.0, v12.19.0</strong></p><p><strong>Versione N-API: 8</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_check_object_type_tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                       napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_type_tag</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> type_tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                       bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] js_object</code>: L&#39;oggetto JavaScript o <a href="/it/nodejs/api/n-api#napi-create-external">external</a> di cui esaminare il type tag.</li><li><code>[in] type_tag</code>: Il tag con cui confrontare qualsiasi tag trovato sull&#39;oggetto.</li><li><code>[out] result</code>: Indica se il type tag fornito corrisponde al type tag sull&#39;oggetto. Viene restituito <code>false</code> anche se non è stato trovato alcun type tag sull&#39;oggetto.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Confronta il puntatore fornito come <code>type_tag</code> con qualsiasi puntatore che può essere trovato su <code>js_object</code>. Se non viene trovato alcun tag su <code>js_object</code> o, se viene trovato un tag ma non corrisponde a <code>type_tag</code>, allora <code>result</code> viene impostato su <code>false</code>. Se viene trovato un tag e corrisponde a <code>type_tag</code>, allora <code>result</code> viene impostato su <code>true</code>.</p><h3 id="napi_add_finalizer" tabindex="-1"><code>napi_add_finalizer</code> <a class="header-anchor" href="#napi_add_finalizer" aria-label="Permalink to “napi_add_finalizer”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 5</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_add_finalizer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">js_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                               void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               node_api_basic_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                               void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_ref</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] js_object</code>: L&#39;oggetto JavaScript a cui verranno allegati i dati nativi.</li><li><code>[in] finalize_data</code>: Dati opzionali da passare a <code>finalize_cb</code>.</li><li><code>[in] finalize_cb</code>: Callback nativa che verrà utilizzata per liberare i dati nativi quando l&#39;oggetto JavaScript è stato sottoposto a garbage collection. <a href="/it/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> fornisce maggiori dettagli.</li><li><code>[in] finalize_hint</code>: Hint contestuale opzionale che viene passato alla callback di finalizzazione.</li><li><code>[out] result</code>: Riferimento opzionale all&#39;oggetto JavaScript.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Aggiunge una callback <code>napi_finalize</code> che verrà chiamata quando l&#39;oggetto JavaScript in <code>js_object</code> è stato sottoposto a garbage collection.</p><p>Questa API può essere chiamata più volte su un singolo oggetto JavaScript.</p><p><em>Attenzione</em>: Il riferimento opzionale restituito (se ottenuto) dovrebbe essere eliminato tramite <a href="/it/nodejs/api/n-api#napi-delete-reference"><code>napi_delete_reference</code></a> SOLO in risposta all&#39;invocazione della callback di finalizzazione. Se viene eliminato prima, la callback di finalizzazione potrebbe non essere mai invocata. Pertanto, quando si ottiene un riferimento, è necessaria anche una callback di finalizzazione per consentire la corretta eliminazione del riferimento.</p><h4 id="node_api_post_finalizer" tabindex="-1"><code>node_api_post_finalizer</code> <a class="header-anchor" href="#node_api_post_finalizer" aria-label="Permalink to “node_api_post_finalizer”">​</a></h4><p><strong>Aggiunta in: v21.0.0, v20.10.0, v18.19.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[Stable: 1 - Sperimentale]</p><p><a href="/it/nodejs/api/documentation#stability-index">Stable: 1</a> <a href="/it/nodejs/api/documentation#stability-index">Stabilità: 1</a> - Sperimentale</p></div><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_post_finalizer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                    void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> finalize_hint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] finalize_cb</code>: Callback nativa che verrà utilizzata per liberare i dati nativi quando l&#39;oggetto JavaScript è stato sottoposto a garbage collection. <a href="/it/nodejs/api/n-api#napi-finalize"><code>napi_finalize</code></a> fornisce maggiori dettagli.</li><li><code>[in] finalize_data</code>: Dati opzionali da passare a <code>finalize_cb</code>.</li><li><code>[in] finalize_hint</code>: Suggerimento contestuale opzionale che viene passato alla callback di finalizzazione.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Pianifica una callback <code>napi_finalize</code> da chiamare in modo asincrono nell&#39;event loop.</p><p>Normalmente, i finalizzatori vengono chiamati mentre il GC (garbage collector) raccoglie gli oggetti. A quel punto, chiamare qualsiasi Node-API che possa causare modifiche nello stato del GC sarà disabilitato e Node.js si arresterà in modo anomalo.</p><p><code>node_api_post_finalizer</code> aiuta a aggirare questa limitazione consentendo all&#39;addon di rimandare le chiamate a tali Node-API a un momento al di fuori della finalizzazione del GC.</p><h2 id="simple-asynchronous-operations" tabindex="-1">Semplici operazioni asincrone <a class="header-anchor" href="#simple-asynchronous-operations" aria-label="Permalink to “Semplici operazioni asincrone”">​</a></h2><p>I moduli addon spesso devono sfruttare gli helper asincroni da libuv come parte della loro implementazione. Ciò consente loro di pianificare il lavoro da eseguire in modo asincrono in modo che i loro metodi possano tornare prima che il lavoro sia completato. Ciò consente loro di evitare di bloccare l&#39;esecuzione complessiva dell&#39;applicazione Node.js.</p><p>Node-API fornisce un&#39;interfaccia ABI-stabile per queste funzioni di supporto che copre i casi d&#39;uso asincroni più comuni.</p><p>Node-API definisce la struttura <code>napi_async_work</code> che viene utilizzata per gestire i worker asincroni. Le istanze vengono create/eliminate con <a href="/it/nodejs/api/n-api#napi-create-async-work"><code>napi_create_async_work</code></a> e <a href="/it/nodejs/api/n-api#napi-delete-async-work"><code>napi_delete_async_work</code></a>.</p><p>Le callback <code>execute</code> e <code>complete</code> sono funzioni che verranno invocate quando l&#39;executor è pronto per l&#39;esecuzione e quando completa rispettivamente la sua attività.</p><p>La funzione <code>execute</code> dovrebbe evitare di effettuare chiamate Node-API che potrebbero comportare l&#39;esecuzione di JavaScript o l&#39;interazione con oggetti JavaScript. Molto spesso, qualsiasi codice che deve effettuare chiamate Node-API dovrebbe essere eseguito nella callback <code>complete</code>. Evitare di utilizzare il parametro <code>napi_env</code> nella callback di esecuzione poiché probabilmente eseguirà JavaScript.</p><p>Queste funzioni implementano le seguenti interfacce:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_async_execute_callback)(napi_env env,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                            void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_async_complete_callback)(napi_env env,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                             napi_status status,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                             void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Quando questi metodi vengono invocati, il parametro <code>data</code> passato sarà il dato <code>void*</code> fornito dall&#39;addon che è stato passato nella chiamata <code>napi_create_async_work</code>.</p><p>Una volta creato, il worker asincrono può essere accodato per l&#39;esecuzione utilizzando la funzione <a href="/it/nodejs/api/n-api#napi-queue-async-work"><code>napi_queue_async_work</code></a>:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_queue_async_work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_async_work </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><a href="/it/nodejs/api/n-api#napi-cancel-async-work"><code>napi_cancel_async_work</code></a> può essere utilizzato se il lavoro deve essere annullato prima che l&#39;esecuzione del lavoro sia iniziata.</p><p>Dopo aver chiamato <a href="/it/nodejs/api/n-api#napi-cancel-async-work"><code>napi_cancel_async_work</code></a>, la callback <code>complete</code> verrà invocata con un valore di stato <code>napi_cancelled</code>. Il lavoro non deve essere eliminato prima dell&#39;invocazione della callback <code>complete</code>, anche quando è stato annullato.</p><h3 id="napi_create_async_work" tabindex="-1"><code>napi_create_async_work</code> <a class="header-anchor" href="#napi_create_async_work" aria-label="Permalink to “napi_create_async_work”">​</a></h3><div class="info custom-block"><p class="custom-block-title">[Cronologia]</p><table tabindex="0"><thead><tr><th>Versione</th><th>Modifiche</th></tr></thead><tbody><tr><td>v8.6.0</td><td>Aggiunti i parametri <code>async_resource</code> e <code>async_resource_name</code>.</td></tr><tr><td>v8.0.0</td><td>Aggiunto in: v8.0.0</td></tr></tbody></table></div><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_async_work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_async_execute_callback </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_async_complete_callback </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">complete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_async_work</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] async_resource</code>: Un oggetto opzionale associato al lavoro asincrono che verrà passato ai possibili hook <a href="/it/nodejs/api/async_hooks#initasyncid-type-triggerasyncid-resource"><code>init</code> di <code>async_hooks</code></a>.</li><li><code>[in] async_resource_name</code>: Identificatore per il tipo di risorsa che viene fornita per le informazioni diagnostiche esposte dall&#39;API <code>async_hooks</code>.</li><li><code>[in] execute</code>: La funzione nativa che deve essere chiamata per eseguire la logica in modo asincrono. La funzione indicata viene chiamata da un thread del pool di worker e può essere eseguita in parallelo con il thread del loop di eventi principale.</li><li><code>[in] complete</code>: La funzione nativa che verrà chiamata quando la logica asincrona è completata o annullata. La funzione indicata viene chiamata dal thread del loop di eventi principale. <a href="/it/nodejs/api/n-api#napi-async-complete-callback"><code>napi_async_complete_callback</code></a> fornisce maggiori dettagli.</li><li><code>[in] data</code>: Contesto dati fornito dall&#39;utente. Questo verrà passato nuovamente alle funzioni execute e complete.</li><li><code>[out] result</code>: <code>napi_async_work*</code> che è l&#39;handle per il lavoro asincrono appena creato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API alloca un oggetto work che viene utilizzato per eseguire la logica in modo asincrono. Dovrebbe essere liberato utilizzando <a href="/it/nodejs/api/n-api#napi-delete-async-work"><code>napi_delete_async_work</code></a> una volta che il lavoro non è più necessario.</p><p><code>async_resource_name</code> deve essere una stringa con terminazione null e codificata in UTF-8.</p><p>L&#39;identificatore <code>async_resource_name</code> è fornito dall&#39;utente e dovrebbe essere rappresentativo del tipo di lavoro asincrono eseguito. Si raccomanda inoltre di applicare il namespacing all&#39;identificatore, ad esempio includendo il nome del modulo. Consultare la <a href="/it/nodejs/api/async_hooks#type"><code>documentazione di async_hooks</code></a> per ulteriori informazioni.</p><h3 id="napi_delete_async_work" tabindex="-1"><code>napi_delete_async_work</code> <a class="header-anchor" href="#napi_delete_async_work" aria-label="Permalink to “napi_delete_async_work”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_delete_async_work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_async_work </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] work</code>: L&#39;handle restituito dalla chiamata a <code>napi_create_async_work</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API libera un oggetto work precedentemente allocato.</p><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h3 id="napi_queue_async_work" tabindex="-1"><code>napi_queue_async_work</code> <a class="header-anchor" href="#napi_queue_async_work" aria-label="Permalink to “napi_queue_async_work”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_queue_async_work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_async_work </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] work</code>: L&#39;handle restituito dalla chiamata a <code>napi_create_async_work</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API richiede che il work precedentemente allocato sia programmato per l&#39;esecuzione. Una volta restituito correttamente, questa API non deve essere richiamata di nuovo con lo stesso elemento <code>napi_async_work</code> o il risultato sarà indefinito.</p><h3 id="napi_cancel_async_work" tabindex="-1"><code>napi_cancel_async_work</code> <a class="header-anchor" href="#napi_cancel_async_work" aria-label="Permalink to “napi_cancel_async_work”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_cancel_async_work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                   napi_async_work </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">work</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] work</code>: L&#39;handle restituito dalla chiamata a <code>napi_create_async_work</code>.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API annulla il work in coda se non è ancora stato avviato. Se ha già iniziato l&#39;esecuzione, non può essere annullato e verrà restituito <code>napi_generic_failure</code>. In caso di successo, la callback <code>complete</code> verrà invocata con un valore di stato di <code>napi_cancelled</code>. Il work non deve essere eliminato prima dell&#39;invocazione della callback <code>complete</code>, anche se è stato annullato correttamente.</p><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h2 id="custom-asynchronous-operations" tabindex="-1">Operazioni asincrone personalizzate <a class="header-anchor" href="#custom-asynchronous-operations" aria-label="Permalink to “Operazioni asincrone personalizzate”">​</a></h2><p>Le semplici API di work asincrono sopra riportate potrebbero non essere appropriate per ogni scenario. Quando si utilizza qualsiasi altro meccanismo asincrono, le seguenti API sono necessarie per garantire che un&#39;operazione asincrona venga correttamente monitorata dal runtime.</p><h3 id="napi_async_init" tabindex="-1"><code>napi_async_init</code> <a class="header-anchor" href="#napi_async_init" aria-label="Permalink to “napi_async_init”">​</a></h3><p><strong>Aggiunto in: v8.6.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_async_init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_async_context</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] async_resource</code>: Oggetto associato al lavoro asincrono che verrà passato ai possibili hook <code>async_hooks</code> <a href="/it/nodejs/api/async_hooks#initasyncid-type-triggerasyncid-resource"><code>init</code></a> e a cui è possibile accedere tramite <a href="/it/nodejs/api/async_hooks#async-hooksexecutionasyncresource"><code>async_hooks.executionAsyncResource()</code></a>.</li><li><code>[in] async_resource_name</code>: Identificatore per il tipo di risorsa che viene fornita per le informazioni diagnostiche esposte dall&#39;API <code>async_hooks</code>.</li><li><code>[out] result</code>: Il contesto asincrono inizializzato.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>L&#39;oggetto <code>async_resource</code> deve essere mantenuto attivo fino a <a href="/it/nodejs/api/n-api#napi-async-destroy"><code>napi_async_destroy</code></a> per fare in modo che l&#39;API relativa a <code>async_hooks</code> agisca correttamente. Al fine di mantenere la compatibilità ABI con le versioni precedenti, i <code>napi_async_context</code> non mantengono il riferimento forte agli oggetti <code>async_resource</code> per evitare di introdurre perdite di memoria. Tuttavia, se <code>async_resource</code> viene raccolto dal garbage collector del motore JavaScript prima che <code>napi_async_context</code> venga distrutto da <code>napi_async_destroy</code>, la chiamata alle API relative a <code>napi_async_context</code> come <a href="/it/nodejs/api/n-api#napi-open-callback-scope"><code>napi_open_callback_scope</code></a> e <a href="/it/nodejs/api/n-api#napi-make-callback"><code>napi_make_callback</code></a> può causare problemi come la perdita di contesto asincrono quando si utilizza l&#39;API <code>AsyncLocalStorage</code>.</p><p>Al fine di mantenere la compatibilità ABI con le versioni precedenti, il passaggio di <code>NULL</code> per <code>async_resource</code> non comporta un errore. Tuttavia, questo non è raccomandato in quanto ciò comporterà un comportamento indesiderabile con gli hook <code>async_hooks</code> <a href="/it/nodejs/api/async_hooks#initasyncid-type-triggerasyncid-resource"><code>init</code></a> e <code>async_hooks.executionAsyncResource()</code> poiché la risorsa è ora richiesta dall&#39;implementazione <code>async_hooks</code> sottostante al fine di fornire il collegamento tra i callback asincroni.</p><h3 id="napi_async_destroy" tabindex="-1"><code>napi_async_destroy</code> <a class="header-anchor" href="#napi_async_destroy" aria-label="Permalink to “napi_async_destroy”">​</a></h3><p><strong>Aggiunto in: v8.6.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_async_destroy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                               napi_async_context </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] async_context</code>: Il contesto asincrono da distruggere.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h3 id="napi_make_callback" tabindex="-1"><code>napi_make_callback</code> <a class="header-anchor" href="#napi_make_callback" aria-label="Permalink to “napi_make_callback”">​</a></h3><div class="info custom-block"><p class="custom-block-title">[Cronologia]</p><table tabindex="0"><thead><tr><th>Versione</th><th>Modifiche</th></tr></thead><tbody><tr><td>v8.6.0</td><td>Aggiunto il parametro <code>async_context</code>.</td></tr><tr><td>v8.0.0</td><td>Aggiunto in: v8.0.0</td></tr></tbody></table></div><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_make_callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_async_context </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">recv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                           size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                           const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                           napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] async_context</code>: Contesto per l&#39;operazione asincrona che sta richiamando la callback. Questo dovrebbe normalmente essere un valore precedentemente ottenuto da <a href="/it/nodejs/api/n-api#napi-async-init"><code>napi_async_init</code></a>. Al fine di mantenere la compatibilità ABI con le versioni precedenti, passare <code>NULL</code> per <code>async_context</code> non comporta un errore. Tuttavia, ciò comporta un funzionamento errato degli hook asincroni. I potenziali problemi includono la perdita del contesto asincrono quando si utilizza l&#39;API <code>AsyncLocalStorage</code>.</li><li><code>[in] recv</code>: Il valore <code>this</code> passato alla funzione chiamata.</li><li><code>[in] func</code>: <code>napi_value</code> che rappresenta la funzione JavaScript da richiamare.</li><li><code>[in] argc</code>: Il conteggio degli elementi nell&#39;array <code>argv</code>.</li><li><code>[in] argv</code>: Array di valori JavaScript come <code>napi_value</code> che rappresentano gli argomenti della funzione. Se <code>argc</code> è zero, questo parametro può essere omesso passando <code>NULL</code>.</li><li><code>[out] result</code>: <code>napi_value</code> che rappresenta l&#39;oggetto JavaScript restituito.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questo metodo consente di chiamare un oggetto funzione JavaScript da un componente aggiuntivo nativo. Questa API è simile a <code>napi_call_function</code>. Tuttavia, viene utilizzata per chiamare <em>dal</em> codice nativo <em>al</em> codice JavaScript <em>dopo</em> essere tornati da un&#39;operazione asincrona (quando non c&#39;è altro script nello stack). È un wrapper abbastanza semplice attorno a <code>node::MakeCallback</code>.</p><p>Si noti che <em>non</em> è necessario utilizzare <code>napi_make_callback</code> all&#39;interno di una <code>napi_async_complete_callback</code>; in quella situazione il contesto asincrono della callback è già stato impostato, quindi una chiamata diretta a <code>napi_call_function</code> è sufficiente e appropriata. L&#39;uso della funzione <code>napi_make_callback</code> può essere richiesto quando si implementa un comportamento asincrono personalizzato che non utilizza <code>napi_create_async_work</code>.</p><p>Qualsiasi <code>process.nextTick</code> o Promise pianificate nella coda dei microtask da JavaScript durante la callback vengono eseguite prima di tornare a C/C++.</p><h3 id="napi_open_callback_scope" tabindex="-1"><code>napi_open_callback_scope</code> <a class="header-anchor" href="#napi_open_callback_scope" aria-label="Permalink to “napi_open_callback_scope”">​</a></h3><p><strong>Aggiunto in: v9.6.0</strong></p><p><strong>Versione N-API: 3</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_open_callback_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">resource_object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_async_context </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                 napi_callback_scope</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] resource_object</code>: Un oggetto associato al lavoro asincrono che verrà passato a possibili hook <code>async_hooks</code> <a href="/it/nodejs/api/async_hooks#initasyncid-type-triggerasyncid-resource"><code>init</code> hook</a>. Questo parametro è stato deprecato e viene ignorato in fase di runtime. Utilizzare il parametro <code>async_resource</code> in <a href="/it/nodejs/api/n-api#napi-async-init"><code>napi_async_init</code></a> invece.</li><li><code>[in] context</code>: Contesto per l&#39;operazione asincrona che sta invocando il callback. Questo dovrebbe essere un valore precedentemente ottenuto da <a href="/it/nodejs/api/n-api#napi-async-init"><code>napi_async_init</code></a>.</li><li><code>[out] result</code>: Il nuovo scope creato.</li></ul><p>Ci sono casi (ad esempio, la risoluzione delle promise) in cui è necessario avere l&#39;equivalente dello scope associato a un callback quando si effettuano determinate chiamate Node-API. Se non c&#39;è altro script nello stack le funzioni <a href="/it/nodejs/api/n-api#napi-open-callback-scope"><code>napi_open_callback_scope</code></a> e <a href="/it/nodejs/api/n-api#napi-close-callback-scope"><code>napi_close_callback_scope</code></a> possono essere utilizzate per aprire/chiudere lo scope richiesto.</p><h3 id="napi_close_callback_scope" tabindex="-1"><code>napi_close_callback_scope</code> <a class="header-anchor" href="#napi_close_callback_scope" aria-label="Permalink to “napi_close_callback_scope”">​</a></h3><p><strong>Aggiunto in: v9.6.0</strong></p><p><strong>Versione N-API: 3</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_close_callback_scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                                  napi_callback_scope </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] scope</code>: Lo scope da chiudere.</li></ul><p>Questa API può essere chiamata anche se è presente un&#39;eccezione JavaScript in sospeso.</p><h2 id="version-management" tabindex="-1">Gestione delle versioni <a class="header-anchor" href="#version-management" aria-label="Permalink to “Gestione delle versioni”">​</a></h2><h3 id="napi_get_node_version" tabindex="-1"><code>napi_get_node_version</code> <a class="header-anchor" href="#napi_get_node_version" aria-label="Permalink to “napi_get_node_version”">​</a></h3><p><strong>Aggiunto in: v8.4.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> major;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minor;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> patch;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> release;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} napi_node_version;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_node_version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_node_version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] version</code>: Un puntatore alle informazioni sulla versione per Node.js stesso.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa funzione riempie la struct <code>version</code> con la versione major, minor e patch di Node.js attualmente in esecuzione, e il campo <code>release</code> con il valore di <a href="/it/nodejs/api/process#processrelease"><code>process.release.name</code></a>.</p><p>Il buffer restituito è allocato staticamente e non necessita di essere liberato.</p><h3 id="napi_get_version" tabindex="-1"><code>napi_get_version</code> <a class="header-anchor" href="#napi_get_version" aria-label="Permalink to “napi_get_version”">​</a></h3><p><strong>Aggiunto in: v8.0.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                             uint32_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] result</code>: La versione più alta di Node-API supportata.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API restituisce la versione più alta di Node-API supportata dal runtime di Node.js. Node-API è pianificato per essere additivo, in modo che le versioni più recenti di Node.js possano supportare funzioni API aggiuntive. Per consentire a un addon di utilizzare una funzione più recente quando viene eseguito con versioni di Node.js che la supportano, fornendo al contempo un comportamento di fallback quando viene eseguito con versioni di Node.js che non la supportano:</p><ul><li>Chiama <code>napi_get_version()</code> per determinare se l&#39;API è disponibile.</li><li>Se disponibile, carica dinamicamente un puntatore alla funzione utilizzando <code>uv_dlsym()</code>.</li><li>Utilizza il puntatore caricato dinamicamente per invocare la funzione.</li><li>Se la funzione non è disponibile, fornisci un&#39;implementazione alternativa che non utilizzi la funzione.</li></ul><h2 id="memory-management" tabindex="-1">Gestione della memoria <a class="header-anchor" href="#memory-management" aria-label="Permalink to “Gestione della memoria”">​</a></h2><h3 id="napi_adjust_external_memory" tabindex="-1"><code>napi_adjust_external_memory</code> <a class="header-anchor" href="#napi_adjust_external_memory" aria-label="Permalink to “napi_adjust_external_memory”">​</a></h3><p><strong>Aggiunto in: v8.5.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_adjust_external_memory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                    int64_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> change_in_bytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                                    int64_t*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] change_in_bytes</code>: La modifica nella memoria allocata esternamente che viene mantenuta attiva dagli oggetti JavaScript.</li><li><code>[out] result</code>: Il valore modificato</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa funzione fornisce a V8 un&#39;indicazione della quantità di memoria allocata esternamente che viene mantenuta attiva dagli oggetti JavaScript (ad esempio un oggetto JavaScript che punta alla propria memoria allocata da un addon nativo). La registrazione della memoria allocata esternamente attiverà garbage collection globali più spesso di quanto farebbe altrimenti.</p><h2 id="promises" tabindex="-1">Promise <a class="header-anchor" href="#promises" aria-label="Permalink to “Promise”">​</a></h2><p>Node-API fornisce strumenti per la creazione di oggetti <code>Promise</code> come descritto nella <a href="https://tc39.github.io/ecma262/#sec-promise-objects" target="_blank" rel="noreferrer">Sezione 25.4</a> della specifica ECMA. Implementa le promise come una coppia di oggetti. Quando una promise viene creata da <code>napi_create_promise()</code>, viene creato un oggetto &quot;deferred&quot; e restituito insieme alla <code>Promise</code>. L&#39;oggetto deferred è legato alla <code>Promise</code> creata ed è l&#39;unico mezzo per risolvere o rifiutare la <code>Promise</code> utilizzando <code>napi_resolve_deferred()</code> o <code>napi_reject_deferred()</code>. L&#39;oggetto deferred creato da <code>napi_create_promise()</code> viene liberato da <code>napi_resolve_deferred()</code> o <code>napi_reject_deferred()</code>. L&#39;oggetto <code>Promise</code> può essere restituito a JavaScript dove può essere utilizzato nel solito modo.</p><p>Ad esempio, per creare una promise e passarla a un worker asincrono:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_deferred deferred;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value promise;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Crea la promise.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_create_promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Passa il deferred a una funzione che esegue un&#39;azione asincrona.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">do_something_asynchronous</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(deferred);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Restituisce la promise a JS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> promise;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>La funzione di cui sopra <code>do_something_asynchronous()</code> eseguirà la sua azione asincrona e quindi risolverà o rifiuterà il deferred, concludendo così la promise e liberando il deferred:</p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_deferred deferred;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_value undefined;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status status;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Crea un valore con cui concludere il deferred.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_get_undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Risolvi o rifiuta la promise associata al deferred a seconda che</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// l&#39;azione asincrona abbia avuto successo.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (asynchronous_action_succeeded) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_resolve_deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, deferred, undefined);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> napi_reject_deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(env, deferred, undefined);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> napi_ok) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// A questo punto il deferred è stato liberato, quindi dovremmo assegnare NULL ad esso.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deferred </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="napi_create_promise" tabindex="-1"><code>napi_create_promise</code> <a class="header-anchor" href="#napi_create_promise" aria-label="Permalink to “napi_create_promise”">​</a></h3><p><strong>Aggiunto in: v8.5.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_deferred</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] deferred</code>: Un oggetto deferred appena creato che può essere successivamente passato a <code>napi_resolve_deferred()</code> o <code>napi_reject_deferred()</code> per risolvere risp. rifiutare la promise associata.</li><li><code>[out] promise</code>: La promise JavaScript associata all&#39;oggetto deferred.</li></ul><p>Restituisce <code>napi_ok</code> se l&#39;API ha avuto successo.</p><p>Questa API crea un oggetto deferred e una promise JavaScript.</p><h3 id="napi_resolve_deferred" tabindex="-1"><code>napi_resolve_deferred</code> <a class="header-anchor" href="#napi_resolve_deferred" aria-label="Permalink to “napi_resolve_deferred”">​</a></h3><p><strong>Aggiunto in: v8.5.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_resolve_deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_deferred </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                  napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">resolution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] deferred</code>: L&#39;oggetto deferred la cui promise associata deve essere risolta.</li><li><code>[in] resolution</code>: Il valore con cui risolvere la promise.</li></ul><p>Questa API risolve una promise JavaScript tramite l&#39;oggetto deferred a cui è associata. Pertanto, può essere utilizzata solo per risolvere le promise JavaScript per le quali è disponibile l&#39;oggetto deferred corrispondente. Ciò significa effettivamente che la promise deve essere stata creata utilizzando <code>napi_create_promise()</code> e l&#39;oggetto deferred restituito da quella chiamata deve essere stato conservato per essere passato a questa API.</p><p>L&#39;oggetto deferred viene liberato al completamento con successo.</p><h3 id="napi_reject_deferred" tabindex="-1"><code>napi_reject_deferred</code> <a class="header-anchor" href="#napi_reject_deferred" aria-label="Permalink to “napi_reject_deferred”">​</a></h3><p><strong>Aggiunto in: v8.5.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_reject_deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_deferred </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">deferred</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">rejection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] deferred</code>: L&#39;oggetto deferred la cui promise associata deve essere risolta.</li><li><code>[in] rejection</code>: Il valore con cui rifiutare la promise.</li></ul><p>Questa API rifiuta una promise JavaScript tramite l&#39;oggetto deferred a cui è associata. Pertanto, può essere utilizzata solo per rifiutare le promise JavaScript per le quali è disponibile l&#39;oggetto deferred corrispondente. Ciò significa effettivamente che la promise deve essere stata creata utilizzando <code>napi_create_promise()</code> e l&#39;oggetto deferred restituito da quella chiamata deve essere stato conservato per essere passato a questa API.</p><p>L&#39;oggetto deferred viene liberato al completamento con successo.</p><h3 id="napi_is_promise" tabindex="-1"><code>napi_is_promise</code> <a class="header-anchor" href="#napi_is_promise" aria-label="Permalink to “napi_is_promise”">​</a></h3><p><strong>Aggiunto in: v8.5.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_is_promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                            bool*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> is_promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] value</code>: Il valore da esaminare.</li><li><code>[out] is_promise</code>: Flag che indica se <code>promise</code> è un oggetto promise nativo (ovvero, un oggetto promise creato dal motore sottostante).</li></ul><h2 id="script-execution" tabindex="-1">Esecuzione di script <a class="header-anchor" href="#script-execution" aria-label="Permalink to “Esecuzione di script”">​</a></h2><p>Node-API fornisce un&#39;API per eseguire una stringa contenente JavaScript utilizzando il motore JavaScript sottostante.</p><h3 id="napi_run_script" tabindex="-1"><code>napi_run_script</code> <a class="header-anchor" href="#napi_run_script" aria-label="Permalink to “napi_run_script”">​</a></h3><p><strong>Aggiunto in: v8.5.0</strong></p><p><strong>Versione N-API: 1</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_run_script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                        napi_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] script</code>: Una stringa JavaScript contenente lo script da eseguire.</li><li><code>[out] result</code>: Il valore risultante dall&#39;esecuzione dello script.</li></ul><p>Questa funzione esegue una stringa di codice JavaScript e ne restituisce il risultato con le seguenti avvertenze:</p><ul><li>A differenza di <code>eval</code>, questa funzione non consente allo script di accedere all&#39;ambito lessicale corrente, e quindi non consente nemmeno di accedere allo <a href="/it/nodejs/api/modules#the-module-scope">scope del modulo</a>, il che significa che pseudo-globali come <code>require</code> non saranno disponibili.</li><li>Lo script può accedere allo <a href="/it/nodejs/api/globals">scope globale</a>. Le dichiarazioni di funzione e <code>var</code> nello script verranno aggiunte all&#39;oggetto <a href="/it/nodejs/api/globals#global"><code>global</code></a>. Le dichiarazioni di variabili fatte usando <code>let</code> e <code>const</code> saranno visibili globalmente, ma non verranno aggiunte all&#39;oggetto <a href="/it/nodejs/api/globals#global"><code>global</code></a>.</li><li>Il valore di <code>this</code> è <a href="/it/nodejs/api/globals#global"><code>global</code></a> all&#39;interno dello script.</li></ul><h2 id="libuv-event-loop" tabindex="-1">Event loop libuv <a class="header-anchor" href="#libuv-event-loop" aria-label="Permalink to “Event loop libuv”">​</a></h2><p>Node-API fornisce una funzione per ottenere l&#39;event loop corrente associato a un determinato <code>napi_env</code>.</p><h3 id="napi_get_uv_event_loop" tabindex="-1"><code>napi_get_uv_event_loop</code> <a class="header-anchor" href="#napi_get_uv_event_loop" aria-label="Permalink to “napi_get_uv_event_loop”">​</a></h3><p><strong>Aggiunto in: v9.3.0, v8.10.0</strong></p><p><strong>Versione N-API: 2</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_uv_event_loop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                               struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> uv_loop_s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> loop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] loop</code>: L&#39;istanza corrente del loop libuv.</li></ul><p>Nota: Sebbene libuv sia stato relativamente stabile nel tempo, non fornisce una garanzia di stabilità ABI. L&#39;uso di questa funzione dovrebbe essere evitato. Il suo uso può comportare un addon che non funziona tra le versioni di Node.js. Le <a href="/it/nodejs/api/n-api#asynchronous-thread-safe-function-calls">chiamate di funzione asincrone thread-safe</a> sono un&#39;alternativa per molti casi d&#39;uso.</p><h2 id="asynchronous-thread-safe-function-calls" tabindex="-1">Chiamate di funzione asincrone thread-safe <a class="header-anchor" href="#asynchronous-thread-safe-function-calls" aria-label="Permalink to “Chiamate di funzione asincrone thread-safe”">​</a></h2><p>Le funzioni JavaScript normalmente possono essere chiamate solo dal thread principale di un addon nativo. Se un addon crea thread aggiuntivi, le funzioni Node-API che richiedono un <code>napi_env</code>, <code>napi_value</code> o <code>napi_ref</code> non devono essere chiamate da tali thread.</p><p>Quando un addon ha thread aggiuntivi e le funzioni JavaScript devono essere invocate in base all&#39;elaborazione completata da tali thread, questi thread devono comunicare con il thread principale dell&#39;addon in modo che il thread principale possa invocare la funzione JavaScript per loro conto. Le API delle funzioni thread-safe forniscono un modo semplice per farlo.</p><p>Queste API forniscono il tipo <code>napi_threadsafe_function</code> così come le API per creare, distruggere e chiamare oggetti di questo tipo. <code>napi_create_threadsafe_function()</code> crea un riferimento persistente a un <code>napi_value</code> che contiene una funzione JavaScript che può essere chiamata da più thread. Le chiamate avvengono in modo asincrono. Ciò significa che i valori con cui richiamare la callback JavaScript verranno inseriti in una coda e, per ogni valore nella coda, verrà alla fine effettuata una chiamata alla funzione JavaScript.</p><p>Al momento della creazione di una <code>napi_threadsafe_function</code> è possibile fornire una callback <code>napi_finalize</code>. Questa callback verrà invocata sul thread principale quando la funzione thread-safe sta per essere distrutta. Riceve il contesto e i dati di finalizzazione forniti durante la costruzione e offre l&#39;opportunità di eseguire la pulizia dopo i thread, ad esempio chiamando <code>uv_thread_join()</code>. <strong>Oltre al thread del ciclo principale, nessun thread dovrebbe utilizzare la funzione thread-safe dopo che la callback di finalizzazione è stata completata.</strong></p><p>Il <code>context</code> fornito durante la chiamata a <code>napi_create_threadsafe_function()</code> può essere recuperato da qualsiasi thread con una chiamata a <code>napi_get_threadsafe_function_context()</code>.</p><h3 id="calling-a-thread-safe-function" tabindex="-1">Chiamare una funzione thread-safe <a class="header-anchor" href="#calling-a-thread-safe-function" aria-label="Permalink to “Chiamare una funzione thread-safe”">​</a></h3><p><code>napi_call_threadsafe_function()</code> può essere utilizzato per avviare una chiamata in JavaScript. <code>napi_call_threadsafe_function()</code> accetta un parametro che controlla se l&#39;API si comporta in modo bloccante. Se impostato su <code>napi_tsfn_nonblocking</code>, l&#39;API si comporta in modo non bloccante, restituendo <code>napi_queue_full</code> se la coda era piena, impedendo l&#39;aggiunta di dati alla coda. Se impostato su <code>napi_tsfn_blocking</code>, l&#39;API si blocca fino a quando lo spazio non diventa disponibile nella coda. <code>napi_call_threadsafe_function()</code> non si blocca mai se la funzione thread-safe è stata creata con una dimensione massima della coda pari a 0.</p><p><code>napi_call_threadsafe_function()</code> non deve essere chiamata con <code>napi_tsfn_blocking</code> da un thread JavaScript, perché, se la coda è piena, potrebbe causare il deadlock del thread JavaScript.</p><p>La chiamata effettiva in JavaScript è controllata dalla callback fornita tramite il parametro <code>call_js_cb</code>. <code>call_js_cb</code> viene invocata sul thread principale una volta per ogni valore inserito nella coda da una chiamata riuscita a <code>napi_call_threadsafe_function()</code>. Se tale callback non viene fornita, verrà utilizzata una callback predefinita e la chiamata JavaScript risultante non avrà argomenti. La callback <code>call_js_cb</code> riceve la funzione JavaScript da chiamare come <code>napi_value</code> nei suoi parametri, così come il puntatore di contesto <code>void*</code> utilizzato durante la creazione di <code>napi_threadsafe_function</code> e il successivo puntatore di dati creato da uno dei thread secondari. La callback può quindi utilizzare un&#39;API come <code>napi_call_function()</code> per chiamare in JavaScript.</p><p>La callback può anche essere invocata con <code>env</code> e <code>call_js_cb</code> entrambi impostati su <code>NULL</code> per indicare che le chiamate in JavaScript non sono più possibili, mentre rimangono elementi nella coda che potrebbero dover essere liberati. Ciò si verifica normalmente quando il processo Node.js termina mentre è ancora attiva una funzione thread-safe.</p><p>Non è necessario chiamare in JavaScript tramite <code>napi_make_callback()</code> perché Node-API esegue <code>call_js_cb</code> in un contesto appropriato per le callback.</p><p>Zero o più elementi in coda possono essere invocati in ogni tick del ciclo di eventi. Le applicazioni non devono dipendere da un comportamento specifico diverso dal progresso nell&#39;invocare le callback e gli eventi verranno invocati man mano che il tempo avanza.</p><h3 id="reference-counting-of-thread-safe-functions" tabindex="-1">Conteggio dei riferimenti delle funzioni thread-safe <a class="header-anchor" href="#reference-counting-of-thread-safe-functions" aria-label="Permalink to “Conteggio dei riferimenti delle funzioni thread-safe”">​</a></h3><p>I thread possono essere aggiunti e rimossi da un oggetto <code>napi_threadsafe_function</code> durante la sua esistenza. Pertanto, oltre a specificare un numero iniziale di thread al momento della creazione, è possibile chiamare <code>napi_acquire_threadsafe_function</code> per indicare che un nuovo thread inizierà a utilizzare la funzione thread-safe. Allo stesso modo, è possibile chiamare <code>napi_release_threadsafe_function</code> per indicare che un thread esistente smetterà di utilizzare la funzione thread-safe.</p><p>Gli oggetti <code>napi_threadsafe_function</code> vengono distrutti quando ogni thread che utilizza l&#39;oggetto ha chiamato <code>napi_release_threadsafe_function()</code> o ha ricevuto uno stato di ritorno di <code>napi_closing</code> in risposta a una chiamata a <code>napi_call_threadsafe_function</code>. La coda viene svuotata prima che <code>napi_threadsafe_function</code> venga distrutta. <code>napi_release_threadsafe_function()</code> dovrebbe essere l&#39;ultima chiamata API effettuata in congiunzione con una data <code>napi_threadsafe_function</code>, perché dopo che la chiamata è stata completata, non vi è alcuna garanzia che la <code>napi_threadsafe_function</code> sia ancora allocata. Per lo stesso motivo, non utilizzare una funzione thread-safe dopo aver ricevuto un valore di ritorno di <code>napi_closing</code> in risposta a una chiamata a <code>napi_call_threadsafe_function</code>. I dati associati a <code>napi_threadsafe_function</code> possono essere liberati nel suo callback <code>napi_finalize</code> che è stato passato a <code>napi_create_threadsafe_function()</code>. Il parametro <code>initial_thread_count</code> di <code>napi_create_threadsafe_function</code> indica il numero iniziale di acquisizioni delle funzioni thread-safe, invece di chiamare <code>napi_acquire_threadsafe_function</code> più volte al momento della creazione.</p><p>Una volta che il numero di thread che utilizzano una <code>napi_threadsafe_function</code> raggiunge lo zero, nessun altro thread può iniziare a utilizzarla chiamando <code>napi_acquire_threadsafe_function()</code>. Infatti, tutte le successive chiamate API ad essa associate, ad eccezione di <code>napi_release_threadsafe_function()</code>, restituiranno un valore di errore di <code>napi_closing</code>.</p><p>La funzione thread-safe può essere &quot;interrotta&quot; fornendo un valore di <code>napi_tsfn_abort</code> a <code>napi_release_threadsafe_function()</code>. Ciò farà sì che tutte le successive API associate alla funzione thread-safe, ad eccezione di <code>napi_release_threadsafe_function()</code>, restituiscano <code>napi_closing</code> anche prima che il suo conteggio dei riferimenti raggiunga lo zero. In particolare, <code>napi_call_threadsafe_function()</code> restituirà <code>napi_closing</code>, informando così i thread che non è più possibile effettuare chiamate asincrone alla funzione thread-safe. Questo può essere usato come criterio per terminare il thread. <strong>Dopo aver ricevuto un valore di ritorno di <code>napi_closing</code> da <code>napi_call_threadsafe_function()</code> un thread non deve più usare la funzione thread-safe perché non è più garantito che sia allocata.</strong></p><h3 id="deciding-whether-to-keep-the-process-running" tabindex="-1">Decidere se mantenere il processo in esecuzione <a class="header-anchor" href="#deciding-whether-to-keep-the-process-running" aria-label="Permalink to “Decidere se mantenere il processo in esecuzione”">​</a></h3><p>Analogamente agli handle libuv, le funzioni thread-safe possono essere &quot;referenziate&quot; e &quot;dereferenziare&quot;. Una funzione thread-safe &quot;referenziata&quot; farà sì che il loop degli eventi sul thread su cui viene creata rimanga attivo fino a quando la funzione thread-safe non viene distrutta. Al contrario, una funzione thread-safe &quot;dereferenziata&quot; non impedirà l&#39;uscita dal loop degli eventi. Le API <code>napi_ref_threadsafe_function</code> e <code>napi_unref_threadsafe_function</code> esistono per questo scopo.</p><p>Né <code>napi_unref_threadsafe_function</code> contrassegna le funzioni thread-safe come in grado di essere distrutte né <code>napi_ref_threadsafe_function</code> ne impedisce la distruzione.</p><h3 id="napi_create_threadsafe_function" tabindex="-1"><code>napi_create_threadsafe_function</code> <a class="header-anchor" href="#napi_create_threadsafe_function" aria-label="Permalink to “napi_create_threadsafe_function”">​</a></h3><div class="info custom-block"><p class="custom-block-title">[Cronologia]</p><table tabindex="0"><thead><tr><th>Versione</th><th>Modifiche</th></tr></thead><tbody><tr><td>v12.6.0, v10.17.0</td><td>Parametro <code>func</code> reso facoltativo con <code>call_js_cb</code> personalizzato.</td></tr><tr><td>v10.6.0</td><td>Aggiunto in: v10.6.0</td></tr></tbody></table></div><p><strong>Versione N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_create_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_value </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">async_resource_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> max_queue_size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> initial_thread_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> thread_finalize_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_finalize </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">thread_finalize_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_threadsafe_function_call_js </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">call_js_cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                napi_threadsafe_function</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[in] func</code>: Una funzione JavaScript facoltativa da chiamare da un altro thread. Deve essere fornita se viene passato <code>NULL</code> a <code>call_js_cb</code>.</li><li><code>[in] async_resource</code>: Un oggetto facoltativo associato al lavoro asincrono che verrà passato a possibili hook <code>init</code> di <code>async_hooks</code> <a href="/it/nodejs/api/async_hooks#initasyncid-type-triggerasyncid-resource"><code>init</code> hooks</a>.</li><li><code>[in] async_resource_name</code>: Una stringa JavaScript per fornire un identificatore per il tipo di risorsa fornita per le informazioni diagnostiche esposte dall&#39;API <code>async_hooks</code>.</li><li><code>[in] max_queue_size</code>: Dimensione massima della coda. <code>0</code> per nessun limite.</li><li><code>[in] initial_thread_count</code>: Il numero iniziale di acquisizioni, ovvero il numero iniziale di thread, incluso il thread principale, che utilizzeranno questa funzione.</li><li><code>[in] thread_finalize_data</code>: Dati facoltativi da passare a <code>thread_finalize_cb</code>.</li><li><code>[in] thread_finalize_cb</code>: Funzione facoltativa da chiamare quando <code>napi_threadsafe_function</code> viene distrutta.</li><li><code>[in] context</code>: Dati facoltativi da allegare alla <code>napi_threadsafe_function</code> risultante.</li><li><code>[in] call_js_cb</code>: Callback facoltativa che chiama la funzione JavaScript in risposta a una chiamata su un thread diverso. Questa callback verrà chiamata sul thread principale. Se non viene fornita, la funzione JavaScript verrà chiamata senza parametri e con <code>undefined</code> come valore <code>this</code>. <a href="/it/nodejs/api/n-api#napi-threadsafe-function-call-js"><code>napi_threadsafe_function_call_js</code></a> fornisce maggiori dettagli.</li><li><code>[out] result</code>: La funzione JavaScript asincrona thread-safe.</li></ul><p><strong>Cronologia delle modifiche:</strong></p><ul><li>Sperimentale (<code>NAPI_EXPERIMENTAL</code> è definita): le eccezioni non gestite generate in <code>call_js_cb</code> vengono gestite con l&#39;evento <a href="/it/nodejs/api/process#event-uncaughtexception"><code>&#39;uncaughtException&#39;</code></a>, invece di essere ignorate.</li></ul><h3 id="napi_get_threadsafe_function_context" tabindex="-1"><code>napi_get_threadsafe_function_context</code> <a class="header-anchor" href="#napi_get_threadsafe_function_context" aria-label="Permalink to “napi_get_threadsafe_function_context”">​</a></h3><p><strong>Aggiunto in: v10.6.0</strong></p><p><strong>Versione N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_get_threadsafe_function_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                     void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] func</code>: La funzione thread-safe per cui recuperare il contesto.</li><li><code>[out] result</code>: La posizione in cui memorizzare il contesto.</li></ul><p>Questa API può essere chiamata da qualsiasi thread che utilizzi <code>func</code>.</p><h3 id="napi_call_threadsafe_function" tabindex="-1"><code>napi_call_threadsafe_function</code> <a class="header-anchor" href="#napi_call_threadsafe_function" aria-label="Permalink to “napi_call_threadsafe_function”">​</a></h3><div class="info custom-block"><p class="custom-block-title">[Cronologia]</p><table tabindex="0"><thead><tr><th>Versione</th><th>Modifiche</th></tr></thead><tbody><tr><td>v14.5.0</td><td>Il supporto per <code>napi_would_deadlock</code> è stato ripristinato.</td></tr><tr><td>v14.1.0</td><td>Restituisce <code>napi_would_deadlock</code> quando viene chiamata con <code>napi_tsfn_blocking</code> dal thread principale o da un thread worker e la coda è piena.</td></tr><tr><td>v10.6.0</td><td>Aggiunto in: v10.6.0</td></tr></tbody></table></div><p><strong>Versione N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_call_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                              void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                              napi_threadsafe_function_call_mode </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">is_blocking</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>[in] func</code>: La funzione JavaScript asincrona thread-safe da invocare.</li><li><code>[in] data</code>: Dati da inviare in JavaScript tramite il callback <code>call_js_cb</code> fornito durante la creazione della funzione JavaScript thread-safe.</li><li><code>[in] is_blocking</code>: Flag il cui valore può essere <code>napi_tsfn_blocking</code> per indicare che la chiamata deve bloccarsi se la coda è piena oppure <code>napi_tsfn_nonblocking</code> per indicare che la chiamata deve restituire immediatamente con uno stato di <code>napi_queue_full</code> ogni volta che la coda è piena.</li></ul><p>Questa API non deve essere chiamata con <code>napi_tsfn_blocking</code> da un thread JavaScript, perché, se la coda è piena, potrebbe causare il deadlock del thread JavaScript.</p><p>Questa API restituirà <code>napi_closing</code> se <code>napi_release_threadsafe_function()</code> è stata chiamata con <code>abort</code> impostato su <code>napi_tsfn_abort</code> da qualsiasi thread. Il valore viene aggiunto alla coda solo se l&#39;API restituisce <code>napi_ok</code>.</p><p>Questa API può essere chiamata da qualsiasi thread che utilizzi <code>func</code>.</p><h3 id="napi_acquire_threadsafe_function" tabindex="-1"><code>napi_acquire_threadsafe_function</code> <a class="header-anchor" href="#napi_acquire_threadsafe_function" aria-label="Permalink to “napi_acquire_threadsafe_function”">​</a></h3><p><strong>Aggiunto in: v10.6.0</strong></p><p><strong>Versione N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_acquire_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] func</code>: La funzione JavaScript asincrona thread-safe di cui iniziare a fare uso.</li></ul><p>Un thread dovrebbe chiamare questa API prima di passare <code>func</code> a qualsiasi altra API di funzione thread-safe per indicare che ne farà uso. Ciò impedisce che <code>func</code> venga distrutta quando tutti gli altri thread hanno smesso di farne uso.</p><p>Questa API può essere chiamata da qualsiasi thread che inizierà a fare uso di <code>func</code>.</p><h3 id="napi_release_threadsafe_function" tabindex="-1"><code>napi_release_threadsafe_function</code> <a class="header-anchor" href="#napi_release_threadsafe_function" aria-label="Permalink to “napi_release_threadsafe_function”">​</a></h3><p><strong>Aggiunto in: v10.6.0</strong></p><p><strong>Versione N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_release_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                 napi_threadsafe_function_release_mode </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] func</code>: La funzione JavaScript asincrona thread-safe il cui conteggio dei riferimenti deve essere decrementato.</li><li><code>[in] mode</code>: Flag il cui valore può essere <code>napi_tsfn_release</code> per indicare che il thread corrente non effettuerà ulteriori chiamate alla funzione thread-safe, oppure <code>napi_tsfn_abort</code> per indicare che, oltre al thread corrente, nessun altro thread dovrebbe effettuare ulteriori chiamate alla funzione thread-safe. Se impostato su <code>napi_tsfn_abort</code>, ulteriori chiamate a <code>napi_call_threadsafe_function()</code> restituiranno <code>napi_closing</code> e non verranno inseriti ulteriori valori nella coda.</li></ul><p>Un thread dovrebbe chiamare questa API quando smette di utilizzare <code>func</code>. Passare <code>func</code> a qualsiasi API thread-safe dopo aver chiamato questa API ha risultati non definiti, poiché <code>func</code> potrebbe essere stata distrutta.</p><p>Questa API può essere chiamata da qualsiasi thread che smetterà di utilizzare <code>func</code>.</p><h3 id="napi_ref_threadsafe_function" tabindex="-1"><code>napi_ref_threadsafe_function</code> <a class="header-anchor" href="#napi_ref_threadsafe_function" aria-label="Permalink to “napi_ref_threadsafe_function”">​</a></h3><p><strong>Aggiunto in: v10.6.0</strong></p><p><strong>Versione N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_ref_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] func</code>: La funzione thread-safe a cui fare riferimento.</li></ul><p>Questa API viene utilizzata per indicare che il ciclo di eventi in esecuzione sul thread principale non deve terminare finché <code>func</code> non è stata distrutta. Simile a <a href="https://docs.libuv.org/en/v1.x/handle#c.uv_ref" target="_blank" rel="noreferrer"><code>uv_ref</code></a> è anche idempotente.</p><p>Né <code>napi_unref_threadsafe_function</code> contrassegna le funzioni thread-safe come in grado di essere distrutte, né <code>napi_ref_threadsafe_function</code> impedisce che vengano distrutte. <code>napi_acquire_threadsafe_function</code> e <code>napi_release_threadsafe_function</code> sono disponibili a tale scopo.</p><p>Questa API può essere chiamata solo dal thread principale.</p><h3 id="napi_unref_threadsafe_function" tabindex="-1"><code>napi_unref_threadsafe_function</code> <a class="header-anchor" href="#napi_unref_threadsafe_function" aria-label="Permalink to “napi_unref_threadsafe_function”">​</a></h3><p><strong>Aggiunto in: v10.6.0</strong></p><p><strong>Versione N-API: 4</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">napi_unref_threadsafe_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, napi_threadsafe_function </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene richiamata l&#39;API.</li><li><code>[in] func</code>: La funzione thread-safe a cui annullare il riferimento.</li></ul><p>Questa API viene utilizzata per indicare che il ciclo di eventi in esecuzione sul thread principale può terminare prima che <code>func</code> venga distrutta. Simile a <a href="https://docs.libuv.org/en/v1.x/handle#c.uv_unref" target="_blank" rel="noreferrer"><code>uv_unref</code></a> è anche idempotente.</p><p>Questa API può essere chiamata solo dal thread principale.</p><h2 id="miscellaneous-utilities" tabindex="-1">Utilità varie <a class="header-anchor" href="#miscellaneous-utilities" aria-label="Permalink to “Utilità varie”">​</a></h2><h3 id="node_api_get_module_file_name" tabindex="-1"><code>node_api_get_module_file_name</code> <a class="header-anchor" href="#node_api_get_module_file_name" aria-label="Permalink to “node_api_get_module_file_name”">​</a></h3><p><strong>Aggiunto in: v15.9.0, v14.18.0, v12.22.0</strong></p><p><strong>Versione N-API: 9</strong></p><div class="language-C line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAPI_EXTERN napi_status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node_api_get_module_file_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(node_api_basic_env </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>[in] env</code>: L&#39;ambiente in cui viene invocata l&#39;API.</li><li><code>[out] result</code>: Un URL contenente il percorso assoluto della posizione da cui è stato caricato l&#39;add-on. Per un file sul file system locale inizierà con <code>file://</code>. La stringa è terminata con null ed è di proprietà di <code>env</code> e quindi non deve essere modificata o liberata.</li></ul><p><code>result</code> può essere una stringa vuota se il processo di caricamento dell&#39;add-on non riesce a stabilire il nome del file dell&#39;add-on durante il caricamento.</p>`,1599)])}var s=e(a,[[`render`,o]]);export{i as __pageData,s as default};