import{__plugin_vue_export_helper_default as e,createElementBlock as t,createStaticVNode as n,openBlock as r}from"./chunks/plugin-vue_export-helper.Bts1mPc7.js";const i=JSON.parse(`{"title":"Поддержка TypeScript в Node.js","description":"Узнайте, как использовать TypeScript с Node.js, включая установку, настройку и лучшие практики интеграции TypeScript в ваши проекты Node.js.","frontmatter":{"title":"Поддержка TypeScript в Node.js","description":"Узнайте, как использовать TypeScript с Node.js, включая установку, настройку и лучшие практики интеграции TypeScript в ваши проекты Node.js.","head":[["meta",{"name":"og:title","content":"Поддержка TypeScript в Node.js | Node.js - iDoc.dev"}],["meta",{"name":"og:description","content":"Узнайте, как использовать TypeScript с Node.js, включая установку, настройку и лучшие практики интеграции TypeScript в ваши проекты Node.js."}],["meta",{"name":"twitter:title","content":"Поддержка TypeScript в Node.js | Node.js - iDoc.dev"}],["meta",{"name":"twitter:description","content":"Узнайте, как использовать TypeScript с Node.js, включая установку, настройку и лучшие практики интеграции TypeScript в ваши проекты Node.js."}],["link",{"rel":"canonical","href":"https://idoc.dev/ru/nodejs/api/typescript"}],["meta",{"property":"og:url","content":"https://idoc.dev/ru/nodejs/api/typescript"}]]},"headers":[],"relativePath":"ru/nodejs/api/typescript.md","filePath":"ru/nodejs/api/typescript.md","lastUpdated":1749464498000}`),a={name:`ru/nodejs/api/typescript.md`};function o(e,i,a,o,s,c){return r(),t(`div`,null,i[0]||=[n(`<h1 id="modules-typescript" tabindex="-1">Модули: TypeScript <a class="header-anchor" href="#modules-typescript" aria-label="Permalink to “Модули: TypeScript”">​</a></h1><div class="info custom-block"><p class="custom-block-title">[История]</p><table tabindex="0"><thead><tr><th>Версия</th><th>Изменения</th></tr></thead><tbody><tr><td>v22.7.0</td><td>Добавлен флаг <code>--experimental-transform-types</code>.</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">[Стабильно: 1 - Экспериментально]</p><p><a href="/ru/nodejs/api/documentation#stability-index">Стабильно: 1</a> <a href="/ru/nodejs/api/documentation#stability-index">Стабильность: 1</a>.1 - Активная разработка</p></div><h2 id="enabling" tabindex="-1">Включение <a class="header-anchor" href="#enabling" aria-label="Permalink to “Включение”">​</a></h2><p>Есть два способа включить поддержку TypeScript во время выполнения в Node.js:</p><h2 id="full-typescript-support" tabindex="-1">Полная поддержка TypeScript <a class="header-anchor" href="#full-typescript-support" aria-label="Permalink to “Полная поддержка TypeScript”">​</a></h2><p>Чтобы использовать TypeScript с полной поддержкой всех функций TypeScript, включая <code>tsconfig.json</code>, вы можете использовать сторонний пакет. В этих инструкциях <a href="https://tsx.is/" target="_blank" rel="noreferrer"><code>tsx</code></a> используется в качестве примера, но существует множество других подобных библиотек.</p><h2 id="type-stripping" tabindex="-1">Удаление типов <a class="header-anchor" href="#type-stripping" aria-label="Permalink to “Удаление типов”">​</a></h2><p><strong>Добавлено в: v22.6.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[Стабильно: 1 - Экспериментально]</p><p><a href="/ru/nodejs/api/documentation#stability-index">Стабильно: 1</a> <a href="/ru/nodejs/api/documentation#stability-index">Стабильность: 1</a>.1 - Активная разработка</p></div><p>Флаг <a href="/ru/nodejs/api/cli#experimental-strip-types"><code>--experimental-strip-types</code></a> позволяет Node.js запускать файлы TypeScript. По умолчанию Node.js будет выполнять только файлы, которые не содержат функций TypeScript, требующих преобразования, таких как перечисления или пространства имен. Node.js заменит встроенные аннотации типов пробелами, и проверка типов не выполняется. Чтобы включить преобразование таких функций, используйте флаг <a href="/ru/nodejs/api/cli#experimental-transform-types"><code>--experimental-transform-types</code></a>. Функции TypeScript, зависящие от настроек в <code>tsconfig.json</code>, такие как пути или преобразование более нового синтаксиса JavaScript в более старые стандарты, намеренно не поддерживаются. Для получения полной поддержки TypeScript см. раздел <a href="/ru/nodejs/api/typescript#full-typescript-support">Полная поддержка TypeScript</a>.</p><p>Функция удаления типов разработана как облегченная. Намеренно не поддерживая синтаксис, требующий генерации кода JavaScript, и заменяя встроенные типы пробелами, Node.js может запускать код TypeScript без необходимости использования карт исходного кода.</p><p>Удаление типов работает с большинством версий TypeScript, но мы рекомендуем версию 5.7 или новее со следующими настройками <code>tsconfig.json</code>:</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;compilerOptions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     &quot;target&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;esnext&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     &quot;module&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;nodenext&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     &quot;allowImportingTsExtensions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     &quot;rewriteRelativeImportExtensions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     &quot;verbatimModuleSyntax&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="determining-module-system" tabindex="-1">Определение системы модулей <a class="header-anchor" href="#determining-module-system" aria-label="Permalink to “Определение системы модулей”">​</a></h3><p>Node.js поддерживает как синтаксис <a href="/ru/nodejs/api/modules">CommonJS</a>, так и <a href="/ru/nodejs/api/esm">ES Modules</a> в файлах TypeScript. Node.js не преобразует одну систему модулей в другую; если вы хотите, чтобы ваш код выполнялся как ES-модуль, вы должны использовать синтаксис <code>import</code> и <code>export</code>, а если вы хотите, чтобы ваш код выполнялся как CommonJS, вы должны использовать <code>require</code> и <code>module.exports</code>.</p><ul><li>Система модулей для файлов <code>.ts</code> определяется <a href="/ru/nodejs/api/packages#determining-module-system">так же, как и для файлов <code>.js</code>.</a> Чтобы использовать синтаксис <code>import</code> и <code>export</code>, добавьте <code>&quot;type&quot;: &quot;module&quot;</code> в ближайший родительский <code>package.json</code>.</li><li>Файлы <code>.mts</code> всегда будут запускаться как ES-модули, аналогично файлам <code>.mjs</code>.</li><li>Файлы <code>.cts</code> всегда будут запускаться как модули CommonJS, аналогично файлам <code>.cjs</code>.</li><li>Файлы <code>.tsx</code> не поддерживаются.</li></ul><p>Как и в файлах JavaScript, <a href="/ru/nodejs/api/esm#mandatory-file-extensions">расширения файлов обязательны</a> в операторах <code>import</code> и выражениях <code>import()</code>: <code>import &#39;./file.ts&#39;</code>, а не <code>import &#39;./file&#39;</code>. Из-за обратной совместимости расширения файлов также обязательны в вызовах <code>require()</code>: <code>require(&#39;./file.ts&#39;)</code>, а не <code>require(&#39;./file&#39;)</code>, аналогично тому, как расширение <code>.cjs</code> является обязательным в вызовах <code>require</code> в файлах CommonJS.</p><p>Опция <code>tsconfig.json</code> <code>allowImportingTsExtensions</code> позволит компилятору TypeScript <code>tsc</code> проверять типы файлов со спецификаторами <code>import</code>, которые включают расширение <code>.ts</code>.</p><h3 id="typescript-features" tabindex="-1">Функции TypeScript <a class="header-anchor" href="#typescript-features" aria-label="Permalink to “Функции TypeScript”">​</a></h3><p>Поскольку Node.js только удаляет встроенные типы, любые функции TypeScript, которые включают <em>замену</em> синтаксиса TypeScript новым синтаксисом JavaScript, приведут к ошибке, если не будет передан флаг <a href="/ru/nodejs/api/cli#experimental-transform-types"><code>--experimental-transform-types</code></a>.</p><p>Наиболее заметными функциями, требующими преобразования, являются:</p><ul><li><code>Enum</code></li><li><code>namespaces</code></li><li><code>legacy module</code></li><li>parameter properties</li></ul><p>Поскольку Decorators в настоящее время являются <a href="https://github.com/tc39/proposal-decorators" target="_blank" rel="noreferrer">предложением TC39 Stage 3</a> и скоро будут поддерживаться движком JavaScript, они не преобразуются и приведут к ошибке парсера. Это временное ограничение, которое будет устранено в будущем.</p><p>Кроме того, Node.js не читает файлы <code>tsconfig.json</code> и не поддерживает функции, которые зависят от настроек в <code>tsconfig.json</code>, такие как paths или преобразование более нового синтаксиса JavaScript в более старые стандарты.</p><h3 id="importing-types-without-type-keyword" tabindex="-1">Импорт типов без ключевого слова <code>type</code> <a class="header-anchor" href="#importing-types-without-type-keyword" aria-label="Permalink to “Импорт типов без ключевого слова type”">​</a></h3><p>Из-за особенностей удаления типов ключевое слово <code>type</code> необходимо для корректного удаления импорта типов. Без ключевого слова <code>type</code> Node.js будет рассматривать импорт как импорт значения, что приведет к ошибке во время выполнения. Опция tsconfig <a href="https://www.typescriptlang.org/tsconfig/#verbatimModuleSyntax" target="_blank" rel="noreferrer"><code>verbatimModuleSyntax</code></a> может быть использована для соответствия этому поведению.</p><p>Этот пример будет работать правильно:</p><div class="language-ts line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Type1, Type2 } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./module.ts&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { fn, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FnParams } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./fn.ts&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Это приведет к ошибке во время выполнения:</p><div class="language-ts line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Type1, Type2 } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./module.ts&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { fn, FnParams } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./fn.ts&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="non-file-forms-of-input" tabindex="-1">Нефайловые формы ввода <a class="header-anchor" href="#non-file-forms-of-input" aria-label="Permalink to “Нефайловые формы ввода”">​</a></h3><p>Удаление типов может быть включено для <code>--eval</code>. Модульная система будет определяться <code>--input-type</code>, как и для JavaScript.</p><p>Синтаксис TypeScript не поддерживается в REPL, STDIN, <code>--print</code>, <code>--check</code> и <code>inspect</code>.</p><h3 id="source-maps" tabindex="-1">Source maps <a class="header-anchor" href="#source-maps" aria-label="Permalink to “Source maps”">​</a></h3><p>Поскольку встроенные типы заменяются пробелами, source maps не нужны для правильных номеров строк в stack traces; и Node.js не генерирует их. Когда <a href="/ru/nodejs/api/cli#experimental-transform-types"><code>--experimental-transform-types</code></a> включен, source-maps включены по умолчанию.</p><h3 id="type-stripping-in-dependencies" tabindex="-1">Удаление типов в зависимостях <a class="header-anchor" href="#type-stripping-in-dependencies" aria-label="Permalink to “Удаление типов в зависимостях”">​</a></h3><p>Чтобы отговорить авторов пакетов от публикации пакетов, написанных на TypeScript, Node.js по умолчанию будет отказываться обрабатывать файлы TypeScript внутри папок под путем <code>node_modules</code>.</p><h3 id="paths-aliases" tabindex="-1">Псевдонимы путей <a class="header-anchor" href="#paths-aliases" aria-label="Permalink to “Псевдонимы путей”">​</a></h3><p><a href="https://www.typescriptlang.org/tsconfig/#paths" target="_blank" rel="noreferrer"><code>tsconfig</code> &quot;paths&quot;</a> не будут преобразованы и, следовательно, приведут к ошибке. Ближайшей доступной функцией является <a href="/ru/nodejs/api/packages#subpath-imports">subpath imports</a> с ограничением, что они должны начинаться с <code>#</code>.</p>`,40)])}var s=e(a,[[`render`,o]]);export{i as __pageData,s as default};