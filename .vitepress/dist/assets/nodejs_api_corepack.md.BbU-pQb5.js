import{__plugin_vue_export_helper_default as e,createElementBlock as t,createStaticVNode as n,openBlock as r}from"./chunks/plugin-vue_export-helper.Bts1mPc7.js";const i=JSON.parse(`{"title":"Node.js Corepack Documentation","description":"Corepack is a binary shipped with Node.js, providing a standard interface for managing package managers like npm, pnpm, and Yarn. It allows users to easily switch between different package managers and versions, ensuring compatibility and simplifying the development workflow.","frontmatter":{"title":"Node.js Corepack Documentation","description":"Corepack is a binary shipped with Node.js, providing a standard interface for managing package managers like npm, pnpm, and Yarn. It allows users to easily switch between different package managers and versions, ensuring compatibility and simplifying the development workflow.","head":[["meta",{"name":"og:title","content":"Node.js Corepack Documentation | Node.js - iDoc.dev"}],["meta",{"name":"og:description","content":"Corepack is a binary shipped with Node.js, providing a standard interface for managing package managers like npm, pnpm, and Yarn. It allows users to easily switch between different package managers and versions, ensuring compatibility and simplifying the development workflow."}],["meta",{"name":"twitter:title","content":"Node.js Corepack Documentation | Node.js - iDoc.dev"}],["meta",{"name":"twitter:description","content":"Corepack is a binary shipped with Node.js, providing a standard interface for managing package managers like npm, pnpm, and Yarn. It allows users to easily switch between different package managers and versions, ensuring compatibility and simplifying the development workflow."}],["link",{"rel":"canonical","href":"https://idoc.dev/nodejs/api/corepack"}],["meta",{"property":"og:url","content":"https://idoc.dev/nodejs/api/corepack"}]]},"headers":[],"relativePath":"nodejs/api/corepack.md","filePath":"en/nodejs/api/corepack.md","lastUpdated":null}`),a={name:`nodejs/api/corepack.md`};function o(e,i,a,o,s,c){return r(),t(`div`,null,i[0]||=[n(`<h1 id="corepack" tabindex="-1">Corepack <a class="header-anchor" href="#corepack" aria-label="Permalink to “Corepack”">​</a></h1><p><strong>Added in: v16.9.0, v14.19.0</strong></p><div class="warning custom-block"><p class="custom-block-title">[Stable: 1 - Experimental]</p><p><a href="/nodejs/api/documentation#stability-index">Stable: 1</a> <a href="/nodejs/api/documentation#stability-index">Stability: 1</a> - Experimental</p></div><p><em><a href="https://github.com/nodejs/corepack">Corepack</a></em> is an experimental tool to help with managing versions of your package managers. It exposes binary proxies for each <a href="/nodejs/api/corepack#supported-package-managers">supported package manager</a> that, when called, will identify whatever package manager is configured for the current project, download it if needed, and finally run it.</p><p>Despite Corepack being distributed with default installs of Node.js, the package managers managed by Corepack are not part of the Node.js distribution and:</p><ul><li>Upon first use, Corepack downloads the latest version from the network.</li><li>Any required updates (related to security vulnerabilities or otherwise) are out of scope of the Node.js project. If necessary end users must figure out how to update on their own.</li></ul><p>This feature simplifies two core workflows:</p><ul><li>It eases new contributor onboarding, since they won&#39;t have to follow system-specific installation processes anymore just to have the package manager you want them to.</li><li>It allows you to ensure that everyone in your team will use exactly the package manager version you intend them to, without them having to manually synchronize it each time you need to make an update.</li></ul><h2 id="workflows" tabindex="-1">Workflows <a class="header-anchor" href="#workflows" aria-label="Permalink to “Workflows”">​</a></h2><h3 id="enabling-the-feature" tabindex="-1">Enabling the feature <a class="header-anchor" href="#enabling-the-feature" aria-label="Permalink to “Enabling the feature”">​</a></h3><p>Due to its experimental status, Corepack currently needs to be explicitly enabled to have any effect. To do that, run <a href="https://github.com/nodejs/corepack#corepack-enable--name" target="_blank" rel="noreferrer"><code>corepack enable</code></a>, which will set up the symlinks in your environment next to the <code>node</code> binary (and overwrite the existing symlinks if necessary).</p><p>From this point forward, any call to the <a href="/nodejs/api/corepack#supported-package-managers">supported binaries</a> will work without further setup. Should you experience a problem, run <a href="https://github.com/nodejs/corepack#corepack-disable--name" target="_blank" rel="noreferrer"><code>corepack disable</code></a> to remove the proxies from your system (and consider opening an issue on the <a href="https://github.com/nodejs/corepack" target="_blank" rel="noreferrer">Corepack repository</a> to let us know).</p><h3 id="configuring-a-package" tabindex="-1">Configuring a package <a class="header-anchor" href="#configuring-a-package" aria-label="Permalink to “Configuring a package”">​</a></h3><p>The Corepack proxies will find the closest <a href="/nodejs/api/packages#nodejs-packagejson-field-definitions"><code>package.json</code></a> file in your current directory hierarchy to extract its <a href="/nodejs/api/packages#packagemanager"><code>&quot;packageManager&quot;</code></a> property.</p><p>If the value corresponds to a <a href="/nodejs/api/corepack#supported-package-managers">supported package manager</a>, Corepack will make sure that all calls to the relevant binaries are run against the requested version, downloading it on demand if needed, and aborting if it cannot be successfully retrieved.</p><p>You can use <a href="https://github.com/nodejs/corepack#corepack-use-nameversion" target="_blank" rel="noreferrer"><code>corepack use</code></a> to ask Corepack to update your local <code>package.json</code> to use the package manager of your choice:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">corepack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # sets the latest 7.x version in the package.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">corepack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yarn@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # sets the latest version in the package.json</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="upgrading-the-global-versions" tabindex="-1">Upgrading the global versions <a class="header-anchor" href="#upgrading-the-global-versions" aria-label="Permalink to “Upgrading the global versions”">​</a></h3><p>When running outside of an existing project (for example when running <code>yarn init</code>), Corepack will by default use predefined versions roughly corresponding to the latest stable releases from each tool. Those versions can be overridden by running the <a href="https://github.com/nodejs/corepack#corepack-install--g--global---all--nameversion" target="_blank" rel="noreferrer"><code>corepack install</code></a> command along with the package manager version you wish to set:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">corepack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --global</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Alternately, a tag or range may be used:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">corepack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pnpm@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">corepack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yarn@stable</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="offline-workflow" tabindex="-1">Offline workflow <a class="header-anchor" href="#offline-workflow" aria-label="Permalink to “Offline workflow”">​</a></h3><p>Many production environments don&#39;t have network access. Since Corepack usually downloads the package manager releases straight from their registries, it can conflict with such environments. To avoid that happening, call the <a href="https://github.com/nodejs/corepack#corepack-pack---all--nameversion" target="_blank" rel="noreferrer"><code>corepack pack</code></a> command while you still have network access (typically at the same time you&#39;re preparing your deploy image). This will ensure that the required package managers are available even without network access.</p><p>The <code>pack</code> command has <a href="https://github.com/nodejs/corepack#utility-commands" target="_blank" rel="noreferrer">various flags</a>. Consult the detailed <a href="https://github.com/nodejs/corepack#readme" target="_blank" rel="noreferrer">Corepack documentation</a> for more information.</p><h2 id="supported-package-managers" tabindex="-1">Supported package managers <a class="header-anchor" href="#supported-package-managers" aria-label="Permalink to “Supported package managers”">​</a></h2><p>The following binaries are provided through Corepack:</p><table tabindex="0"><thead><tr><th>Package manager</th><th>Binary names</th></tr></thead><tbody><tr><td><a href="https://yarnpkg.com/" target="_blank" rel="noreferrer">Yarn</a></td><td><code>yarn</code> , <code>yarnpkg</code></td></tr><tr><td><a href="https://pnpm.io/" target="_blank" rel="noreferrer">pnpm</a></td><td><code>pnpm</code> , <code>pnpx</code></td></tr></tbody></table><h2 id="common-questions" tabindex="-1">Common questions <a class="header-anchor" href="#common-questions" aria-label="Permalink to “Common questions”">​</a></h2><h3 id="how-does-corepack-interact-with-npm?" tabindex="-1">How does Corepack interact with npm? <a class="header-anchor" href="#how-does-corepack-interact-with-npm?" aria-label="Permalink to “How does Corepack interact with npm?”">​</a></h3><p>While Corepack could support npm like any other package manager, its shims aren&#39;t enabled by default. This has a few consequences:</p><ul><li>It&#39;s always possible to run a <code>npm</code> command within a project configured to be used with another package manager, since Corepack cannot intercept it.</li><li>While <code>npm</code> is a valid option in the <a href="/nodejs/api/packages#packagemanager"><code>&quot;packageManager&quot;</code></a> property, the lack of shim will cause the global npm to be used.</li></ul><h3 id="running-npm-install--g-yarn-doesnt-work" tabindex="-1">Running <code>npm install -g yarn</code> doesn&#39;t work <a class="header-anchor" href="#running-npm-install--g-yarn-doesnt-work" aria-label="Permalink to “Running npm install -g yarn doesn&#39;t work”">​</a></h3><p>npm prevents accidentally overriding the Corepack binaries when doing a global install. To avoid this problem, consider one of the following options:</p><ul><li>Don&#39;t run this command; Corepack will provide the package manager binaries anyway and will ensure that the requested versions are always available, so installing the package managers explicitly isn&#39;t needed.</li><li>Add the <code>--force</code> flag to <code>npm install</code>; this will tell npm that it&#39;s fine to override binaries, but you&#39;ll erase the Corepack ones in the process. (Run <a href="https://github.com/nodejs/corepack#corepack-enable--name" target="_blank" rel="noreferrer"><code>corepack enable</code></a> to add them back.)</li></ul>`,35)])}var s=e(a,[[`render`,o]]);export{i as __pageData,s as default};