---
title: Документация Corepack для Node.js
description: Corepack - это бинарный файл, поставляемый вместе с Node.js, который предоставляет стандартный интерфейс для управления менеджерами пакетов, такими как npm, pnpm и Yarn. Он позволяет пользователям легко переключаться между различными менеджерами пакетов и версиями, обеспечивая совместимость и упрощая рабочий процесс разработки.
head:
  - - meta
    - name: og:title
      content: Документация Corepack для Node.js | Node.js - iDoc.dev
  - - meta
    - name: og:description
      content: Corepack - это бинарный файл, поставляемый вместе с Node.js, который предоставляет стандартный интерфейс для управления менеджерами пакетов, такими как npm, pnpm и Yarn. Он позволяет пользователям легко переключаться между различными менеджерами пакетов и версиями, обеспечивая совместимость и упрощая рабочий процесс разработки.
  - - meta
    - name: twitter:title
      content: Документация Corepack для Node.js | Node.js - iDoc.dev
  - - meta
    - name: twitter:description
      content: Corepack - это бинарный файл, поставляемый вместе с Node.js, который предоставляет стандартный интерфейс для управления менеджерами пакетов, такими как npm, pnpm и Yarn. Он позволяет пользователям легко переключаться между различными менеджерами пакетов и версиями, обеспечивая совместимость и упрощая рабочий процесс разработки.
---


# Corepack {#corepack}

**Добавлено в: v16.9.0, v14.19.0**

::: warning [Стабильность: 1 - Экспериментальный]
[Стабильность: 1](/ru/nodejs/api/documentation#stability-index) [Стабильность: 1](/ru/nodejs/api/documentation#stability-index) - Экспериментальный
:::

*<a href="https://github.com/nodejs/corepack">Corepack</a>* - это экспериментальный инструмент, помогающий управлять версиями ваших менеджеров пакетов. Он предоставляет бинарные прокси для каждого [поддерживаемого менеджера пакетов](/ru/nodejs/api/corepack#supported-package-managers), которые при вызове идентифицируют, какой менеджер пакетов настроен для текущего проекта, загружают его при необходимости и, наконец, запускают.

Несмотря на то, что Corepack распространяется с установками Node.js по умолчанию, менеджеры пакетов, управляемые Corepack, не являются частью дистрибутива Node.js и:

- При первом использовании Corepack загружает последнюю версию из сети.
- Любые необходимые обновления (связанные с уязвимостями безопасности или иные) выходят за рамки проекта Node.js. При необходимости конечные пользователи должны самостоятельно решать, как выполнять обновления.

Эта функция упрощает два основных рабочих процесса:

- Это облегчает адаптацию новых участников, поскольку им больше не придется следовать специфическим для системы процессам установки, чтобы получить желаемый менеджер пакетов.
- Это позволяет вам убедиться, что каждый член вашей команды будет использовать именно ту версию менеджера пакетов, которую вы хотите, без необходимости вручную синхронизировать ее каждый раз, когда вам нужно внести обновление.

## Рабочие процессы {#workflows}

### Включение функции {#enabling-the-feature}

Из-за своего экспериментального статуса Corepack в настоящее время необходимо явно включить, чтобы он оказал какое-либо влияние. Для этого запустите [`corepack enable`](https://github.com/nodejs/corepack#corepack-enable--name), который установит символические ссылки в вашей среде рядом с двоичным файлом `node` (и перезапишет существующие символические ссылки, если необходимо).

С этого момента любой вызов [поддерживаемых бинарных файлов](/ru/nodejs/api/corepack#supported-package-managers) будет работать без дальнейшей настройки. Если у вас возникнут проблемы, запустите [`corepack disable`](https://github.com/nodejs/corepack#corepack-disable--name), чтобы удалить прокси из вашей системы (и подумайте об открытии issue в [репозитории Corepack](https://github.com/nodejs/corepack), чтобы сообщить нам об этом).


### Настройка пакета {#configuring-a-package}

Прокси-серверы Corepack найдут ближайший файл [`package.json`](/ru/nodejs/api/packages#nodejs-packagejson-field-definitions) в иерархии вашей текущей директории, чтобы извлечь его свойство [`"packageManager"`](/ru/nodejs/api/packages#packagemanager).

Если значение соответствует [поддерживаемому менеджеру пакетов](/ru/nodejs/api/corepack#supported-package-managers), Corepack убедится, что все вызовы соответствующих бинарных файлов выполняются с запрошенной версией, загружая ее по требованию, если это необходимо, и прерывая процесс, если ее не удается успешно получить.

Вы можете использовать [`corepack use`](https://github.com/nodejs/corepack#corepack-use-nameversion), чтобы попросить Corepack обновить ваш локальный `package.json` для использования менеджера пакетов по вашему выбору:

```bash [BASH]
corepack use  # устанавливает последнюю версию 7.x в package.json
corepack use yarn@* # устанавливает последнюю версию в package.json
```
### Обновление глобальных версий {#upgrading-the-global-versions}

При запуске вне существующего проекта (например, при запуске `yarn init`), Corepack по умолчанию будет использовать предопределенные версии, примерно соответствующие последним стабильным выпускам каждого инструмента. Эти версии можно переопределить, запустив команду [`corepack install`](https://github.com/nodejs/corepack#corepack-install--g--global---all--nameversion) вместе с версией менеджера пакетов, которую вы хотите установить:

```bash [BASH]
corepack install --global
```
Альтернативно, можно использовать тег или диапазон:

```bash [BASH]
corepack install --global pnpm@*
corepack install --global yarn@stable
```
### Автономный режим работы {#offline-workflow}

Многие производственные среды не имеют доступа к сети. Поскольку Corepack обычно загружает выпуски менеджеров пакетов непосредственно из их реестров, это может конфликтовать с такими средами. Чтобы избежать этого, вызовите команду [`corepack pack`](https://github.com/nodejs/corepack#corepack-pack---all--nameversion), пока у вас еще есть доступ к сети (обычно одновременно с подготовкой образа для развертывания). Это гарантирует, что необходимые менеджеры пакетов будут доступны даже без доступа к сети.

Команда `pack` имеет [различные флаги](https://github.com/nodejs/corepack#utility-commands). Обратитесь к подробной [документации Corepack](https://github.com/nodejs/corepack#readme) для получения дополнительной информации.


## Поддерживаемые менеджеры пакетов {#supported-package-managers}

Через Corepack предоставляются следующие бинарные файлы:

| Менеджер пакетов | Имена бинарных файлов |
| --- | --- |
| [Yarn](https://yarnpkg.com/) | `yarn`  ,   `yarnpkg` |
| [pnpm](https://pnpm.io/) | `pnpm`  ,   `pnpx` |
## Часто задаваемые вопросы {#common-questions}

### Как Corepack взаимодействует с npm? {#how-does-corepack-interact-with-npm?}

Хотя Corepack может поддерживать npm как любой другой менеджер пакетов, его шимы не включены по умолчанию. Это имеет несколько последствий:

- Всегда можно выполнить команду `npm` в проекте, настроенном для использования с другим менеджером пакетов, поскольку Corepack не может перехватить ее.
- Хотя `npm` является допустимым вариантом в свойстве [`"packageManager"`](/ru/nodejs/api/packages#packagemanager), отсутствие шима приведет к использованию глобального npm.

### Запуск `npm install -g yarn` не работает {#running-npm-install--g-yarn-doesnt-work}

npm предотвращает случайную перезапись бинарных файлов Corepack при выполнении глобальной установки. Чтобы избежать этой проблемы, рассмотрите один из следующих вариантов:

- Не запускайте эту команду; Corepack в любом случае предоставит бинарные файлы менеджера пакетов и обеспечит постоянную доступность запрошенных версий, поэтому установка менеджеров пакетов явным образом не требуется.
- Добавьте флаг `--force` к `npm install`; это сообщит npm, что перезапись бинарных файлов допустима, но при этом вы сотрете бинарные файлы Corepack. (Запустите [`corepack enable`](https://github.com/nodejs/corepack#corepack-enable--name), чтобы добавить их обратно.)

